!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n||e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function createFirebaseNamespace(){function removeApp(name){callAppHooks(apps_[name],"delete"),delete apps_[name]}function app(name){return name=name||DEFAULT_ENTRY_NAME,contains(apps_,name)||error("no-app",{name:name}),apps_[name]}function initializeApp(options,rawConfig){if(void 0===rawConfig&&(rawConfig={}),"object"!=typeof rawConfig||null===rawConfig){rawConfig={name:rawConfig}}var config=rawConfig;void 0===config.name&&(config.name=DEFAULT_ENTRY_NAME);var name=config.name;"string"==typeof name&&name||error("bad-app-name",{name:name+""}),contains(apps_,name)&&error("duplicate-app",{name:name});var app=new FirebaseAppImpl(options,config,namespace);return apps_[name]=app,callAppHooks(app,"create"),app}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){factories[name]&&error("duplicate-service",{name:name}),factories[name]=createService,appHook&&(appHooks[name]=appHook,getApps().forEach(function(app){appHook("create",app)}));var serviceNamespace=function(appArg){return void 0===appArg&&(appArg=app()),"function"!=typeof appArg[name]&&error("invalid-app-argument",{name:name}),appArg[name]()};return void 0!==serviceProperties&&util.deepExtend(serviceNamespace,serviceProperties),namespace[name]=serviceNamespace,FirebaseAppImpl.prototype[name]=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];return this._getService.bind(this,name).apply(this,allowMultipleInstances?args:[])},serviceNamespace}function extendNamespace(props){util.deepExtend(namespace,props)}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);null!==factoryName&&appHooks[factoryName]&&appHooks[factoryName](eventName,app)})}function useAsService(app,name){if("serverAuth"===name)return null;var useService=name;app.options;return useService}var apps_={},factories={},appHooks={},namespace={__esModule:!0,initializeApp:initializeApp,app:app,apps:null,Promise:Promise,SDK_VERSION:"5.0.4",INTERNAL:{registerService:registerService,createFirebaseNamespace:createFirebaseNamespace,extendNamespace:extendNamespace,createSubscribe:util.createSubscribe,ErrorFactory:util.ErrorFactory,removeApp:removeApp,factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:util.deepExtend}};return util.patchProperty(namespace,"default",namespace),Object.defineProperty(namespace,"apps",{get:getApps}),util.patchProperty(app,"App",FirebaseAppImpl),namespace}function error(code,args){throw appErrors.create(code,args)}Object.defineProperty(exports,"__esModule",{value:!0});var util=require("@firebase/util"),contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},DEFAULT_ENTRY_NAME="[DEFAULT]",tokenListeners=[],FirebaseAppImpl=function(){function FirebaseAppImpl(options,config,firebase_){this.firebase_=firebase_,this.isDeleted_=!1,this.services_={},this.name_=config.name,this._automaticDataCollectionEnabled=config.automaticDataCollectionEnabled||!1,this.options_=util.deepCopy(options),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback),setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}return Object.defineProperty(FirebaseAppImpl.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(val){this.checkDestroyed_(),this._automaticDataCollectionEnabled=val},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(FirebaseAppImpl.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_(),resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];return Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})}),Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=!0,_this.services_={}})},FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(void 0===instanceIdentifier&&(instanceIdentifier=DEFAULT_ENTRY_NAME),this.checkDestroyed_(),this.services_[name]||(this.services_[name]={}),!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier!==DEFAULT_ENTRY_NAME?instanceIdentifier:void 0,service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]},FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;util.deepExtend(this,props),props.INTERNAL&&props.INTERNAL.addAuthTokenListener&&(tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)}),tokenListeners=[])},FirebaseAppImpl.prototype.checkDestroyed_=function(){this.isDeleted_&&error("app-deleted",{name:this.name_})},FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log("dc");var errors={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},appErrors=new util.ErrorFactory("app","Firebase",errors),firebase=createFirebaseNamespace();exports.firebase=firebase,exports.default=firebase},{"@firebase/util":5}],2:[function(require,module,exports){(function(process){"use strict";function decodePath(pathString){for(var pathStringDecoded="",pieces=pathString.split("/"),i=0;i<pieces.length;i++)if(pieces[i].length>0){var piece=pieces[i];try{piece=decodeURIComponent(piece.replace(/\+/g," "))}catch(e){}pathStringDecoded+="/"+piece}return pathStringDecoded}function decodeQuery(queryString){var results={};"?"===queryString.charAt(0)&&(queryString=queryString.substring(1));for(var _i=0,_a=queryString.split("&");_i<_a.length;_i++){var segment=_a[_i];if(0!==segment.length){var kv=segment.split("=");2===kv.length?results[decodeURIComponent(kv[0])]=decodeURIComponent(kv[1]):warn("Invalid query segment '"+segment+"' in query '"+queryString+"'")}}return results}function NAME_ONLY_COMPARATOR(left,right){return nameCompare(left.name,right.name)}function NAME_COMPARATOR(left,right){return nameCompare(left,right)}function nodeFromJSON$1(json,priority){if(void 0===priority&&(priority=null),null===json)return ChildrenNode.EMPTY_NODE;if("object"==typeof json&&".priority"in json&&(priority=json[".priority"]),util.assert(null===priority||"string"==typeof priority||"number"==typeof priority||"object"==typeof priority&&".sv"in priority,"Invalid priority type found: "+typeof priority),"object"==typeof json&&".value"in json&&null!==json[".value"]&&(json=json[".value"]),"object"!=typeof json||".sv"in json){return new LeafNode(json,nodeFromJSON$1(priority))}if(json instanceof Array||!USE_HINZE){var node_1=ChildrenNode.EMPTY_NODE,jsonObj_1=json;return util.forEach(jsonObj_1,function(key,childData){if(util.contains(jsonObj_1,key)&&"."!==key.substring(0,1)){var childNode=nodeFromJSON$1(childData);!childNode.isLeafNode()&&childNode.isEmpty()||(node_1=node_1.updateImmediateChild(key,childNode))}}),node_1.updatePriority(nodeFromJSON$1(priority))}var children_1=[],childrenHavePriority_1=!1,hinzeJsonObj_1=json;if(util.forEach(hinzeJsonObj_1,function(key,child){if("string"!=typeof key||"."!==key.substring(0,1)){var childNode=nodeFromJSON$1(hinzeJsonObj_1[key]);childNode.isEmpty()||(childrenHavePriority_1=childrenHavePriority_1||!childNode.getPriority().isEmpty(),children_1.push(new NamedNode(key,childNode)))}}),0==children_1.length)return ChildrenNode.EMPTY_NODE;var childSet=buildChildSet(children_1,NAME_ONLY_COMPARATOR,function(namedNode){return namedNode.name},NAME_COMPARATOR);if(childrenHavePriority_1){var sortedChildSet=buildChildSet(children_1,PRIORITY_INDEX.getCompare());return new ChildrenNode(childSet,nodeFromJSON$1(priority),new IndexMap({".priority":sortedChildSet},{".priority":PRIORITY_INDEX}))}return new ChildrenNode(childSet,nodeFromJSON$1(priority),IndexMap.Default)}function registerDatabase(instance){var namespace=instance.INTERNAL.registerService("database",function(app,unused,url){return RepoManager.getInstance().databaseFromApp(app,url)},{Reference:Reference,Query:Query,Database:Database,enableLogging:enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS},null,!0);util.isNodeSdk()&&(module.exports=namespace)}Object.defineProperty(exports,"__esModule",{value:!0});var __EMPTY_NODE,MAX_NODE,__childrenNodeConstructor,nodeFromJSON,MAX_NODE$1,_defaultIndexMap,EMPTY_NODE,util=require("@firebase/util"),logger=require("@firebase/logger"),tslib_1=require("tslib"),firebase=function(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}(require("@firebase/app")),DOMStorageWrapper=function(){function DOMStorageWrapper(domStorage_){this.domStorage_=domStorage_,this.prefix_="firebase:"}return DOMStorageWrapper.prototype.set=function(key,value){null==value?this.domStorage_.removeItem(this.prefixedName_(key)):this.domStorage_.setItem(this.prefixedName_(key),util.stringify(value))},DOMStorageWrapper.prototype.get=function(key){var storedVal=this.domStorage_.getItem(this.prefixedName_(key));return null==storedVal?null:util.jsonEval(storedVal)},DOMStorageWrapper.prototype.remove=function(key){this.domStorage_.removeItem(this.prefixedName_(key))},DOMStorageWrapper.prototype.prefixedName_=function(name){return this.prefix_+name},DOMStorageWrapper.prototype.toString=function(){return this.domStorage_.toString()},DOMStorageWrapper}(),MemoryStorage=function(){function MemoryStorage(){this.cache_={},this.isInMemoryStorage=!0}return MemoryStorage.prototype.set=function(key,value){null==value?delete this.cache_[key]:this.cache_[key]=value},MemoryStorage.prototype.get=function(key){return util.contains(this.cache_,key)?this.cache_[key]:null},MemoryStorage.prototype.remove=function(key){delete this.cache_[key]},MemoryStorage}(),createStoragefor=function(domStorageName){try{if("undefined"!=typeof window&&void 0!==window[domStorageName]){var domStorage=window[domStorageName];return domStorage.setItem("firebase:sentinel","cache"),domStorage.removeItem("firebase:sentinel"),new DOMStorageWrapper(domStorage)}}catch(e){}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage"),logClient=new logger.Logger("@firebase/database"),LUIDGenerator=function(){var id=1;return function(){return id++}}(),sha1=function(str){var utf8Bytes=util.stringToByteArray(str),sha1=new util.Sha1;sha1.update(utf8Bytes);var sha1Bytes=sha1.digest();return util.base64.encodeByteArray(sha1Bytes)},buildLogMessage_=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];for(var message="",i=0;i<var_args.length;i++)Array.isArray(var_args[i])||var_args[i]&&"object"==typeof var_args[i]&&"number"==typeof var_args[i].length?message+=buildLogMessage_.apply(null,var_args[i]):"object"==typeof var_args[i]?message+=util.stringify(var_args[i]):message+=var_args[i],message+=" ";return message},logger$1=null,firstLog_=!0,enableLogging=function(logger_,persistent){util.assert(!persistent||!0===logger_||!1===logger_,"Can't turn on custom loggers persistently."),!0===logger_?(logClient.logLevel=logger.LogLevel.VERBOSE,logger$1=logClient.log.bind(logClient),persistent&&SessionStorage.set("logging_enabled",!0)):"function"==typeof logger_?logger$1=logger_:(logger$1=null,SessionStorage.remove("logging_enabled"))},log=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];if(!0===firstLog_&&(firstLog_=!1,null===logger$1&&!0===SessionStorage.get("logging_enabled")&&enableLogging(!0)),logger$1){var message=buildLogMessage_.apply(null,var_args);logger$1(message)}},logWrapper=function(prefix){return function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];log.apply(void 0,[prefix].concat(var_args))}},error=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var message="FIREBASE INTERNAL ERROR: "+buildLogMessage_.apply(void 0,var_args);logClient.error(message)},fatal=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var message="FIREBASE FATAL ERROR: "+buildLogMessage_.apply(void 0,var_args);throw logClient.error(message),new Error(message)},warn=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var message="FIREBASE WARNING: "+buildLogMessage_.apply(void 0,var_args);logClient.warn(message)},warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(data){return"number"==typeof data&&(data!=data||data==Number.POSITIVE_INFINITY||data==Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(fn){if(util.isNodeSdk()||"complete"===document.readyState)fn();else{var called_1=!1,wrappedFn_1=function(){if(!document.body)return void setTimeout(wrappedFn_1,Math.floor(10));called_1||(called_1=!0,fn())};document.addEventListener?(document.addEventListener("DOMContentLoaded",wrappedFn_1,!1),window.addEventListener("load",wrappedFn_1,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&wrappedFn_1()}),window.attachEvent("onload",wrappedFn_1))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(a,b){if(a===b)return 0;if(a===MIN_NAME||b===MAX_NAME)return-1;if(b===MIN_NAME||a===MAX_NAME)return 1;var aAsInt=tryParseInt(a),bAsInt=tryParseInt(b);return null!==aAsInt?null!==bAsInt?aAsInt-bAsInt==0?a.length-b.length:aAsInt-bAsInt:-1:null!==bAsInt?1:a<b?-1:1},stringCompare=function(a,b){return a===b?0:a<b?-1:1},requireKey=function(key,obj){if(obj&&key in obj)return obj[key];throw new Error("Missing required key ("+key+") in object: "+util.stringify(obj))},ObjectToUniqueKey=function(obj){if("object"!=typeof obj||null===obj)return util.stringify(obj);var keys=[];for(var k in obj)keys.push(k);keys.sort();for(var key="{",i=0;i<keys.length;i++)0!==i&&(key+=","),key+=util.stringify(keys[i]),key+=":",key+=ObjectToUniqueKey(obj[keys[i]]);return key+="}"},splitStringBySize=function(str,segsize){var len=str.length;if(len<=segsize)return[str];for(var dataSegs=[],c=0;c<len;c+=segsize)c+segsize>len?dataSegs.push(str.substring(c,len)):dataSegs.push(str.substring(c,c+segsize));return dataSegs},each=function(obj,fn){if(Array.isArray(obj))for(var i=0;i<obj.length;++i)fn(i,obj[i]);else util.forEach(obj,function(key,val){return fn(val,key)})},doubleToIEEE754String=function(v){util.assert(!isInvalidJSONNumber(v),"Invalid JSON number");var s,e,f,ln,i,bits,str;for(0===v?(e=0,f=0,s=1/v==-1/0?1:0):(s=v<0,v=Math.abs(v),v>=Math.pow(2,-1022)?(ln=Math.min(Math.floor(Math.log(v)/Math.LN2),1023),e=ln+1023,f=Math.round(v*Math.pow(2,52-ln)-Math.pow(2,52))):(e=0,f=Math.round(v/Math.pow(2,-1074)))),bits=[],i=52;i;i-=1)bits.push(f%2?1:0),f=Math.floor(f/2);for(i=11;i;i-=1)bits.push(e%2?1:0),e=Math.floor(e/2);bits.push(s?1:0),bits.reverse(),str=bits.join("");var hexByteString="";for(i=0;i<64;i+=8){var hexByte=parseInt(str.substr(i,8),2).toString(16);1===hexByte.length&&(hexByte="0"+hexByte),hexByteString+=hexByte}return hexByteString.toLowerCase()},isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},errorForServerCode=function(code,query){var reason="Unknown Error";"too_big"===code?reason="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==code?reason="Client doesn't have permission to access the desired data.":"unavailable"==code&&(reason="The service is unavailable");var error=new Error(code+" at "+query.path.toString()+": "+reason);return error.code=code.toUpperCase(),error},INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),tryParseInt=function(str){if(INTEGER_REGEXP_.test(str)){var intVal=Number(str);if(intVal>=-2147483648&&intVal<=2147483647)return intVal}return null},exceptionGuard=function(fn){try{fn()}catch(e){setTimeout(function(){var stack=e.stack||"";throw warn("Exception was thrown by user callback.",stack),e},Math.floor(0))}},beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(fn,time){var timeout=setTimeout(fn,time);return"object"==typeof timeout&&timeout.unref&&timeout.unref(),timeout},Path=function(){function Path(pathOrString,pieceNum){if(void 0===pieceNum){this.pieces_=pathOrString.split("/");for(var copyTo=0,i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[copyTo]=this.pieces_[i],copyTo++);this.pieces_.length=copyTo,this.pieceNum_=0}else this.pieces_=pathOrString,this.pieceNum_=pieceNum}return Object.defineProperty(Path,"Empty",{get:function(){return new Path("")},enumerable:!0,configurable:!0}),Path.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},Path.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},Path.prototype.popFront=function(){var pieceNum=this.pieceNum_;return pieceNum<this.pieces_.length&&pieceNum++,new Path(this.pieces_,pieceNum)},Path.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},Path.prototype.toString=function(){for(var pathString="",i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(pathString+="/"+this.pieces_[i]);return pathString||"/"},Path.prototype.toUrlEncodedString=function(){for(var pathString="",i=this.pieceNum_;i<this.pieces_.length;i++)""!==this.pieces_[i]&&(pathString+="/"+encodeURIComponent(String(this.pieces_[i])));return pathString||"/"},Path.prototype.slice=function(begin){return void 0===begin&&(begin=0),this.pieces_.slice(this.pieceNum_+begin)},Path.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length-1;i++)pieces.push(this.pieces_[i]);return new Path(pieces,0)},Path.prototype.child=function(childPathObj){for(var pieces=[],i=this.pieceNum_;i<this.pieces_.length;i++)pieces.push(this.pieces_[i]);if(childPathObj instanceof Path)for(var i=childPathObj.pieceNum_;i<childPathObj.pieces_.length;i++)pieces.push(childPathObj.pieces_[i]);else for(var childPieces=childPathObj.split("/"),i=0;i<childPieces.length;i++)childPieces[i].length>0&&pieces.push(childPieces[i]);return new Path(pieces,0)},Path.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},Path.relativePath=function(outerPath,innerPath){var outer=outerPath.getFront(),inner=innerPath.getFront();if(null===outer)return innerPath;if(outer===inner)return Path.relativePath(outerPath.popFront(),innerPath.popFront());throw new Error("INTERNAL ERROR: innerPath ("+innerPath+") is not within outerPath ("+outerPath+")")},Path.comparePaths=function(left,right){for(var leftKeys=left.slice(),rightKeys=right.slice(),i=0;i<leftKeys.length&&i<rightKeys.length;i++){var cmp=nameCompare(leftKeys[i],rightKeys[i]);if(0!==cmp)return cmp}return leftKeys.length===rightKeys.length?0:leftKeys.length<rightKeys.length?-1:1},Path.prototype.equals=function(other){if(this.getLength()!==other.getLength())return!1;for(var i=this.pieceNum_,j=other.pieceNum_;i<=this.pieces_.length;i++,j++)if(this.pieces_[i]!==other.pieces_[j])return!1;return!0},Path.prototype.contains=function(other){var i=this.pieceNum_,j=other.pieceNum_;if(this.getLength()>other.getLength())return!1;for(;i<this.pieces_.length;){if(this.pieces_[i]!==other.pieces_[j])return!1;++i,++j}return!0},Path}(),ValidationPath=function(){function ValidationPath(path,errorPrefix_){this.errorPrefix_=errorPrefix_,this.parts_=path.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++)this.byteLength_+=util.stringLength(this.parts_[i]);this.checkValid_()}return Object.defineProperty(ValidationPath,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(ValidationPath,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),ValidationPath.prototype.push=function(child){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(child),this.byteLength_+=util.stringLength(child),this.checkValid_()},ValidationPath.prototype.pop=function(){var last=this.parts_.pop();this.byteLength_-=util.stringLength(last),this.parts_.length>0&&(this.byteLength_-=1)},ValidationPath.prototype.checkValid_=function(){if(this.byteLength_>ValidationPath.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+ValidationPath.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>ValidationPath.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ValidationPath.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},ValidationPath.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},ValidationPath}(),LONG_POLLING="long_polling",RepoInfo=function(){function RepoInfo(host,secure,namespace,webSocketOnly,persistenceKey){void 0===persistenceKey&&(persistenceKey=""),this.secure=secure,this.namespace=namespace,this.webSocketOnly=webSocketOnly,this.persistenceKey=persistenceKey,this.host=host.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+host)||this.host}return RepoInfo.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},RepoInfo.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},RepoInfo.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},RepoInfo.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},RepoInfo.prototype.updateHost=function(newHost){newHost!==this.internalHost&&(this.internalHost=newHost,this.isCacheableHost()&&PersistentStorage.set("host:"+this.host,this.internalHost))},RepoInfo.prototype.connectionURL=function(type,params){util.assert("string"==typeof type,"typeof type must == string"),util.assert("object"==typeof params,"typeof params must == object");var connURL;if("websocket"===type)connURL=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(type!==LONG_POLLING)throw new Error("Unknown connection type: "+type);connURL=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(params.ns=this.namespace);var pairs=[];return util.forEach(params,function(key,value){pairs.push(key+"="+value)}),connURL+pairs.join("&")},RepoInfo.prototype.toString=function(){var str=this.toURLString();return this.persistenceKey&&(str+="<"+this.persistenceKey+">"),str},RepoInfo.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},RepoInfo}(),parseRepoInfo=function(dataURL){var parsedUrl=parseURL(dataURL),namespace=parsedUrl.subdomain;"firebase"===parsedUrl.domain&&fatal(parsedUrl.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),namespace&&"undefined"!=namespace||"localhost"===parsedUrl.domain||fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),parsedUrl.secure||warnIfPageIsSecure();var webSocketOnly="ws"===parsedUrl.scheme||"wss"===parsedUrl.scheme;return{repoInfo:new RepoInfo(parsedUrl.host,parsedUrl.secure,namespace,webSocketOnly),path:new Path(parsedUrl.pathString)}},parseURL=function(dataURL){var host="",domain="",subdomain="",pathString="",secure=!0,scheme="https",port=443;if("string"==typeof dataURL){var colonInd=dataURL.indexOf("//");colonInd>=0&&(scheme=dataURL.substring(0,colonInd-1),dataURL=dataURL.substring(colonInd+2));var slashInd=dataURL.indexOf("/");-1===slashInd&&(slashInd=dataURL.length);var questionMarkInd=dataURL.indexOf("?");-1===questionMarkInd&&(questionMarkInd=dataURL.length),host=dataURL.substring(0,Math.min(slashInd,questionMarkInd)),slashInd<questionMarkInd&&(pathString=decodePath(dataURL.substring(slashInd,questionMarkInd)));var queryParams=decodeQuery(dataURL.substring(Math.min(dataURL.length,questionMarkInd)));colonInd=host.indexOf(":"),colonInd>=0?(secure="https"===scheme||"wss"===scheme,port=parseInt(host.substring(colonInd+1),10)):colonInd=dataURL.length;var parts=host.split(".");3===parts.length?(domain=parts[1],subdomain=parts[0].toLowerCase()):2===parts.length?domain=parts[0]:"localhost"===parts[0].slice(0,colonInd).toLowerCase()&&(domain="localhost"),""===subdomain&&"ns"in queryParams&&(subdomain=queryParams.ns)}return{host:host,port:port,domain:domain,subdomain:subdomain,secure:secure,scheme:scheme,pathString:pathString}},INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,isValidKey=function(key){return"string"==typeof key&&0!==key.length&&!INVALID_KEY_REGEX_.test(key)},isValidPathString=function(pathString){return"string"==typeof pathString&&0!==pathString.length&&!INVALID_PATH_REGEX_.test(pathString)},isValidRootPathString=function(pathString){return pathString&&(pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(pathString)},isValidPriority=function(priority){return null===priority||"string"==typeof priority||"number"==typeof priority&&!isInvalidJSONNumber(priority)||priority&&"object"==typeof priority&&util.contains(priority,".sv")},validateFirebaseDataArg=function(fnName,argumentNumber,data,path,optional){optional&&void 0===data||validateFirebaseData(util.errorPrefix(fnName,argumentNumber,optional),data,path)},validateFirebaseData=function(errorPrefix,data,path_){var path=path_ instanceof Path?new ValidationPath(path_,errorPrefix):path_;if(void 0===data)throw new Error(errorPrefix+"contains undefined "+path.toErrorString());if("function"==typeof data)throw new Error(errorPrefix+"contains a function "+path.toErrorString()+" with contents = "+data.toString());if(isInvalidJSONNumber(data))throw new Error(errorPrefix+"contains "+data.toString()+" "+path.toErrorString());if("string"==typeof data&&data.length>10485760/3&&util.stringLength(data)>10485760)throw new Error(errorPrefix+"contains a string greater than 10485760 utf8 bytes "+path.toErrorString()+" ('"+data.substring(0,50)+"...')");if(data&&"object"==typeof data){var hasDotValue_1=!1,hasActualChild_1=!1;if(util.forEach(data,function(key,value){if(".value"===key)hasDotValue_1=!0;else if(".priority"!==key&&".sv"!==key&&(hasActualChild_1=!0,!isValidKey(key)))throw new Error(errorPrefix+" contains an invalid key ("+key+") "+path.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');path.push(key),validateFirebaseData(errorPrefix,value,path),path.pop()}),hasDotValue_1&&hasActualChild_1)throw new Error(errorPrefix+' contains ".value" child '+path.toErrorString()+" in addition to actual children.")}},validateFirebaseMergePaths=function(errorPrefix,mergePaths){var i,curPath;for(i=0;i<mergePaths.length;i++){curPath=mergePaths[i];for(var keys=curPath.slice(),j=0;j<keys.length;j++)if(".priority"===keys[j]&&j===keys.length-1);else if(!isValidKey(keys[j]))throw new Error(errorPrefix+"contains an invalid key ("+keys[j]+") in path "+curPath.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}mergePaths.sort(Path.comparePaths);var prevPath=null;for(i=0;i<mergePaths.length;i++){if(curPath=mergePaths[i],null!==prevPath&&prevPath.contains(curPath))throw new Error(errorPrefix+"contains a path "+prevPath.toString()+" that is ancestor of another path "+curPath.toString());prevPath=curPath}},validateFirebaseMergeDataArg=function(fnName,argumentNumber,data,path,optional){if(!optional||void 0!==data){var errorPrefix=util.errorPrefix(fnName,argumentNumber,optional);if(!data||"object"!=typeof data||Array.isArray(data))throw new Error(errorPrefix+" must be an object containing the children to replace.");var mergePaths=[];util.forEach(data,function(key,value){var curPath=new Path(key);if(validateFirebaseData(errorPrefix,value,path.child(curPath)),".priority"===curPath.getBack()&&!isValidPriority(value))throw new Error(errorPrefix+"contains an invalid value for '"+curPath.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");mergePaths.push(curPath)}),validateFirebaseMergePaths(errorPrefix,mergePaths)}},validatePriority=function(fnName,argumentNumber,priority,optional){if(!optional||void 0!==priority){if(isInvalidJSONNumber(priority))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+"is "+priority.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!isValidPriority(priority))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},validateEventType=function(fnName,argumentNumber,eventType,optional){if(!optional||void 0!==eventType)switch(eventType){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},validateKey=function(fnName,argumentNumber,key,optional){if(!(optional&&void 0===key||isValidKey(key)))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'was an invalid key = "'+key+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},validatePathString=function(fnName,argumentNumber,pathString,optional){if(!(optional&&void 0===pathString||isValidPathString(pathString)))throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+'was an invalid path = "'+pathString+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')
},validateRootPathString=function(fnName,argumentNumber,pathString,optional){pathString&&(pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")),validatePathString(fnName,argumentNumber,pathString,optional)},validateWritablePath=function(fnName,path){if(".info"===path.getFront())throw new Error(fnName+" failed = Can't modify data under /.info/")},validateUrl=function(fnName,argumentNumber,parsedUrl){var pathString=parsedUrl.path.toString();if("string"!=typeof parsedUrl.repoInfo.host||0===parsedUrl.repoInfo.host.length||!isValidKey(parsedUrl.repoInfo.namespace)&&"localhost"!==parsedUrl.repoInfo.host.split(":")[0]||0!==pathString.length&&!isValidRootPathString(pathString))throw new Error(util.errorPrefix(fnName,argumentNumber,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},validateBoolean=function(fnName,argumentNumber,bool,optional){if((!optional||void 0!==bool)&&"boolean"!=typeof bool)throw new Error(util.errorPrefix(fnName,argumentNumber,optional)+"must be a boolean.")},OnDisconnect=function(){function OnDisconnect(repo_,path_){this.repo_=repo_,this.path_=path_}return OnDisconnect.prototype.cancel=function(onComplete){util.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),util.validateCallback("OnDisconnect.cancel",1,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectCancel(this.path_,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.remove=function(onComplete){util.validateArgCount("OnDisconnect.remove",0,1,arguments.length),validateWritablePath("OnDisconnect.remove",this.path_),util.validateCallback("OnDisconnect.remove",1,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSet(this.path_,null,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.set=function(value,onComplete){util.validateArgCount("OnDisconnect.set",1,2,arguments.length),validateWritablePath("OnDisconnect.set",this.path_),validateFirebaseDataArg("OnDisconnect.set",1,value,this.path_,!1),util.validateCallback("OnDisconnect.set",2,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSet(this.path_,value,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.setWithPriority=function(value,priority,onComplete){util.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),validateWritablePath("OnDisconnect.setWithPriority",this.path_),validateFirebaseDataArg("OnDisconnect.setWithPriority",1,value,this.path_,!1),validatePriority("OnDisconnect.setWithPriority",2,priority,!1),util.validateCallback("OnDisconnect.setWithPriority",3,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,value,priority,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect.prototype.update=function(objectToMerge,onComplete){if(util.validateArgCount("OnDisconnect.update",1,2,arguments.length),validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[""+i]=objectToMerge[i];objectToMerge=newObjectToMerge,warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("OnDisconnect.update",1,objectToMerge,this.path_,!1),util.validateCallback("OnDisconnect.update",2,onComplete,!0);var deferred=new util.Deferred;return this.repo_.onDisconnectUpdate(this.path_,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},OnDisconnect}(),TransactionResult=function(){function TransactionResult(committed,snapshot){this.committed=committed,this.snapshot=snapshot}return TransactionResult.prototype.toJSON=function(){return util.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},TransactionResult}(),nextPushId=function(){var PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",lastPushTime=0,lastRandChars=[];return function(now){var duplicateTime=now===lastPushTime;lastPushTime=now;var i,timeStampChars=new Array(8);for(i=7;i>=0;i--)timeStampChars[i]=PUSH_CHARS.charAt(now%64),now=Math.floor(now/64);util.assert(0===now,"Cannot push at time == 0");var id=timeStampChars.join("");if(duplicateTime){for(i=11;i>=0&&63===lastRandChars[i];i--)lastRandChars[i]=0;lastRandChars[i]++}else for(i=0;i<12;i++)lastRandChars[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)id+=PUSH_CHARS.charAt(lastRandChars[i]);return util.assert(20===id.length,"nextPushId: Length should be 20."),id}}(),NamedNode=function(){function NamedNode(name,node){this.name=name,this.node=node}return NamedNode.Wrap=function(name,node){return new NamedNode(name,node)},NamedNode}(),Index=function(){function Index(){}return Index.prototype.getCompare=function(){return this.compare.bind(this)},Index.prototype.indexedValueChanged=function(oldNode,newNode){var oldWrapped=new NamedNode(MIN_NAME,oldNode),newWrapped=new NamedNode(MIN_NAME,newNode);return 0!==this.compare(oldWrapped,newWrapped)},Index.prototype.minPost=function(){return NamedNode.MIN},Index}(),KeyIndex=function(_super){function KeyIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(KeyIndex,_super),Object.defineProperty(KeyIndex,"__EMPTY_NODE",{get:function(){return __EMPTY_NODE},set:function(val){__EMPTY_NODE=val},enumerable:!0,configurable:!0}),KeyIndex.prototype.compare=function(a,b){return nameCompare(a.name,b.name)},KeyIndex.prototype.isDefinedOn=function(node){throw util.assertionError("KeyIndex.isDefinedOn not expected to be called.")},KeyIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!1},KeyIndex.prototype.minPost=function(){return NamedNode.MIN},KeyIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,__EMPTY_NODE)},KeyIndex.prototype.makePost=function(indexValue,name){return util.assert("string"==typeof indexValue,"KeyIndex indexValue must always be a string."),new NamedNode(indexValue,__EMPTY_NODE)},KeyIndex.prototype.toString=function(){return".key"},KeyIndex}(Index),KEY_INDEX=new KeyIndex,priorityHashText=function(priority){return"number"==typeof priority?"number:"+doubleToIEEE754String(priority):"string:"+priority},validatePriorityNode=function(priorityNode){if(priorityNode.isLeafNode()){var val=priorityNode.val();util.assert("string"==typeof val||"number"==typeof val||"object"==typeof val&&util.contains(val,".sv"),"Priority must be a string or number.")}else util.assert(priorityNode===MAX_NODE||priorityNode.isEmpty(),"priority of unexpected type.");util.assert(priorityNode===MAX_NODE||priorityNode.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},LeafNode=function(){function LeafNode(value_,priorityNode_){void 0===priorityNode_&&(priorityNode_=LeafNode.__childrenNodeConstructor.EMPTY_NODE),this.value_=value_,this.priorityNode_=priorityNode_,this.lazyHash_=null,util.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}return Object.defineProperty(LeafNode,"__childrenNodeConstructor",{get:function(){return __childrenNodeConstructor},set:function(val){__childrenNodeConstructor=val},enumerable:!0,configurable:!0}),LeafNode.prototype.isLeafNode=function(){return!0},LeafNode.prototype.getPriority=function(){return this.priorityNode_},LeafNode.prototype.updatePriority=function(newPriorityNode){return new LeafNode(this.value_,newPriorityNode)},LeafNode.prototype.getImmediateChild=function(childName){return".priority"===childName?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.getChild=function(path){return path.isEmpty()?this:".priority"===path.getFront()?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE},LeafNode.prototype.hasChild=function(){return!1},LeafNode.prototype.getPredecessorChildName=function(childName,childNode){return null},LeafNode.prototype.updateImmediateChild=function(childName,newChildNode){return".priority"===childName?this.updatePriority(newChildNode):newChildNode.isEmpty()&&".priority"!==childName?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(childName,newChildNode).updatePriority(this.priorityNode_)},LeafNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();return null===front?newChildNode:newChildNode.isEmpty()&&".priority"!==front?this:(util.assert(".priority"!==front||1===path.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(front,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(path.popFront(),newChildNode)))},LeafNode.prototype.isEmpty=function(){return!1},LeafNode.prototype.numChildren=function(){return 0},LeafNode.prototype.forEachChild=function(index,action){return!1},LeafNode.prototype.val=function(exportFormat){return exportFormat&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},LeafNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash="";this.priorityNode_.isEmpty()||(toHash+="priority:"+priorityHashText(this.priorityNode_.val())+":");var type=typeof this.value_;toHash+=type+":",toHash+="number"===type?doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=sha1(toHash)}return this.lazyHash_},LeafNode.prototype.getValue=function(){return this.value_},LeafNode.prototype.compareTo=function(other){return other===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:other instanceof LeafNode.__childrenNodeConstructor?-1:(util.assert(other.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(other))},LeafNode.prototype.compareToLeafNode_=function(otherLeaf){var otherLeafType=typeof otherLeaf.value_,thisLeafType=typeof this.value_,otherIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType),thisIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);return util.assert(otherIndex>=0,"Unknown leaf type: "+otherLeafType),util.assert(thisIndex>=0,"Unknown leaf type: "+thisLeafType),otherIndex===thisIndex?"object"===thisLeafType?0:this.value_<otherLeaf.value_?-1:this.value_===otherLeaf.value_?0:1:thisIndex-otherIndex},LeafNode.prototype.withIndex=function(){return this},LeafNode.prototype.isIndexed=function(){return!0},LeafNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode()){var otherLeaf=other;return this.value_===otherLeaf.value_&&this.priorityNode_.equals(otherLeaf.priorityNode_)}return!1},LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"],LeafNode}(),PriorityIndex=function(_super){function PriorityIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(PriorityIndex,_super),PriorityIndex.prototype.compare=function(a,b){var aPriority=a.node.getPriority(),bPriority=b.node.getPriority(),indexCmp=aPriority.compareTo(bPriority);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PriorityIndex.prototype.isDefinedOn=function(node){return!node.getPriority().isEmpty()},PriorityIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.getPriority().equals(newNode.getPriority())},PriorityIndex.prototype.minPost=function(){return NamedNode.MIN},PriorityIndex.prototype.maxPost=function(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))},PriorityIndex.prototype.makePost=function(indexValue,name){var priorityNode=nodeFromJSON(indexValue);return new NamedNode(name,new LeafNode("[PRIORITY-POST]",priorityNode))},PriorityIndex.prototype.toString=function(){return".priority"},PriorityIndex}(Index),PRIORITY_INDEX=new PriorityIndex,SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse_,resultGenerator_){void 0===resultGenerator_&&(resultGenerator_=null),this.isReverse_=isReverse_,this.resultGenerator_=resultGenerator_,this.nodeStack_=[];for(var cmp=1;!node.isEmpty();)if(node=node,cmp=startKey?comparator(node.key,startKey):1,isReverse_&&(cmp*=-1),cmp<0)node=this.isReverse_?node.left:node.right;else{if(0===cmp){this.nodeStack_.push(node);break}this.nodeStack_.push(node),node=this.isReverse_?node.right:node.left}}return SortedMapIterator.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var result,node=this.nodeStack_.pop();if(result=this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value},this.isReverse_)for(node=node.left;!node.isEmpty();)this.nodeStack_.push(node),node=node.right;else for(node=node.right;!node.isEmpty();)this.nodeStack_.push(node),node=node.left;return result},SortedMapIterator.prototype.hasNext=function(){return this.nodeStack_.length>0},SortedMapIterator.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var node=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(node.key,node.value):{key:node.key,value:node.value}},SortedMapIterator}(),LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key,this.value=value,this.color=null!=color?color:LLRBNode.RED,this.left=null!=left?left:SortedMap.EMPTY_NODE,this.right=null!=right?right:SortedMap.EMPTY_NODE}return LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(null!=key?key:this.key,null!=value?value:this.value,null!=color?color:this.color,null!=left?left:this.left,null!=right?right:this.right)},LLRBNode.prototype.count=function(){return this.left.count()+1+this.right.count()},LLRBNode.prototype.isEmpty=function(){return!1},LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)},LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)},LLRBNode.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},LLRBNode.prototype.minKey=function(){return this.min_().key},LLRBNode.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},LLRBNode.prototype.insert=function(key,value,comparator){var cmp,n;return n=this,cmp=comparator(key,n.key),n=cmp<0?n.copy(null,null,null,n.left.insert(key,value,comparator),null):0===cmp?n.copy(null,value,null,null,null):n.copy(null,null,null,null,n.right.insert(key,value,comparator)),n.fixUp_()},LLRBNode.prototype.removeMin_=function(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;var n=this;return n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()},LLRBNode.prototype.remove=function(key,comparator){var n,smallest;if(n=this,comparator(key,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(key,comparator),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===comparator(key,n.key)){if(n.right.isEmpty())return SortedMap.EMPTY_NODE;smallest=n.right.min_(),n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp_()},LLRBNode.prototype.isRed_=function(){return this.color},LLRBNode.prototype.fixUp_=function(){var n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n},LLRBNode.prototype.moveRedLeft_=function(){var n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n},LLRBNode.prototype.moveRedRight_=function(){var n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n},LLRBNode.prototype.rotateLeft_=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)},LLRBNode.prototype.rotateRight_=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)},LLRBNode.prototype.colorFlip_=function(){var left=this.left.copy(null,null,!this.left.color,null,null),right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)},LLRBNode.prototype.checkMaxDepth_=function(){var blackDepth=this.check_();return Math.pow(2,blackDepth)<=this.count()+1},LLRBNode.prototype.check_=function(){var blackDepth;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((blackDepth=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return blackDepth+(this.isRed_()?0:1)},LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode}(),LLRBEmptyNode=function(){function LLRBEmptyNode(){}return LLRBEmptyNode.prototype.copy=function(key,value,color,left,right){return this},LLRBEmptyNode.prototype.insert=function(key,value,comparator){return new LLRBNode(key,value,null)},LLRBEmptyNode.prototype.remove=function(key,comparator){return this},LLRBEmptyNode.prototype.count=function(){return 0},LLRBEmptyNode.prototype.isEmpty=function(){return!0},LLRBEmptyNode.prototype.inorderTraversal=function(action){return!1},LLRBEmptyNode.prototype.reverseTraversal=function(action){return!1},LLRBEmptyNode.prototype.minKey=function(){return null},LLRBEmptyNode.prototype.maxKey=function(){return null},LLRBEmptyNode.prototype.check_=function(){return 0},LLRBEmptyNode.prototype.isRed_=function(){return!1},LLRBEmptyNode}(),SortedMap=function(){function SortedMap(comparator_,root_){void 0===root_&&(root_=SortedMap.EMPTY_NODE),this.comparator_=comparator_,this.root_=root_}return SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator_,this.root_.insert(key,value,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator_,this.root_.remove(key,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))},SortedMap.prototype.get=function(key){for(var cmp,node=this.root_;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key)))return node.value;cmp<0?node=node.left:cmp>0&&(node=node.right)}return null},SortedMap.prototype.getPredecessorKey=function(key){for(var cmp,node=this.root_,rightParent=null;!node.isEmpty();){if(0===(cmp=this.comparator_(key,node.key))){if(node.left.isEmpty())return rightParent?rightParent.key:null;for(node=node.left;!node.right.isEmpty();)node=node.right;return node.key}cmp<0?node=node.left:cmp>0&&(rightParent=node,node=node.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},SortedMap.prototype.isEmpty=function(){return this.root_.isEmpty()},SortedMap.prototype.count=function(){return this.root_.count()},SortedMap.prototype.minKey=function(){return this.root_.minKey()},SortedMap.prototype.maxKey=function(){return this.root_.maxKey()},SortedMap.prototype.inorderTraversal=function(action){return this.root_.inorderTraversal(action)},SortedMap.prototype.reverseTraversal=function(action){return this.root_.reverseTraversal(action)},SortedMap.prototype.getIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!1,resultGenerator)},SortedMap.prototype.getReverseIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,!0,resultGenerator)},SortedMap.prototype.getReverseIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,!0,resultGenerator)},SortedMap.EMPTY_NODE=new LLRBEmptyNode,SortedMap}(),LOG_2=Math.log(2),Base12Num=function(){function Base12Num(length){this.count=function(num){return parseInt(Math.log(num)/LOG_2,10)}(length+1),this.current_=this.count-1;var mask=function(bits){return parseInt(Array(bits+1).join("1"),2)}(this.count);this.bits_=length+1&mask}return Base12Num.prototype.nextBitIsOne=function(){var result=!(this.bits_&1<<this.current_);return this.current_--,result},Base12Num}(),buildChildSet=function(childList,cmp,keyFn,mapSortFn){childList.sort(cmp);var buildBalancedTree=function(low,high){var namedNode,key,length=high-low;if(0==length)return null;if(1==length)return namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,null,null);var middle=parseInt(length/2,10)+low,left=buildBalancedTree(low,middle),right=buildBalancedTree(middle+1,high);return namedNode=childList[middle],key=keyFn?keyFn(namedNode):namedNode,new LLRBNode(key,namedNode.node,LLRBNode.BLACK,left,right)},base12=new Base12Num(childList.length),root=function(base12){for(var node=null,root=null,index=childList.length,buildPennant=function(chunkSize,color){var low=index-chunkSize,high=index;index-=chunkSize;var childTree=buildBalancedTree(low+1,high),namedNode=childList[low],key=keyFn?keyFn(namedNode):namedNode;attachPennant(new LLRBNode(key,namedNode.node,color,null,childTree))},attachPennant=function(pennant){node?(node.left=pennant,node=pennant):(root=pennant,node=pennant)},i=0;i<base12.count;++i){var isOne=base12.nextBitIsOne(),chunkSize=Math.pow(2,base12.count-(i+1));isOne?buildPennant(chunkSize,LLRBNode.BLACK):(buildPennant(chunkSize,LLRBNode.BLACK),buildPennant(chunkSize,LLRBNode.RED))}return root}(base12);return new SortedMap(mapSortFn||cmp,root)},fallbackObject={},IndexMap=function(){function IndexMap(indexes_,indexSet_){this.indexes_=indexes_,this.indexSet_=indexSet_}return Object.defineProperty(IndexMap,"Default",{get:function(){return util.assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX})},enumerable:!0,configurable:!0}),IndexMap.prototype.get=function(indexKey){var sortedMap=util.safeGet(this.indexes_,indexKey);if(!sortedMap)throw new Error("No index defined for "+indexKey);return sortedMap===fallbackObject?null:sortedMap},IndexMap.prototype.hasIndex=function(indexDefinition){return util.contains(this.indexSet_,indexDefinition.toString())},IndexMap.prototype.addIndex=function(indexDefinition,existingChildren){util.assert(indexDefinition!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var childList=[],sawIndexedValue=!1,iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)sawIndexedValue=sawIndexedValue||indexDefinition.isDefinedOn(next.node),childList.push(next),next=iter.getNext();var newIndex;newIndex=sawIndexedValue?buildChildSet(childList,indexDefinition.getCompare()):fallbackObject;var indexName=indexDefinition.toString(),newIndexSet=util.clone(this.indexSet_);newIndexSet[indexName]=indexDefinition;var newIndexes=util.clone(this.indexes_);return newIndexes[indexName]=newIndex,new IndexMap(newIndexes,newIndexSet)},IndexMap.prototype.addToIndexes=function(namedNode,existingChildren){var _this=this;return new IndexMap(util.map(this.indexes_,function(indexedChildren,indexName){var index=util.safeGet(_this.indexSet_,indexName);if(util.assert(index,"Missing index implementation for "+indexName),indexedChildren===fallbackObject){if(index.isDefinedOn(namedNode.node)){for(var childList=[],iter=existingChildren.getIterator(NamedNode.Wrap),next=iter.getNext();next;)next.name!=namedNode.name&&childList.push(next),next=iter.getNext();return childList.push(namedNode),buildChildSet(childList,index.getCompare())}return fallbackObject}var existingSnap=existingChildren.get(namedNode.name),newChildren=indexedChildren;return existingSnap&&(newChildren=newChildren.remove(new NamedNode(namedNode.name,existingSnap))),newChildren.insert(namedNode,namedNode.node)}),this.indexSet_)},IndexMap.prototype.removeFromIndexes=function(namedNode,existingChildren){return new IndexMap(util.map(this.indexes_,function(indexedChildren){if(indexedChildren===fallbackObject)return indexedChildren;var existingSnap=existingChildren.get(namedNode.name);return existingSnap?indexedChildren.remove(new NamedNode(namedNode.name,existingSnap)):indexedChildren}),this.indexSet_)},IndexMap}(),ChildrenNode=function(){function ChildrenNode(children_,priorityNode_,indexMap_){this.children_=children_,this.priorityNode_=priorityNode_,this.indexMap_=indexMap_,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&util.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(ChildrenNode,"EMPTY_NODE",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))},enumerable:!0,configurable:!0}),ChildrenNode.prototype.isLeafNode=function(){return!1},ChildrenNode.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE},ChildrenNode.prototype.updatePriority=function(newPriorityNode){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,newPriorityNode,this.indexMap_)},ChildrenNode.prototype.getImmediateChild=function(childName){if(".priority"===childName)return this.getPriority();var child=this.children_.get(childName);return null===child?EMPTY_NODE:child},ChildrenNode.prototype.getChild=function(path){var front=path.getFront();return null===front?this:this.getImmediateChild(front).getChild(path.popFront())},ChildrenNode.prototype.hasChild=function(childName){return null!==this.children_.get(childName)},ChildrenNode.prototype.updateImmediateChild=function(childName,newChildNode){if(util.assert(newChildNode,"We should always be passing snapshot nodes"),".priority"===childName)return this.updatePriority(newChildNode);var namedNode=new NamedNode(childName,newChildNode),newChildren=void 0,newIndexMap=void 0,newPriority=void 0;return newChildNode.isEmpty()?(newChildren=this.children_.remove(childName),newIndexMap=this.indexMap_.removeFromIndexes(namedNode,this.children_)):(newChildren=this.children_.insert(childName,newChildNode),newIndexMap=this.indexMap_.addToIndexes(namedNode,this.children_)),newPriority=newChildren.isEmpty()?EMPTY_NODE:this.priorityNode_,new ChildrenNode(newChildren,newPriority,newIndexMap)},ChildrenNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();if(null===front)return newChildNode;util.assert(".priority"!==path.getFront()||1===path.getLength(),".priority must be the last token in a path");var newImmediateChild=this.getImmediateChild(front).updateChild(path.popFront(),newChildNode);return this.updateImmediateChild(front,newImmediateChild)},ChildrenNode.prototype.isEmpty=function(){return this.children_.isEmpty()},ChildrenNode.prototype.numChildren=function(){return this.children_.count()},ChildrenNode.prototype.val=function(exportFormat){if(this.isEmpty())return null;var obj={},numKeys=0,maxKey=0,allIntegerKeys=!0;if(this.forEachChild(PRIORITY_INDEX,function(key,childNode){obj[key]=childNode.val(exportFormat),numKeys++,allIntegerKeys&&ChildrenNode.INTEGER_REGEXP_.test(key)?maxKey=Math.max(maxKey,Number(key)):allIntegerKeys=!1}),!exportFormat&&allIntegerKeys&&maxKey<2*numKeys){var array=[];for(var key in obj)array[key]=obj[key];return array}return exportFormat&&!this.getPriority().isEmpty()&&(obj[".priority"]=this.getPriority().val()),obj},ChildrenNode.prototype.hash=function(){if(null===this.lazyHash_){var toHash_1="";this.getPriority().isEmpty()||(toHash_1+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,function(key,childNode){var childHash=childNode.hash();""!==childHash&&(toHash_1+=":"+key+":"+childHash)}),this.lazyHash_=""===toHash_1?"":sha1(toHash_1)}return this.lazyHash_},ChildrenNode.prototype.getPredecessorChildName=function(childName,childNode,index){var idx=this.resolveIndex_(index);if(idx){var predecessor=idx.getPredecessorKey(new NamedNode(childName,childNode));return predecessor?predecessor.name:null}return this.children_.getPredecessorKey(childName)},ChildrenNode.prototype.getFirstChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var minKey=idx.minKey();return minKey&&minKey.name}return this.children_.minKey()},ChildrenNode.prototype.getFirstChild=function(indexDefinition){var minKey=this.getFirstChildName(indexDefinition);return minKey?new NamedNode(minKey,this.children_.get(minKey)):null},ChildrenNode.prototype.getLastChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var maxKey=idx.maxKey();return maxKey&&maxKey.name}return this.children_.maxKey()},ChildrenNode.prototype.getLastChild=function(indexDefinition){var maxKey=this.getLastChildName(indexDefinition);return maxKey?new NamedNode(maxKey,this.children_.get(maxKey)):null},ChildrenNode.prototype.forEachChild=function(index,action){var idx=this.resolveIndex_(index);return idx?idx.inorderTraversal(function(wrappedNode){return action(wrappedNode.name,wrappedNode.node)}):this.children_.inorderTraversal(action)},ChildrenNode.prototype.getIterator=function(indexDefinition){return this.getIteratorFrom(indexDefinition.minPost(),indexDefinition)},ChildrenNode.prototype.getIteratorFrom=function(startPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getIteratorFrom(startPost,function(key){return key});for(var iterator=this.children_.getIteratorFrom(startPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,startPost)<0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.getReverseIterator=function(indexDefinition){return this.getReverseIteratorFrom(indexDefinition.maxPost(),indexDefinition)},ChildrenNode.prototype.getReverseIteratorFrom=function(endPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx)return idx.getReverseIteratorFrom(endPost,function(key){return key});for(var iterator=this.children_.getReverseIteratorFrom(endPost.name,NamedNode.Wrap),next=iterator.peek();null!=next&&indexDefinition.compare(next,endPost)>0;)iterator.getNext(),next=iterator.peek();return iterator},ChildrenNode.prototype.compareTo=function(other){return this.isEmpty()?other.isEmpty()?0:-1:other.isLeafNode()||other.isEmpty()?1:other===MAX_NODE$2?-1:0},ChildrenNode.prototype.withIndex=function(indexDefinition){if(indexDefinition===KEY_INDEX||this.indexMap_.hasIndex(indexDefinition))return this;var newIndexMap=this.indexMap_.addIndex(indexDefinition,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,newIndexMap)},ChildrenNode.prototype.isIndexed=function(index){return index===KEY_INDEX||this.indexMap_.hasIndex(index)},ChildrenNode.prototype.equals=function(other){if(other===this)return!0;if(other.isLeafNode())return!1;var otherChildrenNode=other;if(this.getPriority().equals(otherChildrenNode.getPriority())){if(this.children_.count()===otherChildrenNode.children_.count()){for(var thisIter=this.getIterator(PRIORITY_INDEX),otherIter=otherChildrenNode.getIterator(PRIORITY_INDEX),thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext();thisCurrent&&otherCurrent;){if(thisCurrent.name!==otherCurrent.name||!thisCurrent.node.equals(otherCurrent.node))return!1;thisCurrent=thisIter.getNext(),otherCurrent=otherIter.getNext()}return null===thisCurrent&&null===otherCurrent}return!1}return!1},ChildrenNode.prototype.resolveIndex_=function(indexDefinition){return indexDefinition===KEY_INDEX?null:this.indexMap_.get(indexDefinition.toString())},ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,ChildrenNode
}(),MaxNode=function(_super){function MaxNode(){return _super.call(this,new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)||this}return tslib_1.__extends(MaxNode,_super),MaxNode.prototype.compareTo=function(other){return other===this?0:1},MaxNode.prototype.equals=function(other){return other===this},MaxNode.prototype.getPriority=function(){return this},MaxNode.prototype.getImmediateChild=function(childName){return ChildrenNode.EMPTY_NODE},MaxNode.prototype.isEmpty=function(){return!1},MaxNode}(ChildrenNode),MAX_NODE$2=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE$2)}}),KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode.__childrenNodeConstructor=ChildrenNode,function(val){MAX_NODE=val}(MAX_NODE$2),function(val){MAX_NODE$1=val}(MAX_NODE$2);var USE_HINZE=!0;!function(val){nodeFromJSON=val}(nodeFromJSON$1);var __referenceConstructor,OperationType,ValueIndex=function(_super){function ValueIndex(){return null!==_super&&_super.apply(this,arguments)||this}return tslib_1.__extends(ValueIndex,_super),ValueIndex.prototype.compare=function(a,b){var indexCmp=a.node.compareTo(b.node);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},ValueIndex.prototype.isDefinedOn=function(node){return!0},ValueIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.equals(newNode)},ValueIndex.prototype.minPost=function(){return NamedNode.MIN},ValueIndex.prototype.maxPost=function(){return NamedNode.MAX},ValueIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue);return new NamedNode(name,valueNode)},ValueIndex.prototype.toString=function(){return".value"},ValueIndex}(Index),VALUE_INDEX=new ValueIndex,PathIndex=function(_super){function PathIndex(indexPath_){var _this=_super.call(this)||this;return _this.indexPath_=indexPath_,util.assert(!indexPath_.isEmpty()&&".priority"!==indexPath_.getFront(),"Can't create PathIndex with empty path or .priority key"),_this}return tslib_1.__extends(PathIndex,_super),PathIndex.prototype.extractChild=function(snap){return snap.getChild(this.indexPath_)},PathIndex.prototype.isDefinedOn=function(node){return!node.getChild(this.indexPath_).isEmpty()},PathIndex.prototype.compare=function(a,b){var aChild=this.extractChild(a.node),bChild=this.extractChild(b.node),indexCmp=aChild.compareTo(bChild);return 0===indexCmp?nameCompare(a.name,b.name):indexCmp},PathIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON$1(indexValue),node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,valueNode);return new NamedNode(name,node)},PathIndex.prototype.maxPost=function(){var node=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE$2);return new NamedNode(MAX_NAME,node)},PathIndex.prototype.toString=function(){return this.indexPath_.slice().join("/")},PathIndex}(Index),DataSnapshot=function(){function DataSnapshot(node_,ref_,index_){this.node_=node_,this.ref_=ref_,this.index_=index_}return DataSnapshot.prototype.val=function(){return util.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},DataSnapshot.prototype.exportVal=function(){return util.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},DataSnapshot.prototype.toJSON=function(){return util.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},DataSnapshot.prototype.exists=function(){return util.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},DataSnapshot.prototype.child=function(childPathString){util.validateArgCount("DataSnapshot.child",0,1,arguments.length),childPathString=String(childPathString),validatePathString("DataSnapshot.child",1,childPathString,!1);var childPath=new Path(childPathString),childRef=this.ref_.child(childPath);return new DataSnapshot(this.node_.getChild(childPath),childRef,PRIORITY_INDEX)},DataSnapshot.prototype.hasChild=function(childPathString){util.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),validatePathString("DataSnapshot.hasChild",1,childPathString,!1);var childPath=new Path(childPathString);return!this.node_.getChild(childPath).isEmpty()},DataSnapshot.prototype.getPriority=function(){return util.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},DataSnapshot.prototype.forEach=function(action){var _this=this;return util.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),util.validateCallback("DataSnapshot.forEach",1,action,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(key,node){return action(new DataSnapshot(node,_this.ref_.child(key),PRIORITY_INDEX))})},DataSnapshot.prototype.hasChildren=function(){return util.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(DataSnapshot.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),DataSnapshot.prototype.numChildren=function(){return util.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},DataSnapshot.prototype.getRef=function(){return util.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(DataSnapshot.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),DataSnapshot}(),DataEvent=function(){function DataEvent(eventType,eventRegistration,snapshot,prevName){this.eventType=eventType,this.eventRegistration=eventRegistration,this.snapshot=snapshot,this.prevName=prevName}return DataEvent.prototype.getPath=function(){var ref=this.snapshot.getRef();return"value"===this.eventType?ref.path:ref.getParent().path},DataEvent.prototype.getEventType=function(){return this.eventType},DataEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},DataEvent.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+util.stringify(this.snapshot.exportVal())},DataEvent}(),CancelEvent=function(){function CancelEvent(eventRegistration,error,path){this.eventRegistration=eventRegistration,this.error=error,this.path=path}return CancelEvent.prototype.getPath=function(){return this.path},CancelEvent.prototype.getEventType=function(){return"cancel"},CancelEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},CancelEvent.prototype.toString=function(){return this.path.toString()+":cancel"},CancelEvent}(),ValueEventRegistration=function(){function ValueEventRegistration(callback_,cancelCallback_,context_){this.callback_=callback_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ValueEventRegistration.prototype.respondsTo=function(eventType){return"value"===eventType},ValueEventRegistration.prototype.createEvent=function(change,query){var index=query.getQueryParams().getIndex();return new DataEvent("value",this,new DataSnapshot(change.snapshotNode,query.getRef(),index))},ValueEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if("cancel"===eventData.getEventType()){util.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_1=this.cancelCallback_;return function(){cancelCB_1.call(ctx,eventData.error)}}var cb_1=this.callback_;return function(){cb_1.call(ctx,eventData.snapshot)}},ValueEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new CancelEvent(this,error,path):null},ValueEventRegistration.prototype.matches=function(other){return other instanceof ValueEventRegistration&&(!other.callback_||!this.callback_||other.callback_===this.callback_&&other.context_===this.context_)},ValueEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callback_},ValueEventRegistration}(),ChildEventRegistration=function(){function ChildEventRegistration(callbacks_,cancelCallback_,context_){this.callbacks_=callbacks_,this.cancelCallback_=cancelCallback_,this.context_=context_}return ChildEventRegistration.prototype.respondsTo=function(eventType){var eventToCheck="children_added"===eventType?"child_added":eventType;return eventToCheck="children_removed"===eventToCheck?"child_removed":eventToCheck,util.contains(this.callbacks_,eventToCheck)},ChildEventRegistration.prototype.createCancelEvent=function(error,path){return this.cancelCallback_?new CancelEvent(this,error,path):null},ChildEventRegistration.prototype.createEvent=function(change,query){util.assert(null!=change.childName,"Child events should have a childName.");var ref=query.getRef().child(change.childName),index=query.getQueryParams().getIndex();return new DataEvent(change.type,this,new DataSnapshot(change.snapshotNode,ref,index),change.prevName)},ChildEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if("cancel"===eventData.getEventType()){util.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_2=this.cancelCallback_;return function(){cancelCB_2.call(ctx,eventData.error)}}var cb_2=this.callbacks_[eventData.eventType];return function(){cb_2.call(ctx,eventData.snapshot,eventData.prevName)}},ChildEventRegistration.prototype.matches=function(other){if(other instanceof ChildEventRegistration){if(!this.callbacks_||!other.callbacks_)return!0;if(this.context_===other.context_){var otherCount=util.getCount(other.callbacks_);if(otherCount===util.getCount(this.callbacks_)){if(1===otherCount){var otherKey=util.getAnyKey(other.callbacks_),thisKey=util.getAnyKey(this.callbacks_);return!(thisKey!==otherKey||other.callbacks_[otherKey]&&this.callbacks_[thisKey]&&other.callbacks_[otherKey]!==this.callbacks_[thisKey])}return util.every(this.callbacks_,function(eventType,cb){return other.callbacks_[eventType]===cb})}}}return!1},ChildEventRegistration.prototype.hasAnyCallback=function(){return null!==this.callbacks_},ChildEventRegistration}(),Query=function(){function Query(repo,path,queryParams_,orderByCalled_){this.repo=repo,this.path=path,this.queryParams_=queryParams_,this.orderByCalled_=orderByCalled_}return Object.defineProperty(Query,"__referenceConstructor",{get:function(){return util.assert(__referenceConstructor,"Reference.ts has not been loaded"),__referenceConstructor},set:function(val){__referenceConstructor=val},enumerable:!0,configurable:!0}),Query.validateQueryEndpoints_=function(params){var startNode=null,endNode=null;if(params.hasStart()&&(startNode=params.getIndexStartValue()),params.hasEnd()&&(endNode=params.getIndexEndValue()),params.getIndex()===KEY_INDEX){var tooManyArgsError="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",wrongArgTypeError="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(params.hasStart()){if(params.getIndexStartName()!=MIN_NAME)throw new Error(tooManyArgsError);if("string"!=typeof startNode)throw new Error(wrongArgTypeError)}if(params.hasEnd()){if(params.getIndexEndName()!=MAX_NAME)throw new Error(tooManyArgsError);if("string"!=typeof endNode)throw new Error(wrongArgTypeError)}}else if(params.getIndex()===PRIORITY_INDEX){if(null!=startNode&&!isValidPriority(startNode)||null!=endNode&&!isValidPriority(endNode))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(util.assert(params.getIndex()instanceof PathIndex||params.getIndex()===VALUE_INDEX,"unknown index type."),null!=startNode&&"object"==typeof startNode||null!=endNode&&"object"==typeof endNode)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},Query.validateLimit_=function(params){if(params.hasStart()&&params.hasEnd()&&params.hasLimit()&&!params.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},Query.prototype.validateNoPreviousOrderByCall_=function(fnName){if(!0===this.orderByCalled_)throw new Error(fnName+": You can't combine multiple orderBy calls.")},Query.prototype.getQueryParams=function(){return this.queryParams_},Query.prototype.getRef=function(){return util.validateArgCount("Query.ref",0,0,arguments.length),new Query.__referenceConstructor(this.repo,this.path)},Query.prototype.on=function(eventType,callback,cancelCallbackOrContext,context){util.validateArgCount("Query.on",2,4,arguments.length),validateEventType("Query.on",1,eventType,!1),util.validateCallback("Query.on",2,callback,!1);var ret=Query.getCancelAndContextArgs_("Query.on",cancelCallbackOrContext,context);if("value"===eventType)this.onValueEvent(callback,ret.cancel,ret.context);else{var callbacks={};callbacks[eventType]=callback,this.onChildEvent(callbacks,ret.cancel,ret.context)}return callback},Query.prototype.onValueEvent=function(callback,cancelCallback,context){var container=new ValueEventRegistration(callback,cancelCallback||null,context||null);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.onChildEvent=function(callbacks,cancelCallback,context){var container=new ChildEventRegistration(callbacks,cancelCallback,context);this.repo.addEventCallbackForQuery(this,container)},Query.prototype.off=function(eventType,callback,context){util.validateArgCount("Query.off",0,3,arguments.length),validateEventType("Query.off",1,eventType,!0),util.validateCallback("Query.off",2,callback,!0),util.validateContextObject("Query.off",3,context,!0);var container=null,callbacks=null;if("value"===eventType){container=new ValueEventRegistration(callback||null,null,context||null)}else eventType&&(callback&&(callbacks={},callbacks[eventType]=callback),container=new ChildEventRegistration(callbacks,null,context||null));this.repo.removeEventCallbackForQuery(this,container)},Query.prototype.once=function(eventType,userCallback,cancelOrContext,context){var _this=this;util.validateArgCount("Query.once",1,4,arguments.length),validateEventType("Query.once",1,eventType,!1),util.validateCallback("Query.once",2,userCallback,!0);var ret=Query.getCancelAndContextArgs_("Query.once",cancelOrContext,context),firstCall=!0,deferred=new util.Deferred;deferred.promise.catch(function(){});var onceCallback=function(snapshot){firstCall&&(firstCall=!1,_this.off(eventType,onceCallback),userCallback&&userCallback.bind(ret.context)(snapshot),deferred.resolve(snapshot))};return this.on(eventType,onceCallback,function(err){_this.off(eventType,onceCallback),ret.cancel&&ret.cancel.bind(ret.context)(err),deferred.reject(err)}),deferred.promise},Query.prototype.limitToFirst=function(limit){if(util.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Query(this.repo,this.path,this.queryParams_.limitToFirst(limit),this.orderByCalled_)},Query.prototype.limitToLast=function(limit){if(util.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof limit||Math.floor(limit)!==limit||limit<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Query(this.repo,this.path,this.queryParams_.limitToLast(limit),this.orderByCalled_)},Query.prototype.orderByChild=function(path){if(util.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===path)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===path)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===path)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');validatePathString("Query.orderByChild",1,path,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var parsedPath=new Path(path);if(parsedPath.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var index=new PathIndex(parsedPath),newParams=this.queryParams_.orderBy(index);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByKey=function(){util.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var newParams=this.queryParams_.orderBy(KEY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByPriority=function(){util.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var newParams=this.queryParams_.orderBy(PRIORITY_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.orderByValue=function(){util.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var newParams=this.queryParams_.orderBy(VALUE_INDEX);return Query.validateQueryEndpoints_(newParams),new Query(this.repo,this.path,newParams,!0)},Query.prototype.startAt=function(value,name){void 0===value&&(value=null),util.validateArgCount("Query.startAt",0,2,arguments.length),validateFirebaseDataArg("Query.startAt",1,value,this.path,!0),validateKey("Query.startAt",2,name,!0);var newParams=this.queryParams_.startAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===value&&(value=null,name=null),new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.endAt=function(value,name){void 0===value&&(value=null),util.validateArgCount("Query.endAt",0,2,arguments.length),validateFirebaseDataArg("Query.endAt",1,value,this.path,!0),validateKey("Query.endAt",2,name,!0);var newParams=this.queryParams_.endAt(value,name);if(Query.validateLimit_(newParams),Query.validateQueryEndpoints_(newParams),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new Query(this.repo,this.path,newParams,this.orderByCalled_)},Query.prototype.equalTo=function(value,name){if(util.validateArgCount("Query.equalTo",1,2,arguments.length),validateFirebaseDataArg("Query.equalTo",1,value,this.path,!1),validateKey("Query.equalTo",2,name,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(value,name).endAt(value,name)},Query.prototype.toString=function(){return util.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},Query.prototype.toJSON=function(){return util.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},Query.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},Query.prototype.queryIdentifier=function(){var obj=this.queryObject(),id=ObjectToUniqueKey(obj);return"{}"===id?"default":id},Query.prototype.isEqual=function(other){if(util.validateArgCount("Query.isEqual",1,1,arguments.length),!(other instanceof Query)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var sameRepo=this.repo===other.repo,samePath=this.path.equals(other.path),sameQueryIdentifier=this.queryIdentifier()===other.queryIdentifier();return sameRepo&&samePath&&sameQueryIdentifier},Query.getCancelAndContextArgs_=function(fnName,cancelOrContext,context){var ret={cancel:null,context:null};if(cancelOrContext&&context)ret.cancel=cancelOrContext,util.validateCallback(fnName,3,ret.cancel,!0),ret.context=context,util.validateContextObject(fnName,4,ret.context,!0);else if(cancelOrContext)if("object"==typeof cancelOrContext&&null!==cancelOrContext)ret.context=cancelOrContext;else{if("function"!=typeof cancelOrContext)throw new Error(util.errorPrefix(fnName,3,!0)+" must either be a cancel callback or a context object.");ret.cancel=cancelOrContext}return ret},Object.defineProperty(Query.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),Query}(),CountedSet=function(){function CountedSet(){this.set={}}return CountedSet.prototype.add=function(item,val){this.set[item]=null===val||val},CountedSet.prototype.contains=function(key){return util.contains(this.set,key)},CountedSet.prototype.get=function(item){return this.contains(item)?this.set[item]:void 0},CountedSet.prototype.remove=function(item){delete this.set[item]},CountedSet.prototype.clear=function(){this.set={}},CountedSet.prototype.isEmpty=function(){return util.isEmpty(this.set)},CountedSet.prototype.count=function(){return util.getCount(this.set)},CountedSet.prototype.each=function(fn){util.forEach(this.set,function(k,v){return fn(k,v)})},CountedSet.prototype.keys=function(){var keys=[];return util.forEach(this.set,function(k){keys.push(k)}),keys},CountedSet}(),SparseSnapshotTree=function(){function SparseSnapshotTree(){this.value_=null,this.children_=null}return SparseSnapshotTree.prototype.find=function(path){if(null!=this.value_)return this.value_.getChild(path);if(path.isEmpty()||null==this.children_)return null;var childKey=path.getFront();if(path=path.popFront(),this.children_.contains(childKey)){return this.children_.get(childKey).find(path)}return null},SparseSnapshotTree.prototype.remember=function(path,data){if(path.isEmpty())this.value_=data,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(path,data);else{null==this.children_&&(this.children_=new CountedSet);var childKey=path.getFront();this.children_.contains(childKey)||this.children_.add(childKey,new SparseSnapshotTree);var child=this.children_.get(childKey);path=path.popFront(),child.remember(path,data)}},SparseSnapshotTree.prototype.forget=function(path){if(path.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var value=this.value_;this.value_=null;var self_1=this;return value.forEachChild(PRIORITY_INDEX,function(key,tree){self_1.remember(new Path(key),tree)}),this.forget(path)}if(null!==this.children_){var childKey=path.getFront();if(path=path.popFront(),this.children_.contains(childKey)){this.children_.get(childKey).forget(path)&&this.children_.remove(childKey)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},SparseSnapshotTree.prototype.forEachTree=function(prefixPath,func){null!==this.value_?func(prefixPath,this.value_):this.forEachChild(function(key,tree){var path=new Path(prefixPath.toString()+"/"+key);tree.forEachTree(path,func)})},SparseSnapshotTree.prototype.forEachChild=function(func){null!==this.children_&&this.children_.each(function(key,tree){func(key,tree)})},SparseSnapshotTree}(),generateWithValues=function(values){return values=values||{},values.timestamp=values.timestamp||(new Date).getTime(),values},resolveDeferredValue=function(value,serverValues){return value&&"object"==typeof value?(util.assert(".sv"in value,"Unexpected leaf node or priority contents"),serverValues[value[".sv"]]):value},resolveDeferredValueTree=function(tree,serverValues){var resolvedTree=new SparseSnapshotTree;return tree.forEachTree(new Path(""),function(path,node){resolvedTree.remember(path,resolveDeferredValueSnapshot(node,serverValues))}),resolvedTree},resolveDeferredValueSnapshot=function(node,serverValues){var newNode,rawPri=node.getPriority().val(),priority=resolveDeferredValue(rawPri,serverValues);if(node.isLeafNode()){var leafNode=node,value=resolveDeferredValue(leafNode.getValue(),serverValues);return value!==leafNode.getValue()||priority!==leafNode.getPriority().val()?new LeafNode(value,nodeFromJSON$1(priority)):node}var childrenNode=node;return newNode=childrenNode,priority!==childrenNode.getPriority().val()&&(newNode=newNode.updatePriority(new LeafNode(priority))),childrenNode.forEachChild(PRIORITY_INDEX,function(childName,childNode){var newChildNode=resolveDeferredValueSnapshot(childNode,serverValues);newChildNode!==childNode&&(newNode=newNode.updateImmediateChild(childName,newChildNode))}),newNode};!function(OperationType){OperationType[OperationType.OVERWRITE=0]="OVERWRITE",OperationType[OperationType.MERGE=1]="MERGE",OperationType[OperationType.ACK_USER_WRITE=2]="ACK_USER_WRITE",OperationType[OperationType.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(OperationType||(OperationType={}));var emptyChildrenSingleton,__referenceConstructor$1,OperationSource=function(){function OperationSource(fromUser,fromServer,queryId,tagged){this.fromUser=fromUser,this.fromServer=fromServer,this.queryId=queryId,this.tagged=tagged,util.assert(!tagged||fromServer,"Tagged queries must be from server.")}return OperationSource.User=new OperationSource(!0,!1,null,!1),OperationSource.Server=new OperationSource(!1,!0,null,!1),OperationSource.forServerTaggedQuery=function(queryId){return new OperationSource(!1,!0,queryId,!0)},OperationSource}(),AckUserWrite=function(){function AckUserWrite(path,affectedTree,revert){this.path=path,this.affectedTree=affectedTree,this.revert=revert,this.type=OperationType.ACK_USER_WRITE,this.source=OperationSource.User}return AckUserWrite.prototype.operationForChild=function(childName){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return util.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var childTree=this.affectedTree.subtree(new Path(childName));return new AckUserWrite(Path.Empty,childTree,this.revert)}return util.assert(this.path.getFront()===childName,"operationForChild called for unrelated child."),new AckUserWrite(this.path.popFront(),this.affectedTree,this.revert)},AckUserWrite}(),EmptyChildren=function(){return emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton},ImmutableTree=function(){function ImmutableTree(value,children){void 0===children&&(children=EmptyChildren()),this.value=value,this.children=children}return ImmutableTree.fromObject=function(obj){var tree=ImmutableTree.Empty;return util.forEach(obj,function(childPath,childSnap){tree=tree.set(new Path(childPath),childSnap)}),tree},ImmutableTree.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},ImmutableTree.prototype.findRootMostMatchingPathAndValue=function(relativePath,predicate){if(null!=this.value&&predicate(this.value))return{path:Path.Empty,value:this.value};if(relativePath.isEmpty())return null;var front=relativePath.getFront(),child=this.children.get(front);if(null!==child){var childExistingPathAndValue=child.findRootMostMatchingPathAndValue(relativePath.popFront(),predicate);if(null!=childExistingPathAndValue){return{path:new Path(front).child(childExistingPathAndValue.path),value:childExistingPathAndValue.value}}return null}return null},ImmutableTree.prototype.findRootMostValueAndPath=function(relativePath){return this.findRootMostMatchingPathAndValue(relativePath,function(){return!0})},ImmutableTree.prototype.subtree=function(relativePath){if(relativePath.isEmpty())return this;var front=relativePath.getFront(),childTree=this.children.get(front);return null!==childTree?childTree.subtree(relativePath.popFront()):ImmutableTree.Empty},ImmutableTree.prototype.set=function(relativePath,toSet){if(relativePath.isEmpty())return new ImmutableTree(toSet,this.children);var front=relativePath.getFront(),child=this.children.get(front)||ImmutableTree.Empty,newChild=child.set(relativePath.popFront(),toSet),newChildren=this.children.insert(front,newChild);return new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.remove=function(relativePath){if(relativePath.isEmpty())return this.children.isEmpty()?ImmutableTree.Empty:new ImmutableTree(null,this.children);var front=relativePath.getFront(),child=this.children.get(front);if(child){var newChild=child.remove(relativePath.popFront()),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),null===this.value&&newChildren.isEmpty()?ImmutableTree.Empty:new ImmutableTree(this.value,newChildren)}return this},ImmutableTree.prototype.get=function(relativePath){if(relativePath.isEmpty())return this.value;var front=relativePath.getFront(),child=this.children.get(front);return child?child.get(relativePath.popFront()):null},ImmutableTree.prototype.setTree=function(relativePath,newTree){if(relativePath.isEmpty())return newTree;var front=relativePath.getFront(),child=this.children.get(front)||ImmutableTree.Empty,newChild=child.setTree(relativePath.popFront(),newTree),newChildren=void 0;return newChildren=newChild.isEmpty()?this.children.remove(front):this.children.insert(front,newChild),new ImmutableTree(this.value,newChildren)},ImmutableTree.prototype.fold=function(fn){return this.fold_(Path.Empty,fn)},ImmutableTree.prototype.fold_=function(pathSoFar,fn){var accum={};return this.children.inorderTraversal(function(childKey,childTree){accum[childKey]=childTree.fold_(pathSoFar.child(childKey),fn)}),fn(pathSoFar,this.value,accum)},ImmutableTree.prototype.findOnPath=function(path,f){return this.findOnPath_(path,Path.Empty,f)},ImmutableTree.prototype.findOnPath_=function(pathToFollow,pathSoFar,f){var result=!!this.value&&f(pathSoFar,this.value);if(result)return result;if(pathToFollow.isEmpty())return null;var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.findOnPath_(pathToFollow.popFront(),pathSoFar.child(front),f):null},ImmutableTree.prototype.foreachOnPath=function(path,f){return this.foreachOnPath_(path,Path.Empty,f)},ImmutableTree.prototype.foreachOnPath_=function(pathToFollow,currentRelativePath,f){if(pathToFollow.isEmpty())return this;this.value&&f(currentRelativePath,this.value);var front=pathToFollow.getFront(),nextChild=this.children.get(front);return nextChild?nextChild.foreachOnPath_(pathToFollow.popFront(),currentRelativePath.child(front),f):ImmutableTree.Empty},ImmutableTree.prototype.foreach=function(f){this.foreach_(Path.Empty,f)},ImmutableTree.prototype.foreach_=function(currentRelativePath,f){this.children.inorderTraversal(function(childName,childTree){childTree.foreach_(currentRelativePath.child(childName),f)}),this.value&&f(currentRelativePath,this.value)},ImmutableTree.prototype.foreachChild=function(f){this.children.inorderTraversal(function(childName,childTree){childTree.value&&f(childName,childTree.value)})},ImmutableTree.Empty=new ImmutableTree(null),ImmutableTree}(),ListenComplete=function(){function ListenComplete(source,path){this.source=source,this.path=path,this.type=OperationType.LISTEN_COMPLETE}return ListenComplete.prototype.operationForChild=function(childName){return this.path.isEmpty()?new ListenComplete(this.source,Path.Empty):new ListenComplete(this.source,this.path.popFront())},ListenComplete}(),Overwrite=function(){function Overwrite(source,path,snap){this.source=source,this.path=path,this.snap=snap,this.type=OperationType.OVERWRITE}return Overwrite.prototype.operationForChild=function(childName){return this.path.isEmpty()?new Overwrite(this.source,Path.Empty,this.snap.getImmediateChild(childName)):new Overwrite(this.source,this.path.popFront(),this.snap)},Overwrite}(),Merge=function(){
function Merge(source,path,children){this.source=source,this.path=path,this.children=children,this.type=OperationType.MERGE}return Merge.prototype.operationForChild=function(childName){if(this.path.isEmpty()){var childTree=this.children.subtree(new Path(childName));return childTree.isEmpty()?null:childTree.value?new Overwrite(this.source,Path.Empty,childTree.value):new Merge(this.source,Path.Empty,childTree)}return util.assert(this.path.getFront()===childName,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,this.path.popFront(),this.children)},Merge.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Merge}(),CacheNode=function(){function CacheNode(node_,fullyInitialized_,filtered_){this.node_=node_,this.fullyInitialized_=fullyInitialized_,this.filtered_=filtered_}return CacheNode.prototype.isFullyInitialized=function(){return this.fullyInitialized_},CacheNode.prototype.isFiltered=function(){return this.filtered_},CacheNode.prototype.isCompleteForPath=function(path){if(path.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var childKey=path.getFront();return this.isCompleteForChild(childKey)},CacheNode.prototype.isCompleteForChild=function(key){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(key)},CacheNode.prototype.getNode=function(){return this.node_},CacheNode}(),ViewCache=function(){function ViewCache(eventCache_,serverCache_){this.eventCache_=eventCache_,this.serverCache_=serverCache_}return ViewCache.prototype.updateEventSnap=function(eventSnap,complete,filtered){return new ViewCache(new CacheNode(eventSnap,complete,filtered),this.serverCache_)},ViewCache.prototype.updateServerSnap=function(serverSnap,complete,filtered){return new ViewCache(this.eventCache_,new CacheNode(serverSnap,complete,filtered))},ViewCache.prototype.getEventCache=function(){return this.eventCache_},ViewCache.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},ViewCache.prototype.getServerCache=function(){return this.serverCache_},ViewCache.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},ViewCache.Empty=new ViewCache(new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1),new CacheNode(ChildrenNode.EMPTY_NODE,!1,!1)),ViewCache}(),Change=function(){function Change(type,snapshotNode,childName,oldSnap,prevName){this.type=type,this.snapshotNode=snapshotNode,this.childName=childName,this.oldSnap=oldSnap,this.prevName=prevName}return Change.valueChange=function(snapshot){return new Change(Change.VALUE,snapshot)},Change.childAddedChange=function(childKey,snapshot){return new Change(Change.CHILD_ADDED,snapshot,childKey)},Change.childRemovedChange=function(childKey,snapshot){return new Change(Change.CHILD_REMOVED,snapshot,childKey)},Change.childChangedChange=function(childKey,newSnapshot,oldSnapshot){return new Change(Change.CHILD_CHANGED,newSnapshot,childKey,oldSnapshot)},Change.childMovedChange=function(childKey,snapshot){return new Change(Change.CHILD_MOVED,snapshot,childKey)},Change.CHILD_ADDED="child_added",Change.CHILD_REMOVED="child_removed",Change.CHILD_CHANGED="child_changed",Change.CHILD_MOVED="child_moved",Change.VALUE="value",Change}(),IndexedFilter=function(){function IndexedFilter(index_){this.index_=index_}return IndexedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){util.assert(snap.isIndexed(this.index_),"A node must be indexed if only a child is updated");var oldChild=snap.getImmediateChild(key);return oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))&&oldChild.isEmpty()==newChild.isEmpty()?snap:(null!=optChangeAccumulator&&(newChild.isEmpty()?snap.hasChild(key)?optChangeAccumulator.trackChildChange(Change.childRemovedChange(key,oldChild)):util.assert(snap.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):oldChild.isEmpty()?optChangeAccumulator.trackChildChange(Change.childAddedChange(key,newChild)):optChangeAccumulator.trackChildChange(Change.childChangedChange(key,newChild,oldChild))),snap.isLeafNode()&&newChild.isEmpty()?snap:snap.updateImmediateChild(key,newChild).withIndex(this.index_))},IndexedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){return null!=optChangeAccumulator&&(oldSnap.isLeafNode()||oldSnap.forEachChild(PRIORITY_INDEX,function(key,childNode){newSnap.hasChild(key)||optChangeAccumulator.trackChildChange(Change.childRemovedChange(key,childNode))}),newSnap.isLeafNode()||newSnap.forEachChild(PRIORITY_INDEX,function(key,childNode){if(oldSnap.hasChild(key)){var oldChild=oldSnap.getImmediateChild(key);oldChild.equals(childNode)||optChangeAccumulator.trackChildChange(Change.childChangedChange(key,childNode,oldChild))}else optChangeAccumulator.trackChildChange(Change.childAddedChange(key,childNode))})),newSnap.withIndex(this.index_)},IndexedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap.isEmpty()?ChildrenNode.EMPTY_NODE:oldSnap.updatePriority(newPriority)},IndexedFilter.prototype.filtersNodes=function(){return!1},IndexedFilter.prototype.getIndexedFilter=function(){return this},IndexedFilter.prototype.getIndex=function(){return this.index_},IndexedFilter}(),ChildChangeAccumulator=function(){function ChildChangeAccumulator(){this.changeMap_={}}return ChildChangeAccumulator.prototype.trackChildChange=function(change){var type=change.type,childKey=change.childName;util.assert(type==Change.CHILD_ADDED||type==Change.CHILD_CHANGED||type==Change.CHILD_REMOVED,"Only child changes supported for tracking"),util.assert(".priority"!==childKey,"Only non-priority child changes can be tracked.");var oldChange=util.safeGet(this.changeMap_,childKey);if(oldChange){var oldType=oldChange.type;if(type==Change.CHILD_ADDED&&oldType==Change.CHILD_REMOVED)this.changeMap_[childKey]=Change.childChangedChange(childKey,change.snapshotNode,oldChange.snapshotNode);else if(type==Change.CHILD_REMOVED&&oldType==Change.CHILD_ADDED)delete this.changeMap_[childKey];else if(type==Change.CHILD_REMOVED&&oldType==Change.CHILD_CHANGED)this.changeMap_[childKey]=Change.childRemovedChange(childKey,oldChange.oldSnap);else if(type==Change.CHILD_CHANGED&&oldType==Change.CHILD_ADDED)this.changeMap_[childKey]=Change.childAddedChange(childKey,change.snapshotNode);else{if(type!=Change.CHILD_CHANGED||oldType!=Change.CHILD_CHANGED)throw util.assertionError("Illegal combination of changes: "+change+" occurred after "+oldChange);this.changeMap_[childKey]=Change.childChangedChange(childKey,change.snapshotNode,oldChange.oldSnap)}}else this.changeMap_[childKey]=change},ChildChangeAccumulator.prototype.getChanges=function(){return util.getValues(this.changeMap_)},ChildChangeAccumulator}(),NoCompleteChildSource_=function(){function NoCompleteChildSource_(){}return NoCompleteChildSource_.prototype.getCompleteChild=function(childKey){return null},NoCompleteChildSource_.prototype.getChildAfterChild=function(index,child,reverse){return null},NoCompleteChildSource_}(),NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_,WriteTreeCompleteChildSource=function(){function WriteTreeCompleteChildSource(writes_,viewCache_,optCompleteServerCache_){void 0===optCompleteServerCache_&&(optCompleteServerCache_=null),this.writes_=writes_,this.viewCache_=viewCache_,this.optCompleteServerCache_=optCompleteServerCache_}return WriteTreeCompleteChildSource.prototype.getCompleteChild=function(childKey){var node=this.viewCache_.getEventCache();if(node.isCompleteForChild(childKey))return node.getNode().getImmediateChild(childKey);var serverNode=null!=this.optCompleteServerCache_?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(childKey,serverNode)},WriteTreeCompleteChildSource.prototype.getChildAfterChild=function(index,child,reverse){var completeServerData=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),nodes=this.writes_.calcIndexedSlice(completeServerData,child,1,reverse,index);return 0===nodes.length?null:nodes[0]},WriteTreeCompleteChildSource}(),ProcessorResult=function(){function ProcessorResult(viewCache,changes){this.viewCache=viewCache,this.changes=changes}return ProcessorResult}(),ViewProcessor=function(){function ViewProcessor(filter_){this.filter_=filter_}return ViewProcessor.prototype.assertIndexed=function(viewCache){util.assert(viewCache.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),util.assert(viewCache.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},ViewProcessor.prototype.applyOperation=function(oldViewCache,operation,writesCache,completeCache){var newViewCache,filterServerNode,accumulator=new ChildChangeAccumulator;if(operation.type===OperationType.OVERWRITE){var overwrite=operation;overwrite.source.fromUser?newViewCache=this.applyUserOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,accumulator):(util.assert(overwrite.source.fromServer,"Unknown source."),filterServerNode=overwrite.source.tagged||oldViewCache.getServerCache().isFiltered()&&!overwrite.path.isEmpty(),newViewCache=this.applyServerOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.MERGE){var merge=operation;merge.source.fromUser?newViewCache=this.applyUserMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,accumulator):(util.assert(merge.source.fromServer,"Unknown source."),filterServerNode=merge.source.tagged||oldViewCache.getServerCache().isFiltered(),newViewCache=this.applyServerMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,filterServerNode,accumulator))}else if(operation.type===OperationType.ACK_USER_WRITE){var ackUserWrite=operation;newViewCache=ackUserWrite.revert?this.revertUserWrite_(oldViewCache,ackUserWrite.path,writesCache,completeCache,accumulator):this.ackUserWrite_(oldViewCache,ackUserWrite.path,ackUserWrite.affectedTree,writesCache,completeCache,accumulator)}else{if(operation.type!==OperationType.LISTEN_COMPLETE)throw util.assertionError("Unknown operation type: "+operation.type);newViewCache=this.listenComplete_(oldViewCache,operation.path,writesCache,accumulator)}var changes=accumulator.getChanges();return ViewProcessor.maybeAddValueEvent_(oldViewCache,newViewCache,changes),new ProcessorResult(newViewCache,changes)},ViewProcessor.maybeAddValueEvent_=function(oldViewCache,newViewCache,accumulator){var eventSnap=newViewCache.getEventCache();if(eventSnap.isFullyInitialized()){var isLeafOrEmpty=eventSnap.getNode().isLeafNode()||eventSnap.getNode().isEmpty(),oldCompleteSnap=oldViewCache.getCompleteEventSnap();(accumulator.length>0||!oldViewCache.getEventCache().isFullyInitialized()||isLeafOrEmpty&&!eventSnap.getNode().equals(oldCompleteSnap)||!eventSnap.getNode().getPriority().equals(oldCompleteSnap.getPriority()))&&accumulator.push(Change.valueChange(newViewCache.getCompleteEventSnap()))}},ViewProcessor.prototype.generateEventCacheAfterServerEvent_=function(viewCache,changePath,writesCache,source,accumulator){var oldEventSnap=viewCache.getEventCache();if(null!=writesCache.shadowingWrite(changePath))return viewCache;var newEventCache=void 0,serverNode=void 0;if(changePath.isEmpty())if(util.assert(viewCache.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),viewCache.getServerCache().isFiltered()){var serverCache=viewCache.getCompleteServerSnap(),completeChildren=serverCache instanceof ChildrenNode?serverCache:ChildrenNode.EMPTY_NODE,completeEventChildren=writesCache.calcCompleteEventChildren(completeChildren);newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeEventChildren,accumulator)}else{var completeNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeNode,accumulator)}else{var childKey=changePath.getFront();if(".priority"==childKey){util.assert(1==changePath.getLength(),"Can't have a priority with additional path components");var oldEventNode=oldEventSnap.getNode();serverNode=viewCache.getServerCache().getNode();var updatedPriority=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventNode,serverNode);newEventCache=null!=updatedPriority?this.filter_.updatePriority(oldEventNode,updatedPriority):oldEventSnap.getNode()}else{var childChangePath=changePath.popFront(),newEventChild=void 0;if(oldEventSnap.isCompleteForChild(childKey)){serverNode=viewCache.getServerCache().getNode();var eventChildUpdate=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventSnap.getNode(),serverNode);newEventChild=null!=eventChildUpdate?oldEventSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,eventChildUpdate):oldEventSnap.getNode().getImmediateChild(childKey)}else newEventChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());newEventCache=null!=newEventChild?this.filter_.updateChild(oldEventSnap.getNode(),childKey,newEventChild,childChangePath,source,accumulator):oldEventSnap.getNode()}}return viewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized()||changePath.isEmpty(),this.filter_.filtersNodes())},ViewProcessor.prototype.applyServerOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,filterServerNode,accumulator){var newServerCache,oldServerSnap=oldViewCache.getServerCache(),serverFilter=filterServerNode?this.filter_:this.filter_.getIndexedFilter();if(changePath.isEmpty())newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),changedSnap,null);else if(serverFilter.filtersNodes()&&!oldServerSnap.isFiltered()){var newServerNode=oldServerSnap.getNode().updateChild(changePath,changedSnap);newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),newServerNode,null)}else{var childKey=changePath.getFront();if(!oldServerSnap.isCompleteForPath(changePath)&&changePath.getLength()>1)return oldViewCache;var childChangePath=changePath.popFront(),childNode=oldServerSnap.getNode().getImmediateChild(childKey),newChildNode=childNode.updateChild(childChangePath,changedSnap);newServerCache=".priority"==childKey?serverFilter.updatePriority(oldServerSnap.getNode(),newChildNode):serverFilter.updateChild(oldServerSnap.getNode(),childKey,newChildNode,childChangePath,NO_COMPLETE_CHILD_SOURCE,null)}var newViewCache=oldViewCache.updateServerSnap(newServerCache,oldServerSnap.isFullyInitialized()||changePath.isEmpty(),serverFilter.filtersNodes()),source=new WriteTreeCompleteChildSource(writesCache,newViewCache,completeCache);return this.generateEventCacheAfterServerEvent_(newViewCache,changePath,writesCache,source,accumulator)},ViewProcessor.prototype.applyUserOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,accumulator){var newViewCache,newEventCache,oldEventSnap=oldViewCache.getEventCache(),source=new WriteTreeCompleteChildSource(writesCache,oldViewCache,completeCache);if(changePath.isEmpty())newEventCache=this.filter_.updateFullNode(oldViewCache.getEventCache().getNode(),changedSnap,accumulator),newViewCache=oldViewCache.updateEventSnap(newEventCache,!0,this.filter_.filtersNodes());else{var childKey=changePath.getFront();if(".priority"===childKey)newEventCache=this.filter_.updatePriority(oldViewCache.getEventCache().getNode(),changedSnap),newViewCache=oldViewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized(),oldEventSnap.isFiltered());else{var childChangePath=changePath.popFront(),oldChild=oldEventSnap.getNode().getImmediateChild(childKey),newChild=void 0;if(childChangePath.isEmpty())newChild=changedSnap;else{var childNode=source.getCompleteChild(childKey);newChild=null!=childNode?".priority"===childChangePath.getBack()&&childNode.getChild(childChangePath.parent()).isEmpty()?childNode:childNode.updateChild(childChangePath,changedSnap):ChildrenNode.EMPTY_NODE}if(oldChild.equals(newChild))newViewCache=oldViewCache;else{var newEventSnap=this.filter_.updateChild(oldEventSnap.getNode(),childKey,newChild,childChangePath,source,accumulator);newViewCache=oldViewCache.updateEventSnap(newEventSnap,oldEventSnap.isFullyInitialized(),this.filter_.filtersNodes())}}}return newViewCache},ViewProcessor.cacheHasChild_=function(viewCache,childKey){return viewCache.getEventCache().isCompleteForChild(childKey)},ViewProcessor.prototype.applyUserMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,accumulator){var _this=this,curViewCache=viewCache;return changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())&&(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))}),changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())||(curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator))}),curViewCache},ViewProcessor.prototype.applyMerge_=function(node,merge){return merge.foreach(function(relativePath,childNode){node=node.updateChild(relativePath,childNode)}),node},ViewProcessor.prototype.applyServerMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,filterServerNode,accumulator){var _this=this;if(viewCache.getServerCache().getNode().isEmpty()&&!viewCache.getServerCache().isFullyInitialized())return viewCache;var viewMergeTree,curViewCache=viewCache;viewMergeTree=path.isEmpty()?changedChildren:ImmutableTree.Empty.setTree(path,changedChildren);var serverNode=viewCache.getServerCache().getNode();return viewMergeTree.children.inorderTraversal(function(childKey,childTree){if(serverNode.hasChild(childKey)){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}}),viewMergeTree.children.inorderTraversal(function(childKey,childMergeTree){var isUnknownDeepMerge=!viewCache.getServerCache().isCompleteForChild(childKey)&&null==childMergeTree.value;if(!serverNode.hasChild(childKey)&&!isUnknownDeepMerge){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey),newChild=_this.applyMerge_(serverChild,childMergeTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}}),curViewCache},ViewProcessor.prototype.ackUserWrite_=function(viewCache,ackPath,affectedTree,writesCache,completeCache,accumulator){if(null!=writesCache.shadowingWrite(ackPath))return viewCache;var filterServerNode=viewCache.getServerCache().isFiltered(),serverCache=viewCache.getServerCache();if(null!=affectedTree.value){if(ackPath.isEmpty()&&serverCache.isFullyInitialized()||serverCache.isCompleteForPath(ackPath))return this.applyServerOverwrite_(viewCache,ackPath,serverCache.getNode().getChild(ackPath),writesCache,completeCache,filterServerNode,accumulator);if(ackPath.isEmpty()){var changedChildren_1=ImmutableTree.Empty;return serverCache.getNode().forEachChild(KEY_INDEX,function(name,node){changedChildren_1=changedChildren_1.set(new Path(name),node)}),this.applyServerMerge_(viewCache,ackPath,changedChildren_1,writesCache,completeCache,filterServerNode,accumulator)}return viewCache}var changedChildren_2=ImmutableTree.Empty;return affectedTree.foreach(function(mergePath,value){var serverCachePath=ackPath.child(mergePath);serverCache.isCompleteForPath(serverCachePath)&&(changedChildren_2=changedChildren_2.set(mergePath,serverCache.getNode().getChild(serverCachePath)))}),this.applyServerMerge_(viewCache,ackPath,changedChildren_2,writesCache,completeCache,filterServerNode,accumulator)},ViewProcessor.prototype.listenComplete_=function(viewCache,path,writesCache,accumulator){var oldServerNode=viewCache.getServerCache(),newViewCache=viewCache.updateServerSnap(oldServerNode.getNode(),oldServerNode.isFullyInitialized()||path.isEmpty(),oldServerNode.isFiltered());return this.generateEventCacheAfterServerEvent_(newViewCache,path,writesCache,NO_COMPLETE_CHILD_SOURCE,accumulator)},ViewProcessor.prototype.revertUserWrite_=function(viewCache,path,writesCache,completeServerCache,accumulator){var complete;if(null!=writesCache.shadowingWrite(path))return viewCache;var source=new WriteTreeCompleteChildSource(writesCache,viewCache,completeServerCache),oldEventCache=viewCache.getEventCache().getNode(),newEventCache=void 0;if(path.isEmpty()||".priority"===path.getFront()){var newNode=void 0;if(viewCache.getServerCache().isFullyInitialized())newNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());else{var serverChildren=viewCache.getServerCache().getNode();util.assert(serverChildren instanceof ChildrenNode,"serverChildren would be complete if leaf node"),newNode=writesCache.calcCompleteEventChildren(serverChildren)}newNode=newNode,newEventCache=this.filter_.updateFullNode(oldEventCache,newNode,accumulator)}else{var childKey=path.getFront(),newChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());null==newChild&&viewCache.getServerCache().isCompleteForChild(childKey)&&(newChild=oldEventCache.getImmediateChild(childKey)),newEventCache=null!=newChild?this.filter_.updateChild(oldEventCache,childKey,newChild,path.popFront(),source,accumulator):viewCache.getEventCache().getNode().hasChild(childKey)?this.filter_.updateChild(oldEventCache,childKey,ChildrenNode.EMPTY_NODE,path.popFront(),source,accumulator):oldEventCache,newEventCache.isEmpty()&&viewCache.getServerCache().isFullyInitialized()&&(complete=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap()),complete.isLeafNode()&&(newEventCache=this.filter_.updateFullNode(newEventCache,complete,accumulator)))}return complete=viewCache.getServerCache().isFullyInitialized()||null!=writesCache.shadowingWrite(Path.Empty),viewCache.updateEventSnap(newEventCache,complete,this.filter_.filtersNodes())},ViewProcessor}(),EventGenerator=function(){function EventGenerator(query_){this.query_=query_,this.index_=this.query_.getQueryParams().getIndex()}return EventGenerator.prototype.generateEventsForChanges=function(changes,eventCache,eventRegistrations){var _this=this,events=[],moves=[];return changes.forEach(function(change){change.type===Change.CHILD_CHANGED&&_this.index_.indexedValueChanged(change.oldSnap,change.snapshotNode)&&moves.push(Change.childMovedChange(change.childName,change.snapshotNode))}),this.generateEventsForType_(events,Change.CHILD_REMOVED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_ADDED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_MOVED,moves,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.CHILD_CHANGED,changes,eventRegistrations,eventCache),this.generateEventsForType_(events,Change.VALUE,changes,eventRegistrations,eventCache),events},EventGenerator.prototype.generateEventsForType_=function(events,eventType,changes,registrations,eventCache){var _this=this,filteredChanges=changes.filter(function(change){return change.type===eventType});filteredChanges.sort(this.compareChanges_.bind(this)),filteredChanges.forEach(function(change){var materializedChange=_this.materializeSingleChange_(change,eventCache);registrations.forEach(function(registration){registration.respondsTo(change.type)&&events.push(registration.createEvent(materializedChange,_this.query_))})})},EventGenerator.prototype.materializeSingleChange_=function(change,eventCache){return"value"===change.type||"child_removed"===change.type?change:(change.prevName=eventCache.getPredecessorChildName(change.childName,change.snapshotNode,this.index_),change)},EventGenerator.prototype.compareChanges_=function(a,b){if(null==a.childName||null==b.childName)throw util.assertionError("Should only compare child_ events.");var aWrapped=new NamedNode(a.childName,a.snapshotNode),bWrapped=new NamedNode(b.childName,b.snapshotNode);return this.index_.compare(aWrapped,bWrapped)},EventGenerator}(),View=function(){function View(query_,initialViewCache){this.query_=query_,this.eventRegistrations_=[];var params=this.query_.getQueryParams(),indexFilter=new IndexedFilter(params.getIndex()),filter=params.getNodeFilter();this.processor_=new ViewProcessor(filter);var initialServerCache=initialViewCache.getServerCache(),initialEventCache=initialViewCache.getEventCache(),serverSnap=indexFilter.updateFullNode(ChildrenNode.EMPTY_NODE,initialServerCache.getNode(),null),eventSnap=filter.updateFullNode(ChildrenNode.EMPTY_NODE,initialEventCache.getNode(),null),newServerCache=new CacheNode(serverSnap,initialServerCache.isFullyInitialized(),indexFilter.filtersNodes()),newEventCache=new CacheNode(eventSnap,initialEventCache.isFullyInitialized(),filter.filtersNodes());this.viewCache_=new ViewCache(newEventCache,newServerCache),this.eventGenerator_=new EventGenerator(this.query_)}return View.prototype.getQuery=function(){return this.query_},View.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},View.prototype.getCompleteServerCache=function(path){var cache=this.viewCache_.getCompleteServerSnap();return cache&&(this.query_.getQueryParams().loadsAllData()||!path.isEmpty()&&!cache.getImmediateChild(path.getFront()).isEmpty())?cache.getChild(path):null},View.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},View.prototype.addEventRegistration=function(eventRegistration){this.eventRegistrations_.push(eventRegistration)},View.prototype.removeEventRegistration=function(eventRegistration,cancelError){var cancelEvents=[];if(cancelError){util.assert(null==eventRegistration,"A cancel should cancel all event registrations.");var path_1=this.query_.path;this.eventRegistrations_.forEach(function(registration){cancelError=cancelError;var maybeEvent=registration.createCancelEvent(cancelError,path_1);maybeEvent&&cancelEvents.push(maybeEvent)})}if(eventRegistration){for(var remaining=[],i=0;i<this.eventRegistrations_.length;++i){var existing=this.eventRegistrations_[i];if(existing.matches(eventRegistration)){if(eventRegistration.hasAnyCallback()){remaining=remaining.concat(this.eventRegistrations_.slice(i+1));break}}else remaining.push(existing)}this.eventRegistrations_=remaining}else this.eventRegistrations_=[];return cancelEvents},View.prototype.applyOperation=function(operation,writesCache,completeServerCache){operation.type===OperationType.MERGE&&null!==operation.source.queryId&&(util.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),util.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var oldViewCache=this.viewCache_,result=this.processor_.applyOperation(oldViewCache,operation,writesCache,completeServerCache);return this.processor_.assertIndexed(result.viewCache),util.assert(result.viewCache.getServerCache().isFullyInitialized()||!oldViewCache.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=result.viewCache,this.generateEventsForChanges_(result.changes,result.viewCache.getEventCache().getNode(),null)},View.prototype.getInitialEvents=function(registration){var eventSnap=this.viewCache_.getEventCache(),initialChanges=[];if(!eventSnap.getNode().isLeafNode()){eventSnap.getNode().forEachChild(PRIORITY_INDEX,function(key,childNode){initialChanges.push(Change.childAddedChange(key,childNode))})}return eventSnap.isFullyInitialized()&&initialChanges.push(Change.valueChange(eventSnap.getNode())),this.generateEventsForChanges_(initialChanges,eventSnap.getNode(),registration)},View.prototype.generateEventsForChanges_=function(changes,eventCache,eventRegistration){var registrations=eventRegistration?[eventRegistration]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(changes,eventCache,registrations)},View}(),SyncPoint=function(){function SyncPoint(){this.views_={}}return Object.defineProperty(SyncPoint,"__referenceConstructor",{get:function(){return util.assert(__referenceConstructor$1,"Reference.ts has not been loaded"),__referenceConstructor$1},set:function(val){util.assert(!__referenceConstructor$1,"__referenceConstructor has already been defined"),__referenceConstructor$1=val},enumerable:!0,configurable:!0}),SyncPoint.prototype.isEmpty=function(){return util.isEmpty(this.views_)},SyncPoint.prototype.applyOperation=function(operation,writesCache,optCompleteServerCache){var queryId=operation.source.queryId;if(null!==queryId){var view=util.safeGet(this.views_,queryId);return util.assert(null!=view,"SyncTree gave us an op for an invalid query."),view.applyOperation(operation,writesCache,optCompleteServerCache)}var events_1=[];return util.forEach(this.views_,function(key,view){events_1=events_1.concat(view.applyOperation(operation,writesCache,optCompleteServerCache))}),events_1},SyncPoint.prototype.addEventRegistration=function(query,eventRegistration,writesCache,serverCache,serverCacheComplete){var queryId=query.queryIdentifier(),view=util.safeGet(this.views_,queryId);if(!view){var eventCache=writesCache.calcCompleteEventCache(serverCacheComplete?serverCache:null),eventCacheComplete=!1;eventCache?eventCacheComplete=!0:serverCache instanceof ChildrenNode?(eventCache=writesCache.calcCompleteEventChildren(serverCache),eventCacheComplete=!1):(eventCache=ChildrenNode.EMPTY_NODE,eventCacheComplete=!1);var viewCache=new ViewCache(new CacheNode(eventCache,eventCacheComplete,!1),new CacheNode(serverCache,serverCacheComplete,!1));view=new View(query,viewCache),this.views_[queryId]=view}return view.addEventRegistration(eventRegistration),view.getInitialEvents(eventRegistration)},SyncPoint.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var queryId=query.queryIdentifier(),removed=[],cancelEvents=[],hadCompleteView=this.hasCompleteView();if("default"===queryId){var self_1=this;util.forEach(this.views_,function(viewQueryId,view){cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(delete self_1.views_[viewQueryId],view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery()))})}else{var view=util.safeGet(this.views_,queryId);view&&(cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError)),view.isEmpty()&&(delete this.views_[queryId],view.getQuery().getQueryParams().loadsAllData()||removed.push(view.getQuery())))}return hadCompleteView&&!this.hasCompleteView()&&removed.push(new SyncPoint.__referenceConstructor(query.repo,query.path)),{removed:removed,events:cancelEvents}},SyncPoint.prototype.getQueryViews=function(){var _this=this;return Object.keys(this.views_).map(function(key){return _this.views_[key]}).filter(function(view){return!view.getQuery().getQueryParams().loadsAllData()})},SyncPoint.prototype.getCompleteServerCache=function(path){var serverCache=null;return util.forEach(this.views_,function(key,view){serverCache=serverCache||view.getCompleteServerCache(path)}),serverCache},SyncPoint.prototype.viewForQuery=function(query){if(query.getQueryParams().loadsAllData())return this.getCompleteView();var queryId=query.queryIdentifier();return util.safeGet(this.views_,queryId)},SyncPoint.prototype.viewExistsForQuery=function(query){return null!=this.viewForQuery(query)},SyncPoint.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},
SyncPoint.prototype.getCompleteView=function(){return util.findValue(this.views_,function(view){return view.getQuery().getQueryParams().loadsAllData()})||null},SyncPoint}(),CompoundWrite=function(){function CompoundWrite(writeTree_){this.writeTree_=writeTree_}return CompoundWrite.prototype.addWrite=function(path,node){if(path.isEmpty())return new CompoundWrite(new ImmutableTree(node));var rootmost=this.writeTree_.findRootMostValueAndPath(path);if(null!=rootmost){var rootMostPath=rootmost.path,value=rootmost.value,relativePath=Path.relativePath(rootMostPath,path);return value=value.updateChild(relativePath,node),new CompoundWrite(this.writeTree_.set(rootMostPath,value))}var subtree=new ImmutableTree(node);return new CompoundWrite(this.writeTree_.setTree(path,subtree))},CompoundWrite.prototype.addWrites=function(path,updates){var newWrite=this;return util.forEach(updates,function(childKey,node){newWrite=newWrite.addWrite(path.child(childKey),node)}),newWrite},CompoundWrite.prototype.removeWrite=function(path){return path.isEmpty()?CompoundWrite.Empty:new CompoundWrite(this.writeTree_.setTree(path,ImmutableTree.Empty))},CompoundWrite.prototype.hasCompleteWrite=function(path){return null!=this.getCompleteNode(path)},CompoundWrite.prototype.getCompleteNode=function(path){var rootmost=this.writeTree_.findRootMostValueAndPath(path);return null!=rootmost?this.writeTree_.get(rootmost.path).getChild(Path.relativePath(rootmost.path,path)):null},CompoundWrite.prototype.getCompleteChildren=function(){var children=[],node=this.writeTree_.value;return null!=node?node.isLeafNode()||node.forEachChild(PRIORITY_INDEX,function(childName,childNode){children.push(new NamedNode(childName,childNode))}):this.writeTree_.children.inorderTraversal(function(childName,childTree){null!=childTree.value&&children.push(new NamedNode(childName,childTree.value))}),children},CompoundWrite.prototype.childCompoundWrite=function(path){if(path.isEmpty())return this;var shadowingNode=this.getCompleteNode(path);return new CompoundWrite(null!=shadowingNode?new ImmutableTree(shadowingNode):this.writeTree_.subtree(path))},CompoundWrite.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},CompoundWrite.prototype.apply=function(node){return CompoundWrite.applySubtreeWrite_(Path.Empty,this.writeTree_,node)},CompoundWrite.Empty=new CompoundWrite(new ImmutableTree(null)),CompoundWrite.applySubtreeWrite_=function(relativePath,writeTree,node){if(null!=writeTree.value)return node.updateChild(relativePath,writeTree.value);var priorityWrite_1=null;return writeTree.children.inorderTraversal(function(childKey,childTree){".priority"===childKey?(util.assert(null!==childTree.value,"Priority writes must always be leaf nodes"),priorityWrite_1=childTree.value):node=CompoundWrite.applySubtreeWrite_(relativePath.child(childKey),childTree,node)}),node.getChild(relativePath).isEmpty()||null===priorityWrite_1||(node=node.updateChild(relativePath.child(".priority"),priorityWrite_1)),node},CompoundWrite}(),WriteTree=function(){function WriteTree(){this.visibleWrites_=CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return WriteTree.prototype.childWrites=function(path){return new WriteTreeRef(path,this)},WriteTree.prototype.addOverwrite=function(path,snap,writeId,visible){util.assert(writeId>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===visible&&(visible=!0),this.allWrites_.push({path:path,snap:snap,writeId:writeId,visible:visible}),visible&&(this.visibleWrites_=this.visibleWrites_.addWrite(path,snap)),this.lastWriteId_=writeId},WriteTree.prototype.addMerge=function(path,changedChildren,writeId){util.assert(writeId>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:path,children:changedChildren,writeId:writeId,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(path,changedChildren),this.lastWriteId_=writeId},WriteTree.prototype.getWrite=function(writeId){for(var i=0;i<this.allWrites_.length;i++){var record=this.allWrites_[i];if(record.writeId===writeId)return record}return null},WriteTree.prototype.removeWrite=function(writeId){var _this=this,idx=this.allWrites_.findIndex(function(s){return s.writeId===writeId});util.assert(idx>=0,"removeWrite called with nonexistent writeId.");var writeToRemove=this.allWrites_[idx];this.allWrites_.splice(idx,1);for(var removedWriteWasVisible=writeToRemove.visible,removedWriteOverlapsWithOtherWrites=!1,i=this.allWrites_.length-1;removedWriteWasVisible&&i>=0;){var currentWrite=this.allWrites_[i];currentWrite.visible&&(i>=idx&&this.recordContainsPath_(currentWrite,writeToRemove.path)?removedWriteWasVisible=!1:writeToRemove.path.contains(currentWrite.path)&&(removedWriteOverlapsWithOtherWrites=!0)),i--}if(removedWriteWasVisible){if(removedWriteOverlapsWithOtherWrites)return this.resetTree_(),!0;if(writeToRemove.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(writeToRemove.path);else{var children=writeToRemove.children;util.forEach(children,function(childName){_this.visibleWrites_=_this.visibleWrites_.removeWrite(writeToRemove.path.child(childName))})}return!0}return!1},WriteTree.prototype.getCompleteWriteData=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcCompleteEventCache=function(treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites){if(writeIdsToExclude||includeHiddenWrites){var merge=this.visibleWrites_.childCompoundWrite(treePath);if(!includeHiddenWrites&&merge.isEmpty())return completeServerCache;if(includeHiddenWrites||null!=completeServerCache||merge.hasCompleteWrite(Path.Empty)){var filter=function(write){return(write.visible||includeHiddenWrites)&&(!writeIdsToExclude||!~writeIdsToExclude.indexOf(write.writeId))&&(write.path.contains(treePath)||treePath.contains(write.path))},mergeAtPath=WriteTree.layerTree_(this.allWrites_,filter,treePath),layeredCache=completeServerCache||ChildrenNode.EMPTY_NODE;return mergeAtPath.apply(layeredCache)}return null}var shadowingNode=this.visibleWrites_.getCompleteNode(treePath);if(null!=shadowingNode)return shadowingNode;var subMerge=this.visibleWrites_.childCompoundWrite(treePath);if(subMerge.isEmpty())return completeServerCache;if(null!=completeServerCache||subMerge.hasCompleteWrite(Path.Empty)){var layeredCache=completeServerCache||ChildrenNode.EMPTY_NODE;return subMerge.apply(layeredCache)}return null},WriteTree.prototype.calcCompleteEventChildren=function(treePath,completeServerChildren){var completeChildren=ChildrenNode.EMPTY_NODE,topLevelSet=this.visibleWrites_.getCompleteNode(treePath);if(topLevelSet)return topLevelSet.isLeafNode()||topLevelSet.forEachChild(PRIORITY_INDEX,function(childName,childSnap){completeChildren=completeChildren.updateImmediateChild(childName,childSnap)}),completeChildren;if(completeServerChildren){var merge_1=this.visibleWrites_.childCompoundWrite(treePath);return completeServerChildren.forEachChild(PRIORITY_INDEX,function(childName,childNode){var node=merge_1.childCompoundWrite(new Path(childName)).apply(childNode);completeChildren=completeChildren.updateImmediateChild(childName,node)}),merge_1.getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)}),completeChildren}return this.visibleWrites_.childCompoundWrite(treePath).getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)}),completeChildren},WriteTree.prototype.calcEventCacheAfterServerOverwrite=function(treePath,childPath,existingEventSnap,existingServerSnap){util.assert(existingEventSnap||existingServerSnap,"Either existingEventSnap or existingServerSnap must exist");var path=treePath.child(childPath);if(this.visibleWrites_.hasCompleteWrite(path))return null;var childMerge=this.visibleWrites_.childCompoundWrite(path);return childMerge.isEmpty()?existingServerSnap.getChild(childPath):childMerge.apply(existingServerSnap.getChild(childPath))},WriteTree.prototype.calcCompleteChild=function(treePath,childKey,existingServerSnap){var path=treePath.child(childKey),shadowingNode=this.visibleWrites_.getCompleteNode(path);if(null!=shadowingNode)return shadowingNode;if(existingServerSnap.isCompleteForChild(childKey)){return this.visibleWrites_.childCompoundWrite(path).apply(existingServerSnap.getNode().getImmediateChild(childKey))}return null},WriteTree.prototype.shadowingWrite=function(path){return this.visibleWrites_.getCompleteNode(path)},WriteTree.prototype.calcIndexedSlice=function(treePath,completeServerData,startPost,count,reverse,index){var toIterate,merge=this.visibleWrites_.childCompoundWrite(treePath),shadowingNode=merge.getCompleteNode(Path.Empty);if(null!=shadowingNode)toIterate=shadowingNode;else{if(null==completeServerData)return[];toIterate=merge.apply(completeServerData)}if(toIterate=toIterate.withIndex(index),toIterate.isEmpty()||toIterate.isLeafNode())return[];for(var nodes=[],cmp=index.getCompare(),iter=reverse?toIterate.getReverseIteratorFrom(startPost,index):toIterate.getIteratorFrom(startPost,index),next=iter.getNext();next&&nodes.length<count;)0!==cmp(next,startPost)&&nodes.push(next),next=iter.getNext();return nodes},WriteTree.prototype.recordContainsPath_=function(writeRecord,path){return writeRecord.snap?writeRecord.path.contains(path):!!util.findKey(writeRecord.children,function(childSnap,childName){return writeRecord.path.child(childName).contains(path)})},WriteTree.prototype.resetTree_=function(){this.visibleWrites_=WriteTree.layerTree_(this.allWrites_,WriteTree.DefaultFilter_,Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},WriteTree.DefaultFilter_=function(write){return write.visible},WriteTree.layerTree_=function(writes,filter,treeRoot){for(var compoundWrite=CompoundWrite.Empty,i=0;i<writes.length;++i){var write=writes[i];if(filter(write)){var writePath=write.path,relativePath=void 0;if(write.snap)treeRoot.contains(writePath)?(relativePath=Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrite(relativePath,write.snap)):writePath.contains(treeRoot)&&(relativePath=Path.relativePath(writePath,treeRoot),compoundWrite=compoundWrite.addWrite(Path.Empty,write.snap.getChild(relativePath)));else{if(!write.children)throw util.assertionError("WriteRecord should have .snap or .children");if(treeRoot.contains(writePath))relativePath=Path.relativePath(treeRoot,writePath),compoundWrite=compoundWrite.addWrites(relativePath,write.children);else if(writePath.contains(treeRoot))if(relativePath=Path.relativePath(writePath,treeRoot),relativePath.isEmpty())compoundWrite=compoundWrite.addWrites(Path.Empty,write.children);else{var child=util.safeGet(write.children,relativePath.getFront());if(child){var deepNode=child.getChild(relativePath.popFront());compoundWrite=compoundWrite.addWrite(Path.Empty,deepNode)}}}}}return compoundWrite},WriteTree}(),WriteTreeRef=function(){function WriteTreeRef(path,writeTree){this.treePath_=path,this.writeTree_=writeTree}return WriteTreeRef.prototype.calcCompleteEventCache=function(completeServerCache,writeIdsToExclude,includeHiddenWrites){return this.writeTree_.calcCompleteEventCache(this.treePath_,completeServerCache,writeIdsToExclude,includeHiddenWrites)},WriteTreeRef.prototype.calcCompleteEventChildren=function(completeServerChildren){return this.writeTree_.calcCompleteEventChildren(this.treePath_,completeServerChildren)},WriteTreeRef.prototype.calcEventCacheAfterServerOverwrite=function(path,existingEventSnap,existingServerSnap){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,path,existingEventSnap,existingServerSnap)},WriteTreeRef.prototype.shadowingWrite=function(path){return this.writeTree_.shadowingWrite(this.treePath_.child(path))},WriteTreeRef.prototype.calcIndexedSlice=function(completeServerData,startPost,count,reverse,index){return this.writeTree_.calcIndexedSlice(this.treePath_,completeServerData,startPost,count,reverse,index)},WriteTreeRef.prototype.calcCompleteChild=function(childKey,existingServerCache){return this.writeTree_.calcCompleteChild(this.treePath_,childKey,existingServerCache)},WriteTreeRef.prototype.child=function(childName){return new WriteTreeRef(this.treePath_.child(childName),this.writeTree_)},WriteTreeRef}(),SyncTree=function(){function SyncTree(listenProvider_){this.listenProvider_=listenProvider_,this.syncPointTree_=ImmutableTree.Empty,this.pendingWriteTree_=new WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return SyncTree.prototype.applyUserOverwrite=function(path,newData,writeId,visible){return this.pendingWriteTree_.addOverwrite(path,newData,writeId,visible),visible?this.applyOperationToSyncPoints_(new Overwrite(OperationSource.User,path,newData)):[]},SyncTree.prototype.applyUserMerge=function(path,changedChildren,writeId){this.pendingWriteTree_.addMerge(path,changedChildren,writeId);var changeTree=ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge(OperationSource.User,path,changeTree))},SyncTree.prototype.ackUserWrite=function(writeId,revert){void 0===revert&&(revert=!1);var write=this.pendingWriteTree_.getWrite(writeId);if(this.pendingWriteTree_.removeWrite(writeId)){var affectedTree_1=ImmutableTree.Empty;return null!=write.snap?affectedTree_1=affectedTree_1.set(Path.Empty,!0):util.forEach(write.children,function(pathString,node){affectedTree_1=affectedTree_1.set(new Path(pathString),node)}),this.applyOperationToSyncPoints_(new AckUserWrite(write.path,affectedTree_1,revert))}return[]},SyncTree.prototype.applyServerOverwrite=function(path,newData){return this.applyOperationToSyncPoints_(new Overwrite(OperationSource.Server,path,newData))},SyncTree.prototype.applyServerMerge=function(path,changedChildren){var changeTree=ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge(OperationSource.Server,path,changeTree))},SyncTree.prototype.applyListenComplete=function(path){return this.applyOperationToSyncPoints_(new ListenComplete(OperationSource.Server,path))},SyncTree.prototype.applyTaggedQueryOverwrite=function(path,snap,tag){var queryKey=this.queryKeyForTag_(tag);if(null!=queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),op=new Overwrite(OperationSource.forServerTaggedQuery(queryId),relativePath,snap);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedQueryMerge=function(path,changedChildren,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),changeTree=ImmutableTree.fromObject(changedChildren),op=new Merge(OperationSource.forServerTaggedQuery(queryId),relativePath,changeTree);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.applyTaggedListenComplete=function(path,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey),queryPath=r.path,queryId=r.queryId,relativePath=Path.relativePath(queryPath,path),op=new ListenComplete(OperationSource.forServerTaggedQuery(queryId),relativePath);return this.applyTaggedOperation_(queryPath,op)}return[]},SyncTree.prototype.addEventRegistration=function(query,eventRegistration){var path=query.path,serverCache=null,foundAncestorDefaultView=!1;this.syncPointTree_.foreachOnPath(path,function(pathToSyncPoint,sp){var relativePath=Path.relativePath(pathToSyncPoint,path);serverCache=serverCache||sp.getCompleteServerCache(relativePath),foundAncestorDefaultView=foundAncestorDefaultView||sp.hasCompleteView()});var syncPoint=this.syncPointTree_.get(path);syncPoint?(foundAncestorDefaultView=foundAncestorDefaultView||syncPoint.hasCompleteView(),serverCache=serverCache||syncPoint.getCompleteServerCache(Path.Empty)):(syncPoint=new SyncPoint,this.syncPointTree_=this.syncPointTree_.set(path,syncPoint));var serverCacheComplete;if(null!=serverCache)serverCacheComplete=!0;else{serverCacheComplete=!1,serverCache=ChildrenNode.EMPTY_NODE;this.syncPointTree_.subtree(path).foreachChild(function(childName,childSyncPoint){var completeCache=childSyncPoint.getCompleteServerCache(Path.Empty);completeCache&&(serverCache=serverCache.updateImmediateChild(childName,completeCache))})}var viewAlreadyExists=syncPoint.viewExistsForQuery(query);if(!viewAlreadyExists&&!query.getQueryParams().loadsAllData()){var queryKey=SyncTree.makeQueryKey_(query);util.assert(!(queryKey in this.queryToTagMap_),"View does not exist, but we have a tag");var tag=SyncTree.getNextQueryTag_();this.queryToTagMap_[queryKey]=tag,this.tagToQueryMap_["_"+tag]=queryKey}var writesCache=this.pendingWriteTree_.childWrites(path),events=syncPoint.addEventRegistration(query,eventRegistration,writesCache,serverCache,serverCacheComplete);if(!viewAlreadyExists&&!foundAncestorDefaultView){var view=syncPoint.viewForQuery(query);events=events.concat(this.setupListener_(query,view))}return events},SyncTree.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var _this=this,path=query.path,maybeSyncPoint=this.syncPointTree_.get(path),cancelEvents=[];if(maybeSyncPoint&&("default"===query.queryIdentifier()||maybeSyncPoint.viewExistsForQuery(query))){var removedAndEvents=maybeSyncPoint.removeEventRegistration(query,eventRegistration,cancelError);maybeSyncPoint.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(path));var removed=removedAndEvents.removed;cancelEvents=removedAndEvents.events;var removingDefault=-1!==removed.findIndex(function(query){return query.getQueryParams().loadsAllData()}),covered=this.syncPointTree_.findOnPath(path,function(relativePath,parentSyncPoint){return parentSyncPoint.hasCompleteView()});if(removingDefault&&!covered){var subtree=this.syncPointTree_.subtree(path);if(!subtree.isEmpty())for(var newViews=this.collectDistinctViewsForSubTree_(subtree),i=0;i<newViews.length;++i){var view=newViews[i],newQuery=view.getQuery(),listener=this.createListenerForView_(view);this.listenProvider_.startListening(SyncTree.queryForListening_(newQuery),this.tagForQuery_(newQuery),listener.hashFn,listener.onComplete)}}if(!covered&&removed.length>0&&!cancelError)if(removingDefault){this.listenProvider_.stopListening(SyncTree.queryForListening_(query),null)}else removed.forEach(function(queryToRemove){var tagToRemove=_this.queryToTagMap_[SyncTree.makeQueryKey_(queryToRemove)];_this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToRemove),tagToRemove)});this.removeTags_(removed)}return cancelEvents},SyncTree.prototype.calcCompleteEventCache=function(path,writeIdsToExclude){var writeTree=this.pendingWriteTree_,serverCache=this.syncPointTree_.findOnPath(path,function(pathSoFar,syncPoint){var relativePath=Path.relativePath(pathSoFar,path),serverCache=syncPoint.getCompleteServerCache(relativePath);if(serverCache)return serverCache});return writeTree.calcCompleteEventCache(path,serverCache,writeIdsToExclude,!0)},SyncTree.prototype.collectDistinctViewsForSubTree_=function(subtree){return subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView()){return[maybeChildSyncPoint.getCompleteView()]}var views_1=[];return maybeChildSyncPoint&&(views_1=maybeChildSyncPoint.getQueryViews()),util.forEach(childMap,function(key,childViews){views_1=views_1.concat(childViews)}),views_1})},SyncTree.prototype.removeTags_=function(queries){for(var j=0;j<queries.length;++j){var removedQuery=queries[j];if(!removedQuery.getQueryParams().loadsAllData()){var removedQueryKey=SyncTree.makeQueryKey_(removedQuery),removedQueryTag=this.queryToTagMap_[removedQueryKey];delete this.queryToTagMap_[removedQueryKey],delete this.tagToQueryMap_["_"+removedQueryTag]}}},SyncTree.queryForListening_=function(query){return query.getQueryParams().loadsAllData()&&!query.getQueryParams().isDefault()?query.getRef():query},SyncTree.prototype.setupListener_=function(query,view){var path=query.path,tag=this.tagForQuery_(query),listener=this.createListenerForView_(view),events=this.listenProvider_.startListening(SyncTree.queryForListening_(query),tag,listener.hashFn,listener.onComplete),subtree=this.syncPointTree_.subtree(path);if(tag)util.assert(!subtree.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var queriesToStop=subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(!relativePath.isEmpty()&&maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView())return[maybeChildSyncPoint.getCompleteView().getQuery()];var queries_1=[];return maybeChildSyncPoint&&(queries_1=queries_1.concat(maybeChildSyncPoint.getQueryViews().map(function(view){return view.getQuery()}))),util.forEach(childMap,function(key,childQueries){queries_1=queries_1.concat(childQueries)}),queries_1}),i=0;i<queriesToStop.length;++i){var queryToStop=queriesToStop[i];this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToStop),this.tagForQuery_(queryToStop))}return events},SyncTree.prototype.createListenerForView_=function(view){var _this=this,query=view.getQuery(),tag=this.tagForQuery_(query);return{hashFn:function(){return(view.getServerCache()||ChildrenNode.EMPTY_NODE).hash()},onComplete:function(status){if("ok"===status)return tag?_this.applyTaggedListenComplete(query.path,tag):_this.applyListenComplete(query.path);var error$$1=errorForServerCode(status,query);return _this.removeEventRegistration(query,null,error$$1)}}},SyncTree.makeQueryKey_=function(query){return query.path.toString()+"$"+query.queryIdentifier()},SyncTree.parseQueryKey_=function(queryKey){var splitIndex=queryKey.indexOf("$");return util.assert(-1!==splitIndex&&splitIndex<queryKey.length-1,"Bad queryKey."),{queryId:queryKey.substr(splitIndex+1),path:new Path(queryKey.substr(0,splitIndex))}},SyncTree.prototype.queryKeyForTag_=function(tag){return this.tagToQueryMap_["_"+tag]},SyncTree.prototype.tagForQuery_=function(query){var queryKey=SyncTree.makeQueryKey_(query);return util.safeGet(this.queryToTagMap_,queryKey)},SyncTree.getNextQueryTag_=function(){return SyncTree.nextQueryTag_++},SyncTree.prototype.applyTaggedOperation_=function(queryPath,operation){var syncPoint=this.syncPointTree_.get(queryPath);util.assert(syncPoint,"Missing sync point for query tag that we're tracking");var writesCache=this.pendingWriteTree_.childWrites(queryPath);return syncPoint.applyOperation(operation,writesCache,null)},SyncTree.prototype.applyOperationToSyncPoints_=function(operation){return this.applyOperationHelper_(operation,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path.Empty))},SyncTree.prototype.applyOperationHelper_=function(operation,syncPointTree,serverCache,writesCache){if(operation.path.isEmpty())return this.applyOperationDescendantsHelper_(operation,syncPointTree,serverCache,writesCache);var syncPoint=syncPointTree.get(Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path.Empty));var events=[],childName=operation.path.getFront(),childOperation=operation.operationForChild(childName),childTree=syncPointTree.children.get(childName);if(childTree&&childOperation){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName);events=events.concat(this.applyOperationHelper_(childOperation,childTree,childServerCache,childWritesCache))}return syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.prototype.applyOperationDescendantsHelper_=function(operation,syncPointTree,serverCache,writesCache){var _this=this,syncPoint=syncPointTree.get(Path.Empty);null==serverCache&&null!=syncPoint&&(serverCache=syncPoint.getCompleteServerCache(Path.Empty));var events=[];return syncPointTree.children.inorderTraversal(function(childName,childTree){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null,childWritesCache=writesCache.child(childName),childOperation=operation.operationForChild(childName);childOperation&&(events=events.concat(_this.applyOperationDescendantsHelper_(childOperation,childTree,childServerCache,childWritesCache)))}),syncPoint&&(events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))),events},SyncTree.nextQueryTag_=1,SyncTree}(),SnapshotHolder=function(){function SnapshotHolder(){this.rootNode_=ChildrenNode.EMPTY_NODE}return SnapshotHolder.prototype.getNode=function(path){return this.rootNode_.getChild(path)},SnapshotHolder.prototype.updateSnapshot=function(path,newSnapshotNode){this.rootNode_=this.rootNode_.updateChild(path,newSnapshotNode)},SnapshotHolder}(),AuthTokenProvider=function(){function AuthTokenProvider(app_){this.app_=app_}return AuthTokenProvider.prototype.getToken=function(forceRefresh){return this.app_.INTERNAL.getToken(forceRefresh).then(null,function(error$$1){return error$$1&&"auth/token-not-initialized"===error$$1.code?(log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(error$$1)})},AuthTokenProvider.prototype.addTokenChangeListener=function(listener){this.app_.INTERNAL.addAuthTokenListener(listener)},AuthTokenProvider.prototype.removeTokenChangeListener=function(listener){this.app_.INTERNAL.removeAuthTokenListener(listener)},AuthTokenProvider.prototype.notifyForInvalidToken=function(){var errorMessage='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?errorMessage+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?errorMessage+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':errorMessage+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn(errorMessage)},AuthTokenProvider}(),StatsCollection=function(){function StatsCollection(){this.counters_={}}return StatsCollection.prototype.incrementCounter=function(name,amount){void 0===amount&&(amount=1),util.contains(this.counters_,name)||(this.counters_[name]=0),this.counters_[name]+=amount},StatsCollection.prototype.get=function(){return util.deepCopy(this.counters_)},StatsCollection}(),StatsManager=function(){function StatsManager(){}return StatsManager.getCollection=function(repoInfo){var hashString=repoInfo.toString();return this.collections_[hashString]||(this.collections_[hashString]=new StatsCollection),this.collections_[hashString]},StatsManager.getOrCreateReporter=function(repoInfo,creatorFunction){var hashString=repoInfo.toString();return this.reporters_[hashString]||(this.reporters_[hashString]=creatorFunction()),this.reporters_[hashString]},StatsManager.collections_={},StatsManager.reporters_={},StatsManager}(),StatsListener=function(){function StatsListener(collection_){this.collection_=collection_,this.last_=null}return StatsListener.prototype.get=function(){var newStats=this.collection_.get(),delta=util.clone(newStats);return this.last_&&util.forEach(this.last_,function(stat,value){delta[stat]=delta[stat]-value}),this.last_=newStats,delta},StatsListener}(),FIRST_STATS_MIN_TIME=1e4,FIRST_STATS_MAX_TIME=3e4,StatsReporter=function(){function StatsReporter(collection,server_){this.server_=server_,this.statsToReport_={},this.statsListener_=new StatsListener(collection);var timeout=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(timeout))}return StatsReporter.prototype.includeStat=function(stat){this.statsToReport_[stat]=!0},StatsReporter.prototype.reportStats_=function(){var _this=this,stats=this.statsListener_.get(),reportedStats={},haveStatsToReport=!1;util.forEach(stats,function(stat,value){value>0&&util.contains(_this.statsToReport_,stat)&&(reportedStats[stat]=value,haveStatsToReport=!0)}),haveStatsToReport&&this.server_.reportStats(reportedStats),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},StatsReporter}(),EventQueue=function(){function EventQueue(){this.eventLists_=[],this.recursionDepth_=0}return EventQueue.prototype.queueEvents=function(eventDataList){for(var currList=null,i=0;i<eventDataList.length;i++){var eventData=eventDataList[i],eventPath=eventData.getPath();null===currList||eventPath.equals(currList.getPath())||(this.eventLists_.push(currList),currList=null),null===currList&&(currList=new EventList(eventPath)),currList.add(eventData)}currList&&this.eventLists_.push(currList)},EventQueue.prototype.raiseEventsAtPath=function(path,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.equals(path)})},EventQueue.prototype.raiseEventsForChangedPath=function(changedPath,eventDataList){this.queueEvents(eventDataList),this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.contains(changedPath)||changedPath.contains(eventPath)})},EventQueue.prototype.raiseQueuedEventsMatchingPredicate_=function(predicate){this.recursionDepth_++;for(var sentAll=!0,i=0;i<this.eventLists_.length;i++){var eventList=this.eventLists_[i];if(eventList){predicate(eventList.getPath())?(this.eventLists_[i].raise(),this.eventLists_[i]=null):sentAll=!1}}sentAll&&(this.eventLists_=[]),this.recursionDepth_--},EventQueue}(),EventList=function(){function EventList(path_){this.path_=path_,this.events_=[]}return EventList.prototype.add=function(eventData){this.events_.push(eventData)},EventList.prototype.raise=function(){for(var i=0;i<this.events_.length;i++){var eventData=this.events_[i];if(null!==eventData){this.events_[i]=null;var eventFn=eventData.getEventRunner();logger$1&&log("event: "+eventData.toString()),exceptionGuard(eventFn)}}},EventList.prototype.getPath=function(){return this.path_},EventList}(),EventEmitter=function(){function EventEmitter(allowedEvents_){this.allowedEvents_=allowedEvents_,this.listeners_={},util.assert(Array.isArray(allowedEvents_)&&allowedEvents_.length>0,"Requires a non-empty array")}return EventEmitter.prototype.trigger=function(eventType){for(var var_args=[],_i=1;_i<arguments.length;_i++)var_args[_i-1]=arguments[_i];if(Array.isArray(this.listeners_[eventType]))for(var listeners=this.listeners_[eventType].slice(),i=0;i<listeners.length;i++)listeners[i].callback.apply(listeners[i].context,var_args)},EventEmitter.prototype.on=function(eventType,callback,context){this.validateEventType_(eventType),this.listeners_[eventType]=this.listeners_[eventType]||[],this.listeners_[eventType].push({callback:callback,context:context});var eventData=this.getInitialEvent(eventType);eventData&&callback.apply(context,eventData)},EventEmitter.prototype.off=function(eventType,callback,context){this.validateEventType_(eventType);for(var listeners=this.listeners_[eventType]||[],i=0;i<listeners.length;i++)if(listeners[i].callback===callback&&(!context||context===listeners[i].context))return void listeners.splice(i,1)},EventEmitter.prototype.validateEventType_=function(eventType){util.assert(this.allowedEvents_.find(function(et){return et===eventType}),"Unknown event: "+eventType)},EventEmitter}(),VisibilityMonitor=function(_super){function VisibilityMonitor(){var hidden,visibilityChange,_this=_super.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(visibilityChange="visibilitychange",hidden="hidden"):void 0!==document.mozHidden?(visibilityChange="mozvisibilitychange",hidden="mozHidden"):void 0!==document.msHidden?(visibilityChange="msvisibilitychange",
hidden="msHidden"):void 0!==document.webkitHidden&&(visibilityChange="webkitvisibilitychange",hidden="webkitHidden")),_this.visible_=!0,visibilityChange&&document.addEventListener(visibilityChange,function(){var visible=!document[hidden];visible!==_this.visible_&&(_this.visible_=visible,_this.trigger("visible",visible))},!1),_this}return tslib_1.__extends(VisibilityMonitor,_super),VisibilityMonitor.getInstance=function(){return new VisibilityMonitor},VisibilityMonitor.prototype.getInitialEvent=function(eventType){return util.assert("visible"===eventType,"Unknown event type: "+eventType),[this.visible_]},VisibilityMonitor}(EventEmitter),OnlineMonitor=function(_super){function OnlineMonitor(){var _this=_super.call(this,["online"])||this;return _this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||util.isMobileCordova()||(window.addEventListener("online",function(){_this.online_||(_this.online_=!0,_this.trigger("online",!0))},!1),window.addEventListener("offline",function(){_this.online_&&(_this.online_=!1,_this.trigger("online",!1))},!1)),_this}return tslib_1.__extends(OnlineMonitor,_super),OnlineMonitor.getInstance=function(){return new OnlineMonitor},OnlineMonitor.prototype.getInitialEvent=function(eventType){return util.assert("online"===eventType,"Unknown event type: "+eventType),[this.online_]},OnlineMonitor.prototype.currentlyOnline=function(){return this.online_},OnlineMonitor}(EventEmitter),PacketReceiver=function(){function PacketReceiver(onMessage_){this.onMessage_=onMessage_,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return PacketReceiver.prototype.closeAfter=function(responseNum,callback){this.closeAfterResponse=responseNum,this.onClose=callback,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},PacketReceiver.prototype.handleResponse=function(requestNum,data){var _this=this;this.pendingResponses[requestNum]=data;for(var this_1=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var toProcess=this_1.pendingResponses[this_1.currentResponseNum];delete this_1.pendingResponses[this_1.currentResponseNum];for(var i=0;i<toProcess.length;++i)!function(i){toProcess[i]&&exceptionGuard(function(){_this.onMessage_(toProcess[i])})}(i);if(this_1.currentResponseNum===this_1.closeAfterResponse)return this_1.onClose&&(this_1.onClose(),this_1.onClose=null),"break";this_1.currentResponseNum++}())break}},PacketReceiver}(),FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",BrowserPollConnection=function(){function BrowserPollConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId,this.repoInfo=repoInfo,this.transportSessionId=transportSessionId,this.lastSessionId=lastSessionId,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(connId),this.stats_=StatsManager.getCollection(repoInfo),this.urlFn=function(params){return repoInfo.connectionURL(LONG_POLLING,params)}}return BrowserPollConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.curSegmentNum=0,this.onDisconnect_=onDisconnect,this.myPacketOrderer=new PacketReceiver(onMessage),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){_this.log_("Timed out trying to connect."),_this.onClosed_(),_this.connectTimeoutTimer_=null},Math.floor(3e4)),executeWhenDOMReady(function(){if(!_this.isClosed_){_this.scriptTagHolder=new FirebaseIFrameScriptHolder(function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var command=args[0],arg1=args[1],arg2=args[2];if(_this.incrementIncomingBytes_(args),_this.scriptTagHolder)if(_this.connectTimeoutTimer_&&(clearTimeout(_this.connectTimeoutTimer_),_this.connectTimeoutTimer_=null),_this.everConnected_=!0,"start"==command)_this.id=arg1,_this.password=arg2;else{if("close"!==command)throw new Error("Unrecognized command received: "+command);arg1?(_this.scriptTagHolder.sendNewPolls=!1,_this.myPacketOrderer.closeAfter(arg1,function(){_this.onClosed_()})):_this.onClosed_()}},function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var pN=args[0],data=args[1];_this.incrementIncomingBytes_(args),_this.myPacketOrderer.handleResponse(pN,data)},function(){_this.onClosed_()},_this.urlFn);var urlParams={};urlParams.start="t",urlParams.ser=Math.floor(1e8*Math.random()),_this.scriptTagHolder.uniqueCallbackIdentifier&&(urlParams.cb=_this.scriptTagHolder.uniqueCallbackIdentifier),urlParams.v="5",_this.transportSessionId&&(urlParams.s=_this.transportSessionId),_this.lastSessionId&&(urlParams.ls=_this.lastSessionId),!util.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(urlParams.r="f");var connectURL=_this.urlFn(urlParams);_this.log_("Connecting via long-poll to "+connectURL),_this.scriptTagHolder.addTag(connectURL,function(){})}})},BrowserPollConnection.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},BrowserPollConnection.forceAllow=function(){BrowserPollConnection.forceAllow_=!0},BrowserPollConnection.forceDisallow=function(){BrowserPollConnection.forceDisallow_=!0},BrowserPollConnection.isAvailable=function(){return BrowserPollConnection.forceAllow_||!BrowserPollConnection.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()&&!util.isNodeSdk()},BrowserPollConnection.prototype.markConnectionHealthy=function(){},BrowserPollConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},BrowserPollConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},BrowserPollConnection.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},BrowserPollConnection.prototype.send=function(data){var dataStr=util.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter("bytes_sent",dataStr.length);for(var base64data=util.base64Encode(dataStr),dataSegs=splitStringBySize(base64data,1840),i=0;i<dataSegs.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,dataSegs.length,dataSegs[i]),this.curSegmentNum++},BrowserPollConnection.prototype.addDisconnectPingFrame=function(id,pw){if(!util.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var urlParams={};urlParams.dframe="t",urlParams.id=id,urlParams.pw=pw,this.myDisconnFrame.src=this.urlFn(urlParams),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},BrowserPollConnection.prototype.incrementIncomingBytes_=function(args){var bytesReceived=util.stringify(args).length;this.bytesReceived+=bytesReceived,this.stats_.incrementCounter("bytes_received",bytesReceived)},BrowserPollConnection}(),FirebaseIFrameScriptHolder=function(){function FirebaseIFrameScriptHolder(commandCB,onMessageCB,onDisconnect,urlFn){if(this.onDisconnect=onDisconnect,this.urlFn=urlFn,this.outstandingRequests=new CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,util.isNodeSdk())this.commandCB=commandCB,this.onMessageCB=onMessageCB;else{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=commandCB,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=onMessageCB,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();var script="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){script='<script>document.domain="'+document.domain+'";<\/script>'}var iframeContents="<html><body>"+script+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(iframeContents),this.myIFrame.doc.close()}catch(e){log("frame writing exception"),e.stack&&log(e.stack),log(e)}}}return FirebaseIFrameScriptHolder.createIFrame_=function(){var iframe=document.createElement("iframe");if(iframe.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(iframe);try{iframe.contentWindow.document||log("No IE domain setting required")}catch(e){var domain=document.domain;iframe.src="javascript:void((function(){document.open();document.domain='"+domain+"';document.close();})())"}return iframe.contentDocument?iframe.doc=iframe.contentDocument:iframe.contentWindow?iframe.doc=iframe.contentWindow.document:iframe.document&&(iframe.doc=iframe.document),iframe},FirebaseIFrameScriptHolder.prototype.close=function(){var _this=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==_this.myIFrame&&(document.body.removeChild(_this.myIFrame),_this.myIFrame=null)},Math.floor(0))),util.isNodeSdk()&&this.myID){var urlParams={};urlParams.disconn="t",urlParams.id=this.myID,urlParams.pw=this.myPW;var theURL=this.urlFn(urlParams);FirebaseIFrameScriptHolder.nodeRestRequest(theURL)}var onDisconnect=this.onDisconnect;onDisconnect&&(this.onDisconnect=null,onDisconnect())},FirebaseIFrameScriptHolder.prototype.startLongPoll=function(id,pw){for(this.myID=id,this.myPW=pw,this.alive=!0;this.newRequest_(););},FirebaseIFrameScriptHolder.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var urlParams={};urlParams.id=this.myID,urlParams.pw=this.myPW,urlParams.ser=this.currentSerial;for(var theURL=this.urlFn(urlParams),curDataString="",i=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+curDataString.length<=1870))break;var theSeg=this.pendingSegs.shift();curDataString=curDataString+"&seg"+i+"="+theSeg.seg+"&ts"+i+"="+theSeg.ts+"&d"+i+"="+theSeg.d,i++}return theURL+=curDataString,this.addLongPollTag_(theURL,this.currentSerial),!0}return!1},FirebaseIFrameScriptHolder.prototype.enqueueSegment=function(segnum,totalsegs,data){this.pendingSegs.push({seg:segnum,ts:totalsegs,d:data}),this.alive&&this.newRequest_()},FirebaseIFrameScriptHolder.prototype.addLongPollTag_=function(url,serial){var _this=this;this.outstandingRequests.add(serial,1);var doNewRequest=function(){_this.outstandingRequests.remove(serial),_this.newRequest_()},keepaliveTimeout=setTimeout(doNewRequest,Math.floor(25e3)),readyStateCB=function(){clearTimeout(keepaliveTimeout),doNewRequest()};this.addTag(url,readyStateCB)},FirebaseIFrameScriptHolder.prototype.addTag=function(url,loadCB){var _this=this;util.isNodeSdk()?this.doNodeLongPoll(url,loadCB):setTimeout(function(){try{if(!_this.sendNewPolls)return;var newScript_1=_this.myIFrame.doc.createElement("script");newScript_1.type="text/javascript",newScript_1.async=!0,newScript_1.src=url,newScript_1.onload=newScript_1.onreadystatechange=function(){var rstate=newScript_1.readyState;rstate&&"loaded"!==rstate&&"complete"!==rstate||(newScript_1.onload=newScript_1.onreadystatechange=null,newScript_1.parentNode&&newScript_1.parentNode.removeChild(newScript_1),loadCB())},newScript_1.onerror=function(){log("Long-poll script failed to load: "+url),_this.sendNewPolls=!1,_this.close()},_this.myIFrame.doc.body.appendChild(newScript_1)}catch(e){}},Math.floor(1))},FirebaseIFrameScriptHolder}(),WebSocketImpl=null;"undefined"!=typeof MozWebSocket?WebSocketImpl=MozWebSocket:"undefined"!=typeof WebSocket&&(WebSocketImpl=WebSocket);var WebSocketConnection=function(){function WebSocketConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=StatsManager.getCollection(repoInfo),this.connURL=WebSocketConnection.connectionURL_(repoInfo,transportSessionId,lastSessionId)}return WebSocketConnection.connectionURL_=function(repoInfo,transportSessionId,lastSessionId){var urlParams={};return urlParams.v="5",!util.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(urlParams.r="f"),transportSessionId&&(urlParams.s=transportSessionId),lastSessionId&&(urlParams.ls=lastSessionId),repoInfo.connectionURL("websocket",urlParams)},WebSocketConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.onDisconnect=onDisconnect,this.onMessage=onMessage,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{if(util.isNodeSdk()){var device=util.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",options={headers:{"User-Agent":"Firebase/5/"+firebase.SDK_VERSION+"/"+process.platform+"/"+device}},env=process.env,proxy=0==this.connURL.indexOf("wss://")?env.HTTPS_PROXY||env.https_proxy:env.HTTP_PROXY||env.http_proxy;proxy&&(options.proxy={origin:proxy}),this.mySock=new WebSocketImpl(this.connURL,[],options)}else this.mySock=new WebSocketImpl(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var error$$1=e.message||e.data;return error$$1&&this.log_(error$$1),void this.onClosed_()}this.mySock.onopen=function(){_this.log_("Websocket connected."),_this.everConnected_=!0},this.mySock.onclose=function(){_this.log_("Websocket connection was disconnected."),_this.mySock=null,_this.onClosed_()},this.mySock.onmessage=function(m){_this.handleIncomingFrame(m)},this.mySock.onerror=function(e){_this.log_("WebSocket error.  Closing connection.");var error$$1=e.message||e.data;error$$1&&_this.log_(error$$1),_this.onClosed_()}},WebSocketConnection.prototype.start=function(){},WebSocketConnection.forceDisallow=function(){WebSocketConnection.forceDisallow_=!0},WebSocketConnection.isAvailable=function(){var isOldAndroid=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var oldAndroidRegex=/Android ([0-9]{0,}\.[0-9]{0,})/,oldAndroidMatch=navigator.userAgent.match(oldAndroidRegex);oldAndroidMatch&&oldAndroidMatch.length>1&&parseFloat(oldAndroidMatch[1])<4.4&&(isOldAndroid=!0)}return!isOldAndroid&&null!==WebSocketImpl&&!WebSocketConnection.forceDisallow_},WebSocketConnection.previouslyFailed=function(){return PersistentStorage.isInMemoryStorage||!0===PersistentStorage.get("previous_websocket_failure")},WebSocketConnection.prototype.markConnectionHealthy=function(){PersistentStorage.remove("previous_websocket_failure")},WebSocketConnection.prototype.appendFrame_=function(data){if(this.frames.push(data),this.frames.length==this.totalFrames){var fullMess=this.frames.join("");this.frames=null;var jsonMess=util.jsonEval(fullMess);this.onMessage(jsonMess)}},WebSocketConnection.prototype.handleNewFrameCount_=function(frameCount){this.totalFrames=frameCount,this.frames=[]},WebSocketConnection.prototype.extractFrameCount_=function(data){if(util.assert(null===this.frames,"We already have a frame buffer"),data.length<=6){var frameCount=Number(data);if(!isNaN(frameCount))return this.handleNewFrameCount_(frameCount),null}return this.handleNewFrameCount_(1),data},WebSocketConnection.prototype.handleIncomingFrame=function(mess){if(null!==this.mySock){var data=mess.data;if(this.bytesReceived+=data.length,this.stats_.incrementCounter("bytes_received",data.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(data);else{var remainingData=this.extractFrameCount_(data);null!==remainingData&&this.appendFrame_(remainingData)}}},WebSocketConnection.prototype.send=function(data){this.resetKeepAlive();var dataStr=util.stringify(data);this.bytesSent+=dataStr.length,this.stats_.incrementCounter("bytes_sent",dataStr.length);var dataSegs=splitStringBySize(dataStr,16384);dataSegs.length>1&&this.sendString_(String(dataSegs.length));for(var i=0;i<dataSegs.length;i++)this.sendString_(dataSegs[i])},WebSocketConnection.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},WebSocketConnection.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},WebSocketConnection.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},WebSocketConnection.prototype.resetKeepAlive=function(){var _this=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){_this.mySock&&_this.sendString_("0"),_this.resetKeepAlive()},Math.floor(45e3))},WebSocketConnection.prototype.sendString_=function(str){try{this.mySock.send(str)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},WebSocketConnection.responsesRequiredToBeHealthy=2,WebSocketConnection.healthyTimeout=3e4,WebSocketConnection}(),TransportManager=function(){function TransportManager(repoInfo){this.initTransports_(repoInfo)}return Object.defineProperty(TransportManager,"ALL_TRANSPORTS",{get:function(){return[BrowserPollConnection,WebSocketConnection]},enumerable:!0,configurable:!0}),TransportManager.prototype.initTransports_=function(repoInfo){var isWebSocketsAvailable=WebSocketConnection&&WebSocketConnection.isAvailable(),isSkipPollConnection=isWebSocketsAvailable&&!WebSocketConnection.previouslyFailed();if(repoInfo.webSocketOnly&&(isWebSocketsAvailable||warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),isSkipPollConnection=!0),isSkipPollConnection)this.transports_=[WebSocketConnection];else{var transports_1=this.transports_=[];each(TransportManager.ALL_TRANSPORTS,function(i,transport){transport&&transport.isAvailable()&&transports_1.push(transport)})}},TransportManager.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},TransportManager.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},TransportManager}(),Connection=function(){function Connection(id,repoInfo_,onMessage_,onReady_,onDisconnect_,onKill_,lastSessionId){this.id=id,this.repoInfo_=repoInfo_,this.onMessage_=onMessage_,this.onReady_=onReady_,this.onDisconnect_=onDisconnect_,this.onKill_=onKill_,this.lastSessionId=lastSessionId,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(repoInfo_),this.log_("Connection created"),this.start_()}return Connection.prototype.start_=function(){var _this=this,conn=this.transportManager_.initialTransport();this.conn_=new conn(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessageReceived=this.connReceiver_(this.conn_),onConnectionLost=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){_this.conn_&&_this.conn_.open(onMessageReceived,onConnectionLost)},Math.floor(0));var healthyTimeout_ms=conn.healthyTimeout||0;healthyTimeout_ms>0&&(this.healthyTimeout_=setTimeoutNonBlocking(function(){_this.healthyTimeout_=null,_this.isHealthy_||(_this.conn_&&_this.conn_.bytesReceived>102400?(_this.log_("Connection exceeded healthy timeout but has received "+_this.conn_.bytesReceived+" bytes.  Marking connection healthy."),_this.isHealthy_=!0,_this.conn_.markConnectionHealthy()):_this.conn_&&_this.conn_.bytesSent>10240?_this.log_("Connection exceeded healthy timeout but has sent "+_this.conn_.bytesSent+" bytes.  Leaving connection alive."):(_this.log_("Closing unhealthy connection after timeout."),_this.close()))},Math.floor(healthyTimeout_ms)))},Connection.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},Connection.prototype.disconnReceiver_=function(conn){var _this=this;return function(everConnected){conn===_this.conn_?_this.onConnectionLost_(everConnected):conn===_this.secondaryConn_?(_this.log_("Secondary connection lost."),_this.onSecondaryConnectionLost_()):_this.log_("closing an old connection")}},Connection.prototype.connReceiver_=function(conn){var _this=this;return function(message){2!=_this.state_&&(conn===_this.rx_?_this.onPrimaryMessageReceived_(message):conn===_this.secondaryConn_?_this.onSecondaryMessageReceived_(message):_this.log_("message on old connection"))}},Connection.prototype.sendRequest=function(dataMsg){var msg={t:"d",d:dataMsg};this.sendData_(msg)},Connection.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},Connection.prototype.onSecondaryControl_=function(controlData){if("t"in controlData){var cmd=controlData.t;"a"===cmd?this.upgradeIfSecondaryHealthy_():"r"===cmd?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===cmd&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},Connection.prototype.onSecondaryMessageReceived_=function(parsedData){var layer=requireKey("t",parsedData),data=requireKey("d",parsedData);if("c"==layer)this.onSecondaryControl_(data);else{if("d"!=layer)throw new Error("Unknown protocol layer: "+layer);this.pendingDataMessages.push(data)}},Connection.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},Connection.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},Connection.prototype.onPrimaryMessageReceived_=function(parsedData){var layer=requireKey("t",parsedData),data=requireKey("d",parsedData);"c"==layer?this.onControl_(data):"d"==layer&&this.onDataMessage_(data)},Connection.prototype.onDataMessage_=function(message){this.onPrimaryResponse_(),this.onMessage_(message)},Connection.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},Connection.prototype.onControl_=function(controlData){var cmd=requireKey("t",controlData);if("d"in controlData){var payload=controlData.d;if("h"===cmd)this.onHandshake_(payload);else if("n"===cmd){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===cmd?this.onConnectionShutdown_(payload):"r"===cmd?this.onReset_(payload):"e"===cmd?error("Server Error: "+payload):"o"===cmd?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error("Unknown control packet command: "+cmd)}},Connection.prototype.onHandshake_=function(handshake){var timestamp=handshake.ts,version=handshake.v,host=handshake.h;this.sessionId=handshake.s,this.repoInfo_.updateHost(host),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,timestamp),"5"!==version&&warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},Connection.prototype.tryStartUpgrade_=function(){var conn=this.transportManager_.upgradeTransport();conn&&this.startUpgrade_(conn)},Connection.prototype.startUpgrade_=function(conn){var _this=this;this.secondaryConn_=new conn(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=conn.responsesRequiredToBeHealthy||0;var onMessage=this.connReceiver_(this.secondaryConn_),onDisconnect=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(onMessage,onDisconnect),setTimeoutNonBlocking(function(){_this.secondaryConn_&&(_this.log_("Timed out trying to upgrade."),_this.secondaryConn_.close())},Math.floor(6e4))},Connection.prototype.onReset_=function(host){this.log_("Reset packet received.  New host: "+host),this.repoInfo_.updateHost(host),1===this.state_?this.close():(this.closeConnections_(),this.start_())},Connection.prototype.onConnectionEstablished_=function(conn,timestamp){var _this=this;this.log_("Realtime connection established."),this.conn_=conn,this.state_=1,this.onReady_&&(this.onReady_(timestamp,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(function(){_this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},Connection.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},Connection.prototype.onSecondaryConnectionLost_=function(){var conn=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==conn&&this.rx_!==conn||this.close()},Connection.prototype.onConnectionLost_=function(everConnected){this.conn_=null,everConnected||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},Connection.prototype.onConnectionShutdown_=function(reason){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(reason),this.onKill_=null),this.onDisconnect_=null,this.close()},Connection.prototype.sendData_=function(data){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(data)},Connection.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},Connection.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},Connection}(),ServerActions=function(){function ServerActions(){}return ServerActions.prototype.put=function(pathString,data,onComplete,hash){},ServerActions.prototype.merge=function(pathString,data,onComplete,hash){},ServerActions.prototype.refreshAuthToken=function(token){},ServerActions.prototype.onDisconnectPut=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectMerge=function(pathString,data,onComplete){},ServerActions.prototype.onDisconnectCancel=function(pathString,onComplete){},ServerActions.prototype.reportStats=function(stats){},ServerActions}(),RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=3e5,PersistentConnection=function(_super){function PersistentConnection(repoInfo_,onDataUpdate_,onConnectStatus_,onServerInfoUpdate_,authTokenProvider_,authOverride_){var _this=_super.call(this)||this;if(_this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.onConnectStatus_=onConnectStatus_,_this.onServerInfoUpdate_=onServerInfoUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.authOverride_=authOverride_,_this.id=PersistentConnection.nextPersistentConnectionId_++,_this.log_=logWrapper("p:"+_this.id+":"),_this.interruptReasons_={},_this.listens_={},_this.outstandingPuts_=[],_this.outstandingPutCount_=0,_this.onDisconnectRequestQueue_=[],_this.connected_=!1,_this.reconnectDelay_=RECONNECT_MIN_DELAY,_this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,_this.securityDebugCallback_=null,_this.lastSessionId=null,_this.establishConnectionTimer_=null,_this.visible_=!1,_this.requestCBHash_={},_this.requestNumber_=0,_this.realtime_=null,_this.authToken_=null,_this.forceTokenRefresh_=!1,_this.invalidAuthTokenCount_=0,_this.firstConnection_=!0,_this.lastConnectionAttemptTime_=null,_this.lastConnectionEstablishedTime_=null,authOverride_&&!util.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return _this.scheduleConnect_(0),VisibilityMonitor.getInstance().on("visible",_this.onVisible_,_this),-1===repoInfo_.host.indexOf("fblocal")&&OnlineMonitor.getInstance().on("online",_this.onOnline_,_this),_this}return tslib_1.__extends(PersistentConnection,_super),PersistentConnection.prototype.sendRequest=function(action,body,onResponse){var curReqNum=++this.requestNumber_,msg={r:curReqNum,a:action,b:body};this.log_(util.stringify(msg)),util.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(msg),onResponse&&(this.requestCBHash_[curReqNum]=onResponse)},PersistentConnection.prototype.listen=function(query,currentHashFn,tag,onComplete){var queryId=query.queryIdentifier(),pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+queryId),this.listens_[pathString]=this.listens_[pathString]||{},util.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),util.assert(!this.listens_[pathString][queryId],"listen() called twice for same path/queryId.");var listenSpec={onComplete:onComplete,hashFn:currentHashFn,query:query,tag:tag};this.listens_[pathString][queryId]=listenSpec,this.connected_&&this.sendListen_(listenSpec)},PersistentConnection.prototype.sendListen_=function(listenSpec){var _this=this,query=listenSpec.query,pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_("Listen on "+pathString+" for "+queryId);var req={p:pathString};listenSpec.tag&&(req.q=query.queryObject(),req.t=listenSpec.tag),req.h=listenSpec.hashFn(),this.sendRequest("q",req,function(message){var payload=message.d,status=message.s;PersistentConnection.warnOnListenWarnings_(payload,query),(_this.listens_[pathString]&&_this.listens_[pathString][queryId])===listenSpec&&(_this.log_("listen response",message),"ok"!==status&&_this.removeListen_(pathString,queryId),listenSpec.onComplete&&listenSpec.onComplete(status,payload))})},PersistentConnection.warnOnListenWarnings_=function(payload,query){if(payload&&"object"==typeof payload&&util.contains(payload,"w")){var warnings=util.safeGet(payload,"w");if(Array.isArray(warnings)&&~warnings.indexOf("no_index")){var indexSpec='".indexOn": "'+query.getQueryParams().getIndex().toString()+'"',indexPath=query.path.toString();warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+indexSpec+" at "+indexPath+" to your security rules for better performance.")}}},PersistentConnection.prototype.refreshAuthToken=function(token){this.authToken_=token,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(token)},PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_=function(credential){(credential&&40===credential.length||util.isAdmin(credential))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},PersistentConnection.prototype.tryAuth=function(){var _this=this
;if(this.connected_&&this.authToken_){var token_1=this.authToken_,authMethod=util.isValidFormat(token_1)?"auth":"gauth",requestData={cred:token_1};null===this.authOverride_?requestData.noauth=!0:"object"==typeof this.authOverride_&&(requestData.authvar=this.authOverride_),this.sendRequest(authMethod,requestData,function(res){var status=res.s,data=res.d||"error";_this.authToken_===token_1&&("ok"===status?_this.invalidAuthTokenCount_=0:_this.onAuthRevoked_(status,data))})}},PersistentConnection.prototype.unlisten=function(query,tag){var pathString=query.path.toString(),queryId=query.queryIdentifier();this.log_("Unlisten called for "+pathString+" "+queryId),util.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(pathString,queryId)&&this.connected_&&this.sendUnlisten_(pathString,queryId,query.queryObject(),tag)},PersistentConnection.prototype.sendUnlisten_=function(pathString,queryId,queryObj,tag){this.log_("Unlisten on "+pathString+" for "+queryId);var req={p:pathString};tag&&(req.q=queryObj,req.t=tag),this.sendRequest("n",req)},PersistentConnection.prototype.onDisconnectPut=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_("o",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"o",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectMerge=function(pathString,data,onComplete){this.connected_?this.sendOnDisconnect_("om",pathString,data,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"om",data:data,onComplete:onComplete})},PersistentConnection.prototype.onDisconnectCancel=function(pathString,onComplete){this.connected_?this.sendOnDisconnect_("oc",pathString,null,onComplete):this.onDisconnectRequestQueue_.push({pathString:pathString,action:"oc",data:null,onComplete:onComplete})},PersistentConnection.prototype.sendOnDisconnect_=function(action,pathString,data,onComplete){var request={p:pathString,d:data};this.log_("onDisconnect "+action,request),this.sendRequest(action,request,function(response){onComplete&&setTimeout(function(){onComplete(response.s,response.d)},Math.floor(0))})},PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){this.putInternal("p",pathString,data,onComplete,hash)},PersistentConnection.prototype.merge=function(pathString,data,onComplete,hash){this.putInternal("m",pathString,data,onComplete,hash)},PersistentConnection.prototype.putInternal=function(action,pathString,data,onComplete,hash){var request={p:pathString,d:data};void 0!==hash&&(request.h=hash),this.outstandingPuts_.push({action:action,request:request,onComplete:onComplete}),this.outstandingPutCount_++;var index=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(index):this.log_("Buffering put: "+pathString)},PersistentConnection.prototype.sendPut_=function(index){var _this=this,action=this.outstandingPuts_[index].action,request=this.outstandingPuts_[index].request,onComplete=this.outstandingPuts_[index].onComplete;this.outstandingPuts_[index].queued=this.connected_,this.sendRequest(action,request,function(message){_this.log_(action+" response",message),delete _this.outstandingPuts_[index],_this.outstandingPutCount_--,0===_this.outstandingPutCount_&&(_this.outstandingPuts_=[]),onComplete&&onComplete(message.s,message.d)})},PersistentConnection.prototype.reportStats=function(stats){var _this=this;if(this.connected_){var request={c:stats};this.log_("reportStats",request),this.sendRequest("s",request,function(result){if("ok"!==result.s){var errorReason=result.d;_this.log_("reportStats","Error sending stats: "+errorReason)}})}},PersistentConnection.prototype.onDataMessage_=function(message){if("r"in message){this.log_("from server: "+util.stringify(message));var reqNum=message.r,onResponse=this.requestCBHash_[reqNum];onResponse&&(delete this.requestCBHash_[reqNum],onResponse(message.b))}else{if("error"in message)throw"A server-side error has occurred: "+message.error;"a"in message&&this.onDataPush_(message.a,message.b)}},PersistentConnection.prototype.onDataPush_=function(action,body){this.log_("handleServerMessage",action,body),"d"===action?this.onDataUpdate_(body.p,body.d,!1,body.t):"m"===action?this.onDataUpdate_(body.p,body.d,!0,body.t):"c"===action?this.onListenRevoked_(body.p,body.q):"ac"===action?this.onAuthRevoked_(body.s,body.d):"sd"===action?this.onSecurityDebugPacket_(body):error("Unrecognized action received from server: "+util.stringify(action)+"\nAre you using the latest client?")},PersistentConnection.prototype.onReady_=function(timestamp,sessionId){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(timestamp),this.lastSessionId=sessionId,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},PersistentConnection.prototype.scheduleConnect_=function(timeout){var _this=this;util.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){_this.establishConnectionTimer_=null,_this.establishConnection_()},Math.floor(timeout))},PersistentConnection.prototype.onVisible_=function(visible){visible&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=visible},PersistentConnection.prototype.onOnline_=function(online){online?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},PersistentConnection.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var timeSinceLastConnectSucceeded=(new Date).getTime()-this.lastConnectionEstablishedTime_;timeSinceLastConnectSucceeded>3e4&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var timeSinceLastConnectAttempt=(new Date).getTime()-this.lastConnectionAttemptTime_,reconnectDelay=Math.max(0,this.reconnectDelay_-timeSinceLastConnectAttempt);reconnectDelay=Math.random()*reconnectDelay,this.log_("Trying to reconnect in "+reconnectDelay+"ms"),this.scheduleConnect_(reconnectDelay),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},PersistentConnection.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var onDataMessage_1=this.onDataMessage_.bind(this),onReady_1=this.onReady_.bind(this),onDisconnect_1=this.onRealtimeDisconnect_.bind(this),connId_1=this.id+":"+PersistentConnection.nextConnectionId_++,self_1=this,lastSessionId_1=this.lastSessionId,canceled_1=!1,connection_1=null,closeFn_1=function(){connection_1?connection_1.close():(canceled_1=!0,onDisconnect_1())},sendRequestFn=function(msg){util.assert(connection_1,"sendRequest call when we're not connected not allowed."),connection_1.sendRequest(msg)};this.realtime_={close:closeFn_1,sendRequest:sendRequestFn};var forceRefresh=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(forceRefresh).then(function(result){canceled_1?log("getToken() completed but was canceled"):(log("getToken() completed. Creating connection."),self_1.authToken_=result&&result.accessToken,connection_1=new Connection(connId_1,self_1.repoInfo_,onDataMessage_1,onReady_1,onDisconnect_1,function(reason){warn(reason+" ("+self_1.repoInfo_.toString()+")"),self_1.interrupt("server_kill")},lastSessionId_1))}).then(null,function(error$$1){self_1.log_("Failed to get token: "+error$$1),canceled_1||(util.CONSTANTS.NODE_ADMIN&&warn(error$$1),closeFn_1())})}},PersistentConnection.prototype.interrupt=function(reason){log("Interrupting connection for reason: "+reason),this.interruptReasons_[reason]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},PersistentConnection.prototype.resume=function(reason){log("Resuming connection for reason: "+reason),delete this.interruptReasons_[reason],util.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))},PersistentConnection.prototype.handleTimestamp_=function(timestamp){var delta=timestamp-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:delta})},PersistentConnection.prototype.cancelSentTransactions_=function(){for(var i=0;i<this.outstandingPuts_.length;i++){var put=this.outstandingPuts_[i];put&&"h"in put.request&&put.queued&&(put.onComplete&&put.onComplete("disconnect"),delete this.outstandingPuts_[i],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},PersistentConnection.prototype.onListenRevoked_=function(pathString,query){var queryId;queryId=query?query.map(function(q){return ObjectToUniqueKey(q)}).join("$"):"default";var listen=this.removeListen_(pathString,queryId);listen&&listen.onComplete&&listen.onComplete("permission_denied")},PersistentConnection.prototype.removeListen_=function(pathString,queryId){var listen,normalizedPathString=new Path(pathString).toString();return void 0!==this.listens_[normalizedPathString]?(listen=this.listens_[normalizedPathString][queryId],delete this.listens_[normalizedPathString][queryId],0===util.getCount(this.listens_[normalizedPathString])&&delete this.listens_[normalizedPathString]):listen=void 0,listen},PersistentConnection.prototype.onAuthRevoked_=function(statusCode,explanation){log("Auth token revoked: "+statusCode+"/"+explanation),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==statusCode&&"permission_denied"!==statusCode||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},PersistentConnection.prototype.onSecurityDebugPacket_=function(body){this.securityDebugCallback_?this.securityDebugCallback_(body):"msg"in body&&console.log("FIREBASE: "+body.msg.replace("\n","\nFIREBASE: "))},PersistentConnection.prototype.restoreState_=function(){var _this=this;this.tryAuth(),util.forEach(this.listens_,function(pathString,queries){util.forEach(queries,function(key,listenSpec){_this.sendListen_(listenSpec)})});for(var i=0;i<this.outstandingPuts_.length;i++)this.outstandingPuts_[i]&&this.sendPut_(i);for(;this.onDisconnectRequestQueue_.length;){var request=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(request.action,request.pathString,request.data,request.onComplete)}},PersistentConnection.prototype.sendConnectStats_=function(){var stats={},clientName="js";util.CONSTANTS.NODE_ADMIN?clientName="admin_node":util.CONSTANTS.NODE_CLIENT&&(clientName="node"),stats["sdk."+clientName+"."+firebase.SDK_VERSION.replace(/\./g,"-")]=1,util.isMobileCordova()?stats["framework.cordova"]=1:util.isReactNative()&&(stats["framework.reactnative"]=1),this.reportStats(stats)},PersistentConnection.prototype.shouldReconnect_=function(){var online=OnlineMonitor.getInstance().currentlyOnline();return util.isEmpty(this.interruptReasons_)&&online},PersistentConnection.nextPersistentConnectionId_=0,PersistentConnection.nextConnectionId_=0,PersistentConnection}(ServerActions),ReadonlyRestClient=function(_super){function ReadonlyRestClient(repoInfo_,onDataUpdate_,authTokenProvider_){var _this=_super.call(this)||this;return _this.repoInfo_=repoInfo_,_this.onDataUpdate_=onDataUpdate_,_this.authTokenProvider_=authTokenProvider_,_this.log_=logWrapper("p:rest:"),_this.listens_={},_this}return tslib_1.__extends(ReadonlyRestClient,_super),ReadonlyRestClient.prototype.reportStats=function(stats){throw new Error("Method not implemented.")},ReadonlyRestClient.getListenId_=function(query,tag){return void 0!==tag?"tag$"+tag:(util.assert(query.getQueryParams().isDefault(),"should have a tag if it's not a default query."),query.path.toString())},ReadonlyRestClient.prototype.listen=function(query,currentHashFn,tag,onComplete){var _this=this,pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+query.queryIdentifier());var listenId=ReadonlyRestClient.getListenId_(query,tag),thisListen={};this.listens_[listenId]=thisListen;var queryStringParamaters=query.getQueryParams().toRestQueryStringParameters();this.restRequest_(pathString+".json",queryStringParamaters,function(error$$1,result){var data=result;if(404===error$$1&&(data=null,error$$1=null),null===error$$1&&_this.onDataUpdate_(pathString,data,!1,tag),util.safeGet(_this.listens_,listenId)===thisListen){var status_1;status_1=error$$1?401==error$$1?"permission_denied":"rest_error:"+error$$1:"ok",onComplete(status_1,null)}})},ReadonlyRestClient.prototype.unlisten=function(query,tag){var listenId=ReadonlyRestClient.getListenId_(query,tag);delete this.listens_[listenId]},ReadonlyRestClient.prototype.refreshAuthToken=function(token){},ReadonlyRestClient.prototype.restRequest_=function(pathString,queryStringParameters,callback){var _this=this;void 0===queryStringParameters&&(queryStringParameters={}),queryStringParameters.format="export",this.authTokenProvider_.getToken(!1).then(function(authTokenData){var authToken=authTokenData&&authTokenData.accessToken;authToken&&(queryStringParameters.auth=authToken);var url=(_this.repoInfo_.secure?"https://":"http://")+_this.repoInfo_.host+pathString+"?"+util.querystring(queryStringParameters);_this.log_("Sending REST request for "+url);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(callback&&4===xhr.readyState){_this.log_("REST Response for "+url+" received. status:",xhr.status,"response:",xhr.responseText);var res=null;if(xhr.status>=200&&xhr.status<300){try{res=util.jsonEval(xhr.responseText)}catch(e){warn("Failed to parse JSON response for "+url+": "+xhr.responseText)}callback(null,res)}else 401!==xhr.status&&404!==xhr.status&&warn("Got unsuccessful REST response for "+url+" Status: "+xhr.status),callback(xhr.status);callback=null}},xhr.open("GET",url,!0),xhr.send()})},ReadonlyRestClient}(ServerActions),Repo=function(){function Repo(repoInfo_,forceRestClient,app){var _this=this;this.repoInfo_=repoInfo_,this.app=app,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new SparseSnapshotTree,this.persistentConnection_=null;var authTokenProvider=new AuthTokenProvider(app);if(this.stats_=StatsManager.getCollection(repoInfo_),forceRestClient||beingCrawled())this.server_=new ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),authTokenProvider),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var authOverride=app.options.databaseAuthVariableOverride;if(void 0!==authOverride&&null!==authOverride){if("object"!=typeof authOverride)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{util.stringify(authOverride)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),authTokenProvider,authOverride),this.server_=this.persistentConnection_}authTokenProvider.addTokenChangeListener(function(token){_this.server_.refreshAuthToken(token)}),this.statsReporter_=StatsManager.getOrCreateReporter(repoInfo_,function(){return new StatsReporter(_this.stats_,_this.server_)}),this.transactions_init_(),this.infoData_=new SnapshotHolder,this.infoSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){var infoEvents=[],node=_this.infoData_.getNode(query.path);return node.isEmpty()||(infoEvents=_this.infoSyncTree_.applyServerOverwrite(query.path,node),setTimeout(function(){onComplete("ok")},0)),infoEvents},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new SyncTree({startListening:function(query,tag,currentHashFn,onComplete){return _this.server_.listen(query,currentHashFn,tag,function(status,data){var events=onComplete(status,data);_this.eventQueue_.raiseEventsForChangedPath(query.path,events)}),[]},stopListening:function(query,tag){_this.server_.unlisten(query,tag)}})}return Repo.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},Repo.prototype.name=function(){return this.repoInfo_.namespace},Repo.prototype.serverTime=function(){var offsetNode=this.infoData_.getNode(new Path(".info/serverTimeOffset")),offset=offsetNode.val()||0;return(new Date).getTime()+offset},Repo.prototype.generateServerValues=function(){return generateWithValues({timestamp:this.serverTime()})},Repo.prototype.onDataUpdate_=function(pathString,data,isMerge,tag){this.dataUpdateCount++;var path=new Path(pathString);data=this.interceptServerDataCallback_?this.interceptServerDataCallback_(pathString,data):data;var events=[];if(tag)if(isMerge){var taggedChildren=util.map(data,function(raw){return nodeFromJSON$1(raw)});events=this.serverSyncTree_.applyTaggedQueryMerge(path,taggedChildren,tag)}else{var taggedSnap=nodeFromJSON$1(data);events=this.serverSyncTree_.applyTaggedQueryOverwrite(path,taggedSnap,tag)}else if(isMerge){var changedChildren=util.map(data,function(raw){return nodeFromJSON$1(raw)});events=this.serverSyncTree_.applyServerMerge(path,changedChildren)}else{var snap=nodeFromJSON$1(data);events=this.serverSyncTree_.applyServerOverwrite(path,snap)}var affectedPath=path;events.length>0&&(affectedPath=this.rerunTransactions_(path)),this.eventQueue_.raiseEventsForChangedPath(affectedPath,events)},Repo.prototype.interceptServerData_=function(callback){this.interceptServerDataCallback_=callback},Repo.prototype.onConnectStatus_=function(connectStatus){this.updateInfo_("connected",connectStatus),!1===connectStatus&&this.runOnDisconnectEvents_()},Repo.prototype.onServerInfoUpdate_=function(updates){var _this=this;each(updates,function(value,key){_this.updateInfo_(key,value)})},Repo.prototype.updateInfo_=function(pathString,value){var path=new Path("/.info/"+pathString),newNode=nodeFromJSON$1(value);this.infoData_.updateSnapshot(path,newNode);var events=this.infoSyncTree_.applyServerOverwrite(path,newNode);this.eventQueue_.raiseEventsForChangedPath(path,events)},Repo.prototype.getNextWriteId_=function(){return this.nextWriteId_++},Repo.prototype.setWithPriority=function(path,newVal,newPriority,onComplete){var _this=this;this.log_("set",{path:path.toString(),value:newVal,priority:newPriority});var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON$1(newVal,newPriority),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,serverValues),writeId=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserOverwrite(path,newNode,writeId,!0);this.eventQueue_.queueEvents(events),this.server_.put(path.toString(),newNodeUnresolved.val(!0),function(status,errorReason){var success="ok"===status;success||warn("set at "+path+" failed: "+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId,!success);_this.eventQueue_.raiseEventsForChangedPath(path,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)});var affectedPath=this.abortTransactions_(path);this.rerunTransactions_(affectedPath),this.eventQueue_.raiseEventsForChangedPath(affectedPath,[])},Repo.prototype.update=function(path,childrenToMerge,onComplete){var _this=this;this.log_("update",{path:path.toString(),value:childrenToMerge});var empty=!0,serverValues=this.generateServerValues(),changedChildren={};if(util.forEach(childrenToMerge,function(changedKey,changedValue){empty=!1;var newNodeUnresolved=nodeFromJSON$1(changedValue);changedChildren[changedKey]=resolveDeferredValueSnapshot(newNodeUnresolved,serverValues)}),empty)log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(onComplete,"ok");else{var writeId_1=this.getNextWriteId_(),events=this.serverSyncTree_.applyUserMerge(path,changedChildren,writeId_1);this.eventQueue_.queueEvents(events),this.server_.merge(path.toString(),childrenToMerge,function(status,errorReason){var success="ok"===status;success||warn("update at "+path+" failed: "+status);var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId_1,!success),affectedPath=clearEvents.length>0?_this.rerunTransactions_(path):path;_this.eventQueue_.raiseEventsForChangedPath(affectedPath,clearEvents),_this.callOnCompleteCallback(onComplete,status,errorReason)}),util.forEach(childrenToMerge,function(changedPath){var affectedPath=_this.abortTransactions_(path.child(changedPath));_this.rerunTransactions_(affectedPath)}),this.eventQueue_.raiseEventsForChangedPath(path,[])}},Repo.prototype.runOnDisconnectEvents_=function(){var _this=this;this.log_("onDisconnectEvents");var serverValues=this.generateServerValues(),resolvedOnDisconnectTree=resolveDeferredValueTree(this.onDisconnect_,serverValues),events=[];resolvedOnDisconnectTree.forEachTree(Path.Empty,function(path,snap){events=events.concat(_this.serverSyncTree_.applyServerOverwrite(path,snap));var affectedPath=_this.abortTransactions_(path);_this.rerunTransactions_(affectedPath)}),this.onDisconnect_=new SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(Path.Empty,events)},Repo.prototype.onDisconnectCancel=function(path,onComplete){var _this=this;this.server_.onDisconnectCancel(path.toString(),function(status,errorReason){"ok"===status&&_this.onDisconnect_.forget(path),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectSet=function(path,value,onComplete){var _this=this,newNode=nodeFromJSON$1(value);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),function(status,errorReason){"ok"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectSetWithPriority=function(path,value,priority,onComplete){var _this=this,newNode=nodeFromJSON$1(value,priority);this.server_.onDisconnectPut(path.toString(),newNode.val(!0),function(status,errorReason){"ok"===status&&_this.onDisconnect_.remember(path,newNode),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.onDisconnectUpdate=function(path,childrenToMerge,onComplete){var _this=this;if(util.isEmpty(childrenToMerge))return log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(onComplete,"ok");this.server_.onDisconnectMerge(path.toString(),childrenToMerge,function(status,errorReason){"ok"===status&&util.forEach(childrenToMerge,function(childName,childNode){var newChildNode=nodeFromJSON$1(childNode);_this.onDisconnect_.remember(path.child(childName),newChildNode)}),_this.callOnCompleteCallback(onComplete,status,errorReason)})},Repo.prototype.addEventCallbackForQuery=function(query,eventRegistration){var events;events=".info"===query.path.getFront()?this.infoSyncTree_.addEventRegistration(query,eventRegistration):this.serverSyncTree_.addEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.removeEventCallbackForQuery=function(query,eventRegistration){var events;events=".info"===query.path.getFront()?this.infoSyncTree_.removeEventRegistration(query,eventRegistration):this.serverSyncTree_.removeEventRegistration(query,eventRegistration),this.eventQueue_.raiseEventsAtPath(query.path,events)},Repo.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},Repo.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},Repo.prototype.stats=function(showDelta){if(void 0===showDelta&&(showDelta=!1),"undefined"!=typeof console){var stats;showDelta?(this.statsListener_||(this.statsListener_=new StatsListener(this.stats_)),stats=this.statsListener_.get()):stats=this.stats_.get();var longestName=Object.keys(stats).reduce(function(previousValue,currentValue){return Math.max(currentValue.length,previousValue)},0);util.forEach(stats,function(stat,value){for(var i=stat.length;i<longestName+2;i++)stat+=" ";console.log(stat+value)})}},Repo.prototype.statsIncrementCounter=function(metric){this.stats_.incrementCounter(metric),this.statsReporter_.includeStat(metric)},Repo.prototype.log_=function(){for(var var_args=[],_i=0;_i<arguments.length;_i++)var_args[_i]=arguments[_i];var prefix="";this.persistentConnection_&&(prefix=this.persistentConnection_.id+":"),log.apply(void 0,[prefix].concat(var_args))},Repo.prototype.callOnCompleteCallback=function(callback,status,errorReason){callback&&exceptionGuard(function(){if("ok"==status)callback(null);else{var code=(status||"error").toUpperCase(),message=code;errorReason&&(message+=": "+errorReason);var error$$1=new Error(message);error$$1.code=code,callback(error$$1)}})},Object.defineProperty(Repo.prototype,"database",{get:function(){return this.__database||(this.__database=new Database(this))},enumerable:!0,configurable:!0}),Repo}(),RangedFilter=function(){function RangedFilter(params){this.indexedFilter_=new IndexedFilter(params.getIndex()),this.index_=params.getIndex(),this.startPost_=RangedFilter.getStartPost_(params),this.endPost_=RangedFilter.getEndPost_(params)}return RangedFilter.prototype.getStartPost=function(){return this.startPost_},RangedFilter.prototype.getEndPost=function(){return this.endPost_},RangedFilter.prototype.matches=function(node){return this.index_.compare(this.getStartPost(),node)<=0&&this.index_.compare(node,this.getEndPost())<=0},RangedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)},RangedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){newSnap.isLeafNode()&&(newSnap=ChildrenNode.EMPTY_NODE);var filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode.EMPTY_NODE);var self=this;return newSnap.forEachChild(PRIORITY_INDEX,function(key,childNode){self.matches(new NamedNode(key,childNode))||(filtered=filtered.updateImmediateChild(key,ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(oldSnap,filtered,optChangeAccumulator)},RangedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},RangedFilter.prototype.filtersNodes=function(){return!0},RangedFilter.prototype.getIndexedFilter=function(){return this.indexedFilter_},RangedFilter.prototype.getIndex=function(){return this.index_},RangedFilter.getStartPost_=function(params){if(params.hasStart()){var startName=params.getIndexStartName();return params.getIndex().makePost(params.getIndexStartValue(),startName)}return params.getIndex().minPost()},RangedFilter.getEndPost_=function(params){if(params.hasEnd()){var endName=params.getIndexEndName();return params.getIndex().makePost(params.getIndexEndValue(),endName)}return params.getIndex().maxPost()},RangedFilter}(),LimitedFilter=function(){function LimitedFilter(params){this.rangedFilter_=new RangedFilter(params),this.index_=params.getIndex(),this.limit_=params.getLimit(),this.reverse_=!params.isViewFromLeft()}return LimitedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){return this.rangedFilter_.matches(new NamedNode(key,newChild))||(newChild=ChildrenNode.EMPTY_NODE),snap.getImmediateChild(key).equals(newChild)?snap:snap.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator):this.fullLimitUpdateChild_(snap,key,newChild,source,optChangeAccumulator)},LimitedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){var filtered;if(newSnap.isLeafNode()||newSnap.isEmpty())filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<newSnap.numChildren()&&newSnap.isIndexed(this.index_)){filtered=ChildrenNode.EMPTY_NODE.withIndex(this.index_);var iterator=void 0;iterator=this.reverse_?newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var count=0;iterator.hasNext()&&count<this.limit_;){var next=iterator.getNext(),inRange=void 0;if(!(inRange=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),next)<=0:this.index_.compare(next,this.rangedFilter_.getEndPost())<=0))break;filtered=filtered.updateImmediateChild(next.name,next.node),count++}}else{filtered=newSnap.withIndex(this.index_),filtered=filtered.updatePriority(ChildrenNode.EMPTY_NODE);var startPost=void 0,endPost=void 0,cmp=void 0,iterator=void 0;if(this.reverse_){iterator=filtered.getReverseIterator(this.index_),startPost=this.rangedFilter_.getEndPost(),endPost=this.rangedFilter_.getStartPost();var indexCompare_1=this.index_.getCompare();cmp=function(a,b){return indexCompare_1(b,a)}}else iterator=filtered.getIterator(this.index_),startPost=this.rangedFilter_.getStartPost(),endPost=this.rangedFilter_.getEndPost(),cmp=this.index_.getCompare();for(var count=0,foundStartPost=!1;iterator.hasNext();){var next=iterator.getNext();!foundStartPost&&cmp(startPost,next)<=0&&(foundStartPost=!0);var inRange=foundStartPost&&count<this.limit_&&cmp(next,endPost)<=0;inRange?count++:filtered=filtered.updateImmediateChild(next.name,ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(oldSnap,filtered,optChangeAccumulator)},LimitedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap},LimitedFilter.prototype.filtersNodes=function(){return!0},LimitedFilter.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},LimitedFilter.prototype.getIndex=function(){return this.index_},LimitedFilter.prototype.fullLimitUpdateChild_=function(snap,childKey,childSnap,source,changeAccumulator){var cmp;if(this.reverse_){var indexCmp_1=this.index_.getCompare();cmp=function(a,b){return indexCmp_1(b,a)}}else cmp=this.index_.getCompare();var oldEventCache=snap;util.assert(oldEventCache.numChildren()==this.limit_,"");var newChildNamedNode=new NamedNode(childKey,childSnap),windowBoundary=this.reverse_?oldEventCache.getFirstChild(this.index_):oldEventCache.getLastChild(this.index_),inRange=this.rangedFilter_.matches(newChildNamedNode);if(oldEventCache.hasChild(childKey)){for(var oldChildSnap=oldEventCache.getImmediateChild(childKey),nextChild=source.getChildAfterChild(this.index_,windowBoundary,this.reverse_);null!=nextChild&&(nextChild.name==childKey||oldEventCache.hasChild(nextChild.name));)nextChild=source.getChildAfterChild(this.index_,nextChild,this.reverse_);var compareNext=null==nextChild?1:cmp(nextChild,newChildNamedNode);if(inRange&&!childSnap.isEmpty()&&compareNext>=0)return null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childChangedChange(childKey,childSnap,oldChildSnap)),oldEventCache.updateImmediateChild(childKey,childSnap);null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childRemovedChange(childKey,oldChildSnap));var newEventCache=oldEventCache.updateImmediateChild(childKey,ChildrenNode.EMPTY_NODE)
;return null!=nextChild&&this.rangedFilter_.matches(nextChild)?(null!=changeAccumulator&&changeAccumulator.trackChildChange(Change.childAddedChange(nextChild.name,nextChild.node)),newEventCache.updateImmediateChild(nextChild.name,nextChild.node)):newEventCache}return childSnap.isEmpty()?snap:inRange&&cmp(windowBoundary,newChildNamedNode)>=0?(null!=changeAccumulator&&(changeAccumulator.trackChildChange(Change.childRemovedChange(windowBoundary.name,windowBoundary.node)),changeAccumulator.trackChildChange(Change.childAddedChange(childKey,childSnap))),oldEventCache.updateImmediateChild(childKey,childSnap).updateImmediateChild(windowBoundary.name,ChildrenNode.EMPTY_NODE)):snap},LimitedFilter}(),QueryParams=function(){function QueryParams(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}return QueryParams.prototype.hasStart=function(){return this.startSet_},QueryParams.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},QueryParams.prototype.getIndexStartValue=function(){return util.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},QueryParams.prototype.getIndexStartName=function(){return util.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME},QueryParams.prototype.hasEnd=function(){return this.endSet_},QueryParams.prototype.getIndexEndValue=function(){return util.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},QueryParams.prototype.getIndexEndName=function(){return util.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME},QueryParams.prototype.hasLimit=function(){return this.limitSet_},QueryParams.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},QueryParams.prototype.getLimit=function(){return util.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},QueryParams.prototype.getIndex=function(){return this.index_},QueryParams.prototype.copy_=function(){var copy=new QueryParams;return copy.limitSet_=this.limitSet_,copy.limit_=this.limit_,copy.startSet_=this.startSet_,copy.indexStartValue_=this.indexStartValue_,copy.startNameSet_=this.startNameSet_,copy.indexStartName_=this.indexStartName_,copy.endSet_=this.endSet_,copy.indexEndValue_=this.indexEndValue_,copy.endNameSet_=this.endNameSet_,copy.indexEndName_=this.indexEndName_,copy.index_=this.index_,copy.viewFrom_=this.viewFrom_,copy},QueryParams.prototype.limit=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_="",newParams},QueryParams.prototype.limitToFirst=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,newParams},QueryParams.prototype.limitToLast=function(newLimit){var newParams=this.copy_();return newParams.limitSet_=!0,newParams.limit_=newLimit,newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,newParams},QueryParams.prototype.startAt=function(indexValue,key){var newParams=this.copy_();return newParams.startSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexStartValue_=indexValue,null!=key?(newParams.startNameSet_=!0,newParams.indexStartName_=key):(newParams.startNameSet_=!1,newParams.indexStartName_=""),newParams},QueryParams.prototype.endAt=function(indexValue,key){var newParams=this.copy_();return newParams.endSet_=!0,void 0===indexValue&&(indexValue=null),newParams.indexEndValue_=indexValue,void 0!==key?(newParams.endNameSet_=!0,newParams.indexEndName_=key):(newParams.endNameSet_=!1,newParams.indexEndName_=""),newParams},QueryParams.prototype.orderBy=function(index){var newParams=this.copy_();return newParams.index_=index,newParams},QueryParams.prototype.getQueryObject=function(){var WIRE_PROTOCOL_CONSTANTS=QueryParams.WIRE_PROTOCOL_CONSTANTS_,obj={};if(this.startSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){obj[WIRE_PROTOCOL_CONSTANTS.LIMIT]=this.limit_;var viewFrom=this.viewFrom_;""===viewFrom&&(viewFrom=this.isViewFromLeft()?WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT:WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT),obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM]=viewFrom}return this.index_!==PRIORITY_INDEX&&(obj[WIRE_PROTOCOL_CONSTANTS.INDEX]=this.index_.toString()),obj},QueryParams.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},QueryParams.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==PRIORITY_INDEX},QueryParams.prototype.getNodeFilter=function(){return this.loadsAllData()?new IndexedFilter(this.getIndex()):this.hasLimit()?new LimitedFilter(this):new RangedFilter(this)},QueryParams.prototype.toRestQueryStringParameters=function(){var REST_CONSTANTS=QueryParams.REST_QUERY_CONSTANTS_,qs={};if(this.isDefault())return qs;var orderBy;return this.index_===PRIORITY_INDEX?orderBy=REST_CONSTANTS.PRIORITY_INDEX:this.index_===VALUE_INDEX?orderBy=REST_CONSTANTS.VALUE_INDEX:this.index_===KEY_INDEX?orderBy=REST_CONSTANTS.KEY_INDEX:(util.assert(this.index_ instanceof PathIndex,"Unrecognized index type!"),orderBy=this.index_.toString()),qs[REST_CONSTANTS.ORDER_BY]=util.stringify(orderBy),this.startSet_&&(qs[REST_CONSTANTS.START_AT]=util.stringify(this.indexStartValue_),this.startNameSet_&&(qs[REST_CONSTANTS.START_AT]+=","+util.stringify(this.indexStartName_))),this.endSet_&&(qs[REST_CONSTANTS.END_AT]=util.stringify(this.indexEndValue_),this.endNameSet_&&(qs[REST_CONSTANTS.END_AT]+=","+util.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?qs[REST_CONSTANTS.LIMIT_TO_FIRST]=this.limit_:qs[REST_CONSTANTS.LIMIT_TO_LAST]=this.limit_),qs},QueryParams.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},QueryParams.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},QueryParams.DEFAULT=new QueryParams,QueryParams}(),Reference=function(_super){function Reference(repo,path){if(!(repo instanceof Repo))throw new Error("new Reference() no longer supported - use app.database().");return _super.call(this,repo,path,QueryParams.DEFAULT,!1)||this}return tslib_1.__extends(Reference,_super),Reference.prototype.getKey=function(){return util.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},Reference.prototype.child=function(pathString){return util.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof pathString?pathString=String(pathString):pathString instanceof Path||(null===this.path.getFront()?validateRootPathString("Reference.child",1,pathString,!1):validatePathString("Reference.child",1,pathString,!1)),new Reference(this.repo,this.path.child(pathString))},Reference.prototype.getParent=function(){util.validateArgCount("Reference.parent",0,0,arguments.length);var parentPath=this.path.parent();return null===parentPath?null:new Reference(this.repo,parentPath)},Reference.prototype.getRoot=function(){util.validateArgCount("Reference.root",0,0,arguments.length);for(var ref=this;null!==ref.getParent();)ref=ref.getParent();return ref},Reference.prototype.databaseProp=function(){return this.repo.database},Reference.prototype.set=function(newVal,onComplete){util.validateArgCount("Reference.set",1,2,arguments.length),validateWritablePath("Reference.set",this.path),validateFirebaseDataArg("Reference.set",1,newVal,this.path,!1),util.validateCallback("Reference.set",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.setWithPriority(this.path,newVal,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.update=function(objectToMerge,onComplete){if(util.validateArgCount("Reference.update",1,2,arguments.length),validateWritablePath("Reference.update",this.path),Array.isArray(objectToMerge)){for(var newObjectToMerge={},i=0;i<objectToMerge.length;++i)newObjectToMerge[""+i]=objectToMerge[i];objectToMerge=newObjectToMerge,warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}validateFirebaseMergeDataArg("Reference.update",1,objectToMerge,this.path,!1),util.validateCallback("Reference.update",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.update(this.path,objectToMerge,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.setWithPriority=function(newVal,newPriority,onComplete){if(util.validateArgCount("Reference.setWithPriority",2,3,arguments.length),validateWritablePath("Reference.setWithPriority",this.path),validateFirebaseDataArg("Reference.setWithPriority",1,newVal,this.path,!1),validatePriority("Reference.setWithPriority",2,newPriority,!1),util.validateCallback("Reference.setWithPriority",3,onComplete,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var deferred=new util.Deferred;return this.repo.setWithPriority(this.path,newVal,newPriority,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.remove=function(onComplete){return util.validateArgCount("Reference.remove",0,1,arguments.length),validateWritablePath("Reference.remove",this.path),util.validateCallback("Reference.remove",1,onComplete,!0),this.set(null,onComplete)},Reference.prototype.transaction=function(transactionUpdate,onComplete,applyLocally){if(util.validateArgCount("Reference.transaction",1,3,arguments.length),validateWritablePath("Reference.transaction",this.path),util.validateCallback("Reference.transaction",1,transactionUpdate,!1),util.validateCallback("Reference.transaction",2,onComplete,!0),validateBoolean("Reference.transaction",3,applyLocally,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===applyLocally&&(applyLocally=!0);var deferred=new util.Deferred;"function"==typeof onComplete&&deferred.promise.catch(function(){});var promiseComplete=function(error$$1,committed,snapshot){error$$1?deferred.reject(error$$1):deferred.resolve(new TransactionResult(committed,snapshot)),"function"==typeof onComplete&&onComplete(error$$1,committed,snapshot)};return this.repo.startTransaction(this.path,transactionUpdate,promiseComplete,applyLocally),deferred.promise},Reference.prototype.setPriority=function(priority,onComplete){util.validateArgCount("Reference.setPriority",1,2,arguments.length),validateWritablePath("Reference.setPriority",this.path),validatePriority("Reference.setPriority",1,priority,!1),util.validateCallback("Reference.setPriority",2,onComplete,!0);var deferred=new util.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),priority,null,deferred.wrapCallback(onComplete)),deferred.promise},Reference.prototype.push=function(value,onComplete){util.validateArgCount("Reference.push",0,2,arguments.length),validateWritablePath("Reference.push",this.path),validateFirebaseDataArg("Reference.push",1,value,this.path,!0),util.validateCallback("Reference.push",2,onComplete,!0);var promise,now=this.repo.serverTime(),name=nextPushId(now),thennablePushRef=this.child(name),pushRef=this.child(name);return promise=null!=value?thennablePushRef.set(value,onComplete).then(function(){return pushRef}):Promise.resolve(pushRef),thennablePushRef.then=promise.then.bind(promise),thennablePushRef.catch=promise.then.bind(promise,void 0),"function"==typeof onComplete&&promise.catch(function(){}),thennablePushRef},Reference.prototype.onDisconnect=function(){return validateWritablePath("Reference.onDisconnect",this.path),new OnDisconnect(this.repo,this.path)},Object.defineProperty(Reference.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(Reference.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),Reference}(Query);Query.__referenceConstructor=Reference,SyncPoint.__referenceConstructor=Reference;var TransactionStatus,TreeNode=function(){function TreeNode(){this.children={},this.childCount=0,this.value=null}return TreeNode}(),Tree=function(){function Tree(name_,parent_,node_){void 0===name_&&(name_=""),void 0===parent_&&(parent_=null),void 0===node_&&(node_=new TreeNode),this.name_=name_,this.parent_=parent_,this.node_=node_}return Tree.prototype.subTree=function(pathObj){for(var next,path=pathObj instanceof Path?pathObj:new Path(pathObj),child=this;null!==(next=path.getFront());){child=new Tree(next,child,util.safeGet(child.node_.children,next)||new TreeNode),path=path.popFront()}return child},Tree.prototype.getValue=function(){return this.node_.value},Tree.prototype.setValue=function(value){util.assert(void 0!==value,"Cannot set value to undefined"),this.node_.value=value,this.updateParents_()},Tree.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},Tree.prototype.hasChildren=function(){return this.node_.childCount>0},Tree.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},Tree.prototype.forEachChild=function(action){var _this=this;util.forEach(this.node_.children,function(child,childTree){action(new Tree(child,_this,childTree))})},Tree.prototype.forEachDescendant=function(action,includeSelf,childrenFirst){includeSelf&&!childrenFirst&&action(this),this.forEachChild(function(child){child.forEachDescendant(action,!0,childrenFirst)}),includeSelf&&childrenFirst&&action(this)},Tree.prototype.forEachAncestor=function(action,includeSelf){for(var node=includeSelf?this:this.parent();null!==node;){if(action(node))return!0;node=node.parent()}return!1},Tree.prototype.forEachImmediateDescendantWithValue=function(action){this.forEachChild(function(child){null!==child.getValue()?action(child):child.forEachImmediateDescendantWithValue(action)})},Tree.prototype.path=function(){return new Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},Tree.prototype.name=function(){return this.name_},Tree.prototype.parent=function(){return this.parent_},Tree.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},Tree.prototype.updateChild_=function(childName,child){var childEmpty=child.isEmpty(),childExists=util.contains(this.node_.children,childName);childEmpty&&childExists?(delete this.node_.children[childName],this.node_.childCount--,this.updateParents_()):childEmpty||childExists||(this.node_.children[childName]=child.node_,this.node_.childCount++,this.updateParents_())},Tree}();!function(TransactionStatus){TransactionStatus[TransactionStatus.RUN=0]="RUN",TransactionStatus[TransactionStatus.SENT=1]="SENT",TransactionStatus[TransactionStatus.COMPLETED=2]="COMPLETED",TransactionStatus[TransactionStatus.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",TransactionStatus[TransactionStatus.NEEDS_ABORT=4]="NEEDS_ABORT"}(TransactionStatus||(TransactionStatus={})),Repo.MAX_TRANSACTION_RETRIES_=25,Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new Tree},Repo.prototype.startTransaction=function(path,transactionUpdate,onComplete,applyLocally){this.log_("transaction on "+path);var valueCallback=function(){},watchRef=new Reference(this,path);watchRef.on("value",valueCallback);var unwatcher=function(){watchRef.off("value",valueCallback)},transaction={path:path,update:transactionUpdate,onComplete:onComplete,status:null,order:LUIDGenerator(),applyLocally:applyLocally,retryCount:0,unwatcher:unwatcher,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},currentState=this.getLatestState_(path);transaction.currentInputSnapshot=currentState;var newVal=transaction.update(currentState.val());if(void 0===newVal){if(transaction.unwatcher(),transaction.currentOutputSnapshotRaw=null,transaction.currentOutputSnapshotResolved=null,transaction.onComplete){var snapshot=new DataSnapshot(transaction.currentInputSnapshot,new Reference(this,transaction.path),PRIORITY_INDEX);transaction.onComplete(null,!1,snapshot)}}else{validateFirebaseData("transaction failed: Data returned ",newVal,transaction.path),transaction.status=TransactionStatus.RUN;var queueNode=this.transactionQueueTree_.subTree(path),nodeQueue=queueNode.getValue()||[];nodeQueue.push(transaction),queueNode.setValue(nodeQueue);var priorityForNode=void 0;if("object"==typeof newVal&&null!==newVal&&util.contains(newVal,".priority"))priorityForNode=util.safeGet(newVal,".priority"),util.assert(isValidPriority(priorityForNode),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{priorityForNode=(this.serverSyncTree_.calcCompleteEventCache(path)||ChildrenNode.EMPTY_NODE).getPriority().val()}priorityForNode=priorityForNode;var serverValues=this.generateServerValues(),newNodeUnresolved=nodeFromJSON$1(newVal,priorityForNode),newNode=resolveDeferredValueSnapshot(newNodeUnresolved,serverValues);transaction.currentOutputSnapshotRaw=newNodeUnresolved,transaction.currentOutputSnapshotResolved=newNode,transaction.currentWriteId=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserOverwrite(path,newNode,transaction.currentWriteId,transaction.applyLocally);this.eventQueue_.raiseEventsForChangedPath(path,events),this.sendReadyTransactions_()}},Repo.prototype.getLatestState_=function(path,excludeSets){return this.serverSyncTree_.calcCompleteEventCache(path,excludeSets)||ChildrenNode.EMPTY_NODE},Repo.prototype.sendReadyTransactions_=function(node){var _this=this;if(void 0===node&&(node=this.transactionQueueTree_),node||this.pruneCompletedTransactionsBelowNode_(node),null!==node.getValue()){var queue=this.buildTransactionQueue_(node);util.assert(queue.length>0,"Sending zero length transaction queue");queue.every(function(transaction){return transaction.status===TransactionStatus.RUN})&&this.sendTransactionQueue_(node.path(),queue)}else node.hasChildren()&&node.forEachChild(function(childNode){_this.sendReadyTransactions_(childNode)})},Repo.prototype.sendTransactionQueue_=function(path,queue){for(var _this=this,setsToIgnore=queue.map(function(txn){return txn.currentWriteId}),latestState=this.getLatestState_(path,setsToIgnore),snapToSend=latestState,latestHash=latestState.hash(),i=0;i<queue.length;i++){var txn=queue[i];util.assert(txn.status===TransactionStatus.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),txn.status=TransactionStatus.SENT,txn.retryCount++;var relativePath=Path.relativePath(path,txn.path);snapToSend=snapToSend.updateChild(relativePath,txn.currentOutputSnapshotRaw)}var dataToSend=snapToSend.val(!0),pathToSend=path;this.server_.put(pathToSend.toString(),dataToSend,function(status){_this.log_("transaction put response",{path:pathToSend.toString(),status:status});var events=[];if("ok"===status){for(var callbacks=[],i=0;i<queue.length;i++){if(queue[i].status=TransactionStatus.COMPLETED,events=events.concat(_this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId)),queue[i].onComplete){var node=queue[i].currentOutputSnapshotResolved,ref=new Reference(_this,queue[i].path),snapshot=new DataSnapshot(node,ref,PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!0,snapshot))}queue[i].unwatcher()}_this.pruneCompletedTransactionsBelowNode_(_this.transactionQueueTree_.subTree(path)),_this.sendReadyTransactions_(),_this.eventQueue_.raiseEventsForChangedPath(path,events);for(var i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}else{if("datastale"===status)for(var i=0;i<queue.length;i++)queue[i].status===TransactionStatus.SENT_NEEDS_ABORT?queue[i].status=TransactionStatus.NEEDS_ABORT:queue[i].status=TransactionStatus.RUN;else{warn("transaction at "+pathToSend.toString()+" failed: "+status);for(var i=0;i<queue.length;i++)queue[i].status=TransactionStatus.NEEDS_ABORT,queue[i].abortReason=status}_this.rerunTransactions_(path)}},latestHash)},Repo.prototype.rerunTransactions_=function(changedPath){var rootMostTransactionNode=this.getAncestorTransactionNode_(changedPath),path=rootMostTransactionNode.path(),queue=this.buildTransactionQueue_(rootMostTransactionNode);return this.rerunTransactionQueue_(queue,path),path},Repo.prototype.rerunTransactionQueue_=function(queue,path){if(0!==queue.length){for(var callbacks=[],events=[],txnsToRerun=queue.filter(function(q){return q.status===TransactionStatus.RUN}),setsToIgnore=txnsToRerun.map(function(q){return q.currentWriteId}),i=0;i<queue.length;i++){var transaction=queue[i],relativePath=Path.relativePath(path,transaction.path),abortTransaction=!1,abortReason=void 0;if(util.assert(null!==relativePath,"rerunTransactionsUnderNode_: relativePath should not be null."),transaction.status===TransactionStatus.NEEDS_ABORT)abortTransaction=!0,abortReason=transaction.abortReason,events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else if(transaction.status===TransactionStatus.RUN)if(transaction.retryCount>=Repo.MAX_TRANSACTION_RETRIES_)abortTransaction=!0,abortReason="maxretry",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0));else{var currentNode=this.getLatestState_(transaction.path,setsToIgnore);transaction.currentInputSnapshot=currentNode;var newData=queue[i].update(currentNode.val());if(void 0!==newData){validateFirebaseData("transaction failed: Data returned ",newData,transaction.path);var newDataNode=nodeFromJSON$1(newData),hasExplicitPriority="object"==typeof newData&&null!=newData&&util.contains(newData,".priority");hasExplicitPriority||(newDataNode=newDataNode.updatePriority(currentNode.getPriority()));var oldWriteId=transaction.currentWriteId,serverValues=this.generateServerValues(),newNodeResolved=resolveDeferredValueSnapshot(newDataNode,serverValues);transaction.currentOutputSnapshotRaw=newDataNode,transaction.currentOutputSnapshotResolved=newNodeResolved,transaction.currentWriteId=this.getNextWriteId_(),setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId),1),events=events.concat(this.serverSyncTree_.applyUserOverwrite(transaction.path,newNodeResolved,transaction.currentWriteId,transaction.applyLocally)),events=events.concat(this.serverSyncTree_.ackUserWrite(oldWriteId,!0))}else abortTransaction=!0,abortReason="nodata",events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(path,events),events=[],abortTransaction&&(queue[i].status=TransactionStatus.COMPLETED,function(unwatcher){setTimeout(unwatcher,Math.floor(0))}(queue[i].unwatcher),queue[i].onComplete))if("nodata"===abortReason){var ref=new Reference(this,queue[i].path),lastInput=queue[i].currentInputSnapshot,snapshot=new DataSnapshot(lastInput,ref,PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,!1,snapshot))}else callbacks.push(queue[i].onComplete.bind(null,new Error(abortReason),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i]);this.sendReadyTransactions_()}},Repo.prototype.getAncestorTransactionNode_=function(path){for(var front,transactionNode=this.transactionQueueTree_;null!==(front=path.getFront())&&null===transactionNode.getValue();)transactionNode=transactionNode.subTree(front),path=path.popFront();return transactionNode},Repo.prototype.buildTransactionQueue_=function(transactionNode){var transactionQueue=[];return this.aggregateTransactionQueuesForNode_(transactionNode,transactionQueue),transactionQueue.sort(function(a,b){return a.order-b.order}),transactionQueue},Repo.prototype.aggregateTransactionQueuesForNode_=function(node,queue){var _this=this,nodeQueue=node.getValue();if(null!==nodeQueue)for(var i=0;i<nodeQueue.length;i++)queue.push(nodeQueue[i]);node.forEachChild(function(child){_this.aggregateTransactionQueuesForNode_(child,queue)})},Repo.prototype.pruneCompletedTransactionsBelowNode_=function(node){var _this=this,queue=node.getValue();if(queue){for(var to=0,from=0;from<queue.length;from++)queue[from].status!==TransactionStatus.COMPLETED&&(queue[to]=queue[from],to++);queue.length=to,node.setValue(queue.length>0?queue:null)}node.forEachChild(function(childNode){_this.pruneCompletedTransactionsBelowNode_(childNode)})},Repo.prototype.abortTransactions_=function(path){var _this=this,affectedPath=this.getAncestorTransactionNode_(path).path(),transactionNode=this.transactionQueueTree_.subTree(path);return transactionNode.forEachAncestor(function(node){_this.abortTransactionsOnNode_(node)}),this.abortTransactionsOnNode_(transactionNode),transactionNode.forEachDescendant(function(node){_this.abortTransactionsOnNode_(node)}),affectedPath},Repo.prototype.abortTransactionsOnNode_=function(node){var queue=node.getValue();if(null!==queue){for(var callbacks=[],events=[],lastSent=-1,i=0;i<queue.length;i++)if(queue[i].status===TransactionStatus.SENT_NEEDS_ABORT);else if(queue[i].status===TransactionStatus.SENT)util.assert(lastSent===i-1,"All SENT items should be at beginning of queue."),lastSent=i,queue[i].status=TransactionStatus.SENT_NEEDS_ABORT,queue[i].abortReason="set";else if(util.assert(queue[i].status===TransactionStatus.RUN,"Unexpected transaction status in abort"),queue[i].unwatcher(),events=events.concat(this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId,!0)),queue[i].onComplete){callbacks.push(queue[i].onComplete.bind(null,new Error("set"),!1,null))}-1===lastSent?node.setValue(null):queue.length=lastSent+1,this.eventQueue_.raiseEventsForChangedPath(node.path(),events);for(var i=0;i<callbacks.length;i++)exceptionGuard(callbacks[i])}};var _staticInstance,RepoManager=function(){function RepoManager(){this.repos_={},this.useRestClient_=!1}return RepoManager.getInstance=function(){return _staticInstance||(_staticInstance=new RepoManager),_staticInstance},RepoManager.prototype.interrupt=function(){for(var appName in this.repos_)for(var dbUrl in this.repos_[appName])this.repos_[appName][dbUrl].interrupt()},RepoManager.prototype.resume=function(){for(var appName in this.repos_)for(var dbUrl in this.repos_[appName])this.repos_[appName][dbUrl].resume()},RepoManager.prototype.databaseFromApp=function(app,url){var dbUrl=url||app.options.databaseURL;void 0===dbUrl&&fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var parsedUrl=parseRepoInfo(dbUrl),repoInfo=parsedUrl.repoInfo;return validateUrl("Invalid Firebase Database URL",1,parsedUrl),parsedUrl.path.isEmpty()||fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(repoInfo,app).database},RepoManager.prototype.deleteRepo=function(repo){var appRepos=util.safeGet(this.repos_,repo.app.name);appRepos&&util.safeGet(appRepos,repo.repoInfo_.toURLString())===repo||fatal("Database "+repo.app.name+"("+repo.repoInfo_+") has already been deleted."),repo.interrupt(),delete appRepos[repo.repoInfo_.toURLString()]},RepoManager.prototype.createRepo=function(repoInfo,app){var appRepos=util.safeGet(this.repos_,app.name);appRepos||(appRepos={},this.repos_[app.name]=appRepos);var repo=util.safeGet(appRepos,repoInfo.toURLString());return repo&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),repo=new Repo(repoInfo,this.useRestClient_,app),appRepos[repoInfo.toURLString()]=repo,repo},RepoManager.prototype.forceRestClient=function(forceRestClient){this.useRestClient_=forceRestClient},RepoManager}(),Database=function(){function Database(repo_){this.repo_=repo_,repo_ instanceof Repo||fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new Reference(repo_,Path.Empty),this.INTERNAL=new DatabaseInternals(this)}return Object.defineProperty(Database.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),Database.prototype.ref=function(path){return this.checkDeleted_("ref"),util.validateArgCount("database.ref",0,1,arguments.length),path instanceof Reference?this.refFromURL(path.toString()):void 0!==path?this.root_.child(path):this.root_},Database.prototype.refFromURL=function(url){var apiName="database.refFromURL";this.checkDeleted_(apiName),util.validateArgCount(apiName,1,1,arguments.length);var parsedURL=parseRepoInfo(url);validateUrl(apiName,1,parsedURL);var repoInfo=parsedURL.repoInfo;return repoInfo.host!==this.repo_.repoInfo_.host&&fatal(apiName+": Host name does not match the current database: (found "+repoInfo.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(parsedURL.path.toString())},Database.prototype.checkDeleted_=function(apiName){null===this.repo_&&fatal("Cannot call "+apiName+" on a deleted database.")},Database.prototype.goOffline=function(){util.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},Database.prototype.goOnline=function(){util.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},Database.ServerValue={TIMESTAMP:{".sv":"timestamp"}},Database}(),DatabaseInternals=function(){function DatabaseInternals(database){this.database=database}return DatabaseInternals.prototype.delete=function(){return tslib_1.__awaiter(this,void 0,void 0,function(){return tslib_1.__generator(this,function(_a){return this.database.checkDeleted_("delete"),RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},DatabaseInternals}(),forceLongPolling=function(){WebSocketConnection.forceDisallow(),BrowserPollConnection.forceAllow()},forceWebSockets=function(){BrowserPollConnection.forceDisallow()},isWebSocketsAvailable=function(){return WebSocketConnection.isAvailable()},setSecurityDebugCallback=function(ref,callback){ref.repo.persistentConnection_.securityDebugCallback_=callback},stats=function(ref,showDelta){ref.repo.stats(showDelta)},statsIncrementCounter=function(ref,metric){ref.repo.statsIncrementCounter(metric)},dataUpdateCount=function(ref){return ref.repo.dataUpdateCount},interceptServerData=function(ref,callback){return ref.repo.interceptServerData_(callback)},INTERNAL=Object.freeze({forceLongPolling:forceLongPolling,forceWebSockets:forceWebSockets,isWebSocketsAvailable:isWebSocketsAvailable,setSecurityDebugCallback:setSecurityDebugCallback,stats:stats,statsIncrementCounter:statsIncrementCounter,dataUpdateCount:dataUpdateCount,interceptServerData:interceptServerData}),DataConnection=PersistentConnection;PersistentConnection.prototype.simpleListen=function(pathString,onComplete){this.sendRequest("q",{p:pathString},onComplete)},PersistentConnection.prototype.echo=function(data,onEcho){this.sendRequest("echo",{d:data},onEcho)}
;var RealTimeConnection=Connection,hijackHash=function(newHash){var oldPut=PersistentConnection.prototype.put;return PersistentConnection.prototype.put=function(pathString,data,opt_onComplete,opt_hash){void 0!==opt_hash&&(opt_hash=newHash()),oldPut.call(this,pathString,data,opt_onComplete,opt_hash)},function(){PersistentConnection.prototype.put=oldPut}},ConnectionTarget=RepoInfo,queryIdentifier=function(query){return query.queryIdentifier()},listens=function(firebaseRef){return firebaseRef.repo.persistentConnection_.listens_},forceRestClient=function(forceRestClient){RepoManager.getInstance().forceRestClient(forceRestClient)},TEST_ACCESS=Object.freeze({DataConnection:DataConnection,RealTimeConnection:RealTimeConnection,hijackHash:hijackHash,ConnectionTarget:ConnectionTarget,queryIdentifier:queryIdentifier,listens:listens,forceRestClient:forceRestClient}),ServerValue=Database.ServerValue;registerDatabase(firebase),exports.registerDatabase=registerDatabase,exports.Database=Database,exports.Query=Query,exports.Reference=Reference,exports.enableLogging=enableLogging,exports.ServerValue=ServerValue,exports.DataSnapshot=DataSnapshot,exports.OnDisconnect=OnDisconnect}).call(this,require("_process"))},{"@firebase/app":1,"@firebase/logger":3,"@firebase/util":5,_process:57,tslib:78}],3:[function(require,module,exports){"use strict";function setLogLevel(level){instances.forEach(function(inst){inst.logLevel=level})}Object.defineProperty(exports,"__esModule",{value:!0});var instances=[];!function(LogLevel){LogLevel[LogLevel.DEBUG=0]="DEBUG",LogLevel[LogLevel.VERBOSE=1]="VERBOSE",LogLevel[LogLevel.INFO=2]="INFO",LogLevel[LogLevel.WARN=3]="WARN",LogLevel[LogLevel.ERROR=4]="ERROR",LogLevel[LogLevel.SILENT=5]="SILENT"}(exports.LogLevel||(exports.LogLevel={}));var defaultLogLevel=exports.LogLevel.INFO,defaultLogHandler=function(instance,logType){for(var args=[],_i=2;_i<arguments.length;_i++)args[_i-2]=arguments[_i];if(!(logType<instance.logLevel)){var now=(new Date).toISOString();switch(logType){case exports.LogLevel.DEBUG:case exports.LogLevel.VERBOSE:console.log.apply(console,["["+now+"]  "+instance.name+":"].concat(args));break;case exports.LogLevel.INFO:console.info.apply(console,["["+now+"]  "+instance.name+":"].concat(args));break;case exports.LogLevel.WARN:console.warn.apply(console,["["+now+"]  "+instance.name+":"].concat(args));break;case exports.LogLevel.ERROR:console.error.apply(console,["["+now+"]  "+instance.name+":"].concat(args));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+logType+")")}}},Logger=function(){function Logger(name){this.name=name,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,instances.push(this)}return Object.defineProperty(Logger.prototype,"logLevel",{get:function(){return this._logLevel},set:function(val){if(!(val in exports.LogLevel))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=val},enumerable:!0,configurable:!0}),Object.defineProperty(Logger.prototype,"logHandler",{get:function(){return this._logHandler},set:function(val){if("function"!=typeof val)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=val},enumerable:!0,configurable:!0}),Logger.prototype.debug=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,exports.LogLevel.DEBUG].concat(args))},Logger.prototype.log=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,exports.LogLevel.VERBOSE].concat(args))},Logger.prototype.info=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,exports.LogLevel.INFO].concat(args))},Logger.prototype.warn=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,exports.LogLevel.WARN].concat(args))},Logger.prototype.error=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];this._logHandler.apply(this,[this,exports.LogLevel.ERROR].concat(args))},Logger}();exports.setLogLevel=setLogLevel,exports.Logger=Logger},{}],4:[function(require,module,exports){(function(global){"use strict";function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;if(0===self._state)return void self._deferreds.push(deferred);self._handled=!0,Promise._immediateFn(function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null===cb)return void(1===self._state?resolve:reject)(deferred.promise,self._value);var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(bind(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn(function(){self._handled||Promise._unhandledRejectionFn(self._value)});for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn(function(value){done||(done=!0,resolve(self,value))},function(reason){done||(done=!0,reject(self,reason))})}catch(ex){if(done)return;done=!0,reject(self,ex)}}function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}require("whatwg-fetch");var setTimeoutFunc=setTimeout;Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype.finally=function(callback){var constructor=this.constructor;return this.then(function(value){return constructor.resolve(callback()).then(function(){return value})},function(reason){return constructor.resolve(callback()).then(function(){return constructor.reject(reason)})})},Promise.all=function(arr){return new Promise(function(resolve,reject){function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,function(val){res(i,val)},reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}if(!arr||void 0===arr.length)throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);for(var remaining=args.length,i=0;i<args.length;i++)res(i,args[i])})},Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise(function(resolve){resolve(value)})},Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})},Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++)values[i].then(resolve,reject)})},Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)};var globalNS=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==global)return global;throw new Error("unable to locate global object")}();globalNS.Promise||(globalNS.Promise=Promise);var _global=createCommonjsModule(function(module){var global=module.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=global)}),_core=createCommonjsModule(function(module){var core=module.exports={version:"2.5.5"};"number"==typeof __e&&(__e=core)}),_isObject=(_core.version,function(it){return"object"==typeof it?null!==it:"function"==typeof it}),_anObject=function(it){if(!_isObject(it))throw TypeError(it+" is not an object!");return it},_fails=function(exec){try{return!!exec()}catch(e){return!0}},_descriptors=!_fails(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),document=_global.document,is=_isObject(document)&&_isObject(document.createElement),_domCreate=function(it){return is?document.createElement(it):{}},_ie8DomDefine=!_descriptors&&!_fails(function(){return 7!=Object.defineProperty(_domCreate("div"),"a",{get:function(){return 7}}).a}),_toPrimitive=function(it,S){if(!_isObject(it))return it;var fn,val;if(S&&"function"==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;if("function"==typeof(fn=it.valueOf)&&!_isObject(val=fn.call(it)))return val;if(!S&&"function"==typeof(fn=it.toString)&&!_isObject(val=fn.call(it)))return val;throw TypeError("Can't convert object to primitive value")},dP=Object.defineProperty,f=_descriptors?Object.defineProperty:function(O,P,Attributes){if(_anObject(O),P=_toPrimitive(P,!0),_anObject(Attributes),_ie8DomDefine)try{return dP(O,P,Attributes)}catch(e){}if("get"in Attributes||"set"in Attributes)throw TypeError("Accessors not supported!");return"value"in Attributes&&(O[P]=Attributes.value),O},_objectDp={f:f},_propertyDesc=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}},_hide=_descriptors?function(object,key,value){return _objectDp.f(object,key,_propertyDesc(1,value))}:function(object,key,value){return object[key]=value,object},hasOwnProperty={}.hasOwnProperty,_has=function(it,key){return hasOwnProperty.call(it,key)},id=0,px=Math.random(),_uid=function(key){return"Symbol(".concat(void 0===key?"":key,")_",(++id+px).toString(36))},_redefine=createCommonjsModule(function(module){var SRC=_uid("src"),$toString=Function.toString,TPL=(""+$toString).split("toString");_core.inspectSource=function(it){return $toString.call(it)},(module.exports=function(O,key,val,safe){var isFunction="function"==typeof val;isFunction&&(_has(val,"name")||_hide(val,"name",key)),O[key]!==val&&(isFunction&&(_has(val,SRC)||_hide(val,SRC,O[key]?""+O[key]:TPL.join(String(key)))),O===_global?O[key]=val:safe?O[key]?O[key]=val:_hide(O,key,val):(delete O[key],_hide(O,key,val)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[SRC]||$toString.call(this)})}),_aFunction=function(it){if("function"!=typeof it)throw TypeError(it+" is not a function!");return it},_ctx=function(fn,that,length){if(_aFunction(fn),void 0===that)return fn;switch(length){case 1:return function(a){return fn.call(that,a)};case 2:return function(a,b){return fn.call(that,a,b)};case 3:return function(a,b,c){return fn.call(that,a,b,c)}}return function(){return fn.apply(that,arguments)}},$export=function(type,name,source){var key,own,out,exp,IS_FORCED=type&$export.F,IS_GLOBAL=type&$export.G,IS_STATIC=type&$export.S,IS_PROTO=type&$export.P,IS_BIND=type&$export.B,target=IS_GLOBAL?_global:IS_STATIC?_global[name]||(_global[name]={}):(_global[name]||{}).prototype,exports=IS_GLOBAL?_core:_core[name]||(_core[name]={}),expProto=exports.prototype||(exports.prototype={});IS_GLOBAL&&(source=name);for(key in source)own=!IS_FORCED&&target&&void 0!==target[key],out=(own?target:source)[key],exp=IS_BIND&&own?_ctx(out,_global):IS_PROTO&&"function"==typeof out?_ctx(Function.call,out):out,target&&_redefine(target,key,out,type&$export.U),exports[key]!=out&&_hide(exports,key,exp),IS_PROTO&&expProto[key]!=out&&(expProto[key]=out)};_global.core=_core,$export.F=1,$export.G=2,$export.S=4,$export.P=8,$export.B=16,$export.W=32,$export.U=64,$export.R=128;var _export=$export,toString={}.toString,_cof=function(it){return toString.call(it).slice(8,-1)},_iobject=Object("z").propertyIsEnumerable(0)?Object:function(it){return"String"==_cof(it)?it.split(""):Object(it)},_defined=function(it){if(void 0==it)throw TypeError("Can't call method on  "+it);return it},_toObject=function(it){return Object(_defined(it))},ceil=Math.ceil,floor=Math.floor,_toInteger=function(it){return isNaN(it=+it)?0:(it>0?floor:ceil)(it)},min=Math.min,_toLength=function(it){return it>0?min(_toInteger(it),9007199254740991):0},_isArray=Array.isArray||function(arg){return"Array"==_cof(arg)},store=_global["__core-js_shared__"]||(_global["__core-js_shared__"]={}),_shared=function(key){return store[key]||(store[key]={})},_wks=createCommonjsModule(function(module){var store=_shared("wks"),Symbol=_global.Symbol,USE_SYMBOL="function"==typeof Symbol;(module.exports=function(name){return store[name]||(store[name]=USE_SYMBOL&&Symbol[name]||(USE_SYMBOL?Symbol:_uid)("Symbol."+name))}).store=store}),SPECIES=_wks("species"),_arraySpeciesConstructor=function(original){var C;return _isArray(original)&&(C=original.constructor,"function"!=typeof C||C!==Array&&!_isArray(C.prototype)||(C=void 0),_isObject(C)&&null===(C=C[SPECIES])&&(C=void 0)),void 0===C?Array:C},_arraySpeciesCreate=function(original,length){return new(_arraySpeciesConstructor(original))(length)},_arrayMethods=function(TYPE,$create){var IS_MAP=1==TYPE,IS_FILTER=2==TYPE,IS_SOME=3==TYPE,IS_EVERY=4==TYPE,IS_FIND_INDEX=6==TYPE,NO_HOLES=5==TYPE||IS_FIND_INDEX,create=$create||_arraySpeciesCreate;return function($this,callbackfn,that){for(var val,res,O=_toObject($this),self=_iobject(O),f=_ctx(callbackfn,that,3),length=_toLength(self.length),index=0,result=IS_MAP?create($this,length):IS_FILTER?create($this,0):void 0;length>index;index++)if((NO_HOLES||index in self)&&(val=self[index],res=f(val,index,O),TYPE))if(IS_MAP)result[index]=res;else if(res)switch(TYPE){case 3:return!0;case 5:return val;case 6:return index;case 2:result.push(val)}else if(IS_EVERY)return!1;return IS_FIND_INDEX?-1:IS_SOME||IS_EVERY?IS_EVERY:result}},UNSCOPABLES=_wks("unscopables"),ArrayProto=Array.prototype;void 0==ArrayProto[UNSCOPABLES]&&_hide(ArrayProto,UNSCOPABLES,{});var _addToUnscopables=function(key){ArrayProto[UNSCOPABLES][key]=!0},$find=_arrayMethods(5),forced=!0;"find"in[]&&Array(1).find(function(){forced=!1}),_export(_export.P+_export.F*forced,"Array",{find:function(callbackfn){return $find(this,callbackfn,arguments.length>1?arguments[1]:void 0)}}),_addToUnscopables("find");var $find$1=(_core.Array.find,_arrayMethods(6)),forced$1=!0;"findIndex"in[]&&Array(1).findIndex(function(){forced$1=!1}),_export(_export.P+_export.F*forced$1,"Array",{findIndex:function(callbackfn){return $find$1(this,callbackfn,arguments.length>1?arguments[1]:void 0)}}),_addToUnscopables("findIndex");var _toIobject=(_core.Array.findIndex,function(it){return _iobject(_defined(it))}),max=Math.max,min$1=Math.min,_toAbsoluteIndex=function(index,length){return index=_toInteger(index),index<0?max(index+length,0):min$1(index,length)},shared=_shared("keys"),_sharedKey=function(key){return shared[key]||(shared[key]=_uid(key))},arrayIndexOf=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=_toIobject($this),length=_toLength(O.length),index=_toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}}(!1),IE_PROTO=_sharedKey("IE_PROTO"),_objectKeysInternal=function(object,names){var key,O=_toIobject(object),i=0,result=[];for(key in O)key!=IE_PROTO&&_has(O,key)&&result.push(key);for(;names.length>i;)_has(O,key=names[i++])&&(~arrayIndexOf(result,key)||result.push(key));return result},_enumBugKeys="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),_objectKeys=Object.keys||function(O){return _objectKeysInternal(O,_enumBugKeys)},f$1=Object.getOwnPropertySymbols,_objectGops={f:f$1},f$2={}.propertyIsEnumerable,_objectPie={f:f$2},$assign=Object.assign,_objectAssign=!$assign||_fails(function(){var A={},B={},S=Symbol(),K="abcdefghijklmnopqrst";return A[S]=7,K.split("").forEach(function(k){B[k]=k}),7!=$assign({},A)[S]||Object.keys($assign({},B)).join("")!=K})?function(target,source){for(var T=_toObject(target),aLen=arguments.length,index=1,getSymbols=_objectGops.f,isEnum=_objectPie.f;aLen>index;)for(var key,S=_iobject(arguments[index++]),keys=getSymbols?_objectKeys(S).concat(getSymbols(S)):_objectKeys(S),length=keys.length,j=0;length>j;)isEnum.call(S,key=keys[j++])&&(T[key]=S[key]);return T}:$assign;_export(_export.S+_export.F,"Object",{assign:_objectAssign});var MATCH=(_core.Object.assign,_wks("match")),_isRegexp=function(it){var isRegExp;return _isObject(it)&&(void 0!==(isRegExp=it[MATCH])?!!isRegExp:"RegExp"==_cof(it))},_stringContext=function(that,searchString,NAME){if(_isRegexp(searchString))throw TypeError("String#"+NAME+" doesn't accept regex!");return String(_defined(that))},MATCH$1=_wks("match"),$startsWith="".startsWith;_export(_export.P+_export.F*function(KEY){var re=/./;try{"/./"[KEY](re)}catch(e){try{return re[MATCH$1]=!1,!"/./"[KEY](re)}catch(f){}}return!0}("startsWith"),"String",{startsWith:function(searchString){var that=_stringContext(this,searchString,"startsWith"),index=_toLength(Math.min(arguments.length>1?arguments[1]:void 0,that.length)),search=String(searchString);return $startsWith?$startsWith.call(that,search,index):that.slice(index,index+search.length)===search}});var _stringRepeat=(_core.String.startsWith,function(count){var str=String(_defined(this)),res="",n=_toInteger(count);if(n<0||n==1/0)throw RangeError("Count can't be negative");for(;n>0;(n>>>=1)&&(str+=str))1&n&&(res+=str);return res});_export(_export.P,"String",{repeat:_stringRepeat});var _meta=(_core.String.repeat,createCommonjsModule(function(module){var META=_uid("meta"),setDesc=_objectDp.f,id=0,isExtensible=Object.isExtensible||function(){return!0},FREEZE=!_fails(function(){return isExtensible(Object.preventExtensions({}))}),setMeta=function(it){setDesc(it,META,{value:{i:"O"+ ++id,w:{}}})},fastKey=function(it,create){if(!_isObject(it))return"symbol"==typeof it?it:("string"==typeof it?"S":"P")+it;if(!_has(it,META)){if(!isExtensible(it))return"F";if(!create)return"E";setMeta(it)}return it[META].i},getWeak=function(it,create){if(!_has(it,META)){if(!isExtensible(it))return!0;if(!create)return!1;setMeta(it)}return it[META].w},onFreeze=function(it){return FREEZE&&meta.NEED&&isExtensible(it)&&!_has(it,META)&&setMeta(it),it},meta=module.exports={KEY:META,NEED:!1,fastKey:fastKey,getWeak:getWeak,onFreeze:onFreeze}})),def=(_meta.KEY,_meta.NEED,_meta.fastKey,_meta.getWeak,_meta.onFreeze,_objectDp.f),TAG=_wks("toStringTag"),_setToStringTag=function(it,tag,stat){it&&!_has(it=stat?it:it.prototype,TAG)&&def(it,TAG,{configurable:!0,value:tag})},f$3=_wks,_wksExt={f:f$3},defineProperty=_objectDp.f,_wksDefine=function(name){var $Symbol=_core.Symbol||(_core.Symbol=_global.Symbol||{});"_"==name.charAt(0)||name in $Symbol||defineProperty($Symbol,name,{value:_wksExt.f(name)})},_enumKeys=function(it){var result=_objectKeys(it),getSymbols=_objectGops.f;if(getSymbols)for(var key,symbols=getSymbols(it),isEnum=_objectPie.f,i=0;symbols.length>i;)isEnum.call(it,key=symbols[i++])&&result.push(key);return result},_objectDps=_descriptors?Object.defineProperties:function(O,Properties){_anObject(O);for(var P,keys=_objectKeys(Properties),length=keys.length,i=0;length>i;)_objectDp.f(O,P=keys[i++],Properties[P]);return O},document$1=_global.document,_html=document$1&&document$1.documentElement,IE_PROTO$1=_sharedKey("IE_PROTO"),Empty=function(){},createDict=function(){var iframeDocument,iframe=_domCreate("iframe"),i=_enumBugKeys.length;for(iframe.style.display="none",_html.appendChild(iframe),iframe.src="javascript:",iframeDocument=iframe.contentWindow.document,iframeDocument.open(),iframeDocument.write("<script>document.F=Object<\/script>"),iframeDocument.close(),createDict=iframeDocument.F;i--;)delete createDict.prototype[_enumBugKeys[i]];return createDict()},_objectCreate=Object.create||function(O,Properties){var result;return null!==O?(Empty.prototype=_anObject(O),result=new Empty,Empty.prototype=null,result[IE_PROTO$1]=O):result=createDict(),void 0===Properties?result:_objectDps(result,Properties)},hiddenKeys=_enumBugKeys.concat("length","prototype"),f$4=Object.getOwnPropertyNames||function(O){return _objectKeysInternal(O,hiddenKeys)},_objectGopn={f:f$4},gOPN=_objectGopn.f,toString$1={}.toString,windowNames="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],getWindowNames=function(it){try{return gOPN(it)}catch(e){return windowNames.slice()}},f$5=function(it){return windowNames&&"[object Window]"==toString$1.call(it)?getWindowNames(it):gOPN(_toIobject(it))},_objectGopnExt={f:f$5},gOPD=Object.getOwnPropertyDescriptor,f$6=_descriptors?gOPD:function(O,P){if(O=_toIobject(O),P=_toPrimitive(P,!0),_ie8DomDefine)try{return gOPD(O,P)}catch(e){}if(_has(O,P))return _propertyDesc(!_objectPie.f.call(O,P),O[P])},_objectGopd={f:f$6},META=_meta.KEY,gOPD$1=_objectGopd.f,dP$1=_objectDp.f,gOPN$1=_objectGopnExt.f,$Symbol=_global.Symbol,$JSON=_global.JSON,_stringify=$JSON&&$JSON.stringify,HIDDEN=_wks("_hidden"),TO_PRIMITIVE=_wks("toPrimitive"),isEnum={}.propertyIsEnumerable,SymbolRegistry=_shared("symbol-registry"),AllSymbols=_shared("symbols"),OPSymbols=_shared("op-symbols"),ObjectProto=Object.prototype,USE_NATIVE="function"==typeof $Symbol,QObject=_global.QObject,setter=!QObject||!QObject.prototype||!QObject.prototype.findChild,setSymbolDesc=_descriptors&&_fails(function(){return 7!=_objectCreate(dP$1({},"a",{get:function(){return dP$1(this,"a",{value:7}).a}})).a})?function(it,key,D){var protoDesc=gOPD$1(ObjectProto,key);protoDesc&&delete ObjectProto[key],dP$1(it,key,D),protoDesc&&it!==ObjectProto&&dP$1(ObjectProto,key,protoDesc)}:dP$1,wrap=function(tag){var sym=AllSymbols[tag]=_objectCreate($Symbol.prototype);return sym._k=tag,sym},isSymbol=USE_NATIVE&&"symbol"==typeof $Symbol.iterator?function(it){return"symbol"==typeof it}:function(it){return it instanceof $Symbol},$defineProperty=function(it,key,D){return it===ObjectProto&&$defineProperty(OPSymbols,key,D),_anObject(it),key=_toPrimitive(key,!0),_anObject(D),_has(AllSymbols,key)?(D.enumerable?(_has(it,HIDDEN)&&it[HIDDEN][key]&&(it[HIDDEN][key]=!1),D=_objectCreate(D,{enumerable:_propertyDesc(0,!1)})):(_has(it,HIDDEN)||dP$1(it,HIDDEN,_propertyDesc(1,{})),it[HIDDEN][key]=!0),setSymbolDesc(it,key,D)):dP$1(it,key,D)},$defineProperties=function(it,P){_anObject(it);for(var key,keys=_enumKeys(P=_toIobject(P)),i=0,l=keys.length;l>i;)$defineProperty(it,key=keys[i++],P[key]);return it},$create=function(it,P){return void 0===P?_objectCreate(it):$defineProperties(_objectCreate(it),P)},$propertyIsEnumerable=function(key){var E=isEnum.call(this,key=_toPrimitive(key,!0));return!(this===ObjectProto&&_has(AllSymbols,key)&&!_has(OPSymbols,key))&&(!(E||!_has(this,key)||!_has(AllSymbols,key)||_has(this,HIDDEN)&&this[HIDDEN][key])||E)},$getOwnPropertyDescriptor=function(it,key){if(it=_toIobject(it),key=_toPrimitive(key,!0),it!==ObjectProto||!_has(AllSymbols,key)||_has(OPSymbols,key)){var D=gOPD$1(it,key);return!D||!_has(AllSymbols,key)||_has(it,HIDDEN)&&it[HIDDEN][key]||(D.enumerable=!0),D}},$getOwnPropertyNames=function(it){for(var key,names=gOPN$1(_toIobject(it)),result=[],i=0;names.length>i;)_has(AllSymbols,key=names[i++])||key==HIDDEN||key==META||result.push(key);return result},$getOwnPropertySymbols=function(it){for(var key,IS_OP=it===ObjectProto,names=gOPN$1(IS_OP?OPSymbols:_toIobject(it)),result=[],i=0;names.length>i;)!_has(AllSymbols,key=names[i++])||IS_OP&&!_has(ObjectProto,key)||result.push(AllSymbols[key]);return result};USE_NATIVE||($Symbol=function(){if(this instanceof $Symbol)throw TypeError("Symbol is not a constructor!");var tag=_uid(arguments.length>0?arguments[0]:void 0),$set=function(value){this===ObjectProto&&$set.call(OPSymbols,value),_has(this,HIDDEN)&&_has(this[HIDDEN],tag)&&(this[HIDDEN][tag]=!1),setSymbolDesc(this,tag,_propertyDesc(1,value))};return _descriptors&&setter&&setSymbolDesc(ObjectProto,tag,{configurable:!0,set:$set}),wrap(tag)},_redefine($Symbol.prototype,"toString",function(){return this._k}),_objectGopd.f=$getOwnPropertyDescriptor,_objectDp.f=$defineProperty,_objectGopn.f=_objectGopnExt.f=$getOwnPropertyNames,_objectPie.f=$propertyIsEnumerable,_objectGops.f=$getOwnPropertySymbols,_descriptors&&_redefine(ObjectProto,"propertyIsEnumerable",$propertyIsEnumerable,!0),_wksExt.f=function(name){return wrap(_wks(name))}),_export(_export.G+_export.W+_export.F*!USE_NATIVE,{Symbol:$Symbol});for(var es6Symbols="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),j=0;es6Symbols.length>j;)_wks(es6Symbols[j++]);for(var wellKnownSymbols=_objectKeys(_wks.store),k=0;wellKnownSymbols.length>k;)_wksDefine(wellKnownSymbols[k++]);_export(_export.S+_export.F*!USE_NATIVE,"Symbol",{for:function(key){return _has(SymbolRegistry,key+="")?SymbolRegistry[key]:SymbolRegistry[key]=$Symbol(key)},keyFor:function(sym){if(!isSymbol(sym))throw TypeError(sym+" is not a symbol!");for(var key in SymbolRegistry)if(SymbolRegistry[key]===sym)return key},useSetter:function(){setter=!0},useSimple:function(){setter=!1}}),_export(_export.S+_export.F*!USE_NATIVE,"Object",{create:$create,defineProperty:$defineProperty,defineProperties:$defineProperties,getOwnPropertyDescriptor:$getOwnPropertyDescriptor,getOwnPropertyNames:$getOwnPropertyNames,getOwnPropertySymbols:$getOwnPropertySymbols}),$JSON&&_export(_export.S+_export.F*(!USE_NATIVE||_fails(function(){var S=$Symbol();return"[null]"!=_stringify([S])||"{}"!=_stringify({a:S})||"{}"!=_stringify(Object(S))})),"JSON",{stringify:function(it){for(var replacer,$replacer,args=[it],i=1;arguments.length>i;)args.push(arguments[i++]);if($replacer=replacer=args[1],(_isObject(replacer)||void 0!==it)&&!isSymbol(it))return _isArray(replacer)||(replacer=function(key,value){if("function"==typeof $replacer&&(value=$replacer.call(this,key,value)),!isSymbol(value))return value}),args[1]=replacer,_stringify.apply($JSON,args)}}),$Symbol.prototype[TO_PRIMITIVE]||_hide($Symbol.prototype,TO_PRIMITIVE,$Symbol.prototype.valueOf),_setToStringTag($Symbol,"Symbol"),_setToStringTag(Math,"Math",!0),_setToStringTag(_global.JSON,"JSON",!0);var TAG$1=_wks("toStringTag"),ARG="Arguments"==_cof(function(){return arguments}()),tryGet=function(it,key){try{return it[key]}catch(e){}},_classof=function(it){var O,T,B;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(T=tryGet(O=Object(it),TAG$1))?T:ARG?_cof(O):"Object"==(B=_cof(O))&&"function"==typeof O.callee?"Arguments":B},test={};test[_wks("toStringTag")]="z",test+""!="[object z]"&&_redefine(Object.prototype,"toString",function(){return"[object "+_classof(this)+"]"},!0),_wksDefine("asyncIterator"),_wksDefine("observable");var _iterators=(_core.Symbol,{}),IteratorPrototype={};_hide(IteratorPrototype,_wks("iterator"),function(){return this});var _iterCreate=function(Constructor,NAME,next){Constructor.prototype=_objectCreate(IteratorPrototype,{next:_propertyDesc(1,next)}),_setToStringTag(Constructor,NAME+" Iterator")},IE_PROTO$2=_sharedKey("IE_PROTO"),ObjectProto$1=Object.prototype,_objectGpo=Object.getPrototypeOf||function(O){return O=_toObject(O),_has(O,IE_PROTO$2)?O[IE_PROTO$2]:"function"==typeof O.constructor&&O instanceof O.constructor?O.constructor.prototype:O instanceof Object?ObjectProto$1:null},ITERATOR=_wks("iterator"),BUGGY=!([].keys&&"next"in[].keys()),returnThis=function(){return this},_iterDefine=function(Base,NAME,Constructor,next,DEFAULT,IS_SET,FORCED){_iterCreate(Constructor,NAME,next);var methods,key,IteratorPrototype,getMethod=function(kind){if(!BUGGY&&kind in proto)return proto[kind];switch(kind){case"keys":case"values":return function(){return new Constructor(this,kind)}}return function(){return new Constructor(this,kind)}},TAG=NAME+" Iterator",DEF_VALUES="values"==DEFAULT,VALUES_BUG=!1,proto=Base.prototype,$native=proto[ITERATOR]||proto["@@iterator"]||DEFAULT&&proto[DEFAULT],$default=$native||getMethod(DEFAULT),$entries=DEFAULT?DEF_VALUES?getMethod("entries"):$default:void 0,$anyNative="Array"==NAME?proto.entries||$native:$native;if($anyNative&&(IteratorPrototype=_objectGpo($anyNative.call(new Base)))!==Object.prototype&&IteratorPrototype.next&&(_setToStringTag(IteratorPrototype,TAG,!0),"function"!=typeof IteratorPrototype[ITERATOR]&&_hide(IteratorPrototype,ITERATOR,returnThis)),DEF_VALUES&&$native&&"values"!==$native.name&&(VALUES_BUG=!0,$default=function(){return $native.call(this)}),(BUGGY||VALUES_BUG||!proto[ITERATOR])&&_hide(proto,ITERATOR,$default),_iterators[NAME]=$default,_iterators[TAG]=returnThis,DEFAULT)if(methods={values:DEF_VALUES?$default:getMethod("values"),keys:IS_SET?$default:getMethod("keys"),entries:$entries},FORCED)for(key in methods)key in proto||_redefine(proto,key,methods[key]);else _export(_export.P+_export.F*(BUGGY||VALUES_BUG),NAME,methods);return methods},$at=function(TO_STRING){return function(that,pos){var a,b,s=String(_defined(that)),i=_toInteger(pos),l=s.length;return i<0||i>=l?TO_STRING?"":void 0:(a=s.charCodeAt(i),a<55296||a>56319||i+1===l||(b=s.charCodeAt(i+1))<56320||b>57343?TO_STRING?s.charAt(i):a:TO_STRING?s.slice(i,i+2):b-56320+(a-55296<<10)+65536)}}(!0);_iterDefine(String,"String",function(iterated){this._t=String(iterated),this._i=0},function(){var point,O=this._t,index=this._i;return index>=O.length?{value:void 0,done:!0}:(point=$at(O,index),this._i+=point.length,{value:point,done:!1})});var _iterStep=function(done,value){return{value:value,done:!!done}},es6_array_iterator=_iterDefine(Array,"Array",function(iterated,kind){this._t=_toIobject(iterated),this._i=0,this._k=kind},function(){var O=this._t,kind=this._k,index=this._i++;return!O||index>=O.length?(this._t=void 0,_iterStep(1)):"keys"==kind?_iterStep(0,index):"values"==kind?_iterStep(0,O[index]):_iterStep(0,[index,O[index]])},"values");_iterators.Arguments=_iterators.Array,_addToUnscopables("keys"),_addToUnscopables("values"),_addToUnscopables("entries");for(var ITERATOR$1=_wks("iterator"),TO_STRING_TAG=_wks("toStringTag"),ArrayValues=_iterators.Array,DOMIterables={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},collections=_objectKeys(DOMIterables),i=0;i<collections.length;i++){var key,NAME=collections[i],explicit=DOMIterables[NAME],Collection=_global[NAME],proto=Collection&&Collection.prototype;if(proto&&(proto[ITERATOR$1]||_hide(proto,ITERATOR$1,ArrayValues),proto[TO_STRING_TAG]||_hide(proto,TO_STRING_TAG,NAME),_iterators[NAME]=ArrayValues,explicit))for(key in es6_array_iterator)proto[key]||_redefine(proto,key,es6_array_iterator[key],!0)}_wksExt.f("iterator")
}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"whatwg-fetch":80}],5:[function(require,module,exports){"use strict";function deepCopy(value){return deepExtend(void 0,value)}function deepExtend(target,source){if(!(source instanceof Object))return source;switch(source.constructor){case Date:var dateValue=source;return new Date(dateValue.getTime());case Object:void 0===target&&(target={});break;case Array:target=[];break;default:return source}for(var prop in source)source.hasOwnProperty(prop)&&(target[prop]=deepExtend(target[prop],source[prop]));return target}function patchProperty(obj,prop,value){obj[prop]=value}function patchCapture(captureFake){var result=captureStackTrace;return captureStackTrace=captureFake,result}function jsonEval(str){return JSON.parse(str)}function stringify(data){return JSON.stringify(data)}function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)}function async(fn,onError){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];Promise.resolve(!0).then(function(){fn.apply(void 0,args)}).catch(function(error){onError&&onError(error)})}}function implementsAnyMethods(obj,methods){if("object"!=typeof obj||null===obj)return!1;for(var _i=0,methods_1=methods;_i<methods_1.length;_i++){var method=methods_1[_i];if(method in obj&&"function"==typeof obj[method])return!0}return!1}function noop(){}function errorPrefix(fnName,argumentNumber,optional){var argName="";switch(argumentNumber){case 1:argName=optional?"first":"First";break;case 2:argName=optional?"second":"Second";break;case 3:argName=optional?"third":"Third";break;case 4:argName=optional?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var error=fnName+" failed: ";return error+=argName+" argument "}function validateNamespace(fnName,argumentNumber,namespace,optional){if((!optional||namespace)&&"string"!=typeof namespace)throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid firebase namespace.")}function validateCallback(fnName,argumentNumber,callback,optional){if((!optional||callback)&&"function"!=typeof callback)throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid function.")}function validateContextObject(fnName,argumentNumber,context,optional){if((!optional||context)&&("object"!=typeof context||null===context))throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid context object.")}Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("tslib"),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},assert=function(assertion,message){if(!assertion)throw assertionError(message)},assertionError=function(message){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+message)},stringToByteArray=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):55296==(64512&c)&&i+1<str.length&&56320==(64512&str.charCodeAt(i+1))?(c=65536+((1023&c)<<10)+(1023&str.charCodeAt(++i)),out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},byteArrayToString=function(bytes){for(var out=[],pos=0,c=0;pos<bytes.length;){var c1=bytes[pos++];if(c1<128)out[c++]=String.fromCharCode(c1);else if(c1>191&&c1<224){var c2=bytes[pos++];out[c++]=String.fromCharCode((31&c1)<<6|63&c2)}else if(c1>239&&c1<365){var c2=bytes[pos++],c3=bytes[pos++],c4=bytes[pos++],u=((7&c1)<<18|(63&c2)<<12|(63&c3)<<6|63&c4)-65536;out[c++]=String.fromCharCode(55296+(u>>10)),out[c++]=String.fromCharCode(56320+(1023&u))}else{var c2=bytes[pos++],c3=bytes[pos++];out[c++]=String.fromCharCode((15&c1)<<12|(63&c2)<<6|63&c3)}}return out.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_,output=[],i=0;i<input.length;i+=3){var byte1=input[i],haveByte2=i+1<input.length,byte2=haveByte2?input[i+1]:0,haveByte3=i+2<input.length,byte3=haveByte3?input[i+2]:0,outByte1=byte1>>2,outByte2=(3&byte1)<<4|byte2>>4,outByte3=(15&byte2)<<2|byte3>>6,outByte4=63&byte3;haveByte3||(outByte4=64,haveByte2||(outByte3=64)),output.push(byteToCharMap[outByte1],byteToCharMap[outByte2],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join("")},encodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?btoa(input):this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){return this.HAS_NATIVE_SUPPORT&&!opt_webSafe?atob(input):byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();for(var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_,output=[],i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)],haveByte2=i<input.length,byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length,byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length,byte4=haveByte4?charToByteMap[input.charAt(i)]:64;if(++i,null==byte1||null==byte2||null==byte3||null==byte4)throw Error();var outByte1=byte1<<2|byte2>>4;if(output.push(outByte1),64!=byte3){var outByte2=byte2<<4&240|byte3>>2;if(output.push(outByte2),64!=byte4){var outByte3=byte3<<6&192|byte4;output.push(outByte3)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++)this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i),this.charToByteMap_[this.byteToCharMap_[i]]=i,this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i,i>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i)}}},base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return base64.encodeByteArray(utf8Bytes,!0)},base64Decode=function(str){try{return base64.decodeString(str,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve,_this.reject=reject})}return Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){error?_this.reject(error):_this.resolve(value),"function"==typeof callback&&(_this.promise.catch(function(){}),1===callback.length?callback(error):callback(error,value))}},Deferred}(),getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())},isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},isNodeSdk=function(){return!0===CONSTANTS.NODE_CLIENT||!0===CONSTANTS.NODE_ADMIN},ERROR_NAME="FirebaseError",captureStackTrace=Error.captureStackTrace,FirebaseError=function(){function FirebaseError(code,message){if(this.code=code,this.message=message,captureStackTrace)captureStackTrace(this,ErrorFactory.prototype.create);else try{throw Error.apply(this,arguments)}catch(err){this.name=ERROR_NAME,Object.defineProperty(this,"stack",{get:function(){return err.stack}})}}return FirebaseError}();FirebaseError.prototype=Object.create(Error.prototype),FirebaseError.prototype.constructor=FirebaseError,FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service,this.serviceName=serviceName,this.errors=errors,this.pattern=/\{\$([^}]+)}/g}return ErrorFactory.prototype.create=function(code,data){void 0===data&&(data={});var message,template=this.errors[code],fullCode=this.service+"/"+code;message=void 0===template?"Error":template.replace(this.pattern,function(match,key){var value=data[key];return void 0!==value?value.toString():"<"+key+"?>"}),message=this.serviceName+": "+message+" ("+fullCode+").";var err=new FirebaseError(fullCode,message);for(var prop in data)data.hasOwnProperty(prop)&&"_"!==prop.slice(-1)&&(err[prop]=data[prop]);return err},ErrorFactory}(),decode=function(token){var header={},claims={},data={},signature="";try{var parts=token.split(".");header=jsonEval(base64Decode(parts[0])||""),claims=jsonEval(base64Decode(parts[1])||""),signature=parts[2],data=claims.d||{},delete claims.d}catch(e){}return{header:header,claims:claims,data:data,signature:signature}},isValidTimestamp=function(token){var validSince,validUntil,claims=decode(token).claims,now=Math.floor((new Date).getTime()/1e3);return"object"==typeof claims&&(claims.hasOwnProperty("nbf")?validSince=claims.nbf:claims.hasOwnProperty("iat")&&(validSince=claims.iat),validUntil=claims.hasOwnProperty("exp")?claims.exp:validSince+86400),now&&validSince&&validUntil&&now>=validSince&&now<=validUntil},issuedAtTime=function(token){var claims=decode(token).claims;return"object"==typeof claims&&claims.hasOwnProperty("iat")?claims.iat:null},isValidFormat=function(token){var decoded=decode(token),claims=decoded.claims;return!!decoded.signature&&!!claims&&"object"==typeof claims&&claims.hasOwnProperty("iat")},isAdmin=function(token){var claims=decode(token).claims;return"object"==typeof claims&&!0===claims.admin},contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)},safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]},forEach=function(obj,fn){for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&fn(key,obj[key])},extend=function(objTo,objFrom){return forEach(objFrom,function(key,value){objTo[key]=value}),objTo},clone=function(obj){return extend({},obj)},isNonNullObject=function(obj){return"object"==typeof obj&&null!==obj},isEmpty=function(obj){for(var key in obj)return!1;return!0},getCount=function(obj){var rv=0;for(var key in obj)rv++;return rv},map=function(obj,f,opt_obj){var res={};for(var key in obj)res[key]=f.call(opt_obj,obj[key],key,obj);return res},findKey=function(obj,fn,opt_this){for(var key in obj)if(fn.call(opt_this,obj[key],key,obj))return key},findValue=function(obj,fn,opt_this){var key=findKey(obj,fn,opt_this);return key&&obj[key]},getAnyKey=function(obj){for(var key in obj)return key},getValues=function(obj){var res=[],i=0;for(var key in obj)res[i++]=obj[key];return res},every=function(obj,fn){for(var key in obj)if(Object.prototype.hasOwnProperty.call(obj,key)&&!fn(key,obj[key]))return!1;return!0},querystring=function(querystringParams){var params=[];return forEach(querystringParams,function(key,value){Array.isArray(value)?value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+"="+encodeURIComponent(arrayVal))}):params.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}),params.length?"&"+params.join("&"):""},querystringDecode=function(querystring){var obj={};return querystring.replace(/^\?/,"").split("&").forEach(function(token){if(token){var key=token.split("=");obj[key[0]]=key[1]}}),obj},Hash=function(){function Hash(){this.blockSize=-1}return Hash}(),Sha1=function(_super){function Sha1(){var _this=_super.call(this)||this;_this.chain_=[],_this.buf_=[],_this.W_=[],_this.pad_=[],_this.inbuf_=0,_this.total_=0,_this.blockSize=64,_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i)_this.pad_[i]=0;return _this.reset(),_this}return tslib_1.__extends(Sha1,_super),Sha1.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},Sha1.prototype.compress_=function(buf,opt_offset){opt_offset||(opt_offset=0);var W=this.W_;if("string"==typeof buf)for(var i=0;i<16;i++)W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3),opt_offset+=4;else for(var i=0;i<16;i++)W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3],opt_offset+=4;for(var i=16;i<80;i++){var t=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=4294967295&(t<<1|t>>>31)}for(var f,k,a=this.chain_[0],b=this.chain_[1],c=this.chain_[2],d=this.chain_[3],e=this.chain_[4],i=0;i<80;i++){i<40?i<20?(f=d^b&(c^d),k=1518500249):(f=b^c^d,k=1859775393):i<60?(f=b&c|d&(b|c),k=2400959708):(f=b^c^d,k=3395469782);var t=(a<<5|a>>>27)+f+e+k+W[i]&4294967295;e=d,d=c,c=4294967295&(b<<30|b>>>2),b=a,a=t}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+b&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+e&4294967295},Sha1.prototype.update=function(bytes,opt_length){if(null!=bytes){void 0===opt_length&&(opt_length=bytes.length);for(var lengthMinusBlock=opt_length-this.blockSize,n=0,buf=this.buf_,inbuf=this.inbuf_;n<opt_length;){if(0==inbuf)for(;n<=lengthMinusBlock;)this.compress_(bytes,n),n+=this.blockSize;if("string"==typeof bytes){for(;n<opt_length;)if(buf[inbuf]=bytes.charCodeAt(n),++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}else for(;n<opt_length;)if(buf[inbuf]=bytes[n],++inbuf,++n,inbuf==this.blockSize){this.compress_(buf),inbuf=0;break}}this.inbuf_=inbuf,this.total_+=opt_length}},Sha1.prototype.digest=function(){var digest=[],totalBits=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&totalBits,totalBits/=256;this.compress_(this.buf_);for(var n=0,i=0;i<5;i++)for(var j=24;j>=0;j-=8)digest[n]=this.chain_[i]>>j&255,++n;return digest},Sha1}(Hash),ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=onNoObservers,this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}return ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})},ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)}),this.close(error)},ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()}),this.close()},ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var observer,_this=this;if(void 0===nextOrObserver&&void 0===error&&void 0===complete)throw new Error("Missing Observer.");observer=implementsAnyMethods(nextOrObserver,["next","error","complete"])?nextOrObserver:{next:nextOrObserver,error:error,complete:complete},void 0===observer.next&&(observer.next=noop),void 0===observer.error&&(observer.error=noop),void 0===observer.complete&&(observer.complete=noop);var unsub=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{_this.finalError?observer.error(_this.finalError):observer.complete()}catch(e){}}),this.observers.push(observer),unsub},ObserverProxy.prototype.unsubscribeOne=function(i){void 0!==this.observers&&void 0!==this.observers[i]&&(delete this.observers[i],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},ObserverProxy.prototype.forEachObserver=function(fn){if(!this.finalized)for(var i=0;i<this.observers.length;i++)this.sendOne(i,fn)},ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(void 0!==_this.observers&&void 0!==_this.observers[i])try{fn(_this.observers[i])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},ObserverProxy.prototype.close=function(err){var _this=this;this.finalized||(this.finalized=!0,void 0!==err&&(this.finalError=err),this.task.then(function(){_this.observers=void 0,_this.onNoObservers=void 0}))},ObserverProxy}(),validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount?argError="at least "+minCount:argCount>maxCount&&(argError=0===maxCount?"none":"no more than "+maxCount),argError){var error=fnName+" failed: Was called with "+argCount+(1===argCount?" argument.":" arguments.")+" Expects "+argError+".";throw new Error(error)}},stringToByteArray$1=function(str){for(var out=[],p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=55296&&c<=56319){var high=c-55296;i++,assert(i<str.length,"Surrogate pair missing trail surrogate.");c=65536+(high<<10)+(str.charCodeAt(i)-56320)}c<128?out[p++]=c:c<2048?(out[p++]=c>>6|192,out[p++]=63&c|128):c<65536?(out[p++]=c>>12|224,out[p++]=c>>6&63|128,out[p++]=63&c|128):(out[p++]=c>>18|240,out[p++]=c>>12&63|128,out[p++]=c>>6&63|128,out[p++]=63&c|128)}return out},stringLength=function(str){for(var p=0,i=0;i<str.length;i++){var c=str.charCodeAt(i);c<128?p++:c<2048?p+=2:c>=55296&&c<=56319?(p+=4,i++):p+=3}return p};exports.assert=assert,exports.assertionError=assertionError,exports.base64=base64,exports.base64Decode=base64Decode,exports.base64Encode=base64Encode,exports.CONSTANTS=CONSTANTS,exports.deepCopy=deepCopy,exports.deepExtend=deepExtend,exports.patchProperty=patchProperty,exports.Deferred=Deferred,exports.getUA=getUA,exports.isMobileCordova=isMobileCordova,exports.isNodeSdk=isNodeSdk,exports.isReactNative=isReactNative,exports.ErrorFactory=ErrorFactory,exports.FirebaseError=FirebaseError,exports.patchCapture=patchCapture,exports.jsonEval=jsonEval,exports.stringify=stringify,exports.decode=decode,exports.isAdmin=isAdmin,exports.issuedAtTime=issuedAtTime,exports.isValidFormat=isValidFormat,exports.isValidTimestamp=isValidTimestamp,exports.clone=clone,exports.contains=contains,exports.every=every,exports.extend=extend,exports.findKey=findKey,exports.findValue=findValue,exports.forEach=forEach,exports.getAnyKey=getAnyKey,exports.getCount=getCount,exports.getValues=getValues,exports.isEmpty=isEmpty,exports.isNonNullObject=isNonNullObject,exports.map=map,exports.safeGet=safeGet,exports.querystring=querystring,exports.querystringDecode=querystringDecode,exports.Sha1=Sha1,exports.async=async,exports.createSubscribe=createSubscribe,exports.errorPrefix=errorPrefix,exports.validateArgCount=validateArgCount,exports.validateCallback=validateCallback,exports.validateContextObject=validateContextObject,exports.validateNamespace=validateNamespace,exports.stringLength=stringLength,exports.stringToByteArray=stringToByteArray$1},{tslib:78}],6:[function(require,module,exports){"use strict";function placeHoldersCount(b64){var len=b64.length;if(len%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===b64[len-2]?2:"="===b64[len-1]?1:0}function byteLength(b64){return 3*b64.length/4-placeHoldersCount(b64)}function toByteArray(b64){var i,l,tmp,placeHolders,arr,len=b64.length;placeHolders=placeHoldersCount(b64),arr=new Arr(3*len/4-placeHolders),l=placeHolders>0?len-4:len;var L=0;for(i=0;i<l;i+=4)tmp=revLookup[b64.charCodeAt(i)]<<18|revLookup[b64.charCodeAt(i+1)]<<12|revLookup[b64.charCodeAt(i+2)]<<6|revLookup[b64.charCodeAt(i+3)],arr[L++]=tmp>>16&255,arr[L++]=tmp>>8&255,arr[L++]=255&tmp;return 2===placeHolders?(tmp=revLookup[b64.charCodeAt(i)]<<2|revLookup[b64.charCodeAt(i+1)]>>4,arr[L++]=255&tmp):1===placeHolders&&(tmp=revLookup[b64.charCodeAt(i)]<<10|revLookup[b64.charCodeAt(i+1)]<<4|revLookup[b64.charCodeAt(i+2)]>>2,arr[L++]=tmp>>8&255,arr[L++]=255&tmp),arr}function tripletToBase64(num){return lookup[num>>18&63]+lookup[num>>12&63]+lookup[num>>6&63]+lookup[63&num]}function encodeChunk(uint8,start,end){for(var tmp,output=[],i=start;i<end;i+=3)tmp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output.push(tripletToBase64(tmp));return output.join("")}function fromByteArray(uint8){for(var tmp,len=uint8.length,extraBytes=len%3,output="",parts=[],i=0,len2=len-extraBytes;i<len2;i+=16383)parts.push(encodeChunk(uint8,i,i+16383>len2?len2:i+16383));return 1===extraBytes?(tmp=uint8[len-1],output+=lookup[tmp>>2],output+=lookup[tmp<<4&63],output+="=="):2===extraBytes&&(tmp=(uint8[len-2]<<8)+uint8[len-1],output+=lookup[tmp>>10],output+=lookup[tmp>>4&63],output+=lookup[tmp<<2&63],output+="="),parts.push(output),parts.join("")}exports.byteLength=byteLength,exports.toByteArray=toByteArray,exports.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63},{}],7:[function(require,module,exports){},{}],8:[function(require,module,exports){arguments[4][7][0].apply(exports,arguments)},{dup:7}],9:[function(require,module,exports){"use strict";function createBuffer(length){if(length>K_MAX_LENGTH)throw new RangeError("Invalid typed array length");var buf=new Uint8Array(length);return buf.__proto__=Buffer.prototype,buf}function Buffer(arg,encodingOrOffset,length){if("number"==typeof arg){if("string"==typeof encodingOrOffset)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(arg)}return from(arg,encodingOrOffset,length)}function from(value,encodingOrOffset,length){if("number"==typeof value)throw new TypeError('"value" argument must not be a number');return isArrayBuffer(value)?fromArrayBuffer(value,encodingOrOffset,length):"string"==typeof value?fromString(value,encodingOrOffset):fromObject(value)}function assertSize(size){if("number"!=typeof size)throw new TypeError('"size" argument must be a number');if(size<0)throw new RangeError('"size" argument must not be negative')}function alloc(size,fill,encoding){return assertSize(size),size<=0?createBuffer(size):void 0!==fill?"string"==typeof encoding?createBuffer(size).fill(fill,encoding):createBuffer(size).fill(fill):createBuffer(size)}function allocUnsafe(size){return assertSize(size),createBuffer(size<0?0:0|checked(size))}function fromString(string,encoding){if("string"==typeof encoding&&""!==encoding||(encoding="utf8"),!Buffer.isEncoding(encoding))throw new TypeError('"encoding" must be a valid string encoding');var length=0|byteLength(string,encoding),buf=createBuffer(length),actual=buf.write(string,encoding);return actual!==length&&(buf=buf.slice(0,actual)),buf}function fromArrayLike(array){for(var length=array.length<0?0:0|checked(array.length),buf=createBuffer(length),i=0;i<length;i+=1)buf[i]=255&array[i];return buf}function fromArrayBuffer(array,byteOffset,length){if(byteOffset<0||array.byteLength<byteOffset)throw new RangeError("'offset' is out of bounds");if(array.byteLength<byteOffset+(length||0))throw new RangeError("'length' is out of bounds");var buf;return buf=void 0===byteOffset&&void 0===length?new Uint8Array(array):void 0===length?new Uint8Array(array,byteOffset):new Uint8Array(array,byteOffset,length),buf.__proto__=Buffer.prototype,buf}function fromObject(obj){if(Buffer.isBuffer(obj)){var len=0|checked(obj.length),buf=createBuffer(len);return 0===buf.length?buf:(obj.copy(buf,0,0,len),buf)}if(obj){if(isArrayBufferView(obj)||"length"in obj)return"number"!=typeof obj.length||numberIsNaN(obj.length)?createBuffer(0):fromArrayLike(obj);if("Buffer"===obj.type&&Array.isArray(obj.data))return fromArrayLike(obj.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(length){if(length>=K_MAX_LENGTH)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K_MAX_LENGTH.toString(16)+" bytes");return 0|length}function SlowBuffer(length){return+length!=length&&(length=0),Buffer.alloc(+length)}function byteLength(string,encoding){if(Buffer.isBuffer(string))return string.length;if(isArrayBufferView(string)||isArrayBuffer(string))return string.byteLength;"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"latin1":case"binary":return len;case"utf8":case"utf-8":case void 0:return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if((void 0===start||start<0)&&(start=0),start>this.length)return"";if((void 0===end||end>this.length)&&(end=this.length),end<=0)return"";if(end>>>=0,start>>>=0,end<=start)return"";for(encoding||(encoding="utf8");;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"latin1":case"binary":return latin1Slice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function swap(b,n,m){var i=b[n];b[n]=b[m],b[m]=i}function bidirectionalIndexOf(buffer,val,byteOffset,encoding,dir){if(0===buffer.length)return-1;if("string"==typeof byteOffset?(encoding=byteOffset,byteOffset=0):byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset=+byteOffset,numberIsNaN(byteOffset)&&(byteOffset=dir?0:buffer.length-1),byteOffset<0&&(byteOffset=buffer.length+byteOffset),byteOffset>=buffer.length){if(dir)return-1;byteOffset=buffer.length-1}else if(byteOffset<0){if(!dir)return-1;byteOffset=0}if("string"==typeof val&&(val=Buffer.from(val,encoding)),Buffer.isBuffer(val))return 0===val.length?-1:arrayIndexOf(buffer,val,byteOffset,encoding,dir);if("number"==typeof val)return val&=255,"function"==typeof Uint8Array.prototype.indexOf?dir?Uint8Array.prototype.indexOf.call(buffer,val,byteOffset):Uint8Array.prototype.lastIndexOf.call(buffer,val,byteOffset):arrayIndexOf(buffer,[val],byteOffset,encoding,dir);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(arr,val,byteOffset,encoding,dir){function read(buf,i){return 1===indexSize?buf[i]:buf.readUInt16BE(i*indexSize)}var indexSize=1,arrLength=arr.length,valLength=val.length;if(void 0!==encoding&&("ucs2"===(encoding=String(encoding).toLowerCase())||"ucs-2"===encoding||"utf16le"===encoding||"utf-16le"===encoding)){if(arr.length<2||val.length<2)return-1;indexSize=2,arrLength/=2,valLength/=2,byteOffset/=2}var i;if(dir){var foundIndex=-1;for(i=byteOffset;i<arrLength;i++)if(read(arr,i)===read(val,-1===foundIndex?0:i-foundIndex)){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===valLength)return foundIndex*indexSize}else-1!==foundIndex&&(i-=i-foundIndex),foundIndex=-1}else for(byteOffset+valLength>arrLength&&(byteOffset=arrLength-valLength),i=byteOffset;i>=0;i--){for(var found=!0,j=0;j<valLength;j++)if(read(arr,i+j)!==read(val,j)){found=!1;break}if(found)return i}return-1}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length))>remaining&&(length=remaining):length=remaining;var strLen=string.length;if(strLen%2!=0)throw new TypeError("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;++i){var parsed=parseInt(string.substr(2*i,2),16);if(numberIsNaN(parsed))return i;buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function latin1Write(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128==(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte)>127&&(codePoint=tempCodePoint);break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128==(192&secondByte)&&128==(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte)>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint);break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128==(192&secondByte)&&128==(192&thirdByte)&&128==(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte)>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint)}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(127&buf[i]);return ret}function latin1Slice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;++i)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;++i)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!=0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError('"buffer" argument must be a Buffer instance');if(value>max||value<min)throw new RangeError('"value" argument is out of bounds');if(offset+ext>buf.length)throw new RangeError("Index out of range")}function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>buf.length)throw new RangeError("Index out of range");if(offset<0)throw new RangeError("Index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}
function writeDouble(buf,value,offset,littleEndian,noAssert){return value=+value,offset>>>=0,noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=str.trim().replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!=0;)str+="=";return str}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;++i){if((codePoint=string.charCodeAt(i))>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=65536+(leadSurrogate-55296<<10|codePoint-56320)}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;++i)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);++i)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);++i)dst[i+offset]=src[i];return i}function isArrayBuffer(obj){return obj instanceof ArrayBuffer||null!=obj&&null!=obj.constructor&&"ArrayBuffer"===obj.constructor.name&&"number"==typeof obj.byteLength}function isArrayBufferView(obj){return"function"==typeof ArrayBuffer.isView&&ArrayBuffer.isView(obj)}function numberIsNaN(obj){return obj!==obj}var base64=require("base64-js"),ieee754=require("ieee754");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50;var K_MAX_LENGTH=2147483647;exports.kMaxLength=K_MAX_LENGTH,Buffer.TYPED_ARRAY_SUPPORT=function(){try{var arr=new Uint8Array(1);return arr.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===arr.foo()}catch(e){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(value,encodingOrOffset,length){return from(value,encodingOrOffset,length)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(size,fill,encoding){return alloc(size,fill,encoding)},Buffer.allocUnsafe=function(size){return allocUnsafe(size)},Buffer.allocUnsafeSlow=function(size){return allocUnsafe(size)},Buffer.isBuffer=function(b){return null!=b&&!0===b._isBuffer},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len;++i)if(a[i]!==b[i]){x=a[i],y=b[i];break}return x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!Array.isArray(list))throw new TypeError('"list" argument must be an Array of Buffers');if(0===list.length)return Buffer.alloc(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;++i)length+=list[i].length;var buffer=Buffer.allocUnsafe(length),pos=0;for(i=0;i<list.length;++i){var buf=list[i];if(!Buffer.isBuffer(buf))throw new TypeError('"list" argument must be an Array of Buffers');buf.copy(buffer,pos),pos+=buf.length}return buffer},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var len=this.length;if(len%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<len;i+=2)swap(this,i,i+1);return this},Buffer.prototype.swap32=function(){var len=this.length;if(len%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<len;i+=4)swap(this,i,i+3),swap(this,i+1,i+2);return this},Buffer.prototype.swap64=function(){var len=this.length;if(len%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<len;i+=8)swap(this,i,i+7),swap(this,i+1,i+6),swap(this,i+2,i+5),swap(this,i+3,i+4);return this},Buffer.prototype.toString=function(){var length=this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(target,start,end,thisStart,thisEnd){if(!Buffer.isBuffer(target))throw new TypeError("Argument must be a Buffer");if(void 0===start&&(start=0),void 0===end&&(end=target?target.length:0),void 0===thisStart&&(thisStart=0),void 0===thisEnd&&(thisEnd=this.length),start<0||end>target.length||thisStart<0||thisEnd>this.length)throw new RangeError("out of range index");if(thisStart>=thisEnd&&start>=end)return 0;if(thisStart>=thisEnd)return-1;if(start>=end)return 1;if(start>>>=0,end>>>=0,thisStart>>>=0,thisEnd>>>=0,this===target)return 0;for(var x=thisEnd-thisStart,y=end-start,len=Math.min(x,y),thisCopy=this.slice(thisStart,thisEnd),targetCopy=target.slice(start,end),i=0;i<len;++i)if(thisCopy[i]!==targetCopy[i]){x=thisCopy[i],y=targetCopy[i];break}return x<y?-1:y<x?1:0},Buffer.prototype.includes=function(val,byteOffset,encoding){return-1!==this.indexOf(val,byteOffset,encoding)},Buffer.prototype.indexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!0)},Buffer.prototype.lastIndexOf=function(val,byteOffset,encoding){return bidirectionalIndexOf(this,val,byteOffset,encoding,!1)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else{if(!isFinite(offset))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");offset>>>=0,isFinite(length)?(length>>>=0,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0)}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("Attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"latin1":case"binary":return latin1Write(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len)<0&&(start=0):start>len&&(start=len),end<0?(end+=len)<0&&(end=0):end>len&&(end=len),end<start&&(end=start);var newBuf=this.subarray(start,end);return newBuf.__proto__=Buffer.prototype,newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset>>>=0,byteLength>>>=0,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){offset>>>=0,noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return offset>>>=0,noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,byteLength>>>=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,byteLength>>>=0,!noAssert){checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength)-1,0)}var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,255,0),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,65535,0),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value,offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,4294967295,0),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i-1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset>>>=0,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)value<0&&0===sub&&0!==this[offset+i+1]&&(sub=1),this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,1,127,-128),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=255&value,this[offset+1]=value>>>8,offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,2,32767,-32768),this[offset]=value>>>8,this[offset+1]=255&value,offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24,offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset>>>=0,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value,offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;--i)target[i+targetStart]=this[i+start];else if(len<1e3)for(i=0;i<len;++i)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(val,start,end,encoding){if("string"==typeof val){if("string"==typeof start?(encoding=start,start=0,end=this.length):"string"==typeof end&&(encoding=end,end=this.length),1===val.length){var code=val.charCodeAt(0);code<256&&(val=code)}if(void 0!==encoding&&"string"!=typeof encoding)throw new TypeError("encoding must be a string");if("string"==typeof encoding&&!Buffer.isEncoding(encoding))throw new TypeError("Unknown encoding: "+encoding)}else"number"==typeof val&&(val&=255);if(start<0||this.length<start||this.length<end)throw new RangeError("Out of range index");if(end<=start)return this;start>>>=0,end=void 0===end?this.length:end>>>0,val||(val=0);var i;if("number"==typeof val)for(i=start;i<end;++i)this[i]=val;else{var bytes=Buffer.isBuffer(val)?val:new Buffer(val,encoding),len=bytes.length;for(i=0;i<end-start;++i)this[i+start]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g},{"base64-js":6,ieee754:51}],10:[function(require,module,exports){"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return util.isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/"),url=uSplit.join(splitter);var rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],this.query=parseQueryString?querystring.parse(this.search.substr(1)):this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);-1!==hec&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}var auth,atSign;atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd),-1!==atSign&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);-1!==hec&&(-1===hostEnd||hec<hostEnd)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)part.charCodeAt(j)>127?newpart+="x":newpart+=part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=encodeURIComponent(auth),auth=auth.replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&!1!==host?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}),search=search.replace("#","%23"),protocol+host+pathname+search+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)last=srcPath[i],"."===last?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return mustEndAbs=mustEndAbs||result.host&&srcPath.length,mustEndAbs&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(port=port[0],":"!==port&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":11,punycode:58,querystring:61}],11:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}],12:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],13:[function(require,module,exports){(function(Buffer){function isArray(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return"[object Date]"===objectToString(d)}function isError(e){
return"[object Error]"===objectToString(e)||e instanceof Error}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||void 0===arg}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:require("../../is-buffer/index.js")})},{"../../is-buffer/index.js":53}],14:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function ascendingComparator(f){return function(d,x){return ascending(f(d),x)}}function pair(a,b){return[a,b]}function tickIncrement(start,stop,count){var step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log(step)/Math.LN10),error=step/Math.pow(10,power);return power>=0?(error>=e10?10:error>=e5?5:error>=e2?2:1)*Math.pow(10,power):-Math.pow(10,-power)/(error>=e10?10:error>=e5?5:error>=e2?2:1)}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;return error>=e10?step1*=10:error>=e5?step1*=5:error>=e2&&(step1*=2),stop<start?-step1:step1}function length(d){return d.length}var ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},bisector=function(compare){return 1===compare.length&&(compare=ascendingComparator(compare)),{left:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}},ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left,pairs=function(array,f){null==f&&(f=pair);for(var i=0,n=array.length-1,p=array[0],pairs=new Array(n<0?0:n);i<n;)pairs[i]=f(p,p=array[++i]);return pairs},cross=function(values0,values1,reduce){var i0,i1,i,value0,n0=values0.length,n1=values1.length,values=new Array(n0*n1);for(null==reduce&&(reduce=pair),i0=i=0;i0<n0;++i0)for(value0=values0[i0],i1=0;i1<n1;++i1,++i)values[i]=reduce(value0,values1[i1]);return values},descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},number=function(x){return null===x?NaN:+x},variance=function(values,valueof){var value,delta,n=values.length,m=0,i=-1,mean=0,sum=0;if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))||(delta=value-mean,mean+=delta/++m,sum+=delta*(value-mean));else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))||(delta=value-mean,mean+=delta/++m,sum+=delta*(value-mean));if(m>1)return sum/(m-1)},deviation=function(array,f){var v=variance(array,f);return v?Math.sqrt(v):v},extent=function(values,valueof){var value,min,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=max=value;++i<n;)null!=(value=values[i])&&(min>value&&(min=value),max<value&&(max=value))}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&(min>value&&(min=value),max<value&&(max=value));return[min,max]},array=Array.prototype,slice=array.slice,map=array.map,constant=function(x){return function(){return x}},identity=function(x){return x},range=function(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;for(var i=-1,n=0|Math.max(0,Math.ceil((stop-start)/step)),range=new Array(n);++i<n;)range[i]=start+i*step;return range},e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2),ticks=function(start,stop,count){var reverse,n,ticks,step,i=-1;if(stop=+stop,start=+start,count=+count,start===stop&&count>0)return[start];if((reverse=stop<start)&&(n=start,start=stop,stop=n),0===(step=tickIncrement(start,stop,count))||!isFinite(step))return[];if(step>0)for(start=Math.ceil(start/step),stop=Math.floor(stop/step),ticks=new Array(n=Math.ceil(stop-start+1));++i<n;)ticks[i]=(start+i)*step;else for(start=Math.floor(start*step),stop=Math.ceil(stop*step),ticks=new Array(n=Math.ceil(start-stop+1));++i<n;)ticks[i]=(start-i)/step;return reverse&&ticks.reverse(),ticks},sturges=function(values){return Math.ceil(Math.log(values.length)/Math.LN2)+1},histogram=function(){function histogram(data){var i,x,n=data.length,values=new Array(n);for(i=0;i<n;++i)values[i]=value(data[i],i,data);var xz=domain(values),x0=xz[0],x1=xz[1],tz=threshold(values,x0,x1);Array.isArray(tz)||(tz=tickStep(x0,x1,tz),tz=range(Math.ceil(x0/tz)*tz,Math.floor(x1/tz)*tz,tz));for(var m=tz.length;tz[0]<=x0;)tz.shift(),--m;for(;tz[m-1]>x1;)tz.pop(),--m;var bin,bins=new Array(m+1);for(i=0;i<=m;++i)bin=bins[i]=[],bin.x0=i>0?tz[i-1]:x0,bin.x1=i<m?tz[i]:x1;for(i=0;i<n;++i)x=values[i],x0<=x&&x<=x1&&bins[bisectRight(tz,x,0,m)].push(data[i]);return bins}var value=identity,domain=extent,threshold=sturges;return histogram.value=function(_){return arguments.length?(value="function"==typeof _?_:constant(_),histogram):value},histogram.domain=function(_){return arguments.length?(domain="function"==typeof _?_:constant([_[0],_[1]]),histogram):domain},histogram.thresholds=function(_){return arguments.length?(threshold="function"==typeof _?_:constant(Array.isArray(_)?slice.call(_):_),histogram):threshold},histogram},quantile=function(values,p,valueof){if(null==valueof&&(valueof=number),n=values.length){if((p=+p)<=0||n<2)return+valueof(values[0],0,values);if(p>=1)return+valueof(values[n-1],n-1,values);var n,i=(n-1)*p,i0=Math.floor(i),value0=+valueof(values[i0],i0,values);return value0+(+valueof(values[i0+1],i0+1,values)-value0)*(i-i0)}},freedmanDiaconis=function(values,min,max){return values=map.call(values,number).sort(ascending),Math.ceil((max-min)/(2*(quantile(values,.75)-quantile(values,.25))*Math.pow(values.length,-1/3)))},scott=function(values,min,max){return Math.ceil((max-min)/(3.5*deviation(values)*Math.pow(values.length,-1/3)))},max=function(values,valueof){var value,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(max=value;++i<n;)null!=(value=values[i])&&value>max&&(max=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&value>max&&(max=value);return max},mean=function(values,valueof){var value,n=values.length,m=n,i=-1,sum=0;if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))?--m:sum+=value;else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))?--m:sum+=value;if(m)return sum/m},median=function(values,valueof){var value,n=values.length,i=-1,numbers=[];if(null==valueof)for(;++i<n;)isNaN(value=number(values[i]))||numbers.push(value);else for(;++i<n;)isNaN(value=number(valueof(values[i],i,values)))||numbers.push(value);return quantile(numbers.sort(ascending),.5)},merge=function(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(array=arrays[n],m=array.length;--m>=0;)merged[--j]=array[m];return merged},min=function(values,valueof){var value,min,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=value;++i<n;)null!=(value=values[i])&&min>value&&(min=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=value;++i<n;)null!=(value=valueof(values[i],i,values))&&min>value&&(min=value);return min},permute=function(array,indexes){for(var i=indexes.length,permutes=new Array(i);i--;)permutes[i]=array[indexes[i]];return permutes},scan=function(values,compare){if(n=values.length){var n,xi,i=0,j=0,xj=values[j];for(null==compare&&(compare=ascending);++i<n;)(compare(xi=values[i],xj)<0||0!==compare(xj,xj))&&(xj=xi,j=i);return 0===compare(xj,xj)?j:void 0}},shuffle=function(array,i0,i1){for(var t,i,m=(null==i1?array.length:i1)-(i0=null==i0?0:+i0);m;)i=Math.random()*m--|0,t=array[m+i0],array[m+i0]=array[i+i0],array[i+i0]=t;return array},sum=function(values,valueof){var value,n=values.length,i=-1,sum=0;if(null==valueof)for(;++i<n;)(value=+values[i])&&(sum+=value);else for(;++i<n;)(value=+valueof(values[i],i,values))&&(sum+=value);return sum},transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=min(matrix,length),transpose=new Array(m);++i<m;)for(var n,j=-1,row=transpose[i]=new Array(n);++j<n;)row[j]=matrix[j][i];return transpose},zip=function(){return transpose(arguments)};exports.bisect=bisectRight,exports.bisectRight=bisectRight,exports.bisectLeft=bisectLeft,exports.ascending=ascending,exports.bisector=bisector,exports.cross=cross,exports.descending=descending,exports.deviation=deviation,exports.extent=extent,exports.histogram=histogram,exports.thresholdFreedmanDiaconis=freedmanDiaconis,exports.thresholdScott=scott,exports.thresholdSturges=sturges,exports.max=max,exports.mean=mean,exports.median=median,exports.merge=merge,exports.min=min,exports.pairs=pairs,exports.permute=permute,exports.quantile=quantile,exports.range=range,exports.scan=scan,exports.shuffle=shuffle,exports.sum=sum,exports.ticks=ticks,exports.tickIncrement=tickIncrement,exports.tickStep=tickStep,exports.transpose=transpose,exports.variance=variance,exports.zip=zip,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],15:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function translateX(x){return"translate("+(x+.5)+",0)"}function translateY(y){return"translate(0,"+(y+.5)+")"}function number(scale){return function(d){return+scale(d)}}function center(scale){var offset=Math.max(0,scale.bandwidth()-1)/2;return scale.round()&&(offset=Math.round(offset)),function(d){return+scale(d)+offset}}function entering(){return!this.__axis}function axis(orient,scale){function axis(context){var values=null==tickValues?scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain():tickValues,format=null==tickFormat?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):identity:tickFormat,spacing=Math.max(tickSizeInner,0)+tickPadding,range=scale.range(),range0=+range[0]+.5,range1=+range[range.length-1]+.5,position=(scale.bandwidth?center:number)(scale.copy()),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),line=tick.select("line"),text=tick.select("text");path=path.merge(path.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),tick=tick.merge(tickEnter),line=line.merge(tickEnter.append("line").attr("stroke","#000").attr(x+"2",k*tickSizeInner)),text=text.merge(tickEnter.append("text").attr("fill","#000").attr(x,k*spacing).attr("dy",orient===top?"0em":orient===bottom?"0.71em":"0.32em")),context!==selection&&(path=path.transition(context),tick=tick.transition(context),line=line.transition(context),text=text.transition(context),tickExit=tickExit.transition(context).attr("opacity",epsilon).attr("transform",function(d){return isFinite(d=position(d))?transform(d):this.getAttribute("transform")}),tickEnter.attr("opacity",epsilon).attr("transform",function(d){var p=this.parentNode.__axis;return transform(p&&isFinite(p=p(d))?p:position(d))})),tickExit.remove(),path.attr("d",orient===left||orient==right?"M"+k*tickSizeOuter+","+range0+"H0.5V"+range1+"H"+k*tickSizeOuter:"M"+range0+","+k*tickSizeOuter+"V0.5H"+range1+"V"+k*tickSizeOuter),tick.attr("opacity",1).attr("transform",function(d){return transform(position(d))}),line.attr(x+"2",k*tickSizeInner),text.attr(x,k*spacing).text(format),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",orient===right?"start":orient===left?"end":"middle"),selection.each(function(){this.__axis=position})}var tickArguments=[],tickValues=null,tickFormat=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3,k=orient===top||orient===left?-1:1,x=orient===left||orient===right?"x":"y",transform=orient===top||orient===bottom?translateX:translateY;return axis.scale=function(_){return arguments.length?(scale=_,axis):scale},axis.ticks=function(){return tickArguments=slice.call(arguments),axis},axis.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:slice.call(_),axis):tickArguments.slice()},axis.tickValues=function(_){return arguments.length?(tickValues=null==_?null:slice.call(_),axis):tickValues&&tickValues.slice()},axis.tickFormat=function(_){return arguments.length?(tickFormat=_,axis):tickFormat},axis.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,axis):tickSizeInner},axis.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,axis):tickSizeInner},axis.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,axis):tickSizeOuter},axis.tickPadding=function(_){return arguments.length?(tickPadding=+_,axis):tickPadding},axis}function axisTop(scale){return axis(top,scale)}function axisRight(scale){return axis(right,scale)}function axisBottom(scale){return axis(bottom,scale)}function axisLeft(scale){return axis(left,scale)}var slice=Array.prototype.slice,identity=function(x){return x},top=1,right=2,bottom=3,left=4,epsilon=1e-6;exports.axisTop=axisTop,exports.axisRight=axisRight,exports.axisBottom=axisBottom,exports.axisLeft=axisLeft,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],16:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-dispatch"),require("d3-drag"),require("d3-interpolate"),require("d3-selection"),require("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],factory):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Dispatch,d3Drag,d3Interpolate,d3Selection,d3Transition){"use strict";function nopropagation(){d3Selection.event.stopImmediatePropagation()}function type(t){return{type:t}}function defaultFilter(){return!d3Selection.event.button}function defaultExtent(){var svg=this.ownerSVGElement||this;return[[0,0],[svg.width.baseVal.value,svg.height.baseVal.value]]}function local(node){for(;!node.__brush;)if(!(node=node.parentNode))return;return node.__brush}function empty(extent){return extent[0][0]===extent[1][0]||extent[0][1]===extent[1][1]}function brushSelection(node){var state=node.__brush;return state?state.dim.output(state.selection):null}function brushX(){return brush$1(X)}function brushY(){return brush$1(Y)}function brush$1(dim){function brush(group){var overlay=group.property("__brush",initialize).selectAll(".overlay").data([type("overlay")]);overlay.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",cursors.overlay).merge(overlay).each(function(){var extent=local(this).extent;d3Selection.select(this).attr("x",extent[0][0]).attr("y",extent[0][1]).attr("width",extent[1][0]-extent[0][0]).attr("height",extent[1][1]-extent[0][1])}),group.selectAll(".selection").data([type("selection")]).enter().append("rect").attr("class","selection").attr("cursor",cursors.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var handle=group.selectAll(".handle").data(dim.handles,function(d){return d.type});handle.exit().remove(),handle.enter().append("rect").attr("class",function(d){return"handle handle--"+d.type}).attr("cursor",function(d){return cursors[d.type]}),group.each(redraw).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",started)}function redraw(){var group=d3Selection.select(this),selection=local(this).selection;selection?(group.selectAll(".selection").style("display",null).attr("x",selection[0][0]).attr("y",selection[0][1]).attr("width",selection[1][0]-selection[0][0]).attr("height",selection[1][1]-selection[0][1]),group.selectAll(".handle").style("display",null).attr("x",function(d){return"e"===d.type[d.type.length-1]?selection[1][0]-handleSize/2:selection[0][0]-handleSize/2}).attr("y",function(d){return"s"===d.type[0]?selection[1][1]-handleSize/2:selection[0][1]-handleSize/2}).attr("width",function(d){return"n"===d.type||"s"===d.type?selection[1][0]-selection[0][0]+handleSize:handleSize}).attr("height",function(d){return"e"===d.type||"w"===d.type?selection[1][1]-selection[0][1]+handleSize:handleSize})):group.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function emitter(that,args){return that.__brush.emitter||new Emitter(that,args)}function Emitter(that,args){this.that=that,this.args=args,this.state=that.__brush,this.active=0}function started(){function moved(){var point1=d3Selection.mouse(that);!shifting||lockX||lockY||(Math.abs(point1[0]-point[0])>Math.abs(point1[1]-point[1])?lockY=!0:lockX=!0),point=point1,moving=!0,noevent(),move()}function move(){var t;switch(dx=point[0]-point0[0],dy=point[1]-point0[1],mode){case MODE_SPACE:case MODE_DRAG:signX&&(dx=Math.max(W-w0,Math.min(E-e0,dx)),w1=w0+dx,e1=e0+dx),signY&&(dy=Math.max(N-n0,Math.min(S-s0,dy)),n1=n0+dy,s1=s0+dy);break;case MODE_HANDLE:signX<0?(dx=Math.max(W-w0,Math.min(E-w0,dx)),w1=w0+dx,e1=e0):signX>0&&(dx=Math.max(W-e0,Math.min(E-e0,dx)),w1=w0,e1=e0+dx),signY<0?(dy=Math.max(N-n0,Math.min(S-n0,dy)),n1=n0+dy,s1=s0):signY>0&&(dy=Math.max(N-s0,Math.min(S-s0,dy)),n1=n0,s1=s0+dy);break;case MODE_CENTER:signX&&(w1=Math.max(W,Math.min(E,w0-dx*signX)),e1=Math.max(W,Math.min(E,e0+dx*signX))),signY&&(n1=Math.max(N,Math.min(S,n0-dy*signY)),s1=Math.max(N,Math.min(S,s0+dy*signY)))}e1<w1&&(signX*=-1,t=w0,w0=e0,e0=t,t=w1,w1=e1,e1=t,type in flipX&&overlay.attr("cursor",cursors[type=flipX[type]])),s1<n1&&(signY*=-1,t=n0,n0=s0,s0=t,t=n1,n1=s1,s1=t,type in flipY&&overlay.attr("cursor",cursors[type=flipY[type]])),state.selection&&(selection=state.selection),lockX&&(w1=selection[0][0],e1=selection[1][0]),lockY&&(n1=selection[0][1],s1=selection[1][1]),selection[0][0]===w1&&selection[0][1]===n1&&selection[1][0]===e1&&selection[1][1]===s1||(state.selection=[[w1,n1],[e1,s1]],redraw.call(that),emit.brush())}function ended(){if(nopropagation(),d3Selection.event.touches){if(d3Selection.event.touches.length)return;touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),group.on("touchmove.brush touchend.brush touchcancel.brush",null)}else d3Drag.dragEnable(d3Selection.event.view,moving),view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);group.attr("pointer-events","all"),overlay.attr("cursor",cursors.overlay),state.selection&&(selection=state.selection),empty(selection)&&(state.selection=null,redraw.call(that)),emit.end()}function keydowned(){switch(d3Selection.event.keyCode){case 16:shifting=signX&&signY;break;case 18:mode===MODE_HANDLE&&(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER,move());break;case 32:mode!==MODE_HANDLE&&mode!==MODE_CENTER||(signX<0?e0=e1-dx:signX>0&&(w0=w1-dx),signY<0?s0=s1-dy:signY>0&&(n0=n1-dy),mode=MODE_SPACE,overlay.attr("cursor",cursors.selection),move());break;default:return}noevent()}function keyupped(){switch(d3Selection.event.keyCode){case 16:shifting&&(lockX=lockY=shifting=!1,move());break;case 18:mode===MODE_CENTER&&(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE,move());break;case 32:mode===MODE_SPACE&&(d3Selection.event.altKey?(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER):(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE),overlay.attr("cursor",cursors[type]),move());break;default:return}noevent()}if(d3Selection.event.touches){if(d3Selection.event.changedTouches.length<d3Selection.event.touches.length)return noevent()}else if(touchending)return;if(filter.apply(this,arguments)){var w0,w1,n0,n1,e0,e1,s0,s1,dx,dy,moving,lockX,lockY,that=this,type=d3Selection.event.target.__data__.type,mode="selection"===(d3Selection.event.metaKey?type="overlay":type)?MODE_DRAG:d3Selection.event.altKey?MODE_CENTER:MODE_HANDLE,signX=dim===Y?null:signsX[type],signY=dim===X?null:signsY[type],state=local(that),extent=state.extent,selection=state.selection,W=extent[0][0],N=extent[0][1],E=extent[1][0],S=extent[1][1],shifting=signX&&signY&&d3Selection.event.shiftKey,point0=d3Selection.mouse(that),point=point0,emit=emitter(that,arguments).beforestart();"overlay"===type?state.selection=selection=[[w0=dim===Y?W:point0[0],n0=dim===X?N:point0[1]],[e0=dim===Y?E:w0,s0=dim===X?S:n0]]:(w0=selection[0][0],n0=selection[0][1],e0=selection[1][0],s0=selection[1][1]),w1=w0,n1=n0,e1=e0,s1=s0;var group=d3Selection.select(that).attr("pointer-events","none"),overlay=group.selectAll(".overlay").attr("cursor",cursors[type]);if(d3Selection.event.touches)group.on("touchmove.brush",moved,!0).on("touchend.brush touchcancel.brush",ended,!0);else{var view=d3Selection.select(d3Selection.event.view).on("keydown.brush",keydowned,!0).on("keyup.brush",keyupped,!0).on("mousemove.brush",moved,!0).on("mouseup.brush",ended,!0);d3Drag.dragDisable(d3Selection.event.view)}nopropagation(),d3Transition.interrupt(that),redraw.call(that),emit.start()}}function initialize(){var state=this.__brush||{selection:null};return state.extent=extent.apply(this,arguments),state.dim=dim,state}var touchending,extent=defaultExtent,filter=defaultFilter,listeners=d3Dispatch.dispatch(brush,"start","brush","end"),handleSize=6;return brush.move=function(group,selection){group.selection?group.on("start.brush",function(){emitter(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){emitter(this,arguments).end()}).tween("brush",function(){function tween(t){state.selection=1===t&&empty(selection1)?null:i(t),redraw.call(that),emit.brush()}var that=this,state=that.__brush,emit=emitter(that,arguments),selection0=state.selection,selection1=dim.input("function"==typeof selection?selection.apply(this,arguments):selection,state.extent),i=d3Interpolate.interpolate(selection0,selection1);return selection0&&selection1?tween:tween(1)}):group.each(function(){var that=this,args=arguments,state=that.__brush,selection1=dim.input("function"==typeof selection?selection.apply(that,args):selection,state.extent),emit=emitter(that,args).beforestart();d3Transition.interrupt(that),state.selection=null==selection1||empty(selection1)?null:selection1,redraw.call(that),emit.start().brush().end()})},Emitter.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(type){d3Selection.customEvent(new BrushEvent(brush,type,dim.output(this.state.selection)),listeners.apply,listeners,[type,this.that,this.args])}},brush.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),brush):extent},brush.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant(!!_),brush):filter},brush.handleSize=function(_){return arguments.length?(handleSize=+_,brush):handleSize},brush.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?brush:value},brush}var constant=function(x){return function(){return x}},BrushEvent=function(target,type,selection){this.target=target,this.type=type,this.selection=selection},noevent=function(){d3Selection.event.preventDefault(),d3Selection.event.stopImmediatePropagation()},MODE_DRAG={name:"drag"},MODE_SPACE={name:"space"},MODE_HANDLE={name:"handle"},MODE_CENTER={name:"center"},X={name:"x",handles:["e","w"].map(type),input:function(x,e){return x&&[[x[0],e[0][1]],[x[1],e[1][1]]]},output:function(xy){return xy&&[xy[0][0],xy[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(y,e){return y&&[[e[0][0],y[0]],[e[1][0],y[1]]]},output:function(xy){return xy&&[xy[0][1],xy[1][1]]}},XY={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(type),input:function(xy){return xy},output:function(xy){return xy}},cursors={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},flipX={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},flipY={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},signsX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},signsY={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1},brush=function(){return brush$1(XY)};exports.brush=brush,exports.brushX=brushX,exports.brushY=brushY,exports.brushSelection=brushSelection,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-dispatch":20,"d3-drag":21,"d3-interpolate":28,"d3-selection":36,"d3-transition":42}],17:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-array"),require("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-path"],factory):factory(global.d3=global.d3||{},global.d3,global.d3)}(this,function(exports,d3Array,d3Path){"use strict";function compareValue(compare){return function(a,b){return compare(a.source.value+a.target.value,b.source.value+b.target.value)}}function defaultSource(d){return d.source}function defaultTarget(d){return d.target}function defaultRadius(d){return d.radius}function defaultStartAngle(d){return d.startAngle}function defaultEndAngle(d){return d.endAngle}var cos=Math.cos,sin=Math.sin,pi=Math.PI,halfPi=pi/2,tau=2*pi,max=Math.max,chord=function(){function chord(matrix){var k,x,x0,dx,i,j,n=matrix.length,groupSums=[],groupIndex=d3Array.range(n),subgroupIndex=[],chords=[],groups=chords.groups=new Array(n),subgroups=new Array(n*n);for(k=0,i=-1;++i<n;){for(x=0,j=-1;++j<n;)x+=matrix[i][j];groupSums.push(x),subgroupIndex.push(d3Array.range(n)),k+=x}for(sortGroups&&groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])}),sortSubgroups&&subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})}),k=max(0,tau-padAngle*n)/k,dx=k?padAngle:tau/n,x=0,i=-1;++i<n;){for(x0=x,j=-1;++j<n;){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[dj*n+di]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:groupSums[di]},x+=dx}for(i=-1;++i<n;)for(j=i-1;++j<n;){var source=subgroups[j*n+i],target=subgroups[i*n+j];(source.value||target.value)&&chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}return sortChords?chords.sort(sortChords):chords}var padAngle=0,sortGroups=null,sortSubgroups=null,sortChords=null;return chord.padAngle=function(_){return arguments.length?(padAngle=max(0,_),chord):padAngle},chord.sortGroups=function(_){return arguments.length?(sortGroups=_,chord):sortGroups},chord.sortSubgroups=function(_){return arguments.length?(sortSubgroups=_,chord):sortSubgroups},chord.sortChords=function(_){return arguments.length?(null==_?sortChords=null:(sortChords=compareValue(_))._=_,chord):sortChords&&sortChords._},chord},slice=Array.prototype.slice,constant=function(x){return function(){return x}},ribbon=function(){function ribbon(){var buffer,argv=slice.call(arguments),s=source.apply(this,argv),t=target.apply(this,argv),sr=+radius.apply(this,(argv[0]=s,argv)),sa0=startAngle.apply(this,argv)-halfPi,sa1=endAngle.apply(this,argv)-halfPi,sx0=sr*cos(sa0),sy0=sr*sin(sa0),tr=+radius.apply(this,(argv[0]=t,argv)),ta0=startAngle.apply(this,argv)-halfPi,ta1=endAngle.apply(this,argv)-halfPi;if(context||(context=buffer=d3Path.path()),context.moveTo(sx0,sy0),context.arc(0,0,sr,sa0,sa1),sa0===ta0&&sa1===ta1||(context.quadraticCurveTo(0,0,tr*cos(ta0),tr*sin(ta0)),context.arc(0,0,tr,ta0,ta1)),context.quadraticCurveTo(0,0,sx0,sy0),context.closePath(),buffer)return context=null,buffer+""||null}var source=defaultSource,target=defaultTarget,radius=defaultRadius,startAngle=defaultStartAngle,endAngle=defaultEndAngle,context=null;return ribbon.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),ribbon):radius},ribbon.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant(+_),ribbon):startAngle},ribbon.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant(+_),ribbon):endAngle},ribbon.source=function(_){return arguments.length?(source=_,ribbon):source},ribbon.target=function(_){return arguments.length?(target=_,ribbon):target},ribbon.context=function(_){return arguments.length?(context=null==_?null:_,ribbon):context},ribbon};exports.chord=chord,exports.ribbon=ribbon,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-array":14,"d3-path":29}],18:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function Map(){}function map(object,f){var map=new Map;if(object instanceof Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(null==f)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}function createObject(){return{}}function setObject(object,key,value){object[key]=value}function createMap(){return map()}function setMap(map$$1,key,value){map$$1.set(key,value)}function Set(){}function set(object,f){var set=new Set;if(object instanceof Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(null==f)for(;++i<n;)set.add(object[i]);else for(;++i<n;)set.add(f(object[i],i,object))}return set}Map.prototype=map.prototype={constructor:Map,has:function(key){return"$"+key in this},get:function(key){return this["$"+key]},set:function(key,value){return this["$"+key]=value,this},remove:function(key){var property="$"+key;return property in this&&delete this[property]},clear:function(){for(var property in this)"$"===property[0]&&delete this[property]},keys:function(){var keys=[];for(var property in this)"$"===property[0]&&keys.push(property.slice(1));return keys},values:function(){var values=[];for(var property in this)"$"===property[0]&&values.push(this[property]);return values},entries:function(){var entries=[];for(var property in this)"$"===property[0]&&entries.push({key:property.slice(1),value:this[property]});return entries},size:function(){var size=0;for(var property in this)"$"===property[0]&&++size;return size},empty:function(){for(var property in this)if("$"===property[0])return!1;return!0},each:function(f){for(var property in this)"$"===property[0]&&f(this[property],property.slice(1),this)}};var nest=function(){function apply(array,depth,createResult,setResult){
if(depth>=keys.length)return null!=sortValues&&array.sort(sortValues),null!=rollup?rollup(array):array;for(var keyValue,value,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=map(),result=createResult();++i<n;)(values=valuesByKey.get(keyValue=key(value=array[i])+""))?values.push(value):valuesByKey.set(keyValue,[value]);return valuesByKey.each(function(values,key){setResult(result,key,apply(values,depth,createResult,setResult))}),result}function entries(map$$1,depth){if(++depth>keys.length)return map$$1;var array,sortKey=sortKeys[depth-1];return null!=rollup&&depth>=keys.length?array=map$$1.entries():(array=[],map$$1.each(function(v,k){array.push({key:k,values:entries(v,depth)})})),null!=sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}var sortValues,rollup,nest,keys=[],sortKeys=[];return nest={object:function(array){return apply(array,0,createObject,setObject)},map:function(array){return apply(array,0,createMap,setMap)},entries:function(array){return entries(apply(array,0,createMap,setMap),0)},key:function(d){return keys.push(d),nest},sortKeys:function(order){return sortKeys[keys.length-1]=order,nest},sortValues:function(order){return sortValues=order,nest},rollup:function(f){return rollup=f,nest}}},proto=map.prototype;Set.prototype=set.prototype={constructor:Set,has:proto.has,add:function(value){return value+="",this["$"+value]=value,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries};exports.nest=nest,exports.set=set,exports.map=map,exports.keys=keys,exports.values=values,exports.entries=entries,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],19:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}function color(format){var m;return format=(format+"").trim().toLowerCase(),(m=reHex3.exec(format))?(m=parseInt(m[1],16),new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1)):(m=reHex6.exec(format))?rgbn(parseInt(m[1],16)):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function rgbConvert(o){return o instanceof Color||(o=color(o)),o?(o=o.rgb(),new Rgb(o.r,o.g,o.b,o.opacity)):new Rgb}function rgb(r,g,b,opacity){return 1===arguments.length?rgbConvert(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;o=o.rgb();var r=o.r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function labConvert(o){if(o instanceof Lab)return new Lab(o.l,o.a,o.b,o.opacity);if(o instanceof Hcl){var h=o.h*deg2rad;return new Lab(o.l,Math.cos(h)*o.c,Math.sin(h)*o.c,o.opacity)}o instanceof Rgb||(o=rgbConvert(o));var b=rgb2xyz(o.r),a=rgb2xyz(o.g),l=rgb2xyz(o.b),x=xyz2lab((.4124564*b+.3575761*a+.1804375*l)/Xn),y=xyz2lab((.2126729*b+.7151522*a+.072175*l)/Yn);return new Lab(116*y-16,500*(x-y),200*(y-xyz2lab((.0193339*b+.119192*a+.9503041*l)/Zn)),o.opacity)}function lab(l,a,b,opacity){return 1===arguments.length?labConvert(l):new Lab(l,a,b,null==opacity?1:opacity)}function Lab(l,a,b,opacity){this.l=+l,this.a=+a,this.b=+b,this.opacity=+opacity}function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0}function lab2xyz(t){return t>t1?t*t*t:t2*(t-t0)}function xyz2rgb(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function rgb2xyz(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function hclConvert(o){if(o instanceof Hcl)return new Hcl(o.h,o.c,o.l,o.opacity);o instanceof Lab||(o=labConvert(o));var h=Math.atan2(o.b,o.a)*rad2deg;return new Hcl(h<0?h+360:h,Math.sqrt(o.a*o.a+o.b*o.b),o.l,o.opacity)}function hcl(h,c,l,opacity){return 1===arguments.length?hclConvert(h):new Hcl(h,c,l,null==opacity?1:opacity)}function Hcl(h,c,l,opacity){this.h=+h,this.c=+c,this.l=+l,this.opacity=+opacity}function cubehelixConvert(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);o instanceof Rgb||(o=rgbConvert(o));var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*rad2deg-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}function cubehelix(h,s,l,opacity){return 1===arguments.length?cubehelixConvert(h):new Cubehelix(h,s,l,null==opacity?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}var define=function(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor},reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),define(Rgb,rgb,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return a=isNaN(a)?1:Math.max(0,Math.min(1,a)),(1===a?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),define(Hsl,hsl,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;define(Lab,lab,extend(Color,{brighter:function(k){return new Lab(this.l+18*(null==k?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Lab(this.l-18*(null==k?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,z=isNaN(this.b)?y:y-this.b/200;return y=Yn*lab2xyz(y),x=Xn*lab2xyz(x),z=Zn*lab2xyz(z),new Rgb(xyz2rgb(3.2404542*x-1.5371385*y-.4985314*z),xyz2rgb(-.969266*x+1.8760108*y+.041556*z),xyz2rgb(.0556434*x-.2040259*y+1.0572252*z),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(k){return new Hcl(this.h,this.c,this.l+18*(null==k?1:k),this.opacity)},darker:function(k){return new Hcl(this.h,this.c,this.l-18*(null==k?1:k),this.opacity)},rgb:function(){return labConvert(this).rgb()}}));var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;define(Cubehelix,cubehelix,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=isNaN(this.h)?0:(this.h+120)*deg2rad,l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new Rgb(255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+D*sinh)),255*(l+a*(E*cosh)),this.opacity)}})),exports.color=color,exports.rgb=rgb,exports.hsl=hsl,exports.lab=lab,exports.hcl=hcl,exports.cubehelix=cubehelix,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],20:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _)throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:name}})}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name:name,value:callback}),type}var noop={value:function(){}};Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=parseTypenames(typename+"",_),i=-1,n=T.length;{if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t}},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}},exports.dispatch=dispatch,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],21:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-dispatch"),require("d3-selection")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-selection"],factory):factory(global.d3=global.d3||{},global.d3,global.d3)}(this,function(exports,d3Dispatch,d3Selection){"use strict";function nopropagation(){d3Selection.event.stopImmediatePropagation()}function yesdrag(view,noclick){var root=view.document.documentElement,selection=d3Selection.select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,!0),setTimeout(function(){selection.on("click.drag",null)},0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function DragEvent(target,type,subject,id,active,x,y,dx,dy,dispatch$$1){this.target=target,this.type=type,this.subject=subject,this.identifier=id,this.active=active,this.x=x,this.y=y,this.dx=dx,this.dy=dy,this._=dispatch$$1}function defaultFilter(){return!d3Selection.event.button}function defaultContainer(){return this.parentNode}function defaultSubject(d){return null==d?{x:d3Selection.event.x,y:d3Selection.event.y}:d}function defaultTouchable(){return"ontouchstart"in this}var noevent=function(){d3Selection.event.preventDefault(),d3Selection.event.stopImmediatePropagation()},nodrag=function(view){var root=view.document.documentElement,selection=d3Selection.select(view).on("dragstart.drag",noevent,!0);"onselectstart"in root?selection.on("selectstart.drag",noevent,!0):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")},constant=function(x){return function(){return x}};DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};var drag=function(){function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(){if(!touchending&&filter.apply(this,arguments)){var gesture=beforestart("mouse",container.apply(this,arguments),d3Selection.mouse,this,arguments);gesture&&(d3Selection.select(d3Selection.event.view).on("mousemove.drag",mousemoved,!0).on("mouseup.drag",mouseupped,!0),nodrag(d3Selection.event.view),nopropagation(),mousemoving=!1,mousedownx=d3Selection.event.clientX,mousedowny=d3Selection.event.clientY,gesture("start"))}}function mousemoved(){if(noevent(),!mousemoving){var dx=d3Selection.event.clientX-mousedownx,dy=d3Selection.event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag")}function mouseupped(){d3Selection.select(d3Selection.event.view).on("mousemove.drag mouseup.drag",null),yesdrag(d3Selection.event.view,mousemoving),noevent(),gestures.mouse("end")}function touchstarted(){if(filter.apply(this,arguments)){var i,gesture,touches=d3Selection.event.changedTouches,c=container.apply(this,arguments),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(touches[i].identifier,c,d3Selection.touch,this,arguments))&&(nopropagation(),gesture("start"))}}function touchmoved(){var i,gesture,touches=d3Selection.event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(),gesture("drag"))}function touchended(){var i,gesture,touches=d3Selection.event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(),gesture("end"))}function beforestart(id,container,point,that,args){var s,dx,dy,p=point(container,id),sublisteners=listeners.copy();if(d3Selection.customEvent(new DragEvent(drag,"beforestart",s,id,active,p[0],p[1],0,0,sublisteners),function(){return null!=(d3Selection.event.subject=s=subject.apply(that,args))&&(dx=s.x-p[0]||0,dy=s.y-p[1]||0,!0)}))return function gesture(type){var n,p0=p;switch(type){case"start":gestures[id]=gesture,n=active++;break;case"end":delete gestures[id],--active;case"drag":p=point(container,id),n=active}d3Selection.customEvent(new DragEvent(drag,type,s,id,n,p[0]+dx,p[1]+dy,p[0]-p0[0],p[1]-p0[1],sublisteners),sublisteners.apply,sublisteners,[type,that,args])}}var mousedownx,mousedowny,mousemoving,touchending,filter=defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=defaultTouchable,gestures={},listeners=d3Dispatch.dispatch("start","drag","end"),active=0,clickDistance2=0;return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:constant(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:constant(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:constant(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag};exports.drag=drag,exports.dragDisable=nodrag,exports.dragEnable=yesdrag,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-dispatch":20,"d3-selection":36}],22:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}")}function customConverter(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}function inferColumns(rows){var columnSet=Object.create(null),columns=[];return rows.forEach(function(row){for(var column in row)column in columnSet||columns.push(columnSet[column]=column)}),columns}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13,dsv=function(delimiter){function parse(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?customConverter(row,f):objectConverter(row)});return rows.columns=columns||[],rows}function parseRows(text,f){function token(){if(eof)return EOF;if(eol)return eol=!1,EOL;var i,c,j=I;if(text.charCodeAt(j)===QUOTE){for(;I++<N&&text.charCodeAt(I)!==QUOTE||text.charCodeAt(++I)===QUOTE;);return(i=I)>=N?eof=!0:(c=text.charCodeAt(I++))===NEWLINE?eol=!0:c===RETURN&&(eol=!0,text.charCodeAt(I)===NEWLINE&&++I),text.slice(j+1,i-1).replace(/""/g,'"')}for(;I<N;){if((c=text.charCodeAt(i=I++))===NEWLINE)eol=!0;else if(c===RETURN)eol=!0,text.charCodeAt(I)===NEWLINE&&++I;else if(c!==DELIMITER)continue;return text.slice(j,i)}return eof=!0,text.slice(j,N)}var t,rows=[],N=text.length,I=0,n=0,eof=N<=0,eol=!1;for(text.charCodeAt(N-1)===NEWLINE&&--N,text.charCodeAt(N-1)===RETURN&&--N;(t=token())!==EOF;){for(var row=[];t!==EOL&&t!==EOF;)row.push(t),t=token();f&&null==(row=f(row,n++))||rows.push(row)}return rows}function format(rows,columns){return null==columns&&(columns=inferColumns(rows)),[columns.map(formatValue).join(delimiter)].concat(rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})).join("\n")}function formatRows(rows){return rows.map(formatRow).join("\n")}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return null==text?"":reFormat.test(text+="")?'"'+text.replace(/"/g,'""')+'"':text}var reFormat=new RegExp('["'+delimiter+"\n\r]"),DELIMITER=delimiter.charCodeAt(0);return{parse:parse,parseRows:parseRows,format:format,formatRows:formatRows}},csv=dsv(","),csvParse=csv.parse,csvParseRows=csv.parseRows,csvFormat=csv.format,csvFormatRows=csv.formatRows,tsv=dsv("\t"),tsvParse=tsv.parse,tsvParseRows=tsv.parseRows,tsvFormat=tsv.format,tsvFormatRows=tsv.formatRows;exports.dsvFormat=dsv,exports.csvParse=csvParse,exports.csvParseRows=csvParseRows,exports.csvFormat=csvFormat,exports.csvFormatRows=csvFormatRows,exports.tsvParse=tsvParse,exports.tsvParseRows=tsvParseRows,exports.tsvFormat=tsvFormat,exports.tsvFormatRows=tsvFormatRows,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],23:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function linear(t){return+t}function quadIn(t){return t*t}function quadOut(t){return t*(2-t)}function quadInOut(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function cubicIn(t){return t*t*t}function cubicOut(t){return--t*t*t+1}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function sinIn(t){return 1-Math.cos(t*halfPi)}function sinOut(t){return Math.sin(t*halfPi)}function sinInOut(t){return(1-Math.cos(pi*t))/2}function expIn(t){return Math.pow(2,10*t-10)}function expOut(t){return 1-Math.pow(2,-10*t)}function expInOut(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function circleIn(t){return 1-Math.sqrt(1-t*t)}function circleOut(t){return Math.sqrt(1- --t*t)}function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function bounceIn(t){return 1-bounceOut(1-t)}function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}function bounceInOut(t){return((t*=2)<=1?1-bounceOut(1-t):bounceOut(t-1)+1)/2}var polyIn=function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn}(3),polyOut=function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),polyInOut=function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3),pi=Math.PI,halfPi=pi/2,b1=4/11,b2=6/11,b3=8/11,b4=.75,b5=9/11,b6=10/11,b7=.9375,b8=21/22,b9=63/64,b0=1/b1/b1,backIn=function custom(s){function backIn(t){return t*t*((s+1)*t-s)}return s=+s,backIn.overshoot=custom,backIn}(1.70158),backOut=function custom(s){function backOut(t){return--t*t*((s+1)*t+s)+1}return s=+s,backOut.overshoot=custom,backOut}(1.70158),backInOut=function custom(s){function backInOut(t){return((t*=2)<1?t*t*((s+1)*t-s):(t-=2)*t*((s+1)*t+s)+2)/2}return s=+s,backInOut.overshoot=custom,backInOut}(1.70158),tau=2*Math.PI,elasticIn=function custom(a,p){function elasticIn(t){return a*Math.pow(2,10*--t)*Math.sin((s-t)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticIn.amplitude=function(a){return custom(a,p*tau)},elasticIn.period=function(p){return custom(a,p)},elasticIn}(1,.3),elasticOut=function custom(a,p){function elasticOut(t){return 1-a*Math.pow(2,-10*(t=+t))*Math.sin((t+s)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticOut.amplitude=function(a){return custom(a,p*tau)},elasticOut.period=function(p){return custom(a,p)},elasticOut}(1,.3),elasticInOut=function custom(a,p){function elasticInOut(t){return((t=2*t-1)<0?a*Math.pow(2,10*t)*Math.sin((s-t)/p):2-a*Math.pow(2,-10*t)*Math.sin((s+t)/p))/2}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticInOut.amplitude=function(a){return custom(a,p*tau)},elasticInOut.period=function(p){return custom(a,p)},elasticInOut}(1,.3);exports.easeLinear=linear,exports.easeQuad=quadInOut,exports.easeQuadIn=quadIn,exports.easeQuadOut=quadOut,exports.easeQuadInOut=quadInOut,exports.easeCubic=cubicInOut,exports.easeCubicIn=cubicIn,exports.easeCubicOut=cubicOut,exports.easeCubicInOut=cubicInOut,exports.easePoly=polyInOut,exports.easePolyIn=polyIn,exports.easePolyOut=polyOut,exports.easePolyInOut=polyInOut,exports.easeSin=sinInOut,exports.easeSinIn=sinIn,exports.easeSinOut=sinOut,exports.easeSinInOut=sinInOut,exports.easeExp=expInOut,exports.easeExpIn=expIn,exports.easeExpOut=expOut,exports.easeExpInOut=expInOut,exports.easeCircle=circleInOut,exports.easeCircleIn=circleIn,exports.easeCircleOut=circleOut,exports.easeCircleInOut=circleInOut,exports.easeBounce=bounceOut,exports.easeBounceIn=bounceIn,exports.easeBounceOut=bounceOut,exports.easeBounceInOut=bounceInOut,exports.easeBack=backInOut,exports.easeBackIn=backIn,exports.easeBackOut=backOut,exports.easeBackInOut=backInOut,exports.easeElastic=elasticOut,exports.easeElasticIn=elasticIn,exports.easeElasticOut=elasticOut,exports.easeElasticInOut=elasticInOut,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],24:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-quadtree"),require("d3-collection"),require("d3-dispatch"),require("d3-timer")):"function"==typeof define&&define.amd?define(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],factory):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Quadtree,d3Collection,d3Dispatch,d3Timer){"use strict";function x(d){return d.x+d.vx}function y(d){return d.y+d.vy}function index(d){return d.index}function find(nodeById,nodeId){var node=nodeById.get(nodeId);if(!node)throw new Error("missing: "+nodeId);return node}function x$1(d){return d.x}function y$1(d){return d.y}var center=function(x,y){function force(){var i,node,n=nodes.length,sx=0,sy=0;for(i=0;i<n;++i)node=nodes[i],sx+=node.x,sy+=node.y;for(sx=sx/n-x,sy=sy/n-y,i=0;i<n;++i)node=nodes[i],node.x-=sx,node.y-=sy}var nodes;return null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force},constant=function(x){return function(){return x}},jiggle=function(){return 1e-6*(Math.random()-.5)},collide=function(radius){function force(){function apply(quad,x0,y0,x1,y1){var data=quad.data,rj=quad.r,r=ri+rj;{if(!data)return x0>xi+r||x1<xi-r||y0>yi+r||y1<yi-r;if(data.index>node.index){var x=xi-data.x-data.vx,y=yi-data.y-data.vy,l=x*x+y*y;l<r*r&&(0===x&&(x=jiggle(),l+=x*x),0===y&&(y=jiggle(),l+=y*y),l=(r-(l=Math.sqrt(l)))/l*strength,node.vx+=(x*=l)*(r=(rj*=rj)/(ri2+rj)),node.vy+=(y*=l)*r,data.vx-=x*(r=1-r),data.vy-=y*r)}}}for(var i,tree,node,xi,yi,ri,ri2,n=nodes.length,k=0;k<iterations;++k)for(tree=d3Quadtree.quadtree(nodes,x,y).visitAfter(prepare),i=0;i<n;++i)node=nodes[i],ri=radii[node.index],ri2=ri*ri,xi=node.x+node.vx,yi=node.y+node.vy,tree.visit(apply)}function prepare(quad){if(quad.data)return quad.r=radii[quad.data.index];for(var i=quad.r=0;i<4;++i)quad[i]&&quad[i].r>quad.r&&(quad.r=quad[i].r)}function initialize(){if(nodes){var i,node,n=nodes.length;for(radii=new Array(n),i=0;i<n;++i)node=nodes[i],radii[node.index]=+radius(node,i,nodes)}}var nodes,radii,strength=1,iterations=1;return"function"!=typeof radius&&(radius=constant(null==radius?1:+radius)),force.initialize=function(_){nodes=_,initialize()},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),initialize(),force):radius},force},link=function(links){function defaultStrength(link){return 1/Math.min(count[link.source.index],count[link.target.index])}function force(alpha){for(var k=0,n=links.length;k<iterations;++k)for(var link,source,target,x,y,l,b,i=0;i<n;++i)link=links[i],source=link.source,target=link.target,x=target.x+target.vx-source.x-source.vx||jiggle(),y=target.y+target.vy-source.y-source.vy||jiggle(),l=Math.sqrt(x*x+y*y),l=(l-distances[i])/l*alpha*strengths[i],x*=l,y*=l,target.vx-=x*(b=bias[i]),target.vy-=y*b,source.vx+=x*(b=1-b),source.vy+=y*b}function initialize(){if(nodes){var i,link,n=nodes.length,m=links.length,nodeById=d3Collection.map(nodes,id);for(i=0,count=new Array(n);i<m;++i)link=links[i],link.index=i,"object"!=typeof link.source&&(link.source=find(nodeById,link.source)),"object"!=typeof link.target&&(link.target=find(nodeById,link.target)),count[link.source.index]=(count[link.source.index]||0)+1,count[link.target.index]=(count[link.target.index]||0)+1;for(i=0,bias=new Array(m);i<m;++i)link=links[i],bias[i]=count[link.source.index]/(count[link.source.index]+count[link.target.index]);strengths=new Array(m),initializeStrength(),distances=new Array(m),initializeDistance()}}function initializeStrength(){if(nodes)for(var i=0,n=links.length;i<n;++i)strengths[i]=+strength(links[i],i,links)}function initializeDistance(){if(nodes)for(var i=0,n=links.length;i<n;++i)distances[i]=+distance(links[i],i,links)}var strengths,distances,nodes,count,bias,id=index,strength=defaultStrength,distance=constant(30),iterations=1;return null==links&&(links=[]),force.initialize=function(_){nodes=_,initialize()},force.links=function(_){return arguments.length?(links=_,initialize(),
force):links},force.id=function(_){return arguments.length?(id=_,force):id},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initializeStrength(),force):strength},force.distance=function(_){return arguments.length?(distance="function"==typeof _?_:constant(+_),initializeDistance(),force):distance},force},initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5)),simulation=function(nodes){function step(){tick(),event.call("tick",simulation),alpha<alphaMin&&(stepper.stop(),event.call("end",simulation))}function tick(){var i,node,n=nodes.length;for(alpha+=(alphaTarget-alpha)*alphaDecay,forces.each(function(force){force(alpha)}),i=0;i<n;++i)node=nodes[i],null==node.fx?node.x+=node.vx*=velocityDecay:(node.x=node.fx,node.vx=0),null==node.fy?node.y+=node.vy*=velocityDecay:(node.y=node.fy,node.vy=0)}function initializeNodes(){for(var node,i=0,n=nodes.length;i<n;++i){if(node=nodes[i],node.index=i,isNaN(node.x)||isNaN(node.y)){var radius=initialRadius*Math.sqrt(i),angle=i*initialAngle;node.x=radius*Math.cos(angle),node.y=radius*Math.sin(angle)}(isNaN(node.vx)||isNaN(node.vy))&&(node.vx=node.vy=0)}}function initializeForce(force){return force.initialize&&force.initialize(nodes),force}var simulation,alpha=1,alphaMin=.001,alphaDecay=1-Math.pow(alphaMin,1/300),alphaTarget=0,velocityDecay=.6,forces=d3Collection.map(),stepper=d3Timer.timer(step),event=d3Dispatch.dispatch("tick","end");return null==nodes&&(nodes=[]),initializeNodes(),simulation={tick:tick,restart:function(){return stepper.restart(step),simulation},stop:function(){return stepper.stop(),simulation},nodes:function(_){return arguments.length?(nodes=_,initializeNodes(),forces.each(initializeForce),simulation):nodes},alpha:function(_){return arguments.length?(alpha=+_,simulation):alpha},alphaMin:function(_){return arguments.length?(alphaMin=+_,simulation):alphaMin},alphaDecay:function(_){return arguments.length?(alphaDecay=+_,simulation):+alphaDecay},alphaTarget:function(_){return arguments.length?(alphaTarget=+_,simulation):alphaTarget},velocityDecay:function(_){return arguments.length?(velocityDecay=1-_,simulation):1-velocityDecay},force:function(name,_){return arguments.length>1?(null==_?forces.remove(name):forces.set(name,initializeForce(_)),simulation):forces.get(name)},find:function(x,y,radius){var dx,dy,d2,node,closest,i=0,n=nodes.length;for(null==radius?radius=1/0:radius*=radius,i=0;i<n;++i)node=nodes[i],dx=x-node.x,dy=y-node.y,(d2=dx*dx+dy*dy)<radius&&(closest=node,radius=d2);return closest},on:function(name,_){return arguments.length>1?(event.on(name,_),simulation):event.on(name)}}},manyBody=function(){function force(_){var i,n=nodes.length,tree=d3Quadtree.quadtree(nodes,x$1,y$1).visitAfter(accumulate);for(alpha=_,i=0;i<n;++i)node=nodes[i],tree.visit(apply)}function initialize(){if(nodes){var i,node,n=nodes.length;for(strengths=new Array(n),i=0;i<n;++i)node=nodes[i],strengths[node.index]=+strength(node,i,nodes)}}function accumulate(quad){var q,c,x,y,i,strength=0,weight=0;if(quad.length){for(x=y=i=0;i<4;++i)(q=quad[i])&&(c=Math.abs(q.value))&&(strength+=q.value,weight+=c,x+=c*q.x,y+=c*q.y);quad.x=x/weight,quad.y=y/weight}else{q=quad,q.x=q.data.x,q.y=q.data.y;do{strength+=strengths[q.data.index]}while(q=q.next)}quad.value=strength}function apply(quad,x1,_,x2){if(!quad.value)return!0;var x=quad.x-node.x,y=quad.y-node.y,w=x2-x1,l=x*x+y*y;if(w*w/theta2<l)return l<distanceMax2&&(0===x&&(x=jiggle(),l+=x*x),0===y&&(y=jiggle(),l+=y*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)),node.vx+=x*quad.value*alpha/l,node.vy+=y*quad.value*alpha/l),!0;if(!(quad.length||l>=distanceMax2)){(quad.data!==node||quad.next)&&(0===x&&(x=jiggle(),l+=x*x),0===y&&(y=jiggle(),l+=y*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)));do{quad.data!==node&&(w=strengths[quad.data.index]*alpha/l,node.vx+=x*w,node.vy+=y*w)}while(quad=quad.next)}}var nodes,node,alpha,strengths,strength=constant(-30),distanceMin2=1,distanceMax2=1/0,theta2=.81;return force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.distanceMin=function(_){return arguments.length?(distanceMin2=_*_,force):Math.sqrt(distanceMin2)},force.distanceMax=function(_){return arguments.length?(distanceMax2=_*_,force):Math.sqrt(distanceMax2)},force.theta=function(_){return arguments.length?(theta2=_*_,force):Math.sqrt(theta2)},force},radial=function(radius,x,y){function force(alpha){for(var i=0,n=nodes.length;i<n;++i){var node=nodes[i],dx=node.x-x||1e-6,dy=node.y-y||1e-6,r=Math.sqrt(dx*dx+dy*dy),k=(radiuses[i]-r)*strengths[i]*alpha/r;node.vx+=dx*k,node.vy+=dy*k}}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),radiuses=new Array(n),i=0;i<n;++i)radiuses[i]=+radius(nodes[i],i,nodes),strengths[i]=isNaN(radiuses[i])?0:+strength(nodes[i],i,nodes)}}var nodes,strengths,radiuses,strength=constant(.1);return"function"!=typeof radius&&(radius=constant(+radius)),null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),initialize(),force):radius},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force},x$2=function(x){function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)node=nodes[i],node.vx+=(xz[i]-node.x)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),xz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(xz[i]=+x(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}var nodes,strengths,xz,strength=constant(.1);return"function"!=typeof x&&(x=constant(null==x?0:+x)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.x=function(_){return arguments.length?(x="function"==typeof _?_:constant(+_),initialize(),force):x},force},y$2=function(y){function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)node=nodes[i],node.vy+=(yz[i]-node.y)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),yz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(yz[i]=+y(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}var nodes,strengths,yz,strength=constant(.1);return"function"!=typeof y&&(y=constant(null==y?0:+y)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.y=function(_){return arguments.length?(y="function"==typeof _?_:constant(+_),initialize(),force):y},force};exports.forceCenter=center,exports.forceCollide=collide,exports.forceLink=link,exports.forceManyBody=manyBody,exports.forceRadial=radial,exports.forceSimulation=simulation,exports.forceX=x$2,exports.forceY=y$2,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-collection":18,"d3-dispatch":20,"d3-quadtree":31,"d3-timer":41}],25:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function formatSpecifier(specifier){return new FormatSpecifier(specifier)}function FormatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match,fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zero=!!match[5],width=match[6]&&+match[6],comma=!!match[7],precision=match[8]&&+match[8].slice(1),type=match[9]||"";"n"===type?(comma=!0,type="g"):formatTypes[type]||(type=""),(zero||"0"===fill&&"="===align)&&(zero=!0,fill="0",align="="),this.fill=fill,this.align=align,this.sign=sign,this.symbol=symbol,this.zero=zero,this.width=width,this.comma=comma,this.precision=precision,this.type=type}function defaultLocale(definition){return locale=formatLocale(definition),exports.format=locale.format,exports.formatPrefix=locale.formatPrefix,locale}var prefixExponent,formatDecimal=function(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]},exponent=function(x){return x=formatDecimal(Math.abs(x)),x?x[1]:NaN},formatGroup=function(grouping,thousands){return function(value,width){for(var i=value.length,t=[],j=0,g=grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=grouping[j=(j+1)%grouping.length];return t.reverse().join(thousands)}},formatNumerals=function(numerals){return function(value){return value.replace(/[0-9]/g,function(i){return numerals[+i]})}},formatDefault=function(x,p){x=x.toPrecision(p);out:for(var i1,n=x.length,i=1,i0=-1;i<n;++i)switch(x[i]){case".":i0=i1=i;break;case"0":0===i0&&(i0=i),i1=i;break;case"e":break out;default:i0>0&&(i0=0)}return i0>0?x.slice(0,i0)+x.slice(i1+1):x},formatPrefixAuto=function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(exponent/3))))+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+formatDecimal(x,Math.max(0,p+i-1))[0]},formatRounded=function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")},formatTypes={"":formatDefault,"%":function(x,p){return(100*x).toFixed(p)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:function(x){return Math.round(x).toString(10)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},g:function(x,p){return x.toPrecision(p)},o:function(x){return Math.round(x).toString(8)},p:function(x,p){return formatRounded(100*x,p)},r:formatRounded,s:formatPrefixAuto,X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}},re=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var locale,identity=function(x){return x},prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],formatLocale=function(locale){function newFormat(specifier){function format(value){var i,n,c,valuePrefix=prefix,valueSuffix=suffix;if("c"===type)valueSuffix=formatType(value)+valueSuffix,value="";else{value=+value;var valueNegative=value<0;if(value=formatType(Math.abs(value),precision),valueNegative&&0==+value&&(valueNegative=!1),valuePrefix=(valueNegative?"("===sign?sign:"-":"-"===sign||"("===sign?"":sign)+valuePrefix,valueSuffix=("s"===type?prefixes[8+prefixExponent/3]:"")+valueSuffix+(valueNegative&&"("===sign?")":""),maybeSuffix)for(i=-1,n=value.length;++i<n;)if(48>(c=value.charCodeAt(i))||c>57){valueSuffix=(46===c?decimal+value.slice(i+1):value.slice(i))+valueSuffix,value=value.slice(0,i);break}}comma&&!zero&&(value=group(value,1/0));var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";switch(comma&&zero&&(value=group(padding+value,padding.length?width-valueSuffix.length:1/0),padding=""),align){case"<":value=valuePrefix+value+valueSuffix+padding;break;case"=":value=valuePrefix+padding+value+valueSuffix;break;case"^":value=padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length);break;default:value=padding+valuePrefix+value+valueSuffix}return numerals(value)}specifier=formatSpecifier(specifier);var fill=specifier.fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,type=specifier.type,prefix="$"===symbol?currency[0]:"#"===symbol&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix="$"===symbol?currency[1]:/[%p]/.test(type)?percent:"",formatType=formatTypes[type],maybeSuffix=!type||/[defgprs%]/.test(type);return precision=null==precision?type?6:12:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision)),format.toString=function(){return specifier+""},format}function formatPrefix(specifier,value){var f=newFormat((specifier=formatSpecifier(specifier),specifier.type="f",specifier)),e=3*Math.max(-8,Math.min(8,Math.floor(exponent(value)/3))),k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}var group=locale.grouping&&locale.thousands?formatGroup(locale.grouping,locale.thousands):identity,currency=locale.currency,decimal=locale.decimal,numerals=locale.numerals?formatNumerals(locale.numerals):identity,percent=locale.percent||"%";return{format:newFormat,formatPrefix:formatPrefix}};defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var precisionFixed=function(step){return Math.max(0,-exponent(Math.abs(step)))},precisionPrefix=function(step,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent(value)/3)))-exponent(Math.abs(step)))},precisionRound=function(step,max){return step=Math.abs(step),max=Math.abs(max)-step,Math.max(0,exponent(max)-exponent(step))+1};exports.formatDefaultLocale=defaultLocale,exports.formatLocale=formatLocale,exports.formatSpecifier=formatSpecifier,exports.precisionFixed=precisionFixed,exports.precisionPrefix=precisionPrefix,exports.precisionRound=precisionRound,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],26:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-array")):"function"==typeof define&&define.amd?define(["exports","d3-array"],factory):factory(global.d3=global.d3||{},global.d3)}(this,function(exports,d3Array){"use strict";function Adder(){this.reset()}function add(adder,a,b){var x=adder.s=a+b,bv=x-a,av=x-bv;adder.t=a-av+(b-bv)}function acos(x){return x>1?0:x<-1?pi:Math.acos(x)}function asin(x){return x>1?halfPi:x<-1?-halfPi:Math.asin(x)}function haversin(x){return(x=sin(x/2))*x}function noop(){}function streamGeometry(geometry,stream){geometry&&streamGeometryType.hasOwnProperty(geometry.type)&&streamGeometryType[geometry.type](geometry,stream)}function streamLine(coordinates,stream,closed){var coordinate,i=-1,n=coordinates.length-closed;for(stream.lineStart();++i<n;)coordinate=coordinates[i],stream.point(coordinate[0],coordinate[1],coordinate[2]);stream.lineEnd()}function streamPolygon(coordinates,stream){var i=-1,n=coordinates.length;for(stream.polygonStart();++i<n;)streamLine(coordinates[i],stream,1);stream.polygonEnd()}function areaRingStart(){areaStream.point=areaPointFirst}function areaRingEnd(){areaPoint(lambda00,phi00)}function areaPointFirst(lambda,phi){areaStream.point=areaPoint,lambda00=lambda,phi00=phi,lambda*=radians,phi*=radians,lambda0=lambda,cosPhi0=cos(phi=phi/2+quarterPi),sinPhi0=sin(phi)}function areaPoint(lambda,phi){lambda*=radians,phi*=radians,phi=phi/2+quarterPi;var dLambda=lambda-lambda0,sdLambda=dLambda>=0?1:-1,adLambda=sdLambda*dLambda,cosPhi=cos(phi),sinPhi=sin(phi),k=sinPhi0*sinPhi,u=cosPhi0*cosPhi+k*cos(adLambda),v=k*sdLambda*sin(adLambda);areaRingSum.add(atan2(v,u)),lambda0=lambda,cosPhi0=cosPhi,sinPhi0=sinPhi}function spherical(cartesian){return[atan2(cartesian[1],cartesian[0]),asin(cartesian[2])]}function cartesian(spherical){var lambda=spherical[0],phi=spherical[1],cosPhi=cos(phi);return[cosPhi*cos(lambda),cosPhi*sin(lambda),sin(phi)]}function cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function cartesianAddInPlace(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function cartesianNormalizeInPlace(d){var l=sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l,d[1]/=l,d[2]/=l}function boundsPoint(lambda,phi){ranges.push(range$1=[lambda0$1=lambda,lambda1=lambda]),phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi)}function linePoint(lambda,phi){var p=cartesian([lambda*radians,phi*radians]);if(p0){var normal=cartesianCross(p0,p),equatorial=[normal[1],-normal[0],0],inflection=cartesianCross(equatorial,normal);cartesianNormalizeInPlace(inflection),inflection=spherical(inflection);var phii,delta=lambda-lambda2,sign$$1=delta>0?1:-1,lambdai=inflection[0]*degrees*sign$$1,antimeridian=abs(delta)>180;antimeridian^(sign$$1*lambda2<lambdai&&lambdai<sign$$1*lambda)?(phii=inflection[1]*degrees)>phi1&&(phi1=phii):(lambdai=(lambdai+360)%360-180,antimeridian^(sign$$1*lambda2<lambdai&&lambdai<sign$$1*lambda)?(phii=-inflection[1]*degrees)<phi0&&(phi0=phii):(phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi))),antimeridian?lambda<lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda):lambda1>=lambda0$1?(lambda<lambda0$1&&(lambda0$1=lambda),lambda>lambda1&&(lambda1=lambda)):lambda>lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda)}else ranges.push(range$1=[lambda0$1=lambda,lambda1=lambda]);phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi),p0=p,lambda2=lambda}function boundsLineStart(){boundsStream.point=linePoint}function boundsLineEnd(){range$1[0]=lambda0$1,range$1[1]=lambda1,boundsStream.point=boundsPoint,p0=null}function boundsRingPoint(lambda,phi){if(p0){var delta=lambda-lambda2;deltaSum.add(abs(delta)>180?delta+(delta>0?360:-360):delta)}else lambda00$1=lambda,phi00$1=phi;areaStream.point(lambda,phi),linePoint(lambda,phi)}function boundsRingStart(){areaStream.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream.lineEnd(),abs(deltaSum)>epsilon&&(lambda0$1=-(lambda1=180)),range$1[0]=lambda0$1,range$1[1]=lambda1,p0=null}function angle(lambda0,lambda1){return(lambda1-=lambda0)<0?lambda1+360:lambda1}function rangeCompare(a,b){return a[0]-b[0]}function rangeContains(range$$1,x){return range$$1[0]<=range$$1[1]?range$$1[0]<=x&&x<=range$$1[1]:x<range$$1[0]||range$$1[1]<x}function centroidPoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos(phi);centroidPointCartesian(cosPhi*cos(lambda),cosPhi*sin(lambda),sin(phi))}function centroidPointCartesian(x,y,z){++W0,X0+=(x-X0)/W0,Y0+=(y-Y0)/W0,Z0+=(z-Z0)/W0}function centroidLineStart(){centroidStream.point=centroidLinePointFirst}function centroidLinePointFirst(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos(phi);x0=cosPhi*cos(lambda),y0=cosPhi*sin(lambda),z0=sin(phi),centroidStream.point=centroidLinePoint,centroidPointCartesian(x0,y0,z0)}function centroidLinePoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos(phi),x=cosPhi*cos(lambda),y=cosPhi*sin(lambda),z=sin(phi),w=atan2(sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidRingPointFirst}function centroidRingEnd(){centroidRingPoint(lambda00$2,phi00$2),centroidStream.point=centroidPoint}function centroidRingPointFirst(lambda,phi){lambda00$2=lambda,phi00$2=phi,lambda*=radians,phi*=radians,centroidStream.point=centroidRingPoint;var cosPhi=cos(phi);x0=cosPhi*cos(lambda),y0=cosPhi*sin(lambda),z0=sin(phi),centroidPointCartesian(x0,y0,z0)}function centroidRingPoint(lambda,phi){lambda*=radians,phi*=radians;var cosPhi=cos(phi),x=cosPhi*cos(lambda),y=cosPhi*sin(lambda),z=sin(phi),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=sqrt(cx*cx+cy*cy+cz*cz),w=asin(m),v=m&&-w/m;X2+=v*cx,Y2+=v*cy,Z2+=v*cz,W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function rotationIdentity(lambda,phi){return[lambda>pi?lambda-tau:lambda<-pi?lambda+tau:lambda,phi]}function rotateRadians(deltaLambda,deltaPhi,deltaGamma){return(deltaLambda%=tau)?deltaPhi||deltaGamma?compose(rotationLambda(deltaLambda),rotationPhiGamma(deltaPhi,deltaGamma)):rotationLambda(deltaLambda):deltaPhi||deltaGamma?rotationPhiGamma(deltaPhi,deltaGamma):rotationIdentity}function forwardRotationLambda(deltaLambda){return function(lambda,phi){return lambda+=deltaLambda,[lambda>pi?lambda-tau:lambda<-pi?lambda+tau:lambda,phi]}}function rotationLambda(deltaLambda){var rotation=forwardRotationLambda(deltaLambda);return rotation.invert=forwardRotationLambda(-deltaLambda),rotation}function rotationPhiGamma(deltaPhi,deltaGamma){function rotation(lambda,phi){var cosPhi=cos(phi),x=cos(lambda)*cosPhi,y=sin(lambda)*cosPhi,z=sin(phi),k=z*cosDeltaPhi+x*sinDeltaPhi;return[atan2(y*cosDeltaGamma-k*sinDeltaGamma,x*cosDeltaPhi-z*sinDeltaPhi),asin(k*cosDeltaGamma+y*sinDeltaGamma)]}var cosDeltaPhi=cos(deltaPhi),sinDeltaPhi=sin(deltaPhi),cosDeltaGamma=cos(deltaGamma),sinDeltaGamma=sin(deltaGamma);return rotation.invert=function(lambda,phi){var cosPhi=cos(phi),x=cos(lambda)*cosPhi,y=sin(lambda)*cosPhi,z=sin(phi),k=z*cosDeltaGamma-y*sinDeltaGamma;return[atan2(y*cosDeltaGamma+z*sinDeltaGamma,x*cosDeltaPhi+k*sinDeltaPhi),asin(k*cosDeltaPhi-x*sinDeltaPhi)]},rotation}function circleStream(stream,radius,delta,direction,t0,t1){if(delta){var cosRadius=cos(radius),sinRadius=sin(radius),step=direction*delta;null==t0?(t0=radius+direction*tau,t1=radius-step/2):(t0=circleRadius(cosRadius,t0),t1=circleRadius(cosRadius,t1),(direction>0?t0<t1:t0>t1)&&(t0+=direction*tau));for(var point,t=t0;direction>0?t>t1:t<t1;t-=step)point=spherical([cosRadius,-sinRadius*cos(t),-sinRadius*sin(t)]),stream.point(point[0],point[1])}}function circleRadius(cosRadius,point){point=cartesian(point),point[0]-=cosRadius,cartesianNormalizeInPlace(point);var radius=acos(-point[1]);return((-point[2]<0?-radius:radius)+tau-epsilon)%tau}function Intersection(point,points,other,entry){this.x=point,this.z=points,this.o=other,this.e=entry,this.v=!1,this.n=this.p=null}function link(array){if(n=array.length){for(var n,b,i=0,a=array[0];++i<n;)a.n=b=array[i],b.p=a,a=b;a.n=b=array[0],b.p=a}}function validSegment(segment){return segment.length>1}function compareIntersection(a,b){return((a=a.x)[0]<0?a[1]-halfPi-epsilon:halfPi-a[1])-((b=b.x)[0]<0?b[1]-halfPi-epsilon:halfPi-b[1])}function clipAntimeridianLine(stream){var clean,lambda0=NaN,phi0=NaN,sign0=NaN;return{lineStart:function(){stream.lineStart(),clean=1},point:function(lambda1,phi1){var sign1=lambda1>0?pi:-pi,delta=abs(lambda1-lambda0);abs(delta-pi)<epsilon?(stream.point(lambda0,phi0=(phi0+phi1)/2>0?halfPi:-halfPi),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),stream.point(lambda1,phi0),clean=0):sign0!==sign1&&delta>=pi&&(abs(lambda0-sign0)<epsilon&&(lambda0-=sign0*epsilon),abs(lambda1-sign1)<epsilon&&(lambda1-=sign1*epsilon),phi0=clipAntimeridianIntersect(lambda0,phi0,lambda1,phi1),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),clean=0),stream.point(lambda0=lambda1,phi0=phi1),sign0=sign1},lineEnd:function(){stream.lineEnd(),lambda0=phi0=NaN},clean:function(){return 2-clean}}}function clipAntimeridianIntersect(lambda0,phi0,lambda1,phi1){var cosPhi0,cosPhi1,sinLambda0Lambda1=sin(lambda0-lambda1);return abs(sinLambda0Lambda1)>epsilon?atan((sin(phi0)*(cosPhi1=cos(phi1))*sin(lambda1)-sin(phi1)*(cosPhi0=cos(phi0))*sin(lambda0))/(cosPhi0*cosPhi1*sinLambda0Lambda1)):(phi0+phi1)/2}function clipAntimeridianInterpolate(from,to,direction,stream){var phi;if(null==from)phi=direction*halfPi,stream.point(-pi,phi),stream.point(0,phi),stream.point(pi,phi),stream.point(pi,0),stream.point(pi,-phi),stream.point(0,-phi),stream.point(-pi,-phi),stream.point(-pi,0),stream.point(-pi,phi);else if(abs(from[0]-to[0])>epsilon){var lambda=from[0]<to[0]?pi:-pi;phi=direction*lambda/2,stream.point(-lambda,phi),stream.point(0,phi),stream.point(lambda,phi)}else stream.point(to[0],to[1])}function clipRectangle(x0,y0,x1,y1){function visible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function interpolate(from,to,direction,stream){var a=0,a1=0;if(null==from||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoint(from,to)<0^direction>0)do{stream.point(0===a||3===a?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1);else stream.point(to[0],to[1])}function corner(p,direction){return abs(p[0]-x0)<epsilon?direction>0?0:3:abs(p[0]-x1)<epsilon?direction>0?2:1:abs(p[1]-y0)<epsilon?direction>0?1:0:direction>0?3:2}function compareIntersection(a,b){return comparePoint(a.x,b.x)}function comparePoint(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:0===ca?b[1]-a[1]:1===ca?a[0]-b[0]:2===ca?a[1]-b[1]:b[0]-a[0]}return function(stream){function point(x,y){visible(x,y)&&activeStream.point(x,y)}function polygonInside(){for(var winding=0,i=0,n=polygon.length;i<n;++i)for(var a0,a1,ring=polygon[i],j=1,m=ring.length,point=ring[0],b0=point[0],b1=point[1];j<m;++j)a0=b0,a1=b1,point=ring[j],b0=point[0],b1=point[1],a1<=y1?b1>y1&&(b0-a0)*(y1-a1)>(b1-a1)*(x0-a0)&&++winding:b1<=y1&&(b0-a0)*(y1-a1)<(b1-a1)*(x0-a0)&&--winding;return winding}function polygonStart(){activeStream=bufferStream,segments=[],polygon=[],clean=!0}function polygonEnd(){var startInside=polygonInside(),cleanInside=clean&&startInside,visible=(segments=d3Array.merge(segments)).length;(cleanInside||visible)&&(stream.polygonStart(),cleanInside&&(stream.lineStart(),interpolate(null,null,1,stream),stream.lineEnd()),visible&&clipRejoin(segments,compareIntersection,startInside,interpolate,stream),stream.polygonEnd()),activeStream=stream,segments=polygon=ring=null}function lineStart(){clipStream.point=linePoint,polygon&&polygon.push(ring=[]),first=!0,v_=!1,x_=y_=NaN}function lineEnd(){segments&&(linePoint(x__,y__),v__&&v_&&bufferStream.rejoin(),segments.push(bufferStream.result())),clipStream.point=point,v_&&activeStream.lineEnd()}function linePoint(x,y){var v=visible(x,y);if(polygon&&ring.push([x,y]),first)x__=x,y__=y,v__=v,first=!1,v&&(activeStream.lineStart(),activeStream.point(x,y));else if(v&&v_)activeStream.point(x,y);else{var a=[x_=Math.max(clipMin,Math.min(clipMax,x_)),y_=Math.max(clipMin,Math.min(clipMax,y_))],b=[x=Math.max(clipMin,Math.min(clipMax,x)),y=Math.max(clipMin,Math.min(clipMax,y))];clipLine(a,b,x0,y0,x1,y1)?(v_||(activeStream.lineStart(),activeStream.point(a[0],a[1])),activeStream.point(b[0],b[1]),v||activeStream.lineEnd(),clean=!1):v&&(activeStream.lineStart(),activeStream.point(x,y),clean=!1)}x_=x,y_=y,v_=v}var segments,polygon,ring,x__,y__,v__,x_,y_,v_,first,clean,activeStream=stream,bufferStream=clipBuffer(),clipStream={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:polygonStart,polygonEnd:polygonEnd};return clipStream}}function lengthLineStart(){lengthStream.point=lengthPointFirst,lengthStream.lineEnd=lengthLineEnd}function lengthLineEnd(){lengthStream.point=lengthStream.lineEnd=noop}function lengthPointFirst(lambda,phi){lambda*=radians,phi*=radians,lambda0$2=lambda,sinPhi0$1=sin(phi),cosPhi0$1=cos(phi),lengthStream.point=lengthPoint}function lengthPoint(lambda,phi){lambda*=radians,phi*=radians;var sinPhi=sin(phi),cosPhi=cos(phi),delta=abs(lambda-lambda0$2),cosDelta=cos(delta),sinDelta=sin(delta),x=cosPhi*sinDelta,y=cosPhi0$1*sinPhi-sinPhi0$1*cosPhi*cosDelta,z=sinPhi0$1*sinPhi+cosPhi0$1*cosPhi*cosDelta;lengthSum.add(atan2(sqrt(x*x+y*y),z)),lambda0$2=lambda,sinPhi0$1=sinPhi,cosPhi0$1=cosPhi}function containsGeometry(geometry,point){return!(!geometry||!containsGeometryType.hasOwnProperty(geometry.type))&&containsGeometryType[geometry.type](geometry,point)}function containsPoint(coordinates,point){return 0===distance(coordinates,point)}function containsLine(coordinates,point){var ab=distance(coordinates[0],coordinates[1]);return distance(coordinates[0],point)+distance(point,coordinates[1])<=ab+epsilon}function containsPolygon(coordinates,point){return!!polygonContains(coordinates.map(ringRadians),pointRadians(point))}function ringRadians(ring){return ring=ring.map(pointRadians),ring.pop(),ring}function pointRadians(point){return[point[0]*radians,point[1]*radians]}function graticuleX(y0,y1,dy){var y=d3Array.range(y0,y1-epsilon,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function graticuleY(x0,x1,dx){var x=d3Array.range(x0,x1-epsilon,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function graticule(){function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3Array.range(ceil(X0/DX)*DX,X1,DX).map(X).concat(d3Array.range(ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3Array.range(ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs(x%DX)>epsilon}).map(x)).concat(d3Array.range(ceil(y0/dy)*dy,y1,dy).filter(function(y){return abs(y%DY)>epsilon}).map(y))}var x1,x0,X1,X0,y1,y0,Y1,Y0,x,y,X,Y,dx=10,dy=dx,DX=90,DY=360,precision=2.5;return graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})},graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}},graticule.extent=function(_){return arguments.length?graticule.extentMajor(_).extentMinor(_):graticule.extentMinor()},graticule.extentMajor=function(_){return arguments.length?(X0=+_[0][0],X1=+_[1][0],Y0=+_[0][1],Y1=+_[1][1],X0>X1&&(_=X0,X0=X1,X1=_),Y0>Y1&&(_=Y0,Y0=Y1,Y1=_),graticule.precision(precision)):[[X0,Y0],[X1,Y1]]},graticule.extentMinor=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],x0>x1&&(_=x0,x0=x1,x1=_),y0>y1&&(_=y0,y0=y1,y1=_),graticule.precision(precision)):[[x0,y0],[x1,y1]]},graticule.step=function(_){return arguments.length?graticule.stepMajor(_).stepMinor(_):graticule.stepMinor()},graticule.stepMajor=function(_){return arguments.length?(DX=+_[0],DY=+_[1],graticule):[DX,DY]},graticule.stepMinor=function(_){return arguments.length?(dx=+_[0],dy=+_[1],graticule):[dx,dy]},graticule.precision=function(_){return arguments.length?(precision=+_,x=graticuleX(y0,y1,90),y=graticuleY(x0,x1,precision),X=graticuleX(Y0,Y1,90),Y=graticuleY(X0,X1,precision),graticule):precision},graticule.extentMajor([[-180,-90+epsilon],[180,90-epsilon]]).extentMinor([[-180,-80-epsilon],[180,80+epsilon]])}function graticule10(){return graticule()()}function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaPointFirst$1(x,y){areaStream$1.point=areaPoint$1,x00=x0$1=x,y00=y0$1=y}function areaPoint$1(x,y){areaRingSum$1.add(y0$1*x-x0$1*y),x0$1=x,y0$1=y}function areaRingEnd$1(){areaPoint$1(x00,y00)}function boundsPoint$1(x,y){x<x0$2&&(x0$2=x),x>x1&&(x1=x),y<y0$2&&(y0$2=y),y>y1&&(y1=y)}function centroidPoint$1(x,y){X0$1+=x,Y0$1+=y,++Z0$1}function centroidLineStart$1(){centroidStream$1.point=centroidPointFirstLine}function centroidPointFirstLine(x,y){centroidStream$1.point=centroidPointLine,centroidPoint$1(x0$3=x,y0$3=y)}function centroidPointLine(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,centroidPoint$1(x0$3=x,y0$3=y)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){
centroidStream$1.point=centroidPointFirstRing}function centroidRingEnd$1(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(x,y){centroidStream$1.point=centroidPointRing,centroidPoint$1(x00$1=x0$3=x,y00$1=y0$3=y)}function centroidPointRing(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,z=y0$3*x-x0$3*y,X2$1+=z*(x0$3+x),Y2$1+=z*(y0$3+y),Z2$1+=3*z,centroidPoint$1(x0$3=x,y0$3=y)}function PathContext(context){this._context=context}function lengthPointFirst$1(x,y){lengthStream$1.point=lengthPoint$1,x00$2=x0$4=x,y00$2=y0$4=y}function lengthPoint$1(x,y){x0$4-=x,y0$4-=y,lengthSum$1.add(sqrt(x0$4*x0$4+y0$4*y0$4)),x0$4=x,y0$4=y}function PathString(){this._string=[]}function circle$1(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}function transformer(methods){return function(stream){var s=new TransformStream;for(var key in methods)s[key]=methods[key];return s.stream=stream,s}}function TransformStream(){}function fit(projection,fitBounds,object){var clip=projection.clipExtent&&projection.clipExtent();return projection.scale(150).translate([0,0]),null!=clip&&projection.clipExtent(null),geoStream(object,projection.stream(boundsStream$1)),fitBounds(boundsStream$1.result()),null!=clip&&projection.clipExtent(clip),projection}function fitExtent(projection,extent,object){return fit(projection,function(b){var w=extent[1][0]-extent[0][0],h=extent[1][1]-extent[0][1],k=Math.min(w/(b[1][0]-b[0][0]),h/(b[1][1]-b[0][1])),x=+extent[0][0]+(w-k*(b[1][0]+b[0][0]))/2,y=+extent[0][1]+(h-k*(b[1][1]+b[0][1]))/2;projection.scale(150*k).translate([x,y])},object)}function fitSize(projection,size,object){return fitExtent(projection,[[0,0],size],object)}function fitWidth(projection,width,object){return fit(projection,function(b){var w=+width,k=w/(b[1][0]-b[0][0]),x=(w-k*(b[1][0]+b[0][0]))/2,y=-k*b[0][1];projection.scale(150*k).translate([x,y])},object)}function fitHeight(projection,height,object){return fit(projection,function(b){var h=+height,k=h/(b[1][1]-b[0][1]),x=-k*b[0][0],y=(h-k*(b[1][1]+b[0][1]))/2;projection.scale(150*k).translate([x,y])},object)}function resampleNone(project){return transformer({point:function(x,y){x=project(x,y),this.stream.point(x[0],x[1])}})}function resample$1(project,delta2){function resampleLineTo(x0,y0,lambda0,a0,b0,c0,x1,y1,lambda1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*delta2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=sqrt(a*a+b*b+c*c),phi2=asin(c/=m),lambda2=abs(abs(c)-1)<epsilon||abs(lambda0-lambda1)<epsilon?(lambda0+lambda1)/2:atan2(b,a),p=project(lambda2,phi2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;(dz*dz/d2>delta2||abs((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<cosMinDistance)&&(resampleLineTo(x0,y0,lambda0,a0,b0,c0,x2,y2,lambda2,a/=m,b/=m,c,depth,stream),stream.point(x2,y2),resampleLineTo(x2,y2,lambda2,a,b,c,x1,y1,lambda1,a1,b1,c1,depth,stream))}}return function(stream){function point(x,y){x=project(x,y),stream.point(x[0],x[1])}function lineStart(){x0=NaN,resampleStream.point=linePoint,stream.lineStart()}function linePoint(lambda,phi){var c=cartesian([lambda,phi]),p=project(lambda,phi);resampleLineTo(x0,y0,lambda0,a0,b0,c0,x0=p[0],y0=p[1],lambda0=lambda,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream),stream.point(x0,y0)}function lineEnd(){resampleStream.point=point,stream.lineEnd()}function ringStart(){lineStart(),resampleStream.point=ringPoint,resampleStream.lineEnd=ringEnd}function ringPoint(lambda,phi){linePoint(lambda00=lambda,phi),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0,resampleStream.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,lambda0,a0,b0,c0,x00,y00,lambda00,a00,b00,c00,maxDepth,stream),resampleStream.lineEnd=lineEnd,lineEnd()}var lambda00,x00,y00,a00,b00,c00,lambda0,x0,y0,a0,b0,c0,resampleStream={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart(),resampleStream.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd(),resampleStream.lineStart=lineStart}};return resampleStream}}function transformRotate(rotate){return transformer({point:function(x,y){var r=rotate(x,y);return this.stream.point(r[0],r[1])}})}function projection(project){return projectionMutator(function(){return project})()}function projectionMutator(projectAt){function projection(point){return point=projectRotate(point[0]*radians,point[1]*radians),[point[0]*k+dx,dy-point[1]*k]}function invert(point){return(point=projectRotate.invert((point[0]-dx)/k,(dy-point[1])/k))&&[point[0]*degrees,point[1]*degrees]}function projectTransform(x,y){return x=project(x,y),[x[0]*k+dx,dy-x[1]*k]}function recenter(){projectRotate=compose(rotate=rotateRadians(deltaLambda,deltaPhi,deltaGamma),project);var center=project(lambda,phi);return dx=x-center[0]*k,dy=y+center[1]*k,reset()}function reset(){return cache=cacheStream=null,projection}var project,dx,dy,rotate,projectRotate,y0,x1,y1,cache,cacheStream,k=150,x=480,y=250,lambda=0,phi=0,deltaLambda=0,deltaPhi=0,deltaGamma=0,theta=null,preclip=clipAntimeridian,x0=null,postclip=identity,delta2=.5,projectResample=resample(projectTransform,delta2);return projection.stream=function(stream){return cache&&cacheStream===stream?cache:cache=transformRadians(transformRotate(rotate)(preclip(projectResample(postclip(cacheStream=stream)))))},projection.preclip=function(_){return arguments.length?(preclip=_,theta=void 0,reset()):preclip},projection.postclip=function(_){return arguments.length?(postclip=_,x0=y0=x1=y1=null,reset()):postclip},projection.clipAngle=function(_){return arguments.length?(preclip=+_?clipCircle(theta=_*radians):(theta=null,clipAntimeridian),reset()):theta*degrees},projection.clipExtent=function(_){return arguments.length?(postclip=null==_?(x0=y0=x1=y1=null,identity):clipRectangle(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},projection.scale=function(_){return arguments.length?(k=+_,recenter()):k},projection.translate=function(_){return arguments.length?(x=+_[0],y=+_[1],recenter()):[x,y]},projection.center=function(_){return arguments.length?(lambda=_[0]%360*radians,phi=_[1]%360*radians,recenter()):[lambda*degrees,phi*degrees]},projection.rotate=function(_){return arguments.length?(deltaLambda=_[0]%360*radians,deltaPhi=_[1]%360*radians,deltaGamma=_.length>2?_[2]%360*radians:0,recenter()):[deltaLambda*degrees,deltaPhi*degrees,deltaGamma*degrees]},projection.precision=function(_){return arguments.length?(projectResample=resample(projectTransform,delta2=_*_),reset()):sqrt(delta2)},projection.fitExtent=function(extent,object){return fitExtent(projection,extent,object)},projection.fitSize=function(size,object){return fitSize(projection,size,object)},projection.fitWidth=function(width,object){return fitWidth(projection,width,object)},projection.fitHeight=function(height,object){return fitHeight(projection,height,object)},function(){return project=projectAt.apply(this,arguments),projection.invert=project.invert&&invert,recenter()}}function conicProjection(projectAt){var phi0=0,phi1=pi/3,m=projectionMutator(projectAt),p=m(phi0,phi1);return p.parallels=function(_){return arguments.length?m(phi0=_[0]*radians,phi1=_[1]*radians):[phi0*degrees,phi1*degrees]},p}function cylindricalEqualAreaRaw(phi0){function forward(lambda,phi){return[lambda*cosPhi0,sin(phi)/cosPhi0]}var cosPhi0=cos(phi0);return forward.invert=function(x,y){return[x/cosPhi0,asin(y*cosPhi0)]},forward}function conicEqualAreaRaw(y0,y1){function project(x,y){var r=sqrt(c-2*n*sin(y))/n;return[r*sin(x*=n),r0-r*cos(x)]}var sy0=sin(y0),n=(sy0+sin(y1))/2;if(abs(n)<epsilon)return cylindricalEqualAreaRaw(y0);var c=1+sy0*(2*n-sy0),r0=sqrt(c)/n;return project.invert=function(x,y){var r0y=r0-y;return[atan2(x,abs(r0y))/n*sign(r0y),asin((c-(x*x+r0y*r0y)*n*n)/(2*n))]},project}function multiplex(streams){var n=streams.length;return{point:function(x,y){for(var i=-1;++i<n;)streams[i].point(x,y)},sphere:function(){for(var i=-1;++i<n;)streams[i].sphere()},lineStart:function(){for(var i=-1;++i<n;)streams[i].lineStart()},lineEnd:function(){for(var i=-1;++i<n;)streams[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<n;)streams[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<n;)streams[i].polygonEnd()}}}function azimuthalRaw(scale){return function(x,y){var cx=cos(x),cy=cos(y),k=scale(cx*cy);return[k*cy*sin(x),k*sin(y)]}}function azimuthalInvert(angle){return function(x,y){var z=sqrt(x*x+y*y),c=angle(z),sc=sin(c),cc=cos(c);return[atan2(x*sc,z*cc),asin(z&&y*sc/z)]}}function mercatorRaw(lambda,phi){return[lambda,log(tan((halfPi+phi)/2))]}function mercatorProjection(project){function reclip(){var k=pi*scale(),t=m(rotation(m.rotate()).invert([0,0]));return clipExtent(null==x0?[[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]]:project===mercatorRaw?[[Math.max(t[0]-k,x0),y0],[Math.min(t[0]+k,x1),y1]]:[[x0,Math.max(t[1]-k,y0)],[x1,Math.min(t[1]+k,y1)]])}var y0,x1,y1,m=projection(project),center=m.center,scale=m.scale,translate=m.translate,clipExtent=m.clipExtent,x0=null;return m.scale=function(_){return arguments.length?(scale(_),reclip()):scale()},m.translate=function(_){return arguments.length?(translate(_),reclip()):translate()},m.center=function(_){return arguments.length?(center(_),reclip()):center()},m.clipExtent=function(_){return arguments.length?(null==_?x0=y0=x1=y1=null:(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reclip()):null==x0?null:[[x0,y0],[x1,y1]]},reclip()}function tany(y){return tan((halfPi+y)/2)}function conicConformalRaw(y0,y1){function project(x,y){f>0?y<-halfPi+epsilon&&(y=-halfPi+epsilon):y>halfPi-epsilon&&(y=halfPi-epsilon);var r=f/pow(tany(y),n);return[r*sin(n*x),f-r*cos(n*x)]}var cy0=cos(y0),n=y0===y1?sin(y0):log(cy0/cos(y1))/log(tany(y1)/tany(y0)),f=cy0*pow(tany(y0),n)/n;return n?(project.invert=function(x,y){var fy=f-y,r=sign(n)*sqrt(x*x+fy*fy);return[atan2(x,abs(fy))/n*sign(fy),2*atan(pow(f/r,1/n))-halfPi]},project):mercatorRaw}function equirectangularRaw(lambda,phi){return[lambda,phi]}function conicEquidistantRaw(y0,y1){function project(x,y){var gy=g-y,nx=n*x;return[gy*sin(nx),g-gy*cos(nx)]}var cy0=cos(y0),n=y0===y1?sin(y0):(cy0-cos(y1))/(y1-y0),g=cy0/n+y0;return abs(n)<epsilon?equirectangularRaw:(project.invert=function(x,y){var gy=g-y;return[atan2(x,abs(gy))/n*sign(gy),g-sign(n)*sqrt(x*x+gy*gy)]},project)}function gnomonicRaw(x,y){var cy=cos(y),k=cos(x)*cy;return[cy*sin(x)/k,sin(y)/k]}function scaleTranslate(kx,ky,tx,ty){return 1===kx&&1===ky&&0===tx&&0===ty?identity:transformer({point:function(x,y){this.stream.point(x*kx+tx,y*ky+ty)}})}function naturalEarth1Raw(lambda,phi){var phi2=phi*phi,phi4=phi2*phi2;return[lambda*(.8707-.131979*phi2+phi4*(phi4*(.003971*phi2-.001529*phi4)-.013791)),phi*(1.007226+phi2*(.015085+phi4*(.028874*phi2-.044475-.005916*phi4)))]}function orthographicRaw(x,y){return[cos(y)*sin(x),sin(y)]}function stereographicRaw(x,y){var cy=cos(y),k=1+cos(x)*cy;return[cy*sin(x)/k,sin(y)/k]}function transverseMercatorRaw(lambda,phi){return[log(tan((halfPi+phi)/2)),-lambda]}var adder=function(){return new Adder};Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(y){add(temp,y,this.t),add(this,temp.s,this.s),this.s?this.t+=temp.t:this.s=temp.t},valueOf:function(){return this.s}};var lambda00,phi00,lambda0,cosPhi0,sinPhi0,lambda0$1,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,ranges,range$1,W0,W1,X0,Y0,Z0,X1,Y1,Z1,X2,Y2,Z2,lambda00$2,phi00$2,x0,y0,z0,temp=new Adder,epsilon=1e-6,pi=Math.PI,halfPi=pi/2,quarterPi=pi/4,tau=2*pi,degrees=180/pi,radians=pi/180,abs=Math.abs,atan=Math.atan,atan2=Math.atan2,cos=Math.cos,ceil=Math.ceil,exp=Math.exp,log=Math.log,pow=Math.pow,sin=Math.sin,sign=Math.sign||function(x){return x>0?1:x<0?-1:0},sqrt=Math.sqrt,tan=Math.tan,streamObjectType={Feature:function(object,stream){streamGeometry(object.geometry,stream)},FeatureCollection:function(object,stream){for(var features=object.features,i=-1,n=features.length;++i<n;)streamGeometry(features[i].geometry,stream)}},streamGeometryType={Sphere:function(object,stream){stream.sphere()},Point:function(object,stream){object=object.coordinates,stream.point(object[0],object[1],object[2])},MultiPoint:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)object=coordinates[i],stream.point(object[0],object[1],object[2])},LineString:function(object,stream){streamLine(object.coordinates,stream,0)},MultiLineString:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamLine(coordinates[i],stream,0)},Polygon:function(object,stream){streamPolygon(object.coordinates,stream)},MultiPolygon:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamPolygon(coordinates[i],stream)},GeometryCollection:function(object,stream){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)streamGeometry(geometries[i],stream)}},geoStream=function(object,stream){object&&streamObjectType.hasOwnProperty(object.type)?streamObjectType[object.type](object,stream):streamGeometry(object,stream)},areaRingSum=adder(),areaSum=adder(),areaStream={point:noop,lineStart:noop,lineEnd:noop,polygonStart:function(){areaRingSum.reset(),areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){var areaRing=+areaRingSum;areaSum.add(areaRing<0?tau+areaRing:areaRing),this.lineStart=this.lineEnd=this.point=noop},sphere:function(){areaSum.add(tau)}},area=function(object){return areaSum.reset(),geoStream(object,areaStream),2*areaSum},deltaSum=adder(),boundsStream={point:boundsPoint,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream.point=boundsRingPoint,boundsStream.lineStart=boundsRingStart,boundsStream.lineEnd=boundsRingEnd,deltaSum.reset(),areaStream.polygonStart()},polygonEnd:function(){areaStream.polygonEnd(),boundsStream.point=boundsPoint,boundsStream.lineStart=boundsLineStart,boundsStream.lineEnd=boundsLineEnd,areaRingSum<0?(lambda0$1=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon?phi1=90:deltaSum<-epsilon&&(phi0=-90),range$1[0]=lambda0$1,range$1[1]=lambda1}},bounds=function(feature){var i,n,a,b,merged,deltaMax,delta;if(phi1=lambda1=-(lambda0$1=phi0=1/0),ranges=[],geoStream(feature,boundsStream),n=ranges.length){for(ranges.sort(rangeCompare),i=1,a=ranges[0],merged=[a];i<n;++i)b=ranges[i],rangeContains(a,b[0])||rangeContains(a,b[1])?(angle(a[0],b[1])>angle(a[0],a[1])&&(a[1]=b[1]),angle(b[0],a[1])>angle(a[0],a[1])&&(a[0]=b[0])):merged.push(a=b);for(deltaMax=-1/0,n=merged.length-1,i=0,a=merged[n];i<=n;a=b,++i)b=merged[i],(delta=angle(a[1],b[0]))>deltaMax&&(deltaMax=delta,lambda0$1=b[0],lambda1=a[1])}return ranges=range$1=null,lambda0$1===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0$1,phi0],[lambda1,phi1]]},centroidStream={sphere:noop,point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd}},centroid=function(object){W0=W1=X0=Y0=Z0=X1=Y1=Z1=X2=Y2=Z2=0,geoStream(object,centroidStream);var x=X2,y=Y2,z=Z2,m=x*x+y*y+z*z;return m<1e-12&&(x=X1,y=Y1,z=Z1,W1<epsilon&&(x=X0,y=Y0,z=Z0),(m=x*x+y*y+z*z)<1e-12)?[NaN,NaN]:[atan2(y,x)*degrees,asin(z/sqrt(m))*degrees]},constant=function(x){return function(){return x}},compose=function(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(compose.invert=function(x,y){return(x=b.invert(x,y))&&a.invert(x[0],x[1])}),compose};rotationIdentity.invert=rotationIdentity;var lambda0$2,sinPhi0$1,cosPhi0$1,x00,y00,x0$1,y0$1,x00$1,y00$1,x0$3,y0$3,rotation=function(rotate){function forward(coordinates){return coordinates=rotate(coordinates[0]*radians,coordinates[1]*radians),coordinates[0]*=degrees,coordinates[1]*=degrees,coordinates}return rotate=rotateRadians(rotate[0]*radians,rotate[1]*radians,rotate.length>2?rotate[2]*radians:0),forward.invert=function(coordinates){return coordinates=rotate.invert(coordinates[0]*radians,coordinates[1]*radians),coordinates[0]*=degrees,coordinates[1]*=degrees,coordinates},forward},circle=function(){function point(x,y){ring.push(x=rotate(x,y)),x[0]*=degrees,x[1]*=degrees}function circle(){var c=center.apply(this,arguments),r=radius.apply(this,arguments)*radians,p=precision.apply(this,arguments)*radians;return ring=[],rotate=rotateRadians(-c[0]*radians,-c[1]*radians,0).invert,circleStream(stream,r,p,1),c={type:"Polygon",coordinates:[ring]},ring=rotate=null,c}var ring,rotate,center=constant([0,0]),radius=constant(90),precision=constant(6),stream={point:point};return circle.center=function(_){return arguments.length?(center="function"==typeof _?_:constant([+_[0],+_[1]]),circle):center},circle.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),circle):radius},circle.precision=function(_){return arguments.length?(precision="function"==typeof _?_:constant(+_),circle):precision},circle},clipBuffer=function(){var line,lines=[];return{point:function(x,y){line.push([x,y])},lineStart:function(){lines.push(line=[])},lineEnd:noop,rejoin:function(){lines.length>1&&lines.push(lines.pop().concat(lines.shift()))},result:function(){var result=lines;return lines=[],line=null,result}}},pointEqual=function(a,b){return abs(a[0]-b[0])<epsilon&&abs(a[1]-b[1])<epsilon},clipRejoin=function(segments,compareIntersection,startInside,interpolate,stream){var i,n,subject=[],clip=[];if(segments.forEach(function(segment){if(!((n=segment.length-1)<=0)){var n,x,p0=segment[0],p1=segment[n];if(pointEqual(p0,p1)){for(stream.lineStart(),i=0;i<n;++i)stream.point((p0=segment[i])[0],p0[1]);return void stream.lineEnd()}subject.push(x=new Intersection(p0,segment,null,!0)),clip.push(x.o=new Intersection(p0,null,x,!1)),subject.push(x=new Intersection(p1,segment,null,!1)),clip.push(x.o=new Intersection(p1,null,x,!0))}}),subject.length){for(clip.sort(compareIntersection),link(subject),link(clip),i=0,n=clip.length;i<n;++i)clip[i].e=startInside=!startInside;for(var points,point,start=subject[0];;){for(var current=start,isSubject=!0;current.v;)if((current=current.n)===start)return;points=current.z,stream.lineStart();do{if(current.v=current.o.v=!0,current.e){if(isSubject)for(i=0,n=points.length;i<n;++i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,stream);current=current.n}else{if(isSubject)for(points=current.p.z,i=points.length-1;i>=0;--i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.p.x,-1,stream);current=current.p}current=current.o,points=current.z,isSubject=!isSubject}while(!current.v);stream.lineEnd()}}},sum=adder(),polygonContains=function(polygon,point){var lambda=point[0],phi=point[1],normal=[sin(lambda),-cos(lambda),0],angle=0,winding=0;sum.reset();for(var i=0,n=polygon.length;i<n;++i)if(m=(ring=polygon[i]).length)for(var ring,m,point0=ring[m-1],lambda0=point0[0],phi0=point0[1]/2+quarterPi,sinPhi0=sin(phi0),cosPhi0=cos(phi0),j=0;j<m;++j,lambda0=lambda1,sinPhi0=sinPhi1,cosPhi0=cosPhi1,point0=point1){var point1=ring[j],lambda1=point1[0],phi1=point1[1]/2+quarterPi,sinPhi1=sin(phi1),cosPhi1=cos(phi1),delta=lambda1-lambda0,sign$$1=delta>=0?1:-1,absDelta=sign$$1*delta,antimeridian=absDelta>pi,k=sinPhi0*sinPhi1;if(sum.add(atan2(k*sign$$1*sin(absDelta),cosPhi0*cosPhi1+k*cos(absDelta))),angle+=antimeridian?delta+sign$$1*tau:delta,antimeridian^lambda0>=lambda^lambda1>=lambda){var arc=cartesianCross(cartesian(point0),cartesian(point1));cartesianNormalizeInPlace(arc);var intersection=cartesianCross(normal,arc);cartesianNormalizeInPlace(intersection);var phiArc=(antimeridian^delta>=0?-1:1)*asin(intersection[2]);(phi>phiArc||phi===phiArc&&(arc[0]||arc[1]))&&(winding+=antimeridian^delta>=0?1:-1)}}return(angle<-epsilon||angle<epsilon&&sum<-epsilon)^1&winding},clip=function(pointVisible,clipLine,interpolate,start){return function(sink){function point(lambda,phi){pointVisible(lambda,phi)&&sink.point(lambda,phi)}function pointLine(lambda,phi){line.point(lambda,phi)}function lineStart(){clip.point=pointLine,line.lineStart()}function lineEnd(){clip.point=point,line.lineEnd()}function pointRing(lambda,phi){ring.push([lambda,phi]),ringSink.point(lambda,phi)}function ringStart(){ringSink.lineStart(),ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]),ringSink.lineEnd();var i,m,segment,point,clean=ringSink.clean(),ringSegments=ringBuffer.result(),n=ringSegments.length;if(ring.pop(),polygon.push(ring),ring=null,n)if(1&clean){if(segment=ringSegments[0],(m=segment.length-1)>0){for(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),i=0;i<m;++i)sink.point((point=segment[i])[0],point[1]);sink.lineEnd()}}else n>1&&2&clean&&ringSegments.push(ringSegments.pop().concat(ringSegments.shift())),segments.push(ringSegments.filter(validSegment))}var polygon,segments,ring,line=clipLine(sink),ringBuffer=clipBuffer(),ringSink=clipLine(ringBuffer),polygonStarted=!1,clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing,clip.lineStart=ringStart,clip.lineEnd=ringEnd,segments=[],polygon=[]},polygonEnd:function(){clip.point=point,clip.lineStart=lineStart,clip.lineEnd=lineEnd,segments=d3Array.merge(segments);var startInside=polygonContains(polygon,start);segments.length?(polygonStarted||(sink.polygonStart(),polygonStarted=!0),clipRejoin(segments,compareIntersection,startInside,interpolate,sink)):startInside&&(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd()),polygonStarted&&(sink.polygonEnd(),polygonStarted=!1),segments=polygon=null},sphere:function(){sink.polygonStart(),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd(),sink.polygonEnd()}};return clip}},clipAntimeridian=clip(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi,-halfPi]),clipCircle=function(radius){function interpolate(from,to,direction,stream){circleStream(stream,radius,delta,direction,from,to)}function visible(lambda,phi){return cos(lambda)*cos(phi)>cr}function clipLine(stream){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=!1,clean=1},point:function(lambda,phi){var point2,point1=[lambda,phi],v=visible(lambda,phi),c=smallRadius?v?0:code(lambda,phi):v?code(lambda+(lambda<0?pi:-pi),phi):0;if(!point0&&(v00=v0=v)&&stream.lineStart(),v!==v0&&(!(point2=intersect(point0,point1))||pointEqual(point0,point2)||pointEqual(point1,point2))&&(point1[0]+=epsilon,point1[1]+=epsilon,v=visible(point1[0],point1[1])),v!==v0)clean=0,v?(stream.lineStart(),point2=intersect(point1,point0),stream.point(point2[0],point2[1])):(point2=intersect(point0,point1),stream.point(point2[0],point2[1]),stream.lineEnd()),point0=point2;else if(notHemisphere&&point0&&smallRadius^v){var t;c&c0||!(t=intersect(point1,point0,!0))||(clean=0,smallRadius?(stream.lineStart(),stream.point(t[0][0],t[0][1]),stream.point(t[1][0],t[1][1]),stream.lineEnd()):(stream.point(t[1][0],t[1][1]),stream.lineEnd(),stream.lineStart(),stream.point(t[0][0],t[0][1])))}!v||point0&&pointEqual(point0,point1)||stream.point(point1[0],point1[1]),point0=point1,v0=v,c0=c},lineEnd:function(){v0&&stream.lineEnd(),point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=cartesian(a),pb=cartesian(b),n1=[1,0,0],n2=cartesianCross(pa,pb),n2n2=cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=cartesianCross(n1,n2),A=cartesianScale(n1,c1);cartesianAddInPlace(A,cartesianScale(n2,c2));var u=n1xn2,w=cartesianDot(A,u),uu=cartesianDot(u,u),t2=w*w-uu*(cartesianDot(A,A)-1);if(!(t2<0)){var t=sqrt(t2),q=cartesianScale(u,(-w-t)/uu);if(cartesianAddInPlace(q,A),q=spherical(q),!two)return q;var z,lambda0=a[0],lambda1=b[0],phi0=a[1],phi1=b[1];lambda1<lambda0&&(z=lambda0,lambda0=lambda1,lambda1=z);var delta=lambda1-lambda0,polar=abs(delta-pi)<epsilon,meridian=polar||delta<epsilon;if(!polar&&phi1<phi0&&(z=phi0,phi0=phi1,phi1=z),meridian?polar?phi0+phi1>0^q[1]<(abs(q[0]-lambda0)<epsilon?phi0:phi1):phi0<=q[1]&&q[1]<=phi1:delta>pi^(lambda0<=q[0]&&q[0]<=lambda1)){var q1=cartesianScale(u,(-w+t)/uu);return cartesianAddInPlace(q1,A),[q,spherical(q1)]}}}function code(lambda,phi){var r=smallRadius?radius:pi-radius,code=0;return lambda<-r?code|=1:lambda>r&&(code|=2),phi<-r?code|=4:phi>r&&(code|=8),code}var cr=cos(radius),delta=6*radians,smallRadius=cr>0,notHemisphere=abs(cr)>epsilon;return clip(visible,clipLine,interpolate,smallRadius?[0,-radius]:[-pi,radius-pi])},clipLine=function(a,b,x0,y0,x1,y1){var r,ax=a[0],ay=a[1],bx=b[0],by=b[1],t0=0,t1=1,dx=bx-ax,dy=by-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return t0>0&&(a[0]=ax+t0*dx,a[1]=ay+t0*dy),t1<1&&(b[0]=ax+t1*dx,b[1]=ay+t1*dy),!0}}}}},clipMax=1e9,clipMin=-clipMax,extent=function(){var cache,cacheStream,clip,x0=0,y0=0,x1=960,y1=500;return clip={stream:function(stream){return cache&&cacheStream===stream?cache:cache=clipRectangle(x0,y0,x1,y1)(cacheStream=stream)},extent:function(_){return arguments.length?(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1],cache=cacheStream=null,clip):[[x0,y0],[x1,y1]]}}},lengthSum=adder(),lengthStream={sphere:noop,point:noop,lineStart:lengthLineStart,lineEnd:noop,polygonStart:noop,polygonEnd:noop},length=function(object){return lengthSum.reset(),geoStream(object,lengthStream),+lengthSum},coordinates=[null,null],object={type:"LineString",coordinates:coordinates},distance=function(a,b){return coordinates[0]=a,coordinates[1]=b,length(object)},containsObjectType={Feature:function(object,point){return containsGeometry(object.geometry,point)},FeatureCollection:function(object,point){for(var features=object.features,i=-1,n=features.length;++i<n;)if(containsGeometry(features[i].geometry,point))return!0;return!1}},containsGeometryType={Sphere:function(){return!0},Point:function(object,point){return containsPoint(object.coordinates,point)},MultiPoint:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsPoint(coordinates[i],point))return!0;return!1},LineString:function(object,point){return containsLine(object.coordinates,point)},MultiLineString:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsLine(coordinates[i],point))return!0;return!1},Polygon:function(object,point){return containsPolygon(object.coordinates,point)},MultiPolygon:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsPolygon(coordinates[i],point))return!0;return!1},GeometryCollection:function(object,point){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)if(containsGeometry(geometries[i],point))return!0;return!1}},contains=function(object,point){return(object&&containsObjectType.hasOwnProperty(object.type)?containsObjectType[object.type]:containsGeometry)(object,point)},interpolate=function(a,b){var x0=a[0]*radians,y0=a[1]*radians,x1=b[0]*radians,y1=b[1]*radians,cy0=cos(y0),sy0=sin(y0),cy1=cos(y1),sy1=sin(y1),kx0=cy0*cos(x0),ky0=cy0*sin(x0),kx1=cy1*cos(x1),ky1=cy1*sin(x1),d=2*asin(sqrt(haversin(y1-y0)+cy0*cy1*haversin(x1-x0))),k=sin(d),interpolate=d?function(t){var B=sin(t*=d)/k,A=sin(d-t)/k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[atan2(y,x)*degrees,atan2(z,sqrt(x*x+y*y))*degrees]}:function(){return[x0*degrees,y0*degrees]};return interpolate.distance=d,interpolate},identity=function(x){return x},areaSum$1=adder(),areaRingSum$1=adder(),areaStream$1={point:noop,lineStart:noop,lineEnd:noop,polygonStart:function(){areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){areaStream$1.lineStart=areaStream$1.lineEnd=areaStream$1.point=noop,areaSum$1.add(abs(areaRingSum$1)),areaRingSum$1.reset()},result:function(){var area=areaSum$1/2;return areaSum$1.reset(),area}},x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream$1={point:boundsPoint$1,lineStart:noop,lineEnd:noop,polygonStart:noop,polygonEnd:noop,result:function(){var bounds=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),bounds}},X0$1=0,Y0$1=0,Z0$1=0,X1$1=0,Y1$1=0,Z1$1=0,X2$1=0,Y2$1=0,Z2$1=0,centroidStream$1={point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.point=centroidPoint$1,centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1},result:function(){var centroid=Z2$1?[X2$1/Z2$1,Y2$1/Z2$1]:Z1$1?[X1$1/Z1$1,Y1$1/Z1$1]:Z0$1?[X0$1/Z0$1,Y0$1/Z0$1]:[NaN,NaN];return X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=X2$1=Y2$1=Z2$1=0,centroid}};PathContext.prototype={_radius:4.5,pointRadius:function(_){return this._radius=_,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._context.moveTo(x,y),this._point=1;break;case 1:this._context.lineTo(x,y);break;default:this._context.moveTo(x+this._radius,y),this._context.arc(x,y,this._radius,0,tau)}},result:noop};var lengthRing,x00$2,y00$2,x0$4,y0$4,lengthSum$1=adder(),lengthStream$1={point:noop,lineStart:function(){lengthStream$1.point=lengthPointFirst$1},lineEnd:function(){lengthRing&&lengthPoint$1(x00$2,y00$2),lengthStream$1.point=noop},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var length=+lengthSum$1;return lengthSum$1.reset(),length}};PathString.prototype={_radius:4.5,_circle:circle$1(4.5),pointRadius:function(_){return(_=+_)!==this._radius&&(this._radius=_,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._string.push("M",x,",",y),this._point=1;break;case 1:this._string.push("L",x,",",y);break;default:null==this._circle&&(this._circle=circle$1(this._radius)),this._string.push("M",x,",",y,this._circle)}},result:function(){if(this._string.length){var result=this._string.join("");return this._string=[],result}return null}};var index=function(projection,context){function path(object){return object&&("function"==typeof pointRadius&&contextStream.pointRadius(+pointRadius.apply(this,arguments)),geoStream(object,projectionStream(contextStream))),contextStream.result()}var projectionStream,contextStream,pointRadius=4.5;return path.area=function(object){return geoStream(object,projectionStream(areaStream$1)),areaStream$1.result()},path.measure=function(object){return geoStream(object,projectionStream(lengthStream$1)),lengthStream$1.result()},path.bounds=function(object){return geoStream(object,projectionStream(boundsStream$1)),boundsStream$1.result()},path.centroid=function(object){return geoStream(object,projectionStream(centroidStream$1)),centroidStream$1.result()},path.projection=function(_){return arguments.length?(projectionStream=null==_?(projection=null,identity):(projection=_).stream,path):projection},path.context=function(_){return arguments.length?(contextStream=null==_?(context=null,new PathString):new PathContext(context=_),"function"!=typeof pointRadius&&contextStream.pointRadius(pointRadius),path):context},path.pointRadius=function(_){
return arguments.length?(pointRadius="function"==typeof _?_:(contextStream.pointRadius(+_),+_),path):pointRadius},path.projection(projection).context(context)},transform=function(methods){return{stream:transformer(methods)}};TransformStream.prototype={constructor:TransformStream,point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var maxDepth=16,cosMinDistance=cos(30*radians),resample=function(project,delta2){return+delta2?resample$1(project,delta2):resampleNone(project)},transformRadians=transformer({point:function(x,y){this.stream.point(x*radians,y*radians)}}),conicEqualArea=function(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])},albers=function(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},albersUsa=function(){function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];return point=null,lower48Point.point(x,y),point||(alaskaPoint.point(x,y),point)||(hawaiiPoint.point(x,y),point)}function reset(){return cache=cacheStream=null,albersUsa}var cache,cacheStream,lower48Point,alaskaPoint,hawaiiPoint,point,lower48=albers(),alaska=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),hawaii=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),pointStream={point:function(x,y){point=[x,y]}};return albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=-.214&&x<-.115?hawaii:lower48).invert(coordinates)},albersUsa.stream=function(stream){return cache&&cacheStream===stream?cache:cache=multiplex([lower48.stream(cacheStream=stream),alaska.stream(stream),hawaii.stream(stream)])},albersUsa.precision=function(_){return arguments.length?(lower48.precision(_),alaska.precision(_),hawaii.precision(_),reset()):lower48.precision()},albersUsa.scale=function(_){return arguments.length?(lower48.scale(_),alaska.scale(.35*_),hawaii.scale(_),albersUsa.translate(lower48.translate())):lower48.scale()},albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];return lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream),alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+epsilon,y+.12*k+epsilon],[x-.214*k-epsilon,y+.234*k-epsilon]]).stream(pointStream),hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+epsilon,y+.166*k+epsilon],[x-.115*k-epsilon,y+.234*k-epsilon]]).stream(pointStream),reset()},albersUsa.fitExtent=function(extent,object){return fitExtent(albersUsa,extent,object)},albersUsa.fitSize=function(size,object){return fitSize(albersUsa,size,object)},albersUsa.fitWidth=function(width,object){return fitWidth(albersUsa,width,object)},albersUsa.fitHeight=function(height,object){return fitHeight(albersUsa,height,object)},albersUsa.scale(1070)},azimuthalEqualAreaRaw=azimuthalRaw(function(cxcy){return sqrt(2/(1+cxcy))});azimuthalEqualAreaRaw.invert=azimuthalInvert(function(z){return 2*asin(z/2)});var azimuthalEqualArea=function(){return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(179.999)},azimuthalEquidistantRaw=azimuthalRaw(function(c){return(c=acos(c))&&c/sin(c)});azimuthalEquidistantRaw.invert=azimuthalInvert(function(z){return z});var azimuthalEquidistant=function(){return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(179.999)};mercatorRaw.invert=function(x,y){return[x,2*atan(exp(y))-halfPi]};var mercator=function(){return mercatorProjection(mercatorRaw).scale(961/tau)},conicConformal=function(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])};equirectangularRaw.invert=equirectangularRaw;var equirectangular=function(){return projection(equirectangularRaw).scale(152.63)},conicEquidistant=function(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])};gnomonicRaw.invert=azimuthalInvert(atan);var gnomonic=function(){return projection(gnomonicRaw).scale(144.049).clipAngle(60)},identity$1=function(){function reset(){return cache=cacheStream=null,projection}var y0,x1,y1,cache,cacheStream,projection,k=1,tx=0,ty=0,sx=1,sy=1,transform$$1=identity,x0=null,postclip=identity;return projection={stream:function(stream){return cache&&cacheStream===stream?cache:cache=transform$$1(postclip(cacheStream=stream))},postclip:function(_){return arguments.length?(postclip=_,x0=y0=x1=y1=null,reset()):postclip},clipExtent:function(_){return arguments.length?(postclip=null==_?(x0=y0=x1=y1=null,identity):clipRectangle(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},scale:function(_){return arguments.length?(transform$$1=scaleTranslate((k=+_)*sx,k*sy,tx,ty),reset()):k},translate:function(_){return arguments.length?(transform$$1=scaleTranslate(k*sx,k*sy,tx=+_[0],ty=+_[1]),reset()):[tx,ty]},reflectX:function(_){return arguments.length?(transform$$1=scaleTranslate(k*(sx=_?-1:1),k*sy,tx,ty),reset()):sx<0},reflectY:function(_){return arguments.length?(transform$$1=scaleTranslate(k*sx,k*(sy=_?-1:1),tx,ty),reset()):sy<0},fitExtent:function(extent,object){return fitExtent(projection,extent,object)},fitSize:function(size,object){return fitSize(projection,size,object)},fitWidth:function(width,object){return fitWidth(projection,width,object)},fitHeight:function(height,object){return fitHeight(projection,height,object)}}};naturalEarth1Raw.invert=function(x,y){var delta,phi=y,i=25;do{var phi2=phi*phi,phi4=phi2*phi2;phi-=delta=(phi*(1.007226+phi2*(.015085+phi4*(.028874*phi2-.044475-.005916*phi4)))-y)/(1.007226+phi2*(.045255+phi4*(.259866*phi2-.311325-.005916*11*phi4)))}while(abs(delta)>epsilon&&--i>0);return[x/(.8707+(phi2=phi*phi)*(phi2*(phi2*phi2*phi2*(.003971-.001529*phi2)-.013791)-.131979)),phi]};var naturalEarth1=function(){return projection(naturalEarth1Raw).scale(175.295)};orthographicRaw.invert=azimuthalInvert(asin);var orthographic=function(){return projection(orthographicRaw).scale(249.5).clipAngle(90+epsilon)};stereographicRaw.invert=azimuthalInvert(function(z){return 2*atan(z)});var stereographic=function(){return projection(stereographicRaw).scale(250).clipAngle(142)};transverseMercatorRaw.invert=function(x,y){return[-y,2*atan(exp(x))-halfPi]};var transverseMercator=function(){var m=mercatorProjection(transverseMercatorRaw),center=m.center,rotate=m.rotate;return m.center=function(_){return arguments.length?center([-_[1],_[0]]):(_=center(),[_[1],-_[0]])},m.rotate=function(_){return arguments.length?rotate([_[0],_[1],_.length>2?_[2]+90:90]):(_=rotate(),[_[0],_[1],_[2]-90])},rotate([0,0,90]).scale(159.155)};exports.geoArea=area,exports.geoBounds=bounds,exports.geoCentroid=centroid,exports.geoCircle=circle,exports.geoClipAntimeridian=clipAntimeridian,exports.geoClipCircle=clipCircle,exports.geoClipExtent=extent,exports.geoClipRectangle=clipRectangle,exports.geoContains=contains,exports.geoDistance=distance,exports.geoGraticule=graticule,exports.geoGraticule10=graticule10,exports.geoInterpolate=interpolate,exports.geoLength=length,exports.geoPath=index,exports.geoAlbers=albers,exports.geoAlbersUsa=albersUsa,exports.geoAzimuthalEqualArea=azimuthalEqualArea,exports.geoAzimuthalEqualAreaRaw=azimuthalEqualAreaRaw,exports.geoAzimuthalEquidistant=azimuthalEquidistant,exports.geoAzimuthalEquidistantRaw=azimuthalEquidistantRaw,exports.geoConicConformal=conicConformal,exports.geoConicConformalRaw=conicConformalRaw,exports.geoConicEqualArea=conicEqualArea,exports.geoConicEqualAreaRaw=conicEqualAreaRaw,exports.geoConicEquidistant=conicEquidistant,exports.geoConicEquidistantRaw=conicEquidistantRaw,exports.geoEquirectangular=equirectangular,exports.geoEquirectangularRaw=equirectangularRaw,exports.geoGnomonic=gnomonic,exports.geoGnomonicRaw=gnomonicRaw,exports.geoIdentity=identity$1,exports.geoProjection=projection,exports.geoProjectionMutator=projectionMutator,exports.geoMercator=mercator,exports.geoMercatorRaw=mercatorRaw,exports.geoNaturalEarth1=naturalEarth1,exports.geoNaturalEarth1Raw=naturalEarth1Raw,exports.geoOrthographic=orthographic,exports.geoOrthographicRaw=orthographicRaw,exports.geoStereographic=stereographic,exports.geoStereographicRaw=stereographicRaw,exports.geoTransverseMercator=transverseMercator,exports.geoTransverseMercatorRaw=transverseMercatorRaw,exports.geoRotation=rotation,exports.geoStream=geoStream,exports.geoTransform=transform,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-array":14}],27:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function defaultSeparation(a,b){return a.parent===b.parent?1:2}function meanX(children){return children.reduce(meanXReduce,0)/children.length}function meanXReduce(x,c){return x+c.x}function maxY(children){return 1+children.reduce(maxYReduce,0)}function maxYReduce(y,c){return Math.max(y,c.y)}function leafLeft(node){for(var children;children=node.children;)node=children[0];return node}function leafRight(node){for(var children;children=node.children;)node=children[children.length-1];return node}function count(node){var sum=0,children=node.children,i=children&&children.length;if(i)for(;--i>=0;)sum+=children[i].value;else sum=1;node.value=sum}function leastCommonAncestor(a,b){if(a===b)return a;var aNodes=a.ancestors(),bNodes=b.ancestors(),c=null;for(a=aNodes.pop(),b=bNodes.pop();a===b;)c=a,a=aNodes.pop(),b=bNodes.pop();return c}function hierarchy(data,children){var node,child,childs,i,n,root=new Node(data),valued=+data.value&&(root.value=data.value),nodes=[root];for(null==children&&(children=defaultChildren);node=nodes.pop();)if(valued&&(node.value=+node.data.value),(childs=children(node.data))&&(n=childs.length))for(node.children=new Array(n),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new Node(childs[i])),child.parent=node,child.depth=node.depth+1;return root.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(d){return d.children}function copyData(node){node.data=node.data.data}function computeHeight(node){var height=0;do{node.height=height}while((node=node.parent)&&node.height<++height)}function Node(data){this.data=data,this.depth=this.height=0,this.parent=null}function shuffle(array){for(var t,i,m=array.length;m;)i=Math.random()*m--|0,t=array[m],array[m]=array[i],array[i]=t;return array}function extendBasis(B,p){var i,j;if(enclosesWeakAll(p,B))return[p];for(i=0;i<B.length;++i)if(enclosesNot(p,B[i])&&enclosesWeakAll(encloseBasis2(B[i],p),B))return[B[i],p];for(i=0;i<B.length-1;++i)for(j=i+1;j<B.length;++j)if(enclosesNot(encloseBasis2(B[i],B[j]),p)&&enclosesNot(encloseBasis2(B[i],p),B[j])&&enclosesNot(encloseBasis2(B[j],p),B[i])&&enclosesWeakAll(encloseBasis3(B[i],B[j],p),B))return[B[i],B[j],p];throw new Error}function enclosesNot(a,b){var dr=a.r-b.r,dx=b.x-a.x,dy=b.y-a.y;return dr<0||dr*dr<dx*dx+dy*dy}function enclosesWeak(a,b){var dr=a.r-b.r+1e-6,dx=b.x-a.x,dy=b.y-a.y;return dr>0&&dr*dr>dx*dx+dy*dy}function enclosesWeakAll(a,B){for(var i=0;i<B.length;++i)if(!enclosesWeak(a,B[i]))return!1;return!0}function encloseBasis(B){switch(B.length){case 1:return encloseBasis1(B[0]);case 2:return encloseBasis2(B[0],B[1]);case 3:return encloseBasis3(B[0],B[1],B[2])}}function encloseBasis1(a){return{x:a.x,y:a.y,r:a.r}}function encloseBasis2(a,b){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x21=x2-x1,y21=y2-y1,r21=r2-r1,l=Math.sqrt(x21*x21+y21*y21);return{x:(x1+x2+x21/l*r21)/2,y:(y1+y2+y21/l*r21)/2,r:(l+r1+r2)/2}}function encloseBasis3(a,b,c){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x3=c.x,y3=c.y,r3=c.r,a2=x1-x2,a3=x1-x3,b2=y1-y2,b3=y1-y3,c2=r2-r1,c3=r3-r1,d1=x1*x1+y1*y1-r1*r1,d2=d1-x2*x2-y2*y2+r2*r2,d3=d1-x3*x3-y3*y3+r3*r3,ab=a3*b2-a2*b3,xa=(b2*d3-b3*d2)/(2*ab)-x1,xb=(b3*c2-b2*c3)/ab,ya=(a3*d2-a2*d3)/(2*ab)-y1,yb=(a2*c3-a3*c2)/ab,A=xb*xb+yb*yb-1,B=2*(r1+xa*xb+ya*yb),C=xa*xa+ya*ya-r1*r1,r=-(A?(B+Math.sqrt(B*B-4*A*C))/(2*A):C/B);return{x:x1+xa+xb*r,y:y1+ya+yb*r,r:r}}function place(a,b,c){var ax=a.x,ay=a.y,da=b.r+c.r,db=a.r+c.r,dx=b.x-ax,dy=b.y-ay,dc=dx*dx+dy*dy;if(dc){var x=.5+((db*=db)-(da*=da))/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=ax+x*dx+y*dy,c.y=ay+x*dy-y*dx}else c.x=ax+db,c.y=ay}function intersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return dr*dr-1e-6>dx*dx+dy*dy}function score(node){var a=node._,b=node.next._,ab=a.r+b.r,dx=(a.x*b.r+b.x*a.r)/ab,dy=(a.y*b.r+b.y*a.r)/ab;return dx*dx+dy*dy}function Node$1(circle){this._=circle,this.next=null,this.previous=null}function packEnclose(circles){if(!(n=circles.length))return 0;var a,b,c,n,aa,ca,i,j,k,sj,sk;if(a=circles[0],a.x=0,a.y=0,!(n>1))return a.r;if(b=circles[1],a.x=-b.r,b.x=a.r,b.y=0,!(n>2))return a.r+b.r;place(b,a,c=circles[2]),a=new Node$1(a),b=new Node$1(b),c=new Node$1(c),a.next=c.previous=b,b.next=a.previous=c,c.next=b.previous=a;pack:for(i=3;i<n;++i){place(a._,b._,c=circles[i]),c=new Node$1(c),j=b.next,k=a.previous,sj=b._.r,sk=a._.r;do{if(sj<=sk){if(intersects(j._,c._)){b=j,a.next=b,b.previous=a,--i;continue pack}sj+=j._.r,j=j.next}else{if(intersects(k._,c._)){a=k,a.next=b,b.previous=a,--i;continue pack}sk+=k._.r,k=k.previous}}while(j!==k.next);for(c.previous=a,c.next=b,a.next=b.previous=b=c,aa=score(a);(c=c.next)!==b;)(ca=score(c))<aa&&(a=c,aa=ca);b=a.next}for(a=[b._],c=b;(c=c.next)!==b;)a.push(c._);for(c=enclose(a),i=0;i<n;++i)a=circles[i],a.x-=c.x,a.y-=c.y;return c.r}function optional(f){return null==f?null:required(f)}function required(f){if("function"!=typeof f)throw new Error;return f}function constantZero(){return 0}function defaultRadius(d){return Math.sqrt(d.value)}function radiusLeaf(radius){return function(node){node.children||(node.r=Math.max(0,+radius(node)||0))}}function packChildren(padding,k){return function(node){if(children=node.children){var children,i,e,n=children.length,r=padding(node)*k||0;if(r)for(i=0;i<n;++i)children[i].r+=r;if(e=packEnclose(children),r)for(i=0;i<n;++i)children[i].r-=r;node.r=e+r}}}function translateChild(k){return function(node){var parent=node.parent;node.r*=k,parent&&(node.x=parent.x+k*node.x,node.y=parent.y+k*node.y)}}function defaultId(d){return d.id}function defaultParentId(d){return d.parentId}function defaultSeparation$1(a,b){return a.parent===b.parent?1:2}function nextLeft(v){var children=v.children;return children?children[0]:v.t}function nextRight(v){var children=v.children;return children?children[children.length-1]:v.t}function moveSubtree(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change,wp.s+=shift,wm.c+=change,wp.z+=shift,wp.m+=shift}function executeShifts(v){for(var w,shift=0,change=0,children=v.children,i=children.length;--i>=0;)w=children[i],w.z+=shift,w.m+=shift,shift+=w.s+(change+=w.c)}function nextAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}function TreeNode(node,i){this._=node,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}function treeRoot(root){for(var node,child,children,i,n,tree=new TreeNode(root,0),nodes=[tree];node=nodes.pop();)if(children=node._.children)for(node.children=new Array(n=children.length),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new TreeNode(children[i],i)),child.parent=node;return(tree.parent=new TreeNode(null,0)).children=[tree],tree}function squarifyRatio(ratio,parent,x0,y0,x1,y1){for(var row,nodeValue,dx,dy,sumValue,minValue,maxValue,newRatio,minRatio,alpha,beta,rows=[],nodes=parent.children,i0=0,i1=0,n=nodes.length,value=parent.value;i0<n;){dx=x1-x0,dy=y1-y0;do{sumValue=nodes[i1++].value}while(!sumValue&&i1<n);for(minValue=maxValue=sumValue,alpha=Math.max(dy/dx,dx/dy)/(value*ratio),beta=sumValue*sumValue*alpha,minRatio=Math.max(maxValue/beta,beta/minValue);i1<n;++i1){if(sumValue+=nodeValue=nodes[i1].value,nodeValue<minValue&&(minValue=nodeValue),nodeValue>maxValue&&(maxValue=nodeValue),beta=sumValue*sumValue*alpha,(newRatio=Math.max(maxValue/beta,beta/minValue))>minRatio){sumValue-=nodeValue;break}minRatio=newRatio}rows.push(row={value:sumValue,dice:dx<dy,children:nodes.slice(i0,i1)}),row.dice?treemapDice(row,x0,y0,x1,value?y0+=dy*sumValue/value:y1):treemapSlice(row,x0,y0,value?x0+=dx*sumValue/value:x1,y1),value-=sumValue,i0=i1}return rows}var cluster=function(){function cluster(root){var previousNode,x=0;root.eachAfter(function(node){var children=node.children;children?(node.x=meanX(children),node.y=maxY(children)):(node.x=previousNode?x+=separation(node,previousNode):0,node.y=0,previousNode=node)});var left=leafLeft(root),right=leafRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;return root.eachAfter(nodeSize?function(node){node.x=(node.x-root.x)*dx,node.y=(root.y-node.y)*dy}:function(node){node.x=(node.x-x0)/(x1-x0)*dx,node.y=(1-(root.y?node.y/root.y:1))*dy})}var separation=defaultSeparation,dx=1,dy=1,nodeSize=!1;return cluster.separation=function(x){return arguments.length?(separation=x,cluster):separation},cluster.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],cluster):nodeSize?null:[dx,dy]},cluster.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],cluster):nodeSize?[dx,dy]:null},cluster},node_count=function(){return this.eachAfter(count)},node_each=function(callback){var current,children,i,n,node=this,next=[node];do{for(current=next.reverse(),next=[];node=current.pop();)if(callback(node),children=node.children)for(i=0,n=children.length;i<n;++i)next.push(children[i])}while(next.length);return this},node_eachBefore=function(callback){for(var children,i,node=this,nodes=[node];node=nodes.pop();)if(callback(node),children=node.children)for(i=children.length-1;i>=0;--i)nodes.push(children[i]);return this},node_eachAfter=function(callback){for(var children,i,n,node=this,nodes=[node],next=[];node=nodes.pop();)if(next.push(node),children=node.children)for(i=0,n=children.length;i<n;++i)nodes.push(children[i]);for(;node=next.pop();)callback(node);return this},node_sum=function(value){return this.eachAfter(function(node){for(var sum=+value(node.data)||0,children=node.children,i=children&&children.length;--i>=0;)sum+=children[i].value;node.value=sum})},node_sort=function(compare){return this.eachBefore(function(node){node.children&&node.children.sort(compare)})},node_path=function(end){for(var start=this,ancestor=leastCommonAncestor(start,end),nodes=[start];start!==ancestor;)start=start.parent,nodes.push(start);for(var k=nodes.length;end!==ancestor;)nodes.splice(k,0,end),end=end.parent;return nodes},node_ancestors=function(){for(var node=this,nodes=[node];node=node.parent;)nodes.push(node);return nodes},node_descendants=function(){var nodes=[];return this.each(function(node){nodes.push(node)}),nodes},node_leaves=function(){var leaves=[];return this.eachBefore(function(node){node.children||leaves.push(node)}),leaves},node_links=function(){var root=this,links=[];return root.each(function(node){node!==root&&links.push({source:node.parent,target:node})}),links};Node.prototype=hierarchy.prototype={constructor:Node,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var slice=Array.prototype.slice,enclose=function(circles){for(var p,e,i=0,n=(circles=shuffle(slice.call(circles))).length,B=[];i<n;)p=circles[i],e&&enclosesWeak(e,p)?++i:(e=encloseBasis(B=extendBasis(B,p)),i=0);return e},siblings=function(circles){return packEnclose(circles),circles},constant=function(x){return function(){return x}},index=function(){function pack(root){return root.x=dx/2,root.y=dy/2,radius?root.eachBefore(radiusLeaf(radius)).eachAfter(packChildren(padding,.5)).eachBefore(translateChild(1)):root.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(padding,root.r/Math.min(dx,dy))).eachBefore(translateChild(Math.min(dx,dy)/(2*root.r))),root}var radius=null,dx=1,dy=1,padding=constantZero;return pack.radius=function(x){return arguments.length?(radius=optional(x),pack):radius},pack.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],pack):[dx,dy]},pack.padding=function(x){return arguments.length?(padding="function"==typeof x?x:constant(+x),pack):padding},pack},roundNode=function(node){node.x0=Math.round(node.x0),node.y0=Math.round(node.y0),node.x1=Math.round(node.x1),node.y1=Math.round(node.y1)},treemapDice=function(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(x1-x0)/parent.value;++i<n;)node=nodes[i],node.y0=y0,node.y1=y1,node.x0=x0,node.x1=x0+=node.value*k},partition=function(){function partition(root){var n=root.height+1;return root.x0=root.y0=padding,root.x1=dx,root.y1=dy/n,root.eachBefore(positionNode(dy,n)),round&&root.eachBefore(roundNode),root}function positionNode(dy,n){return function(node){node.children&&treemapDice(node,node.x0,dy*(node.depth+1)/n,node.x1,dy*(node.depth+2)/n);var x0=node.x0,y0=node.y0,x1=node.x1-padding,y1=node.y1-padding;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1}}var dx=1,dy=1,padding=0,round=!1;return partition.round=function(x){return arguments.length?(round=!!x,partition):round},partition.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],partition):[dx,dy]},partition.padding=function(x){return arguments.length?(padding=+x,partition):padding},partition},keyPrefix="$",preroot={depth:-1},ambiguous={},stratify=function(){function stratify(data){var d,i,root,parent,node,nodeId,nodeKey,n=data.length,nodes=new Array(n),nodeByKey={};for(i=0;i<n;++i)d=data[i],node=nodes[i]=new Node(d),null!=(nodeId=id(d,i,data))&&(nodeId+="")&&(nodeKey=keyPrefix+(node.id=nodeId),nodeByKey[nodeKey]=nodeKey in nodeByKey?ambiguous:node);for(i=0;i<n;++i)if(node=nodes[i],null!=(nodeId=parentId(data[i],i,data))&&(nodeId+="")){if(!(parent=nodeByKey[keyPrefix+nodeId]))throw new Error("missing: "+nodeId);if(parent===ambiguous)throw new Error("ambiguous: "+nodeId);parent.children?parent.children.push(node):parent.children=[node],node.parent=parent}else{if(root)throw new Error("multiple roots");root=node}if(!root)throw new Error("no root");if(root.parent=preroot,root.eachBefore(function(node){node.depth=node.parent.depth+1,--n}).eachBefore(computeHeight),root.parent=null,n>0)throw new Error("cycle");return root}var id=defaultId,parentId=defaultParentId;return stratify.id=function(x){return arguments.length?(id=required(x),stratify):id},stratify.parentId=function(x){return arguments.length?(parentId=required(x),stratify):parentId},stratify};TreeNode.prototype=Object.create(Node.prototype);var tree=function(){function tree(root){var t=treeRoot(root);if(t.eachAfter(firstWalk),t.parent.m=-t.z,t.eachBefore(secondWalk),nodeSize)root.eachBefore(sizeNode);else{var left=root,right=root,bottom=root;root.eachBefore(function(node){node.x<left.x&&(left=node),node.x>right.x&&(right=node),node.depth>bottom.depth&&(bottom=node)});var s=left===right?1:separation(left,right)/2,tx=s-left.x,kx=dx/(right.x+s+tx),ky=dy/(bottom.depth||1);root.eachBefore(function(node){node.x=(node.x+tx)*kx,node.y=node.depth*ky})}return root}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children){executeShifts(v);var midpoint=(children[0].z+children[children.length-1].z)/2;w?(v.z=w.z+separation(v._,w._),v.m=v.z-midpoint):v.z=midpoint}else w&&(v.z=w.z+separation(v._,w._));v.parent.A=apportion(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m,v.m+=v.parent.m}function apportion(v,w,ancestor){if(w){for(var shift,vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m;vim=nextRight(vim),vip=nextLeft(vip),vim&&vip;)vom=nextLeft(vom),vop=nextRight(vop),vop.a=v,shift=vim.z+sim-vip.z-sip+separation(vim._,vip._),shift>0&&(moveSubtree(nextAncestor(vim,v,ancestor),v,shift),sip+=shift,sop+=shift),sim+=vim.m,sip+=vip.m,som+=vom.m,sop+=vop.m;vim&&!nextRight(vop)&&(vop.t=vim,vop.m+=sim-sop),vip&&!nextLeft(vom)&&(vom.t=vip,vom.m+=sip-som,ancestor=v)}return ancestor}function sizeNode(node){node.x*=dx,node.y=node.depth*dy}var separation=defaultSeparation$1,dx=1,dy=1,nodeSize=null;return tree.separation=function(x){return arguments.length?(separation=x,tree):separation},tree.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],tree):nodeSize?null:[dx,dy]},tree.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],tree):nodeSize?[dx,dy]:null},tree},treemapSlice=function(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(y1-y0)/parent.value;++i<n;)node=nodes[i],node.x0=x0,node.x1=x1,node.y0=y0,node.y1=y0+=node.value*k},phi=(1+Math.sqrt(5))/2,squarify=function custom(ratio){function squarify(parent,x0,y0,x1,y1){squarifyRatio(ratio,parent,x0,y0,x1,y1)}return squarify.ratio=function(x){return custom((x=+x)>1?x:1)},squarify}(phi),index$1=function(){function treemap(root){return root.x0=root.y0=0,root.x1=dx,root.y1=dy,root.eachBefore(positionNode),paddingStack=[0],round&&root.eachBefore(roundNode),root}function positionNode(node){var p=paddingStack[node.depth],x0=node.x0+p,y0=node.y0+p,x1=node.x1-p,y1=node.y1-p;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1,node.children&&(p=paddingStack[node.depth+1]=paddingInner(node)/2,x0+=paddingLeft(node)-p,y0+=paddingTop(node)-p,x1-=paddingRight(node)-p,y1-=paddingBottom(node)-p,x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),tile(node,x0,y0,x1,y1))}var tile=squarify,round=!1,dx=1,dy=1,paddingStack=[0],paddingInner=constantZero,paddingTop=constantZero,paddingRight=constantZero,paddingBottom=constantZero,paddingLeft=constantZero;return treemap.round=function(x){return arguments.length?(round=!!x,treemap):round},treemap.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],treemap):[dx,dy]},treemap.tile=function(x){return arguments.length?(tile=required(x),treemap):tile},treemap.padding=function(x){return arguments.length?treemap.paddingInner(x).paddingOuter(x):treemap.paddingInner()},treemap.paddingInner=function(x){return arguments.length?(paddingInner="function"==typeof x?x:constant(+x),treemap):paddingInner},treemap.paddingOuter=function(x){return arguments.length?treemap.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x):treemap.paddingTop()},treemap.paddingTop=function(x){return arguments.length?(paddingTop="function"==typeof x?x:constant(+x),treemap):paddingTop},treemap.paddingRight=function(x){return arguments.length?(paddingRight="function"==typeof x?x:constant(+x),treemap):paddingRight},treemap.paddingBottom=function(x){return arguments.length?(paddingBottom="function"==typeof x?x:constant(+x),treemap):paddingBottom},treemap.paddingLeft=function(x){return arguments.length?(paddingLeft="function"==typeof x?x:constant(+x),treemap):paddingLeft},treemap},binary=function(parent,x0,y0,x1,y1){function partition(i,j,value,x0,y0,x1,y1){if(i>=j-1){var node=nodes[i];return node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1,void 0}for(var valueOffset=sums[i],valueTarget=value/2+valueOffset,k=i+1,hi=j-1;k<hi;){var mid=k+hi>>>1;sums[mid]<valueTarget?k=mid+1:hi=mid}valueTarget-sums[k-1]<sums[k]-valueTarget&&i+1<k&&--k;var valueLeft=sums[k]-valueOffset,valueRight=value-valueLeft;if(x1-x0>y1-y0){var xk=(x0*valueRight+x1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,xk,y1),partition(k,j,valueRight,xk,y0,x1,y1)}else{var yk=(y0*valueRight+y1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,x1,yk),partition(k,j,valueRight,x0,yk,x1,y1)}}var i,sum,nodes=parent.children,n=nodes.length,sums=new Array(n+1);for(sums[0]=sum=i=0;i<n;++i)sums[i+1]=sum+=nodes[i].value;partition(0,n,parent.value,x0,y0,x1,y1)},sliceDice=function(parent,x0,y0,x1,y1){(1&parent.depth?treemapSlice:treemapDice)(parent,x0,y0,x1,y1)},resquarify=function custom(ratio){function resquarify(parent,x0,y0,x1,y1){if((rows=parent._squarify)&&rows.ratio===ratio)for(var rows,row,nodes,i,n,j=-1,m=rows.length,value=parent.value;++j<m;){for(row=rows[j],nodes=row.children,i=row.value=0,n=nodes.length;i<n;++i)row.value+=nodes[i].value;row.dice?treemapDice(row,x0,y0,x1,y0+=(y1-y0)*row.value/value):treemapSlice(row,x0,y0,x0+=(x1-x0)*row.value/value,y1),value-=row.value}else parent._squarify=rows=squarifyRatio(ratio,parent,x0,y0,x1,y1),rows.ratio=ratio}return resquarify.ratio=function(x){return custom((x=+x)>1?x:1)},resquarify}(phi);exports.cluster=cluster,exports.hierarchy=hierarchy,exports.pack=index,exports.packSiblings=siblings,exports.packEnclose=enclose,exports.partition=partition,exports.stratify=stratify,exports.tree=tree,exports.treemap=index$1,exports.treemapBinary=binary,exports.treemapDice=treemapDice,exports.treemapSlice=treemapSlice,exports.treemapSliceDice=sliceDice,exports.treemapSquarify=squarify,exports.treemapResquarify=resquarify,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],28:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-color"],factory):factory(global.d3=global.d3||{},global.d3)}(this,function(exports,d3Color){"use strict";function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}function linear(a,d){return function(t){return a+t*d}}function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}function hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):constant(isNaN(a)?b:a)}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?exponential(a,b,y):constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):constant(isNaN(a)?b:a)}function rgbSpline(spline){return function(colors){var i,color$$1,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color$$1=d3Color.rgb(colors[i]),r[i]=color$$1.r||0,g[i]=color$$1.g||0,b[i]=color$$1.b||0;return r=spline(r),g=spline(g),b=spline(b),color$$1.opacity=1,function(t){return color$$1.r=r(t),color$$1.g=g(t),color$$1.b=b(t),color$$1+""}}}function zero(b){return function(){return b}}function one(b){return function(t){return b(t)+""}}function parseCss(value){return"none"===value?identity:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=value,value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),value=value.slice(7,-1).split(","),decompose(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5]))}function parseSvg(value){return null==value?identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?(value=value.matrix,decompose(value.a,value.b,value.c,value.d,value.e,value.f)):identity)}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({
i:s.push(pop(s)+"rotate(",null,degParen)-2,x:number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),translate(a.translateX,a.translateY,b.translateX,b.translateY,s,q),rotate(a.rotate,b.rotate,s,q),skewX(a.skewX,b.skewX,s,q),scale(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}function cosh(x){return((x=Math.exp(x))+1/x)/2}function sinh(x){return((x=Math.exp(x))-1/x)/2}function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}function hsl$1(hue$$1){return function(start,end){var h=hue$$1((start=d3Color.hsl(start)).h,(end=d3Color.hsl(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(t),start.opacity=opacity(t),start+""}}}function lab$1(start,end){var l=nogamma((start=d3Color.lab(start)).l,(end=d3Color.lab(end)).l),a=nogamma(start.a,end.a),b=nogamma(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.l=l(t),start.a=a(t),start.b=b(t),start.opacity=opacity(t),start+""}}function hcl$1(hue$$1){return function(start,end){var h=hue$$1((start=d3Color.hcl(start)).h,(end=d3Color.hcl(end)).h),c=nogamma(start.c,end.c),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.c=c(t),start.l=l(t),start.opacity=opacity(t),start+""}}}function cubehelix$1(hue$$1){return function cubehelixGamma(y){function cubehelix$$1(start,end){var h=hue$$1((start=d3Color.cubehelix(start)).h,(end=d3Color.cubehelix(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(Math.pow(t,y)),start.opacity=opacity(t),start+""}}return y=+y,cubehelix$$1.gamma=cubehelixGamma,cubehelix$$1}(1)}var cssNode,cssRoot,cssView,svgNode,basis$1=function(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}},basisClosed=function(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}},constant=function(x){return function(){return x}},rgb$1=function rgbGamma(y){function rgb$$1(start,end){var r=color$$1((start=d3Color.rgb(start)).r,(end=d3Color.rgb(end)).r),g=color$$1(start.g,end.g),b=color$$1(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}var color$$1=gamma(y);return rgb$$1.gamma=rgbGamma,rgb$$1}(1),rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed),array=function(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(na),c=new Array(nb);for(i=0;i<na;++i)x[i]=value(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}},date=function(a,b){var d=new Date;return a=+a,b-=a,function(t){return d.setTime(a+b*t),d}},number=function(a,b){return a=+a,b-=a,function(t){return a+b*t}},object=function(a,b){var k,i={},c={};null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={});for(k in b)k in a?i[k]=value(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}},reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g"),string=function(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?one(q[0].x):zero(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})},value=function(a,b){var c,t=typeof b;return null==b||"boolean"===t?constant(b):("number"===t?number:"string"===t?(c=d3Color.color(b))?(b=c,rgb$1):string:b instanceof d3Color.color?rgb$1:b instanceof Date?date:Array.isArray(b)?array:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?object:number)(a,b)},round=function(a,b){return a=+a,b-=a,function(t){return Math.round(a+b*t)}},degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},decompose=function(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}},interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),rho=Math.SQRT2,zoom=function(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+4*d2)/(2*w0*2*d1),b1=(w1*w1-w0*w0-4*d2)/(2*w1*2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(2*d1)*(coshr0*tanh(rho*s+r0)-sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S,i},hsl$2=hsl$1(hue),hslLong=hsl$1(nogamma),hcl$2=hcl$1(hue),hclLong=hcl$1(nogamma),cubehelix$2=cubehelix$1(hue),cubehelixLong=cubehelix$1(nogamma),quantize=function(interpolator,n){for(var samples=new Array(n),i=0;i<n;++i)samples[i]=interpolator(i/(n-1));return samples};exports.interpolate=value,exports.interpolateArray=array,exports.interpolateBasis=basis$1,exports.interpolateBasisClosed=basisClosed,exports.interpolateDate=date,exports.interpolateNumber=number,exports.interpolateObject=object,exports.interpolateRound=round,exports.interpolateString=string,exports.interpolateTransformCss=interpolateTransformCss,exports.interpolateTransformSvg=interpolateTransformSvg,exports.interpolateZoom=zoom,exports.interpolateRgb=rgb$1,exports.interpolateRgbBasis=rgbBasis,exports.interpolateRgbBasisClosed=rgbBasisClosed,exports.interpolateHsl=hsl$2,exports.interpolateHslLong=hslLong,exports.interpolateLab=lab$1,exports.interpolateHcl=hcl$2,exports.interpolateHclLong=hclLong,exports.interpolateCubehelix=cubehelix$2,exports.interpolateCubehelixLong=cubehelixLong,exports.quantize=quantize,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-color":19}],29:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path(){return new Path}var pi=Math.PI,tau=2*pi,tauEpsilon=tau-1e-6;Path.prototype=path.prototype={constructor:Path,moveTo:function(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function(x1,y1,x,y){this._+="Q"+ +x1+","+ +y1+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._+="C"+ +x1+","+ +y1+","+ +x2+","+ +y2+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function(x1,y1,x2,y2,r){x1=+x1,y1=+y1,x2=+x2,y2=+y2,r=+r;var x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=x1)+","+(this._y1=y1);else if(l01_2>1e-6)if(Math.abs(y01*x21-y21*x01)>1e-6&&r){var x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((pi-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;Math.abs(t01-1)>1e-6&&(this._+="L"+(x1+t01*x01)+","+(y1+t01*y01)),this._+="A"+r+","+r+",0,0,"+ +(y01*x20>x01*y20)+","+(this._x1=x1+t21*x21)+","+(this._y1=y1+t21*y21)}else this._+="L"+(this._x1=x1)+","+(this._y1=y1);else;},arc:function(x,y,r,a0,a1,ccw){x=+x,y=+y,r=+r;var dx=r*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+x0+","+y0:(Math.abs(this._x1-x0)>1e-6||Math.abs(this._y1-y0)>1e-6)&&(this._+="L"+x0+","+y0),r&&(da<0&&(da=da%tau+tau),da>tauEpsilon?this._+="A"+r+","+r+",0,1,"+cw+","+(x-dx)+","+(y-dy)+"A"+r+","+r+",0,1,"+cw+","+(this._x1=x0)+","+(this._y1=y0):da>1e-6&&(this._+="A"+r+","+r+",0,"+ +(da>=pi)+","+cw+","+(this._x1=x+r*Math.cos(a1))+","+(this._y1=y+r*Math.sin(a1))))},rect:function(x,y,w,h){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +w+"v"+ +h+"h"+-w+"Z"},toString:function(){return this._}},exports.path=path,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],30:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function lexicographicOrder(a,b){return a[0]-b[0]||a[1]-b[1]}function computeUpperHullIndexes(points){for(var n=points.length,indexes=[0,1],size=2,i=2;i<n;++i){for(;size>1&&cross(points[indexes[size-2]],points[indexes[size-1]],points[i])<=0;)--size;indexes[size++]=i}return indexes.slice(0,size)}var area=function(polygon){for(var a,i=-1,n=polygon.length,b=polygon[n-1],area=0;++i<n;)a=b,b=polygon[i],area+=a[1]*b[0]-a[0]*b[1];return area/2},centroid=function(polygon){for(var a,c,i=-1,n=polygon.length,x=0,y=0,b=polygon[n-1],k=0;++i<n;)a=b,b=polygon[i],k+=c=a[0]*b[1]-b[0]*a[1],x+=(a[0]+b[0])*c,y+=(a[1]+b[1])*c;return k*=3,[x/k,y/k]},cross=function(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])},hull=function(points){if((n=points.length)<3)return null;var i,n,sortedPoints=new Array(n),flippedPoints=new Array(n);for(i=0;i<n;++i)sortedPoints[i]=[+points[i][0],+points[i][1],i];for(sortedPoints.sort(lexicographicOrder),i=0;i<n;++i)flippedPoints[i]=[sortedPoints[i][0],-sortedPoints[i][1]];var upperIndexes=computeUpperHullIndexes(sortedPoints),lowerIndexes=computeUpperHullIndexes(flippedPoints),skipLeft=lowerIndexes[0]===upperIndexes[0],skipRight=lowerIndexes[lowerIndexes.length-1]===upperIndexes[upperIndexes.length-1],hull=[];for(i=upperIndexes.length-1;i>=0;--i)hull.push(points[sortedPoints[upperIndexes[i]][2]]);for(i=+skipLeft;i<lowerIndexes.length-skipRight;++i)hull.push(points[sortedPoints[lowerIndexes[i]][2]]);return hull},contains=function(polygon,point){for(var x1,y1,n=polygon.length,p=polygon[n-1],x=point[0],y=point[1],x0=p[0],y0=p[1],inside=!1,i=0;i<n;++i)p=polygon[i],x1=p[0],y1=p[1],y1>y!=y0>y&&x<(x0-x1)*(y-y1)/(y0-y1)+x1&&(inside=!inside),x0=x1,y0=y1;return inside},length=function(polygon){for(var xa,ya,i=-1,n=polygon.length,b=polygon[n-1],xb=b[0],yb=b[1],perimeter=0;++i<n;)xa=xb,ya=yb,b=polygon[i],xb=b[0],yb=b[1],xa-=xb,ya-=yb,perimeter+=Math.sqrt(xa*xa+ya*ya);return perimeter};exports.polygonArea=area,exports.polygonCentroid=centroid,exports.polygonHull=hull,exports.polygonContains=contains,exports.polygonLength=length,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],31:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function add(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function addAll(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));for(x1<x0&&(x0=this._x0,x1=this._x1),y1<y0&&(y0=this._y0,y1=this._y1),this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)add(this,xz[i],yz[i],data[i]);return this}function removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this}function defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}var tree_add=function(d){var x=+this._x.call(null,d),y=+this._y.call(null,d);return add(this.cover(x,y),x,y,d)},tree_cover=function(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{if(!(x0>x||x>x1||y0>y||y>y1))return this;var parent,i,z=x1-x0,node=this._root;switch(i=(y<(y0+y1)/2)<<1|x<(x0+x1)/2){case 0:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x1=x0+z,y1=y0+z,x>x1||y>y1);break;case 1:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x0=x1-z,y1=y0+z,x0>x||y>y1);break;case 2:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x1=x0+z,y0=y1-z,x>x1||y0>y);break;case 3:do{parent=new Array(4),parent[i]=node,node=parent}while(z*=2,x0=x1-z,y0=y1-z,x0>x||y0>y)}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},tree_data=function(){var data=[];return this.visit(function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)}),data},tree_extent=function(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},Quad=function(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1},tree_find=function(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new Quad(node[3],xm,ym,x2,y2),new Quad(node[2],x1,ym,xm,y2),new Quad(node[1],xm,y1,x2,ym),new Quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},tree_remove=function(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},tree_root=function(){return this._root},tree_size=function(){var size=0;return this.visit(function(node){if(!node.length)do{++size}while(node=node.next)}),size},tree_visit=function(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym))}return this},tree_visitAfter=function(callback){var q,quads=[],next=[];for(this._root&&quads.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},tree_x=function(_){return arguments.length?(this._x=_,this):this._x},tree_y=function(_){return arguments.length?(this._y=_,this):this._y},treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=tree_add,treeProto.addAll=addAll,treeProto.cover=tree_cover,treeProto.data=tree_data,treeProto.extent=tree_extent,treeProto.find=tree_find,treeProto.remove=tree_remove,treeProto.removeAll=removeAll,treeProto.root=tree_root,treeProto.size=tree_size,treeProto.visit=tree_visit,treeProto.visitAfter=tree_visitAfter,treeProto.x=tree_x,treeProto.y=tree_y,exports.quadtree=quadtree,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],32:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function Queue(size){this._size=size,this._call=this._error=null,this._tasks=[],this._data=[],this._waiting=this._active=this._ended=this._start=0}function poke(q){if(!q._start)try{start(q)}catch(e){if(q._tasks[q._ended+q._active-1])abort(q,e);else if(!q._data)throw e}}function start(q){for(;q._start=q._waiting&&q._active<q._size;){var i=q._ended+q._active,t=q._tasks[i],j=t.length-1,c=t[j];t[j]=end(q,i),--q._waiting,++q._active,t=c.apply(null,t),q._tasks[i]&&(q._tasks[i]=t||noabort)}}function end(q,i){return function(e,r){q._tasks[i]&&(--q._active,++q._ended,q._tasks[i]=null,null==q._error&&(null!=e?abort(q,e):(q._data[i]=r,q._waiting?poke(q):maybeNotify(q))))}}function abort(q,e){var t,i=q._tasks.length;for(q._error=e,q._data=void 0,q._waiting=NaN;--i>=0;)if((t=q._tasks[i])&&(q._tasks[i]=null,t.abort))try{t.abort()}catch(e){}q._active=NaN,maybeNotify(q)}function maybeNotify(q){if(!q._active&&q._call){var d=q._data;q._data=void 0,q._call(q._error,d)}}function queue(concurrency){if(null==concurrency)concurrency=1/0;else if(!((concurrency=+concurrency)>=1))throw new Error("invalid concurrency");return new Queue(concurrency)}var slice=[].slice,noabort={};Queue.prototype=queue.prototype={constructor:Queue,defer:function(callback){if("function"!=typeof callback)throw new Error("invalid callback");if(this._call)throw new Error("defer after await");if(null!=this._error)return this;var t=slice.call(arguments,1);return t.push(callback),++this._waiting,this._tasks.push(t),poke(this),this},abort:function(){return null==this._error&&abort(this,new Error("abort")),this},await:function(callback){if("function"!=typeof callback)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=function(error,results){callback.apply(null,[error].concat(results))},maybeNotify(this),this},awaitAll:function(callback){if("function"!=typeof callback)throw new Error("invalid callback");if(this._call)throw new Error("multiple await");return this._call=callback,maybeNotify(this),this}},exports.queue=queue,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],33:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";var defaultSource=function(){return Math.random()},uniform=function sourceRandomUniform(source){function randomUniform(min,max){return min=null==min?0:+min,max=null==max?1:+max,1===arguments.length?(max=min,min=0):max-=min,function(){return source()*max+min}}return randomUniform.source=sourceRandomUniform,randomUniform}(defaultSource),normal=function sourceRandomNormal(source){function randomNormal(mu,sigma){var x,r;return mu=null==mu?0:+mu,sigma=null==sigma?1:+sigma,function(){var y;if(null!=x)y=x,x=null;else do{x=2*source()-1,y=2*source()-1,r=x*x+y*y}while(!r||r>1);return mu+sigma*y*Math.sqrt(-2*Math.log(r)/r)}}return randomNormal.source=sourceRandomNormal,randomNormal}(defaultSource),logNormal=function sourceRandomLogNormal(source){function randomLogNormal(){var randomNormal=normal.source(source).apply(this,arguments);return function(){return Math.exp(randomNormal())}}return randomLogNormal.source=sourceRandomLogNormal,randomLogNormal}(defaultSource),irwinHall=function sourceRandomIrwinHall(source){function randomIrwinHall(n){return function(){for(var sum=0,i=0;i<n;++i)sum+=source();return sum}}return randomIrwinHall.source=sourceRandomIrwinHall,randomIrwinHall}(defaultSource),bates=function sourceRandomBates(source){function randomBates(n){var randomIrwinHall=irwinHall.source(source)(n);return function(){return randomIrwinHall()/n}}return randomBates.source=sourceRandomBates,randomBates}(defaultSource),exponential=function sourceRandomExponential(source){function randomExponential(lambda){return function(){return-Math.log(1-source())/lambda}}return randomExponential.source=sourceRandomExponential,randomExponential}(defaultSource);exports.randomUniform=uniform,exports.randomNormal=normal,exports.randomLogNormal=logNormal,exports.randomBates=bates,exports.randomIrwinHall=irwinHall,exports.randomExponential=exponential,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],34:[function(require,module,exports){"use strict";function fixCallback(callback){return function(error,xhr){callback(null==error?xhr:null)}}function hasResponse(xhr){var type=xhr.responseType;return type&&"text"!==type?xhr.response:xhr.responseText}function responseOf(parse,row){return function(request$$1){return parse(request$$1.responseText,row)}}var XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest;Object.defineProperty(exports,"__esModule",{value:!0});var d3Collection=require("d3-collection"),d3Dispatch=require("d3-dispatch"),d3Dsv=require("d3-dsv"),request=function(url,callback){function respond(o){var result,status=xhr.status;if(!status&&hasResponse(xhr)||status>=200&&status<300||304===status){if(response)try{result=response.call(request,xhr)}catch(e){return void event.call("error",request,e)}else result=xhr;event.call("load",request,result)}else event.call("error",request,o)}var request,mimeType,response,responseType,event=d3Dispatch.dispatch("beforesend","progress","load","error"),headers=d3Collection.map(),xhr=new XMLHttpRequest,user=null,password=null,timeout=0;if("undefined"==typeof XDomainRequest||"withCredentials"in xhr||!/^(http(s)?:)?\/\//.test(url)||(xhr=new XDomainRequest),"onload"in xhr?xhr.onload=xhr.onerror=xhr.ontimeout=respond:xhr.onreadystatechange=function(o){xhr.readyState>3&&respond(o)},xhr.onprogress=function(e){event.call("progress",request,e)},request={header:function(name,value){return name=(name+"").toLowerCase(),arguments.length<2?headers.get(name):(null==value?headers.remove(name):headers.set(name,value+""),request)},mimeType:function(value){return arguments.length?(mimeType=null==value?null:value+"",request):mimeType},responseType:function(value){return arguments.length?(responseType=value,request):responseType},timeout:function(value){return arguments.length?(timeout=+value,request):timeout},user:function(value){return arguments.length<1?user:(user=null==value?null:value+"",request)},password:function(value){return arguments.length<1?password:(password=null==value?null:value+"",request)},response:function(value){return response=value,request},get:function(data,callback){return request.send("GET",data,callback)},post:function(data,callback){return request.send("POST",data,callback)},send:function(method,data,callback){return xhr.open(method,url,!0,user,password),null==mimeType||headers.has("accept")||headers.set("accept",mimeType+",*/*"),xhr.setRequestHeader&&headers.each(function(value,name){xhr.setRequestHeader(name,value)}),null!=mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(mimeType),null!=responseType&&(xhr.responseType=responseType),timeout>0&&(xhr.timeout=timeout),null==callback&&"function"==typeof data&&(callback=data,data=null),null!=callback&&1===callback.length&&(callback=fixCallback(callback)),null!=callback&&request.on("error",callback).on("load",function(xhr){callback(null,xhr)}),event.call("beforesend",request,xhr),xhr.send(null==data?null:data),request},abort:function(){return xhr.abort(),request},on:function(){var value=event.on.apply(event,arguments);return value===event?request:value}},null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return request.get(callback)}return request},type=function(defaultMimeType,response){return function(url,callback){var r=request(url).mimeType(defaultMimeType).response(response);if(null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return r.get(callback)}return r}},html=type("text/html",function(xhr){return document.createRange().createContextualFragment(xhr.responseText)}),json=type("application/json",function(xhr){return JSON.parse(xhr.responseText)}),text=type("text/plain",function(xhr){return xhr.responseText}),xml=type("application/xml",function(xhr){var xml=xhr.responseXML;if(!xml)throw new Error("parse error");return xml}),dsv=function(defaultMimeType,parse){return function(url,row,callback){arguments.length<3&&(callback=row,row=null);var r=request(url).mimeType(defaultMimeType);return r.row=function(_){return arguments.length?r.response(responseOf(parse,row=_)):row},r.row(row),callback?r.get(callback):r}},csv=dsv("text/csv",d3Dsv.csvParse),tsv=dsv("text/tab-separated-values",d3Dsv.tsvParse);exports.request=request,exports.html=html,exports.json=json,exports.text=text,exports.xml=xml,exports.csv=csv,exports.tsv=tsv},{"d3-collection":18,"d3-dispatch":20,"d3-dsv":22,xmlhttprequest:81}],35:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-array"),require("d3-collection"),require("d3-interpolate"),require("d3-format"),require("d3-time"),require("d3-time-format"),require("d3-color")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-collection","d3-interpolate","d3-format","d3-time","d3-time-format","d3-color"],factory):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Array,d3Collection,d3Interpolate,d3Format,d3Time,d3TimeFormat,d3Color){"use strict";function ordinal(range$$1){function scale(d){var key=d+"",i=index.get(key);if(!i){if(unknown!==implicit)return unknown;index.set(key,i=domain.push(d))}return range$$1[(i-1)%range$$1.length]}var index=d3Collection.map(),domain=[],unknown=implicit;return range$$1=null==range$$1?[]:slice.call(range$$1),scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=d3Collection.map();for(var d,key,i=-1,n=_.length;++i<n;)index.has(key=(d=_[i])+"")||index.set(key,domain.push(d));return scale},scale.range=function(_){return arguments.length?(range$$1=slice.call(_),scale):range$$1.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal().domain(domain).range(range$$1).unknown(unknown)},scale}function band(){function rescale(){var n=domain().length,reverse=range$$1[1]<range$$1[0],start=range$$1[reverse-0],stop=range$$1[1-reverse];step=(stop-start)/Math.max(1,n-paddingInner+2*paddingOuter),round&&(step=Math.floor(step)),start+=(stop-start-step*(n-paddingInner))*align,bandwidth=step*(1-paddingInner),round&&(start=Math.round(start),bandwidth=Math.round(bandwidth));var values=d3Array.range(n).map(function(i){return start+step*i});return ordinalRange(reverse?values.reverse():values)}var step,bandwidth,scale=ordinal().unknown(void 0),domain=scale.domain,ordinalRange=scale.range,range$$1=[0,1],round=!1,paddingInner=0,paddingOuter=0,align=.5;return delete scale.unknown,scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.range=function(_){return arguments.length?(range$$1=[+_[0],+_[1]],rescale()):range$$1.slice()},scale.rangeRound=function(_){return range$$1=[+_[0],+_[1]],round=!0,rescale()},scale.bandwidth=function(){return bandwidth},scale.step=function(){return step},scale.round=function(_){return arguments.length?(round=!!_,rescale()):round},scale.padding=function(_){return arguments.length?(paddingInner=paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingInner=function(_){return arguments.length?(paddingInner=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingOuter=function(_){return arguments.length?(paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingOuter},scale.align=function(_){return arguments.length?(align=Math.max(0,Math.min(1,_)),rescale()):align},scale.copy=function(){return band().domain(domain()).range(range$$1).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align)},rescale()}function pointish(scale){var copy=scale.copy;return scale.padding=scale.paddingOuter,delete scale.paddingInner,delete scale.paddingOuter,scale.copy=function(){return pointish(copy())},scale}function point(){return pointish(band().paddingInner(1))}function deinterpolateLinear(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:constant(b)}function deinterpolateClamp(deinterpolate){return function(a,b){
var d=deinterpolate(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:d(x)}}}function reinterpolateClamp(reinterpolate){return function(a,b){var r=reinterpolate(a=+a,b=+b);return function(t){return t<=0?a:t>=1?b:r(t)}}}function bimap(domain,range$$1,deinterpolate,reinterpolate){var d0=domain[0],d1=domain[1],r0=range$$1[0],r1=range$$1[1];return d1<d0?(d0=deinterpolate(d1,d0),r0=reinterpolate(r1,r0)):(d0=deinterpolate(d0,d1),r0=reinterpolate(r0,r1)),function(x){return r0(d0(x))}}function polymap(domain,range$$1,deinterpolate,reinterpolate){var j=Math.min(domain.length,range$$1.length)-1,d=new Array(j),r=new Array(j),i=-1;for(domain[j]<domain[0]&&(domain=domain.slice().reverse(),range$$1=range$$1.slice().reverse());++i<j;)d[i]=deinterpolate(domain[i],domain[i+1]),r[i]=reinterpolate(range$$1[i],range$$1[i+1]);return function(x){var i=d3Array.bisect(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp())}function continuous(deinterpolate,reinterpolate){function rescale(){return piecewise=Math.min(domain.length,range$$1.length)>2?polymap:bimap,output=input=null,scale}function scale(x){return(output||(output=piecewise(domain,range$$1,clamp?deinterpolateClamp(deinterpolate):deinterpolate,interpolate$$1)))(+x)}var piecewise,output,input,domain=unit,range$$1=unit,interpolate$$1=d3Interpolate.interpolate,clamp=!1;return scale.invert=function(y){return(input||(input=piecewise(range$$1,domain,deinterpolateLinear,clamp?reinterpolateClamp(reinterpolate):reinterpolate)))(+y)},scale.domain=function(_){return arguments.length?(domain=map$1.call(_,number),rescale()):domain.slice()},scale.range=function(_){return arguments.length?(range$$1=slice.call(_),rescale()):range$$1.slice()},scale.rangeRound=function(_){return range$$1=slice.call(_),interpolate$$1=d3Interpolate.interpolateRound,rescale()},scale.clamp=function(_){return arguments.length?(clamp=!!_,rescale()):clamp},scale.interpolate=function(_){return arguments.length?(interpolate$$1=_,rescale()):interpolate$$1},rescale()}function linearish(scale){var domain=scale.domain;return scale.ticks=function(count){var d=domain();return d3Array.ticks(d[0],d[d.length-1],null==count?10:count)},scale.tickFormat=function(count,specifier){return tickFormat(domain(),count,specifier)},scale.nice=function(count){null==count&&(count=10);var step,d=domain(),i0=0,i1=d.length-1,start=d[i0],stop=d[i1];return stop<start&&(step=start,start=stop,stop=step,step=i0,i0=i1,i1=step),step=d3Array.tickIncrement(start,stop,count),step>0?(start=Math.floor(start/step)*step,stop=Math.ceil(stop/step)*step,step=d3Array.tickIncrement(start,stop,count)):step<0&&(start=Math.ceil(start*step)/step,stop=Math.floor(stop*step)/step,step=d3Array.tickIncrement(start,stop,count)),step>0?(d[i0]=Math.floor(start/step)*step,d[i1]=Math.ceil(stop/step)*step,domain(d)):step<0&&(d[i0]=Math.ceil(start*step)/step,d[i1]=Math.floor(stop*step)/step,domain(d)),scale},scale}function linear(){var scale=continuous(deinterpolateLinear,d3Interpolate.interpolateNumber);return scale.copy=function(){return copy(scale,linear())},linearish(scale)}function identity(){function scale(x){return+x}var domain=[0,1];return scale.invert=scale,scale.domain=scale.range=function(_){return arguments.length?(domain=map$1.call(_,number),scale):domain.slice()},scale.copy=function(){return identity().domain(domain)},linearish(scale)}function deinterpolate(a,b){return(b=Math.log(b/a))?function(x){return Math.log(x/a)/b}:constant(b)}function reinterpolate(a,b){return a<0?function(t){return-Math.pow(-b,t)*Math.pow(-a,1-t)}:function(t){return Math.pow(b,t)*Math.pow(a,1-t)}}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function powp(base){return 10===base?pow10:base===Math.E?Math.exp:function(x){return Math.pow(base,x)}}function logp(base){return base===Math.E?Math.log:10===base&&Math.log10||2===base&&Math.log2||(base=Math.log(base),function(x){return Math.log(x)/base})}function reflect(f){return function(x){return-f(-x)}}function log(){function rescale(){return logs=logp(base),pows=powp(base),domain()[0]<0&&(logs=reflect(logs),pows=reflect(pows)),scale}var scale=continuous(deinterpolate,reinterpolate).domain([1,10]),domain=scale.domain,base=10,logs=logp(10),pows=powp(10);return scale.base=function(_){return arguments.length?(base=+_,rescale()):base},scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.ticks=function(count){var r,d=domain(),u=d[0],v=d[d.length-1];(r=v<u)&&(i=u,u=v,v=i);var p,k,t,i=logs(u),j=logs(v),n=null==count?10:+count,z=[];if(!(base%1)&&j-i<n){if(i=Math.round(i)-1,j=Math.round(j)+1,u>0){for(;i<j;++i)for(k=1,p=pows(i);k<base;++k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else for(;i<j;++i)for(k=base-1,p=pows(i);k>=1;--k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else z=d3Array.ticks(i,j,Math.min(j-i,n)).map(pows);return r?z.reverse():z},scale.tickFormat=function(count,specifier){if(null==specifier&&(specifier=10===base?".0e":","),"function"!=typeof specifier&&(specifier=d3Format.format(specifier)),count===1/0)return specifier;null==count&&(count=10);var k=Math.max(1,base*count/scale.ticks().length);return function(d){var i=d/pows(Math.round(logs(d)));return i*base<base-.5&&(i*=base),i<=k?specifier(d):""}},scale.nice=function(){return domain(nice(domain(),{floor:function(x){return pows(Math.floor(logs(x)))},ceil:function(x){return pows(Math.ceil(logs(x)))}}))},scale.copy=function(){return copy(scale,log().base(base))},scale}function raise(x,exponent){return x<0?-Math.pow(-x,exponent):Math.pow(x,exponent)}function pow(){function deinterpolate(a,b){return(b=raise(b,exponent)-(a=raise(a,exponent)))?function(x){return(raise(x,exponent)-a)/b}:constant(b)}function reinterpolate(a,b){return b=raise(b,exponent)-(a=raise(a,exponent)),function(t){return raise(a+b*t,1/exponent)}}var exponent=1,scale=continuous(deinterpolate,reinterpolate),domain=scale.domain;return scale.exponent=function(_){return arguments.length?(exponent=+_,domain(domain())):exponent},scale.copy=function(){return copy(scale,pow().exponent(exponent))},linearish(scale)}function sqrt(){return pow().exponent(.5)}function quantile$1(){function rescale(){var i=0,n=Math.max(1,range$$1.length);for(thresholds=new Array(n-1);++i<n;)thresholds[i-1]=d3Array.quantile(domain,i/n);return scale}function scale(x){if(!isNaN(x=+x))return range$$1[d3Array.bisect(thresholds,x)]}var domain=[],range$$1=[],thresholds=[];return scale.invertExtent=function(y){var i=range$$1.indexOf(y);return i<0?[NaN,NaN]:[i>0?thresholds[i-1]:domain[0],i<thresholds.length?thresholds[i]:domain[domain.length-1]]},scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[];for(var d,i=0,n=_.length;i<n;++i)null==(d=_[i])||isNaN(d=+d)||domain.push(d);return domain.sort(d3Array.ascending),rescale()},scale.range=function(_){return arguments.length?(range$$1=slice.call(_),rescale()):range$$1.slice()},scale.quantiles=function(){return thresholds.slice()},scale.copy=function(){return quantile$1().domain(domain).range(range$$1)},scale}function quantize(){function scale(x){if(x<=x)return range$$1[d3Array.bisect(domain,x,0,n)]}function rescale(){var i=-1;for(domain=new Array(n);++i<n;)domain[i]=((i+1)*x1-(i-n)*x0)/(n+1);return scale}var x0=0,x1=1,n=1,domain=[.5],range$$1=[0,1];return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],rescale()):[x0,x1]},scale.range=function(_){return arguments.length?(n=(range$$1=slice.call(_)).length-1,rescale()):range$$1.slice()},scale.invertExtent=function(y){var i=range$$1.indexOf(y);return i<0?[NaN,NaN]:i<1?[x0,domain[0]]:i>=n?[domain[n-1],x1]:[domain[i-1],domain[i]]},scale.copy=function(){return quantize().domain([x0,x1]).range(range$$1)},linearish(scale)}function threshold(){function scale(x){if(x<=x)return range$$1[d3Array.bisect(domain,x,0,n)]}var domain=[.5],range$$1=[0,1],n=1;return scale.domain=function(_){return arguments.length?(domain=slice.call(_),n=Math.min(domain.length,range$$1.length-1),scale):domain.slice()},scale.range=function(_){return arguments.length?(range$$1=slice.call(_),n=Math.min(domain.length,range$$1.length-1),scale):range$$1.slice()},scale.invertExtent=function(y){var i=range$$1.indexOf(y);return[domain[i-1],domain[i]]},scale.copy=function(){return threshold().domain(domain).range(range$$1)},scale}function date(t){return new Date(t)}function number$1(t){return t instanceof Date?+t:+new Date(+t)}function calendar(year,month,week,day,hour,minute,second,millisecond,format$$1){function tickFormat(date){return(second(date)<date?formatMillisecond:minute(date)<date?formatSecond:hour(date)<date?formatMinute:day(date)<date?formatHour:month(date)<date?week(date)<date?formatDay:formatWeek:year(date)<date?formatMonth:formatYear)(date)}function tickInterval(interval,start,stop,step){if(null==interval&&(interval=10),"number"==typeof interval){var target=Math.abs(stop-start)/interval,i=d3Array.bisector(function(i){return i[2]}).right(tickIntervals,target);i===tickIntervals.length?(step=d3Array.tickStep(start/durationYear,stop/durationYear,interval),interval=year):i?(i=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i],step=i[1],interval=i[0]):(step=Math.max(d3Array.tickStep(start,stop,interval),1),interval=millisecond)}return null==step?interval:interval.every(step)}var scale=continuous(deinterpolateLinear,d3Interpolate.interpolateNumber),invert=scale.invert,domain=scale.domain,formatMillisecond=format$$1(".%L"),formatSecond=format$$1(":%S"),formatMinute=format$$1("%I:%M"),formatHour=format$$1("%I %p"),formatDay=format$$1("%a %d"),formatWeek=format$$1("%b %d"),formatMonth=format$$1("%B"),formatYear=format$$1("%Y"),tickIntervals=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[minute,1,durationMinute],[minute,5,5*durationMinute],[minute,15,15*durationMinute],[minute,30,30*durationMinute],[hour,1,durationHour],[hour,3,3*durationHour],[hour,6,6*durationHour],[hour,12,12*durationHour],[day,1,durationDay],[day,2,2*durationDay],[week,1,durationWeek],[month,1,durationMonth],[month,3,3*durationMonth],[year,1,durationYear]];return scale.invert=function(y){return new Date(invert(y))},scale.domain=function(_){return arguments.length?domain(map$1.call(_,number$1)):domain().map(date)},scale.ticks=function(interval,step){var t,d=domain(),t0=d[0],t1=d[d.length-1],r=t1<t0;return r&&(t=t0,t0=t1,t1=t),t=tickInterval(interval,t0,t1,step),t=t?t.range(t0,t1+1):[],r?t.reverse():t},scale.tickFormat=function(count,specifier){return null==specifier?tickFormat:format$$1(specifier)},scale.nice=function(interval,step){var d=domain();return(interval=tickInterval(interval,d[0],d[d.length-1],step))?domain(nice(d,interval)):scale},scale.copy=function(){return copy(scale,calendar(year,month,week,day,hour,minute,second,millisecond,format$$1))},scale}function ramp(range$$1){var n=range$$1.length;return function(t){return range$$1[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}function sequential(interpolator){function scale(x){var t=(x-x0)/(x1-x0);return interpolator(clamp?Math.max(0,Math.min(1,t)):t)}var x0=0,x1=1,clamp=!1;return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],scale):[x0,x1]},scale.clamp=function(_){return arguments.length?(clamp=!!_,scale):clamp},scale.interpolator=function(_){return arguments.length?(interpolator=_,scale):interpolator},scale.copy=function(){return sequential(interpolator).domain([x0,x1]).clamp(clamp)},linearish(scale)}var array=Array.prototype,map$1=array.map,slice=array.slice,implicit={name:"implicit"},constant=function(x){return function(){return x}},number=function(x){return+x},unit=[0,1],tickFormat=function(domain,count,specifier){var precision,start=domain[0],stop=domain[domain.length-1],step=d3Array.tickStep(start,stop,null==count?10:count);switch(specifier=d3Format.formatSpecifier(null==specifier?",f":specifier),specifier.type){case"s":var value=Math.max(Math.abs(start),Math.abs(stop));return null!=specifier.precision||isNaN(precision=d3Format.precisionPrefix(step,value))||(specifier.precision=precision),d3Format.formatPrefix(specifier,value);case"":case"e":case"g":case"p":case"r":null!=specifier.precision||isNaN(precision=d3Format.precisionRound(step,Math.max(Math.abs(start),Math.abs(stop))))||(specifier.precision=precision-("e"===specifier.type));break;case"f":case"%":null!=specifier.precision||isNaN(precision=d3Format.precisionFixed(step))||(specifier.precision=precision-2*("%"===specifier.type))}return d3Format.format(specifier)},nice=function(domain,interval){domain=domain.slice();var t,i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(t=i0,i0=i1,i1=t,t=x0,x0=x1,x1=t),domain[i0]=interval.floor(x0),domain[i1]=interval.ceil(x1),domain},durationSecond=1e3,durationMinute=60*durationSecond,durationHour=60*durationMinute,durationDay=24*durationHour,durationWeek=7*durationDay,durationMonth=30*durationDay,durationYear=365*durationDay,time=function(){return calendar(d3Time.timeYear,d3Time.timeMonth,d3Time.timeWeek,d3Time.timeDay,d3Time.timeHour,d3Time.timeMinute,d3Time.timeSecond,d3Time.timeMillisecond,d3TimeFormat.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utcTime=function(){return calendar(d3Time.utcYear,d3Time.utcMonth,d3Time.utcWeek,d3Time.utcDay,d3Time.utcHour,d3Time.utcMinute,d3Time.utcSecond,d3Time.utcMillisecond,d3TimeFormat.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},colors=function(s){return s.match(/.{6}/g).map(function(x){return"#"+x})},category10=colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),category20b=colors("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),category20c=colors("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),category20=colors("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),cubehelix$1=d3Interpolate.interpolateCubehelixLong(d3Color.cubehelix(300,.5,0),d3Color.cubehelix(-240,.5,1)),warm=d3Interpolate.interpolateCubehelixLong(d3Color.cubehelix(-100,.75,.35),d3Color.cubehelix(80,1.5,.8)),cool=d3Interpolate.interpolateCubehelixLong(d3Color.cubehelix(260,.75,.35),d3Color.cubehelix(80,1.5,.8)),rainbow=d3Color.cubehelix(),rainbow$1=function(t){(t<0||t>1)&&(t-=Math.floor(t));var ts=Math.abs(t-.5);return rainbow.h=360*t-100,rainbow.s=1.5-1.5*ts,rainbow.l=.8-.9*ts,rainbow+""},viridis=ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),magma=ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),inferno=ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),plasma=ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));exports.scaleBand=band,exports.scalePoint=point,exports.scaleIdentity=identity,exports.scaleLinear=linear,exports.scaleLog=log,exports.scaleOrdinal=ordinal,exports.scaleImplicit=implicit,exports.scalePow=pow,exports.scaleSqrt=sqrt,exports.scaleQuantile=quantile$1,exports.scaleQuantize=quantize,exports.scaleThreshold=threshold,exports.scaleTime=time,exports.scaleUtc=utcTime,exports.schemeCategory10=category10,exports.schemeCategory20b=category20b,exports.schemeCategory20c=category20c,exports.schemeCategory20=category20,exports.interpolateCubehelixDefault=cubehelix$1,exports.interpolateRainbow=rainbow$1,exports.interpolateWarm=warm,exports.interpolateCool=cool,exports.interpolateViridis=viridis,exports.interpolateMagma=magma,exports.interpolateInferno=inferno,exports.interpolatePlasma=plasma,exports.scaleSequential=sequential,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-array":14,"d3-collection":18,"d3-color":19,"d3-format":25,"d3-interpolate":28,"d3-time":40,"d3-time-format":39}],36:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function namespace(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name}function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}}function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}function creator(name){var fullname=namespace(name);return(fullname.local?creatorFixed:creatorInherit)(fullname)}function none(){}function selector(selector){return null==selector?none:function(){return this.querySelector(selector)}}function selection_select(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)}function empty(){return[]}function selectorAll(selector){return null==selector?empty:function(){return this.querySelectorAll(selector)}}function selection_selectAll(select){"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)}function selection_filter(match){"function"!=typeof match&&(match=matcher$1(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)}function sparse(update){return new Array(update.length)}function selection_enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}function constant(x){return function(){return x}}function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue={},groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=keyPrefix+key.call(node,node.__data__,i,group),keyValue in nodeByKeyValue?exit[i]=node:nodeByKeyValue[keyValue]=node);for(i=0;i<dataLength;++i)keyValue=keyPrefix+key.call(parent,data[i],i,data),(node=nodeByKeyValue[keyValue])?(update[i]=node,node.__data__=data[i],nodeByKeyValue[keyValue]=null):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue[keyValues[i]]===node&&(exit[i]=node)}function selection_data(value,key){if(!value)return data=new Array(this.size()),j=-1,this.each(function(d){data[++j]=d}),data;var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=constant(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=value.call(parent,parent&&parent.__data__,j,parents),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return update=new Selection(update,parents),update._enter=enter,update._exit=exit,update}function selection_exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)}function selection_merge(selection$$1){for(var groups0=this._groups,groups1=selection$$1._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)}function selection_order(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&next!==node.nextSibling&&next.parentNode.insertBefore(node,next),next=node);return this}function selection_sort(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()}function ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function selection_call(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this}function selection_nodes(){var nodes=new Array(this.size()),i=-1;return this.each(function(){nodes[++i]=this}),nodes}function selection_node(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null}function selection_size(){var size=0;return this.each(function(){++size}),size}function selection_empty(){return!this.node()}function selection_each(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,value){return function(){this.setAttribute(name,value)}}function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}function selection_attr(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?attrRemoveNS:attrRemove:"function"==typeof value?fullname.local?attrFunctionNS:attrFunction:fullname.local?attrConstantNS:attrConstant)(fullname,value))}function defaultView(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView}function styleRemove(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}}function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}function selection_style(name,value,priority){return arguments.length>1?this.each((null==value?styleRemove:"function"==typeof value?styleFunction:styleConstant)(name,value,null==priority?"":priority)):styleValue(this.node(),name)}function styleValue(node,name){return node.style.getPropertyValue(name)||defaultView(node).getComputedStyle(node,null).getPropertyValue(name)}function propertyRemove(name){return function(){delete this[name]}}function propertyConstant(name,value){return function(){this[name]=value}}function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}function selection_property(name,value){return arguments.length>1?this.each((null==value?propertyRemove:"function"==typeof value?propertyFunction:propertyConstant)(name,value)):this.node()[name]}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function classedTrue(names){return function(){classedAdd(this,names)}}function classedFalse(names){return function(){classedRemove(this,names)}}function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}function selection_classed(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?classedFunction:value?classedTrue:classedFalse)(names,value))}
function textRemove(){this.textContent=""}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}function selection_text(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?textFunction:textConstant)(value)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(value){return function(){this.innerHTML=value}}function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}function selection_html(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?htmlFunction:htmlConstant)(value)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(name){var create="function"==typeof name?name:creator(name);return this.select(function(){return this.appendChild(create.apply(this,arguments))})}function constantNull(){return null}function selection_insert(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select(function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)})}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function selection_cloneDeep(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}function selection_clone(deep){return this.select(deep?selection_cloneDeep:selection_cloneShallow)}function selection_datum(value){return arguments.length?this.property("__data__",value):this.node().__data__}function filterContextListener(listener,index,group){return listener=contextListener(listener,index,group),function(event){var related=event.relatedTarget;related&&(related===this||8&related.compareDocumentPosition(this))||listener.call(this,event)}}function contextListener(listener,index,group){return function(event1){var event0=exports.event;exports.event=event1;try{listener.call(this,this.__data__,index,group)}finally{exports.event=event0}}}function parseTypenames(typenames){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name:name}})}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.capture);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,capture){var wrap=filterEvents.hasOwnProperty(typename.type)?filterContextListener:contextListener;return function(d,i,group){var o,on=this.__on,listener=wrap(value,i,group);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=listener,o.capture=capture),void(o.value=value);this.addEventListener(typename.type,listener,capture),o={type:typename.type,name:typename.name,value:value,listener:listener,capture:capture},on?on.push(o):this.__on=[o]}}function selection_on(typename,value,capture){var i,t,typenames=parseTypenames(typename+""),n=typenames.length;{if(!(arguments.length<2)){for(on=value?onAdd:onRemove,null==capture&&(capture=!1),i=0;i<n;++i)this.each(on(typenames[i],value,capture));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value}}function customEvent(event1,listener,that,args){var event0=exports.event;event1.sourceEvent=exports.event,exports.event=event1;try{return listener.apply(that,args)}finally{exports.event=event0}}function dispatchEvent(node,type,params){var window=defaultView(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}}function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}function selection_dispatch(type,params){return this.each(("function"==typeof params?dispatchFunction:dispatchConstant)(type,params))}function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}function select(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)}function create(name){return select(creator(name).call(document.documentElement))}function local(){return new Local}function Local(){this._="@"+(++nextId).toString(36)}function sourceEvent(){for(var source,current=exports.event;source=current.sourceEvent;)current=source;return current}function point(node,event){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,point=point.matrixTransform(node.getScreenCTM().inverse()),[point.x,point.y]}var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}function mouse(node){var event=sourceEvent();return event.changedTouches&&(event=event.changedTouches[0]),point(node,event)}function selectAll(selector){return"string"==typeof selector?new Selection([document.querySelectorAll(selector)],[document.documentElement]):new Selection([null==selector?[]:selector],root)}function touch(node,touches,identifier){arguments.length<3&&(identifier=touches,touches=sourceEvent().changedTouches);for(var touch,i=0,n=touches?touches.length:0;i<n;++i)if((touch=touches[i]).identifier===identifier)return point(node,touch);return null}function touches(node,touches){null==touches&&(touches=sourceEvent().touches);for(var i=0,n=touches?touches.length:0,points=new Array(n);i<n;++i)points[i]=point(node,touches[i]);return points}var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},matcher=function(selector){return function(){return this.matches(selector)}};if("undefined"!=typeof document){var element=document.documentElement;if(!element.matches){var vendorMatches=element.webkitMatchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector;matcher=function(selector){return function(){return vendorMatches.call(this,selector)}}}}var matcher$1=matcher;EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var keyPrefix="$";ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var filterEvents={};if(exports.event=null,"undefined"!=typeof document){"onmouseenter"in document.documentElement||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"})}var root=[null];Selection.prototype=selection.prototype={constructor:Selection,select:selection_select,selectAll:selection_selectAll,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,merge:selection_merge,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch};var nextId=0;Local.prototype=local.prototype={constructor:Local,get:function(node){for(var id=this._;!(id in node);)if(!(node=node.parentNode))return;return node[id]},set:function(node,value){return node[this._]=value},remove:function(node){return this._ in node&&delete node[this._]},toString:function(){return this._}},exports.create=create,exports.creator=creator,exports.local=local,exports.matcher=matcher$1,exports.mouse=mouse,exports.namespace=namespace,exports.namespaces=namespaces,exports.clientPoint=point,exports.select=select,exports.selectAll=selectAll,exports.selection=selection,exports.selector=selector,exports.selectorAll=selectorAll,exports.style=styleValue,exports.touch=touch,exports.touches=touches,exports.window=defaultView,exports.customEvent=customEvent,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],37:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-path")):"function"==typeof define&&define.amd?define(["exports","d3-path"],factory):factory(global.d3=global.d3||{},global.d3)}(this,function(exports,d3Path){"use strict";function acos(x){return x>1?0:x<-1?pi:Math.acos(x)}function asin(x){return x>=1?halfPi:x<=-1?-halfPi:Math.asin(x)}function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=(x32*(y0-y2)-y32*(x0-x2))/(y32*x10-x32*y10);return[x0+t*x10,y0+t*y10]}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*sqrt(max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function Linear(context){this._context=context}function x(p){return p[0]}function y(p){return p[1]}function Radial(curve){this._curve=curve}function curveRadial(curve){function radial(context){return new Radial(curve(context))}return radial._curve=curve,radial}function lineRadial(l){var c=l.curve;return l.angle=l.x,delete l.x,l.radius=l.y,delete l.y,l.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},l}function linkSource(d){return d.source}function linkTarget(d){return d.target}function link(curve){function link(){var buffer,argv=slice.call(arguments),s=source.apply(this,argv),t=target.apply(this,argv);if(context||(context=buffer=d3Path.path()),curve(context,+x$$1.apply(this,(argv[0]=s,argv)),+y$$1.apply(this,argv),+x$$1.apply(this,(argv[0]=t,argv)),+y$$1.apply(this,argv)),buffer)return context=null,buffer+""||null}var source=linkSource,target=linkTarget,x$$1=x,y$$1=y,context=null;return link.source=function(_){return arguments.length?(source=_,link):source},link.target=function(_){return arguments.length?(target=_,link):target},link.x=function(_){return arguments.length?(x$$1="function"==typeof _?_:constant(+_),link):x$$1},link.y=function(_){return arguments.length?(y$$1="function"==typeof _?_:constant(+_),link):y$$1},link.context=function(_){return arguments.length?(context=null==_?null:_,link):context},link}function curveHorizontal(context,x0,y0,x1,y1){context.moveTo(x0,y0),context.bezierCurveTo(x0=(x0+x1)/2,y0,x0,y1,x1,y1)}function curveVertical(context,x0,y0,x1,y1){context.moveTo(x0,y0),context.bezierCurveTo(x0,y0=(y0+y1)/2,x1,y0,x1,y1)}function curveRadial$1(context,x0,y0,x1,y1){var p0=pointRadial(x0,y0),p1=pointRadial(x0,y0=(y0+y1)/2),p2=pointRadial(x1,y0),p3=pointRadial(x1,y1);context.moveTo(p0[0],p0[1]),context.bezierCurveTo(p1[0],p1[1],p2[0],p2[1],p3[0],p3[1])}function linkHorizontal(){return link(curveHorizontal)}function linkVertical(){return link(curveVertical)}function linkRadial(){var l=link(curveRadial$1);return l.angle=l.x,delete l.x,l.radius=l.y,delete l.y,l}function point(that,x,y){that._context.bezierCurveTo((2*that._x0+that._x1)/3,(2*that._y0+that._y1)/3,(that._x0+2*that._x1)/3,(that._y0+2*that._y1)/3,(that._x0+4*that._x1+x)/6,(that._y0+4*that._y1+y)/6)}function Basis(context){this._context=context}function BasisClosed(context){this._context=context}function BasisOpen(context){this._context=context}function Bundle(context,beta){this._basis=new Basis(context),this._beta=beta}function point$1(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context,this._k=(1-tension)/6}function CardinalClosed(context,tension){this._context=context,this._k=(1-tension)/6}function CardinalOpen(context,tension){this._context=context,this._k=(1-tension)/6}function point$2(that,x,y){var x1=that._x1,y1=that._y1,x2=that._x2,y2=that._y2;if(that._l01_a>epsilon){var a=2*that._l01_2a+3*that._l01_a*that._l12_a+that._l12_2a,n=3*that._l01_a*(that._l01_a+that._l12_a);x1=(x1*a-that._x0*that._l12_2a+that._x2*that._l01_2a)/n,y1=(y1*a-that._y0*that._l12_2a+that._y2*that._l01_2a)/n}if(that._l23_a>epsilon){var b=2*that._l23_2a+3*that._l23_a*that._l12_a+that._l12_2a,m=3*that._l23_a*(that._l23_a+that._l12_a);x2=(x2*b+that._x1*that._l23_2a-x*that._l12_2a)/m,y2=(y2*b+that._y1*that._l23_2a-y*that._l12_2a)/m}that._context.bezierCurveTo(x1,y1,x2,y2,that._x2,that._y2)}function CatmullRom(context,alpha){this._context=context,this._alpha=alpha}function CatmullRomClosed(context,alpha){this._context=context,this._alpha=alpha}function CatmullRomOpen(context,alpha){this._context=context,this._alpha=alpha}function LinearClosed(context){this._context=context}function sign(x){return x<0?-1:1}function slope3(that,x2,y2){var h0=that._x1-that._x0,h1=x2-that._x1,s0=(that._y1-that._y0)/(h0||h1<0&&-0),s1=(y2-that._y1)/(h1||h0<0&&-0),p=(s0*h1+s1*h0)/(h0+h1);return(sign(s0)+sign(s1))*Math.min(Math.abs(s0),Math.abs(s1),.5*Math.abs(p))||0}function slope2(that,t){var h=that._x1-that._x0;return h?(3*(that._y1-that._y0)/h-t)/2:t}function point$3(that,t0,t1){var x0=that._x0,y0=that._y0,x1=that._x1,y1=that._y1,dx=(x1-x0)/3;that._context.bezierCurveTo(x0+dx,y0+dx*t0,x1-dx,y1-dx*t1,x1,y1)}function MonotoneX(context){this._context=context}function MonotoneY(context){this._context=new ReflectContext(context)}function ReflectContext(context){this._context=context}function monotoneX(context){return new MonotoneX(context)}function monotoneY(context){return new MonotoneY(context)}function Natural(context){this._context=context}function controlPoints(x){var i,m,n=x.length-1,a=new Array(n),b=new Array(n),r=new Array(n);for(a[0]=0,b[0]=2,r[0]=x[0]+2*x[1],i=1;i<n-1;++i)a[i]=1,b[i]=4,r[i]=4*x[i]+2*x[i+1];for(a[n-1]=2,b[n-1]=7,r[n-1]=8*x[n-1]+x[n],i=1;i<n;++i)m=a[i]/b[i-1],b[i]-=m,r[i]-=m*r[i-1];for(a[n-1]=r[n-1]/b[n-1],i=n-2;i>=0;--i)a[i]=(r[i]-a[i+1])/b[i];for(b[n-1]=(x[n]+a[n-1])/2,i=0;i<n-1;++i)b[i]=2*x[i+1]-a[i+1];return[a,b]}function Step(context,t){this._context=context,this._t=t}function stepBefore(context){return new Step(context,0)}function stepAfter(context){return new Step(context,1)}function stackValue(d,key){return d[key]}function sum(series){for(var v,s=0,i=-1,n=series.length;++i<n;)(v=+series[i][1])&&(s+=v);return s}var constant=function(x){return function(){return x}},abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max=Math.max,min=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon=1e-12,pi=Math.PI,halfPi=pi/2,tau=2*pi,arc=function(){function arc(){var buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-halfPi,a1=endAngle.apply(this,arguments)-halfPi,da=abs(a1-a0),cw=a1>a0;if(context||(context=buffer=d3Path.path()),r1<r0&&(r=r1,r1=r0,r0=r),r1>epsilon)if(da>tau-epsilon)context.moveTo(r1*cos(a0),r1*sin(a0)),context.arc(0,0,r1,a0,a1,!cw),r0>epsilon&&(context.moveTo(r0*cos(a1),r0*sin(a1)),context.arc(0,0,r0,a1,a0,cw));else{var t0,t1,a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>epsilon&&(padRadius?+padRadius.apply(this,arguments):sqrt(r0*r0+r1*r1)),rc=min(abs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc;if(rp>epsilon){var p0=asin(rp/r0*sin(ap)),p1=asin(rp/r1*sin(ap));(da0-=2*p0)>epsilon?(p0*=cw?1:-1,a00+=p0,a10-=p0):(da0=0,a00=a10=(a0+a1)/2),(da1-=2*p1)>epsilon?(p1*=cw?1:-1,a01+=p1,a11-=p1):(da1=0,a01=a11=(a0+a1)/2)}var x01=r1*cos(a01),y01=r1*sin(a01),x10=r0*cos(a10),y10=r0*sin(a10);if(rc>epsilon){var x11=r1*cos(a11),y11=r1*sin(a11),x00=r0*cos(a00),y00=r0*sin(a00);if(da<pi){var oc=da0>epsilon?intersect(x01,y01,x00,y00,x11,y11,x10,y10):[x10,y10],ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/sin(acos((ax*bx+ay*by)/(sqrt(ax*ax+ay*ay)*sqrt(bx*bx+by*by)))/2),lc=sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=min(rc,(r0-lc)/(kc-1)),rc1=min(rc,(r1-lc)/(kc+1))}}da1>epsilon?rc1>epsilon?(t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw),t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw),context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01),rc1<rc?context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r1,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),!cw),context.arc(t1.cx,t1.cy,rc1,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):(context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw)):context.moveTo(x01,y01),r0>epsilon&&da0>epsilon?rc0>epsilon?(t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw),t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw),context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01),rc0<rc?context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r0,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),cw),context.arc(t1.cx,t1.cy,rc0,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):context.arc(0,0,r0,a10,a00,cw):context.lineTo(x10,y10)}else context.moveTo(0,0);if(context.closePath(),buffer)return context=null,buffer+""||null}var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=constant(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;return arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-pi/2;return[cos(a)*r,sin(a)*r]},arc.innerRadius=function(_){return arguments.length?(innerRadius="function"==typeof _?_:constant(+_),arc):innerRadius},arc.outerRadius=function(_){return arguments.length?(outerRadius="function"==typeof _?_:constant(+_),arc):outerRadius},arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"==typeof _?_:constant(+_),arc):cornerRadius},arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"==typeof _?_:constant(+_),arc):padRadius},arc.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant(+_),arc):startAngle},arc.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant(+_),arc):endAngle},arc.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant(+_),arc):padAngle},arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context},arc};Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}};var curveLinear=function(context){return new Linear(context)},line=function(){function line(data){var i,d,buffer,n=data.length,defined0=!1;for(null==context&&(output=curve(buffer=d3Path.path())),i=0;i<=n;++i)!(i<n&&defined(d=data[i],i,data))===defined0&&((defined0=!defined0)?output.lineStart():output.lineEnd()),defined0&&output.point(+x$$1(d,i,data),+y$$1(d,i,data));if(buffer)return output=null,buffer+""||null}var x$$1=x,y$$1=y,defined=constant(!0),context=null,curve=curveLinear,output=null;return line.x=function(_){return arguments.length?(x$$1="function"==typeof _?_:constant(+_),line):x$$1},line.y=function(_){return arguments.length?(y$$1="function"==typeof _?_:constant(+_),line):y$$1},line.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant(!!_),line):defined},line.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),line):curve},line.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),line):context},line},area=function(){function area(data){var i,j,k,d,buffer,n=data.length,defined0=!1,x0z=new Array(n),y0z=new Array(n);for(null==context&&(output=curve(buffer=d3Path.path())),i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0)if(defined0=!defined0)j=i,output.areaStart(),output.lineStart();else{for(output.lineEnd(),output.lineStart(),k=i-1;k>=j;--k)output.point(x0z[k],y0z[k]);output.lineEnd(),output.areaEnd()}defined0&&(x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data),output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i]))}if(buffer)return output=null,buffer+""||null}function arealine(){return line().defined(defined).curve(curve).context(context)}var x0=x,x1=null,y0=constant(0),y1=y,defined=constant(!0),context=null,curve=curveLinear,output=null;return area.x=function(_){return arguments.length?(x0="function"==typeof _?_:constant(+_),x1=null,area):x0},area.x0=function(_){return arguments.length?(x0="function"==typeof _?_:constant(+_),area):x0},area.x1=function(_){return arguments.length?(x1=null==_?null:"function"==typeof _?_:constant(+_),area):x1},area.y=function(_){return arguments.length?(y0="function"==typeof _?_:constant(+_),y1=null,area):y0},area.y0=function(_){return arguments.length?(y0="function"==typeof _?_:constant(+_),area):y0},area.y1=function(_){return arguments.length?(y1=null==_?null:"function"==typeof _?_:constant(+_),area):y1},area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)},area.lineY1=function(){return arealine().x(x0).y(y1)},area.lineX1=function(){return arealine().x(x1).y(y0)},area.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant(!!_),area):defined},area.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),area):curve},area.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),area):context},area},descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},identity=function(d){return d},pie=function(){function pie(data){var i,j,k,a1,v,n=data.length,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(tau,Math.max(-tau,endAngle.apply(this,arguments)-a0)),p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1);for(i=0;i<n;++i)(v=arcs[index[i]=i]=+value(data[i],i,data))>0&&(sum+=v);for(null!=sortValues?index.sort(function(i,j){return sortValues(arcs[i],arcs[j])}):null!=sort&&index.sort(function(i,j){return sort(data[i],data[j])}),i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1)j=index[i],v=arcs[j],a1=a0+(v>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p};return arcs}var value=identity,sortValues=descending,sort=null,startAngle=constant(0),endAngle=constant(tau),padAngle=constant(0);return pie.value=function(_){return arguments.length?(value="function"==typeof _?_:constant(+_),pie):value},pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues},pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant(+_),pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant(+_),pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant(+_),pie):padAngle},pie},curveRadialLinear=curveRadial(curveLinear);Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,r){this._curve.point(r*Math.sin(a),r*-Math.cos(a))}};var lineRadial$1=function(){return lineRadial(line().curve(curveRadialLinear))},areaRadial=function(){var a=area().curve(curveRadialLinear),c=a.curve,x0=a.lineX0,x1=a.lineX1,y0=a.lineY0,y1=a.lineY1;return a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return lineRadial(x0())},delete a.lineX0,a.lineEndAngle=function(){return lineRadial(x1())},delete a.lineX1,a.lineInnerRadius=function(){return lineRadial(y0())},delete a.lineY0,a.lineOuterRadius=function(){return lineRadial(y1())},delete a.lineY1,a.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},a},pointRadial=function(x,y){return[(y=+y)*Math.cos(x-=Math.PI/2),y*Math.sin(x)]},slice=Array.prototype.slice,circle={draw:function(context,size){var r=Math.sqrt(size/pi);context.moveTo(r,0),context.arc(0,0,r,0,tau)}},cross={draw:function(context,size){var r=Math.sqrt(size/5)/2;context.moveTo(-3*r,-r),context.lineTo(-r,-r),context.lineTo(-r,-3*r),context.lineTo(r,-3*r),context.lineTo(r,-r),context.lineTo(3*r,-r),context.lineTo(3*r,r),context.lineTo(r,r),context.lineTo(r,3*r),context.lineTo(-r,3*r),context.lineTo(-r,r),context.lineTo(-3*r,r),context.closePath()}},tan30=Math.sqrt(1/3),tan30_2=2*tan30,diamond={draw:function(context,size){var y=Math.sqrt(size/tan30_2),x=y*tan30;context.moveTo(0,-y),context.lineTo(x,0),context.lineTo(0,y),context.lineTo(-x,0),context.closePath()}},kr=Math.sin(pi/10)/Math.sin(7*pi/10),kx=Math.sin(tau/10)*kr,ky=-Math.cos(tau/10)*kr,star={draw:function(context,size){var r=Math.sqrt(.8908130915292852*size),x=kx*r,y=ky*r;context.moveTo(0,-r),context.lineTo(x,y);for(var i=1;i<5;++i){var a=tau*i/5,c=Math.cos(a),s=Math.sin(a);context.lineTo(s*r,-c*r),context.lineTo(c*x-s*y,s*x+c*y)}context.closePath()}},square={draw:function(context,size){var w=Math.sqrt(size),x=-w/2;context.rect(x,x,w,w)}},sqrt3=Math.sqrt(3),triangle={draw:function(context,size){var y=-Math.sqrt(size/(3*sqrt3));context.moveTo(0,2*y),context.lineTo(-sqrt3*y,-y),context.lineTo(sqrt3*y,-y),context.closePath()}},c=-.5,s=Math.sqrt(3)/2,k=1/Math.sqrt(12),a=3*(k/2+1),wye={draw:function(context,size){var r=Math.sqrt(size/a),x0=r/2,y0=r*k,x1=x0,y1=r*k+r,x2=-x1,y2=y1;context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.lineTo(c*x0-s*y0,s*x0+c*y0),context.lineTo(c*x1-s*y1,s*x1+c*y1),context.lineTo(c*x2-s*y2,s*x2+c*y2),context.lineTo(c*x0+s*y0,c*y0-s*x0),context.lineTo(c*x1+s*y1,c*y1-s*x1),context.lineTo(c*x2+s*y2,c*y2-s*x2),context.closePath()}},symbols=[circle,cross,diamond,square,star,triangle,wye],symbol=function(){function symbol(){var buffer;if(context||(context=buffer=d3Path.path()),type.apply(this,arguments).draw(context,+size.apply(this,arguments)),buffer)return context=null,buffer+""||null}var type=constant(circle),size=constant(64),context=null;return symbol.type=function(_){return arguments.length?(type="function"==typeof _?_:constant(_),symbol):type},symbol.size=function(_){return arguments.length?(size="function"==typeof _?_:constant(+_),symbol):size},symbol.context=function(_){return arguments.length?(context=null==_?null:_,symbol):context},symbol},noop=function(){};Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basis=function(context){return new Basis(context)};BasisClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x2=x,this._y2=y;break;case 1:this._point=2,this._x3=x,this._y3=y;break;case 2:this._point=3,this._x4=x,this._y4=y,this._context.moveTo((this._x0+4*this._x1+x)/6,(this._y0+4*this._y1+y)/6);break;default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basisClosed=function(context){return new BasisClosed(context)};BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var x0=(this._x0+4*this._x1+x)/6,y0=(this._y0+4*this._y1+y)/6;this._line?this._context.lineTo(x0,y0):this._context.moveTo(x0,y0);break;case 3:this._point=4;default:point(this,x,y)}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y}};var basisOpen=function(context){return new BasisOpen(context)};Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var x=this._x,y=this._y,j=x.length-1;if(j>0)for(var t,x0=x[0],y0=y[0],dx=x[j]-x0,dy=y[j]-y0,i=-1;++i<=j;)t=i/j,this._basis.point(this._beta*x[i]+(1-this._beta)*(x0+t*dx),this._beta*y[i]+(1-this._beta)*(y0+t*dy));this._x=this._y=null,this._basis.lineEnd()},point:function(x,y){this._x.push(+x),this._y.push(+y)}}
;var bundle=function custom(beta){function bundle(context){return 1===beta?new Basis(context):new Bundle(context,beta)}return bundle.beta=function(beta){return custom(+beta)},bundle}(.85);Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$1(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:point$1(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinal=function custom(tension){function cardinal(context){return new Cardinal(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CardinalClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:point$1(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinalClosed=function custom(tension){function cardinal(context){return new CardinalClosed(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$1(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinalOpen=function custom(tension){function cardinal(context){return new CardinalOpen(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:point$2(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRom=function custom(alpha){function catmullRom(context){return alpha?new CatmullRom(context,alpha):new Cardinal(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);CatmullRomClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:point$2(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRomClosed=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomClosed(context,alpha):new CardinalClosed(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$2(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var catmullRomOpen=function custom(alpha){function catmullRom(context){return alpha?new CatmullRomOpen(context,alpha):new CardinalOpen(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);LinearClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(x,y){x=+x,y=+y,this._point?this._context.lineTo(x,y):(this._point=1,this._context.moveTo(x,y))}};var linearClosed=function(context){return new LinearClosed(context)};MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$3(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){var t1=NaN;if(x=+x,y=+y,x!==this._x1||y!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,point$3(this,slope2(this,t1=slope3(this,x,y)),t1);break;default:point$3(this,this._t0,t1=slope3(this,x,y))}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y,this._t0=t1}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(x,y){MonotoneX.prototype.point.call(this,y,x)},ReflectContext.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._context.bezierCurveTo(y1,x1,y2,x2,y,x)}},Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var x=this._x,y=this._y,n=x.length;if(n)if(this._line?this._context.lineTo(x[0],y[0]):this._context.moveTo(x[0],y[0]),2===n)this._context.lineTo(x[1],y[1]);else for(var px=controlPoints(x),py=controlPoints(y),i0=0,i1=1;i1<n;++i0,++i1)this._context.bezierCurveTo(px[0][i0],py[0][i0],px[1][i0],py[1][i0],x[i1],y[i1]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(x,y){this._x.push(+x),this._y.push(+y)}};var natural=function(context){return new Natural(context)};Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y),this._context.lineTo(x1,y)}}this._x=x,this._y=y}};var step=function(context){return new Step(context,.5)},none=function(series,order){if((n=series.length)>1)for(var j,s0,n,i=1,s1=series[order[0]],m=s1.length;i<n;++i)for(s0=s1,s1=series[order[i]],j=0;j<m;++j)s1[j][1]+=s1[j][0]=isNaN(s0[j][1])?s0[j][0]:s0[j][1]},none$1=function(series){for(var n=series.length,o=new Array(n);--n>=0;)o[n]=n;return o},stack=function(){function stack(data){var i,oz,kz=keys.apply(this,arguments),m=data.length,n=kz.length,sz=new Array(n);for(i=0;i<n;++i){for(var sij,ki=kz[i],si=sz[i]=new Array(m),j=0;j<m;++j)si[j]=sij=[0,+value(data[j],ki,j,data)],sij.data=data[j];si.key=ki}for(i=0,oz=order(sz);i<n;++i)sz[oz[i]].index=i;return offset(sz,oz),sz}var keys=constant([]),order=none$1,offset=none,value=stackValue;return stack.keys=function(_){return arguments.length?(keys="function"==typeof _?_:constant(slice.call(_)),stack):keys},stack.value=function(_){return arguments.length?(value="function"==typeof _?_:constant(+_),stack):value},stack.order=function(_){return arguments.length?(order=null==_?none$1:"function"==typeof _?_:constant(slice.call(_)),stack):order},stack.offset=function(_){return arguments.length?(offset=null==_?none:_,stack):offset},stack},expand=function(series,order){if((n=series.length)>0){for(var i,n,y,j=0,m=series[0].length;j<m;++j){for(y=i=0;i<n;++i)y+=series[i][j][1]||0;if(y)for(i=0;i<n;++i)series[i][j][1]/=y}none(series,order)}},diverging=function(series,order){if((n=series.length)>1)for(var i,d,dy,yp,yn,n,j=0,m=series[order[0]].length;j<m;++j)for(yp=yn=0,i=0;i<n;++i)(dy=(d=series[order[i]][j])[1]-d[0])>=0?(d[0]=yp,d[1]=yp+=dy):dy<0?(d[1]=yn,d[0]=yn+=dy):d[0]=yp},silhouette=function(series,order){if((n=series.length)>0){for(var n,j=0,s0=series[order[0]],m=s0.length;j<m;++j){for(var i=0,y=0;i<n;++i)y+=series[i][j][1]||0;s0[j][1]+=s0[j][0]=-y/2}none(series,order)}},wiggle=function(series,order){if((n=series.length)>0&&(m=(s0=series[order[0]]).length)>0){for(var s0,m,n,y=0,j=1;j<m;++j){for(var i=0,s1=0,s2=0;i<n;++i){for(var si=series[order[i]],sij0=si[j][1]||0,sij1=si[j-1][1]||0,s3=(sij0-sij1)/2,k=0;k<i;++k){var sk=series[order[k]];s3+=(sk[j][1]||0)-(sk[j-1][1]||0)}s1+=sij0,s2+=s3*sij0}s0[j-1][1]+=s0[j-1][0]=y,s1&&(y-=s2/s1)}s0[j-1][1]+=s0[j-1][0]=y,none(series,order)}},ascending=function(series){var sums=series.map(sum);return none$1(series).sort(function(a,b){return sums[a]-sums[b]})},descending$1=function(series){return ascending(series).reverse()},insideOut=function(series){var i,j,n=series.length,sums=series.map(sum),order=none$1(series).sort(function(a,b){return sums[b]-sums[a]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i)j=order[i],top<bottom?(top+=sums[j],tops.push(j)):(bottom+=sums[j],bottoms.push(j));return bottoms.reverse().concat(tops)},reverse=function(series){return none$1(series).reverse()};exports.arc=arc,exports.area=area,exports.line=line,exports.pie=pie,exports.areaRadial=areaRadial,exports.radialArea=areaRadial,exports.lineRadial=lineRadial$1,exports.radialLine=lineRadial$1,exports.pointRadial=pointRadial,exports.linkHorizontal=linkHorizontal,exports.linkVertical=linkVertical,exports.linkRadial=linkRadial,exports.symbol=symbol,exports.symbols=symbols,exports.symbolCircle=circle,exports.symbolCross=cross,exports.symbolDiamond=diamond,exports.symbolSquare=square,exports.symbolStar=star,exports.symbolTriangle=triangle,exports.symbolWye=wye,exports.curveBasisClosed=basisClosed,exports.curveBasisOpen=basisOpen,exports.curveBasis=basis,exports.curveBundle=bundle,exports.curveCardinalClosed=cardinalClosed,exports.curveCardinalOpen=cardinalOpen,exports.curveCardinal=cardinal,exports.curveCatmullRomClosed=catmullRomClosed,exports.curveCatmullRomOpen=catmullRomOpen,exports.curveCatmullRom=catmullRom,exports.curveLinearClosed=linearClosed,exports.curveLinear=curveLinear,exports.curveMonotoneX=monotoneX,exports.curveMonotoneY=monotoneY,exports.curveNatural=natural,exports.curveStep=step,exports.curveStepAfter=stepAfter,exports.curveStepBefore=stepBefore,exports.stack=stack,exports.stackOffsetExpand=expand,exports.stackOffsetDiverging=diverging,exports.stackOffsetNone=none,exports.stackOffsetSilhouette=silhouette,exports.stackOffsetWiggle=wiggle,exports.stackOrderAscending=ascending,exports.stackOrderDescending=descending$1,exports.stackOrderInsideOut=insideOut,exports.stackOrderNone=none$1,exports.stackOrderReverse=reverse,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-path":29}],38:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function rotatePoint(x,y,theta){return[Math.cos(theta)*x+-Math.sin(theta)*y,Math.sin(theta)*x+Math.cos(theta)*y]}function circumradius(side){return side*circumradiusCoeff}function sideLength(area){var num=4*area,denom=Math.sqrt(5*(5+2*Math.sqrt(5)));return Math.sqrt(num/denom)}function sideLength$1(area){var num=2*area,denom=3*Math.sqrt(3);return Math.sqrt(num/denom)}function drawBuild(theta){var t=theta||0;return function(context,size){var s=sideLength$1(size),R=s;context.moveTo.apply(context,rotatePoint(R,0,t));for(var i=0;i<6;++i){var a=tau*i/6,x=Math.cos(a)*R,y=Math.sin(a)*R;context.lineTo.apply(context,rotatePoint(x,y,t))}context.closePath()}}function circumradius$1(side){return side*circumradiusCoeff$1}function sideLength$2(area){var num=area*(1-Math.sqrt(2));return Math.sqrt(-1*num/2)}function drawBuild$1(theta){var t=theta||0;return function(context,size){var s=sideLength$2(size),R=circumradius$1(s);context.moveTo.apply(context,rotatePoint(R,0,t));for(var i=0;i<8;++i){var a=tau*i/8,x=Math.cos(a)*R,y=Math.sin(a)*R;context.lineTo.apply(context,rotatePoint(x,y,t))}context.closePath()}}var sqrt3=Math.sqrt(3),triangleDown={draw:function(context,size){var y=-Math.sqrt(size/(3*sqrt3));context.moveTo(0,2*-y),context.lineTo(-sqrt3*y,y),context.lineTo(sqrt3*y,y),context.closePath()}},triangleLeft={draw:function(context,size){var x=-Math.sqrt(size/(3*sqrt3));context.moveTo(2*x,0),context.lineTo(-x,-sqrt3*x),context.lineTo(-x,sqrt3*x),context.closePath()}},triangleRight={draw:function(context,size){var x=-Math.sqrt(size/(3*sqrt3));context.moveTo(2*-x,0),context.lineTo(x,-sqrt3*x),context.lineTo(x,sqrt3*x),context.closePath()}},tan30=Math.sqrt(1/3),tan30_2=2*tan30,diamondAlt={draw:function(context,size){var x=Math.sqrt(size/tan30_2),y=x*tan30;context.moveTo(0,-y),context.lineTo(x,0),context.lineTo(0,y),context.lineTo(-x,0),context.closePath()}},diamondSquare={draw:function(context,size){var w=Math.sqrt(size),d=w/2*Math.sqrt(2);context.moveTo(0,-d),context.lineTo(d,0),context.lineTo(0,d),context.lineTo(-d,0),context.closePath()}},pi=Math.PI,tau=2*pi,circumradiusCoeff=.1*Math.sqrt(50+10*Math.sqrt(5)),pentagon={draw:function(context,size){var s=sideLength(size),R=circumradius(s),theta=-tau/4;context.moveTo.apply(context,rotatePoint(R,0,theta));for(var i=0;i<5;++i){var a=tau*i/5,x=Math.cos(a)*R,y=Math.sin(a)*R;context.lineTo.apply(context,rotatePoint(x,y,theta))}context.closePath()}},hexagon={draw:drawBuild(tau/12)},hexagonAlt={draw:drawBuild()},circumradiusCoeff$1=.5*Math.sqrt(4+2*Math.sqrt(2)),octagon={draw:drawBuild$1()},octagonAlt={draw:drawBuild$1(tau/16)},x={draw:function(context,size){var r=Math.sqrt(size/5)/2,theta=tau/8,points=[rotatePoint(-3*r,-r,theta),rotatePoint(-r,-r,theta),rotatePoint(-r,-3*r,theta),rotatePoint(r,-3*r,theta),rotatePoint(r,-r,theta),rotatePoint(3*r,-r,theta),rotatePoint(3*r,r,theta),rotatePoint(r,r,theta),rotatePoint(r,3*r,theta),rotatePoint(-r,3*r,theta),rotatePoint(-r,r,theta),rotatePoint(-3*r,r,theta)];context.moveTo.apply(context,points.pop());for(var i=0;i<points.length;i++)context.lineTo.apply(context,points[i]);context.closePath()}};exports.symbolTriangleDown=triangleDown,exports.symbolTriangleLeft=triangleLeft,exports.symbolTriangleRight=triangleRight,exports.symbolDiamondAlt=diamondAlt,exports.symbolDiamondSquare=diamondSquare,exports.symbolPentagon=pentagon,exports.symbolHexagon=hexagon,exports.symbolHexagonAlt=hexagonAlt,exports.symbolOctagon=octagon,exports.symbolOctagonAlt=octagonAlt,exports.symbolCrossAlt=x,exports.symbolX=x,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],39:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-time")):"function"==typeof define&&define.amd?define(["exports","d3-time"],factory):factory(global.d3=global.d3||{},global.d3)}(this,function(exports,d3Time){"use strict";function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return date.setFullYear(d.y),date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return date.setUTCFullYear(d.y),date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newYear(y){return{y:y,m:0,d:1,H:0,M:0,S:0,L:0}}function formatLocale(locale){function newFormat(specifier,formats){return function(date){var c,pad,format,string=[],i=-1,j=0,n=specifier.length;for(date instanceof Date||(date=new Date(+date));++i<n;)37===specifier.charCodeAt(i)&&(string.push(specifier.slice(j,i)),null!=(pad=pads[c=specifier.charAt(++i)])?c=specifier.charAt(++i):pad="e"===c?" ":"0",(format=formats[c])&&(c=format(date,pad)),string.push(c),j=i+1);return string.push(specifier.slice(j,i)),string.join("")}}function newParse(specifier,newDate){return function(string){var week,day,d=newYear(1900),i=parseSpecifier(d,specifier,string+="",0);if(i!=string.length)return null;if("Q"in d)return new Date(d.Q);if("p"in d&&(d.H=d.H%12+12*d.p),"V"in d){if(d.V<1||d.V>53)return null;"w"in d||(d.w=1),"Z"in d?(week=utcDate(newYear(d.y)),day=week.getUTCDay(),week=day>4||0===day?d3Time.utcMonday.ceil(week):d3Time.utcMonday(week),week=d3Time.utcDay.offset(week,7*(d.V-1)),d.y=week.getUTCFullYear(),d.m=week.getUTCMonth(),d.d=week.getUTCDate()+(d.w+6)%7):(week=newDate(newYear(d.y)),day=week.getDay(),week=day>4||0===day?d3Time.timeMonday.ceil(week):d3Time.timeMonday(week),week=d3Time.timeDay.offset(week,7*(d.V-1)),d.y=week.getFullYear(),d.m=week.getMonth(),d.d=week.getDate()+(d.w+6)%7)}else("W"in d||"U"in d)&&("w"in d||(d.w="u"in d?d.u%7:"W"in d?1:0),day="Z"in d?utcDate(newYear(d.y)).getUTCDay():newDate(newYear(d.y)).getDay(),d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(day+5)%7:d.w+7*d.U-(day+6)%7);return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,utcDate(d)):newDate(d)}}function parseSpecifier(d,specifier,string,j){for(var c,parse,i=0,n=specifier.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=specifier.charCodeAt(i++))){if(c=specifier.charAt(i++),!(parse=parses[c in pads?specifier.charAt(i++):c])||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}function parsePeriod(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortWeekday(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseWeekday(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseShortMonth(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseMonth(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup[n[0].toLowerCase()],i+n[0].length):-1}function parseLocaleDateTime(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)}function parseLocaleDate(d,string,i){return parseSpecifier(d,locale_date,string,i)}function parseLocaleTime(d,string,i){return parseSpecifier(d,locale_time,string,i)}function formatShortWeekday(d){return locale_shortWeekdays[d.getDay()]}function formatWeekday(d){return locale_weekdays[d.getDay()]}function formatShortMonth(d){return locale_shortMonths[d.getMonth()]}function formatMonth(d){return locale_months[d.getMonth()]}function formatPeriod(d){return locale_periods[+(d.getHours()>=12)]}function formatUTCShortWeekday(d){return locale_shortWeekdays[d.getUTCDay()]}function formatUTCWeekday(d){return locale_weekdays[d.getUTCDay()]}function formatUTCShortMonth(d){return locale_shortMonths[d.getUTCMonth()]}function formatUTCMonth(d){return locale_months[d.getUTCMonth()]}function formatUTCPeriod(d){return locale_periods[+(d.getUTCHours()>=12)]}var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths,periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths),formats={a:formatShortWeekday,A:formatWeekday,b:formatShortMonth,B:formatMonth,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:formatPeriod,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},utcFormats={a:formatUTCShortWeekday,A:formatUTCWeekday,b:formatUTCShortMonth,B:formatUTCMonth,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:formatUTCPeriod,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},parses={a:parseShortWeekday,A:parseWeekday,b:parseShortMonth,B:parseMonth,c:parseLocaleDateTime,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:parsePeriod,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:parseLocaleDate,X:parseLocaleTime,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};return formats.x=newFormat(locale_date,formats),formats.X=newFormat(locale_time,formats),formats.c=newFormat(locale_dateTime,formats),utcFormats.x=newFormat(locale_date,utcFormats),utcFormats.X=newFormat(locale_time,utcFormats),utcFormats.c=newFormat(locale_dateTime,utcFormats),{format:function(specifier){var f=newFormat(specifier+="",formats);return f.toString=function(){return specifier},f},parse:function(specifier){var p=newParse(specifier+="",localDate);return p.toString=function(){return specifier},p},utcFormat:function(specifier){var f=newFormat(specifier+="",utcFormats);return f.toString=function(){return specifier},f},utcParse:function(specifier){var p=newParse(specifier,utcDate);return p.toString=function(){return specifier},p}}}function pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){for(var map={},i=-1,n=names.length;++i<n;)map[names[i].toLowerCase()]=i;return map}function parseWeekdayNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekdayNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.u=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberISO(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.V=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseMicroseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+6));return n?(d.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function parseUnixTimestamp(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=+n[0],i+n[0].length):-1}function parseUnixTimestampSeconds(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=1e3*+n[0],i+n[0].length):-1}function formatDayOfMonth(d,p){return pad(d.getDate(),p,2)}function formatHour24(d,p){return pad(d.getHours(),p,2)}function formatHour12(d,p){return pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return pad(1+d3Time.timeDay.count(d3Time.timeYear(d),d),p,3)}function formatMilliseconds(d,p){return pad(d.getMilliseconds(),p,3)}function formatMicroseconds(d,p){return formatMilliseconds(d,p)+"000"}function formatMonthNumber(d,p){return pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return pad(d.getSeconds(),p,2)}function formatWeekdayNumberMonday(d){var day=d.getDay();return 0===day?7:day}function formatWeekNumberSunday(d,p){return pad(d3Time.timeSunday.count(d3Time.timeYear(d),d),p,2)}function formatWeekNumberISO(d,p){var day=d.getDay();return d=day>=4||0===day?d3Time.timeThursday(d):d3Time.timeThursday.ceil(d),pad(d3Time.timeThursday.count(d3Time.timeYear(d),d)+(4===d3Time.timeYear(d).getDay()),p,2)}function formatWeekdayNumberSunday(d){return d.getDay()}function formatWeekNumberMonday(d,p){return pad(d3Time.timeMonday.count(d3Time.timeYear(d),d),p,2)}function formatYear(d,p){return pad(d.getFullYear()%100,p,2)}function formatFullYear(d,p){return pad(d.getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+pad(z/60|0,"0",2)+pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return pad(1+d3Time.utcDay.count(d3Time.utcYear(d),d),p,3)}function formatUTCMilliseconds(d,p){return pad(d.getUTCMilliseconds(),p,3)}function formatUTCMicroseconds(d,p){return formatUTCMilliseconds(d,p)+"000"}function formatUTCMonthNumber(d,p){return pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return pad(d.getUTCSeconds(),p,2)}function formatUTCWeekdayNumberMonday(d){var dow=d.getUTCDay();return 0===dow?7:dow}function formatUTCWeekNumberSunday(d,p){return pad(d3Time.utcSunday.count(d3Time.utcYear(d),d),p,2)}function formatUTCWeekNumberISO(d,p){var day=d.getUTCDay();return d=day>=4||0===day?d3Time.utcThursday(d):d3Time.utcThursday.ceil(d),pad(d3Time.utcThursday.count(d3Time.utcYear(d),d)+(4===d3Time.utcYear(d).getUTCDay()),p,2)}function formatUTCWeekdayNumberSunday(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return pad(d3Time.utcMonday.count(d3Time.utcYear(d),d),p,2)}function formatUTCYear(d,p){return pad(d.getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(d){return+d}function formatUnixTimestampSeconds(d){return Math.floor(+d/1e3)}function defaultLocale(definition){return locale=formatLocale(definition),exports.timeFormat=locale.format,exports.timeParse=locale.parse,exports.utcFormat=locale.utcFormat,exports.utcParse=locale.utcParse,locale}function formatIsoNative(date){return date.toISOString()}function parseIsoNative(string){var date=new Date(string);return isNaN(date)?null:date}var locale,pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]})
;var formatIso=Date.prototype.toISOString?formatIsoNative:exports.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),parseIso=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:exports.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");exports.timeFormatDefaultLocale=defaultLocale,exports.timeFormatLocale=formatLocale,exports.isoFormat=formatIso,exports.isoParse=parseIso,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-time":40}],40:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function newInterval(floori,offseti,count,field){function interval(date){return floori(date=new Date(+date)),date}return interval.floor=interval,interval.ceil=function(date){return floori(date=new Date(date-1)),offseti(date,1),floori(date),date},interval.round=function(date){var d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1},interval.offset=function(date,step){return offseti(date=new Date(+date),null==step?1:Math.floor(step)),date},interval.range=function(start,stop,step){var previous,range=[];if(start=interval.ceil(start),step=null==step?1:Math.floor(step),!(start<stop&&step>0))return range;do{range.push(previous=new Date(+start)),offseti(start,step),floori(start)}while(previous<start&&start<stop);return range},interval.filter=function(test){return newInterval(function(date){if(date>=date)for(;floori(date),!test(date);)date.setTime(date-1)},function(date,step){if(date>=date)if(step<0)for(;++step<=0;)for(;offseti(date,-1),!test(date););else for(;--step>=0;)for(;offseti(date,1),!test(date););})},count&&(interval.count=function(start,end){return t0.setTime(+start),t1.setTime(+end),floori(t0),floori(t1),Math.floor(count(t0,t1))},interval.every=function(step){return step=Math.floor(step),isFinite(step)&&step>0?step>1?interval.filter(field?function(d){return field(d)%step==0}:function(d){return interval.count(0,d)%step==0}):interval:null}),interval}function weekday(i){return newInterval(function(date){date.setDate(date.getDate()-(date.getDay()+7-i)%7),date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+7*step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/durationWeek})}function utcWeekday(i){return newInterval(function(date){date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+7*step)},function(start,end){return(end-start)/durationWeek})}var t0=new Date,t1=new Date,millisecond=newInterval(function(){},function(date,step){date.setTime(+date+step)},function(start,end){return end-start});millisecond.every=function(k){return k=Math.floor(k),isFinite(k)&&k>0?k>1?newInterval(function(date){date.setTime(Math.floor(date/k)*k)},function(date,step){date.setTime(+date+step*k)},function(start,end){return(end-start)/k}):millisecond:null};var milliseconds=millisecond.range,durationMinute=6e4,durationWeek=6048e5,second=newInterval(function(date){date.setTime(1e3*Math.floor(date/1e3))},function(date,step){date.setTime(+date+1e3*step)},function(start,end){return(end-start)/1e3},function(date){return date.getUTCSeconds()}),seconds=second.range,minute=newInterval(function(date){date.setTime(Math.floor(date/durationMinute)*durationMinute)},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getMinutes()}),minutes=minute.range,hour=newInterval(function(date){var offset=date.getTimezoneOffset()*durationMinute%36e5;offset<0&&(offset+=36e5),date.setTime(36e5*Math.floor((+date-offset)/36e5)+offset)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getHours()}),hours=hour.range,day=newInterval(function(date){date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/864e5},function(date){return date.getDate()-1}),days=day.range,sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),sundays=sunday.range,mondays=monday.range,tuesdays=tuesday.range,wednesdays=wednesday.range,thursdays=thursday.range,fridays=friday.range,saturdays=saturday.range,month=newInterval(function(date){date.setDate(1),date.setHours(0,0,0,0)},function(date,step){date.setMonth(date.getMonth()+step)},function(start,end){return end.getMonth()-start.getMonth()+12*(end.getFullYear()-start.getFullYear())},function(date){return date.getMonth()}),months=month.range,year=newInterval(function(date){date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step)},function(start,end){return end.getFullYear()-start.getFullYear()},function(date){return date.getFullYear()});year.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setFullYear(Math.floor(date.getFullYear()/k)*k),date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step*k)}):null};var years=year.range,utcMinute=newInterval(function(date){date.setUTCSeconds(0,0)},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getUTCMinutes()}),utcMinutes=utcMinute.range,utcHour=newInterval(function(date){date.setUTCMinutes(0,0,0)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getUTCHours()}),utcHours=utcHour.range,utcDay=newInterval(function(date){date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step)},function(start,end){return(end-start)/864e5},function(date){return date.getUTCDate()-1}),utcDays=utcDay.range,utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,utcMonth=newInterval(function(date){date.setUTCDate(1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCMonth(date.getUTCMonth()+step)},function(start,end){return end.getUTCMonth()-start.getUTCMonth()+12*(end.getUTCFullYear()-start.getUTCFullYear())},function(date){return date.getUTCMonth()}),utcMonths=utcMonth.range,utcYear=newInterval(function(date){date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step)},function(start,end){return end.getUTCFullYear()-start.getUTCFullYear()},function(date){return date.getUTCFullYear()});utcYear.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k),date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step*k)}):null};var utcYears=utcYear.range;exports.timeInterval=newInterval,exports.timeMillisecond=millisecond,exports.timeMilliseconds=milliseconds,exports.utcMillisecond=millisecond,exports.utcMilliseconds=milliseconds,exports.timeSecond=second,exports.timeSeconds=seconds,exports.utcSecond=second,exports.utcSeconds=seconds,exports.timeMinute=minute,exports.timeMinutes=minutes,exports.timeHour=hour,exports.timeHours=hours,exports.timeDay=day,exports.timeDays=days,exports.timeWeek=sunday,exports.timeWeeks=sundays,exports.timeSunday=sunday,exports.timeSundays=sundays,exports.timeMonday=monday,exports.timeMondays=mondays,exports.timeTuesday=tuesday,exports.timeTuesdays=tuesdays,exports.timeWednesday=wednesday,exports.timeWednesdays=wednesdays,exports.timeThursday=thursday,exports.timeThursdays=thursdays,exports.timeFriday=friday,exports.timeFridays=fridays,exports.timeSaturday=saturday,exports.timeSaturdays=saturdays,exports.timeMonth=month,exports.timeMonths=months,exports.timeYear=year,exports.timeYears=years,exports.utcMinute=utcMinute,exports.utcMinutes=utcMinutes,exports.utcHour=utcHour,exports.utcHours=utcHours,exports.utcDay=utcDay,exports.utcDays=utcDays,exports.utcWeek=utcSunday,exports.utcWeeks=utcSundays,exports.utcSunday=utcSunday,exports.utcSundays=utcSundays,exports.utcMonday=utcMonday,exports.utcMondays=utcMondays,exports.utcTuesday=utcTuesday,exports.utcTuesdays=utcTuesdays,exports.utcWednesday=utcWednesday,exports.utcWednesdays=utcWednesdays,exports.utcThursday=utcThursday,exports.utcThursdays=utcThursdays,exports.utcFriday=utcFriday,exports.utcFridays=utcFridays,exports.utcSaturday=utcSaturday,exports.utcSaturdays=utcSaturdays,exports.utcMonth=utcMonth,exports.utcMonths=utcMonths,exports.utcYear=utcYear,exports.utcYears=utcYears,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],41:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function nap(){for(var t0,t2,t1=taskHead,time=1/0;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}function sleep(time){if(!frame){timeout&&(timeout=clearTimeout(timeout));time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}var taskHead,taskTail,frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var timeout$1=function(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(function(elapsed){t.stop(),callback(elapsed+delay)},delay,time),t},interval$1=function(callback,delay,time){var t=new Timer,total=delay;return null==delay?(t.restart(callback,delay,time),t):(delay=+delay,time=null==time?now():+time,t.restart(function tick(elapsed){elapsed+=total,t.restart(tick,total+=delay,time),callback(elapsed)},delay,time),t)};exports.now=now,exports.timer=timer,exports.timerFlush=timerFlush,exports.timeout=timeout$1,exports.interval=interval$1,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],42:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-selection"),require("d3-dispatch"),require("d3-timer"),require("d3-interpolate"),require("d3-color"),require("d3-ease")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-dispatch","d3-timer","d3-interpolate","d3-color","d3-ease"],factory):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Selection,d3Dispatch,d3Timer,d3Interpolate,d3Color,d3Ease){"use strict";function init(node,id){var schedule=get(node,id);if(schedule.state>CREATED)throw new Error("too late; already scheduled");return schedule}function set(node,id){var schedule=get(node,id);if(schedule.state>STARTING)throw new Error("too late; already started");return schedule}function get(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}function create(node,id,self){function schedule(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)}function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if(o=schedules[i],o.name===self.name){if(o.state===STARTED)return d3Timer.timeout(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),delete schedules[i])}if(d3Timer.timeout(function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))}),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(null,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){self.state=ENDED,self.timer.stop(),delete schedules[id];for(var i in schedules)return;delete node.__transition}var tween,schedules=node.__transition;schedules[id]=self,self.timer=d3Timer.timer(schedule,0,self.time)}function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=tween0=tween;for(var i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1=tween1.slice(),tween1.splice(i,1);break}}schedule.tween=tween1}}function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name:name,value:value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}}function tweenValue(transition,name,value){var id=transition._id;return transition.each(function(){var schedule=set(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)}),function(node){return get(node,id).value[name]}}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,interpolate$$1,value1){var value00,interpolate0;return function(){var value0=this.getAttribute(name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$1(value00=value0,value1)}}function attrConstantNS(fullname,interpolate$$1,value1){var value00,interpolate0;return function(){var value0=this.getAttributeNS(fullname.space,fullname.local);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$1(value00=value0,value1)}}function attrFunction(name,interpolate$$1,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);return null==value1?void this.removeAttribute(name):(value0=this.getAttribute(name),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1))}}function attrFunctionNS(fullname,interpolate$$1,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);return null==value1?void this.removeAttributeNS(fullname.space,fullname.local):(value0=this.getAttributeNS(fullname.space,fullname.local),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1))}}function attrTweenNS(fullname,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttributeNS(fullname.space,fullname.local,i(t))}}return tween._value=value,tween}function attrTween(name,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttribute(name,i(t))}}return tween._value=value,tween}function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}}function durationFunction(id,value){return function(){set(this,id).duration=+value.apply(this,arguments)}}function durationConstant(id,value){return value=+value,function(){set(this,id).duration=value}}function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){set(this,id).ease=value}}function start(name){return(name+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t})}function onFunction(id,name,listener){var on0,on1,sit=start(name)?init:set;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}function styleRemove(name,interpolate$$1){var value00,value10,interpolate0;return function(){var value0=d3Selection.style(this,name),value1=(this.style.removeProperty(name),d3Selection.style(this,name));return value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1)}}function styleRemoveEnd(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,interpolate$$1,value1){var value00,interpolate0;return function(){var value0=d3Selection.style(this,name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate$$1(value00=value0,value1)}}function styleFunction(name,interpolate$$1,value){var value00,value10,interpolate0;return function(){var value0=d3Selection.style(this,name),value1=value(this);return null==value1&&(this.style.removeProperty(name),value1=d3Selection.style(this,name)),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate$$1(value00=value0,value10=value1)}}function styleTween(name,value,priority){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.style.setProperty(name,i(t),priority)}}return tween._value=value,tween}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function transition(name){return d3Selection.selection().transition(name)}function newId(){return++id}function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))return defaultTiming.time=d3Timer.now(),defaultTiming;return timing}var emptyOn=d3Dispatch.dispatch("start","end","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6,schedule=function(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};create(node,id,{name:name,index:index,group:group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})},interrupt=function(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){name=null==name?null:name+"";for(i in schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),active&&schedule.on.call("interrupt",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}},selection_interrupt=function(name){return this.each(function(){interrupt(this,name)})},transition_tween=function(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=get(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?tweenRemove:tweenFunction)(id,name,value))},interpolate=function(a,b){var c;return("number"==typeof b?d3Interpolate.interpolateNumber:b instanceof d3Color.color?d3Interpolate.interpolateRgb:(c=d3Color.color(b))?(b=c,d3Interpolate.interpolateRgb):d3Interpolate.interpolateString)(a,b)},transition_attr=function(name,value){var fullname=d3Selection.namespace(name),i="transform"===fullname?d3Interpolate.interpolateTransformSvg:interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?attrFunctionNS:attrFunction)(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?attrRemoveNS:attrRemove)(fullname):(fullname.local?attrConstantNS:attrConstant)(fullname,i,value+""))},transition_attrTween=function(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=d3Selection.namespace(name);return this.tween(key,(fullname.local?attrTweenNS:attrTween)(fullname,value))},transition_delay=function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?delayFunction:delayConstant)(id,value)):get(this.node(),id).delay},transition_duration=function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?durationFunction:durationConstant)(id,value)):get(this.node(),id).duration},transition_ease=function(value){var id=this._id;return arguments.length?this.each(easeConstant(id,value)):get(this.node(),id).ease},transition_filter=function(match){"function"!=typeof match&&(match=d3Selection.matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},transition_merge=function(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},transition_on=function(name,listener){var id=this._id;return arguments.length<2?get(this.node(),id).on.on(name):this.each(onFunction(id,name,listener))},transition_remove=function(){return this.on("end.remove",removeFunction(this._id))},transition_select=function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=d3Selection.selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,get(node,id)));return new Transition(subgroups,this._parents,name,id)},transition_selectAll=function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=d3Selection.selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=get(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},Selection=d3Selection.selection.prototype.constructor,transition_selection=function(){return new Selection(this._groups,this._parents)},transition_style=function(name,value,priority){var i="transform"==(name+="")?d3Interpolate.interpolateTransformCss:interpolate;return null==value?this.styleTween(name,styleRemove(name,i)).on("end.style."+name,styleRemoveEnd(name)):this.styleTween(name,"function"==typeof value?styleFunction(name,i,tweenValue(this,"style."+name,value)):styleConstant(name,i,value+""),priority)},transition_styleTween=function(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,styleTween(name,value,null==priority?"":priority))},transition_text=function(value){return this.tween("text","function"==typeof value?textFunction(tweenValue(this,"text",value)):textConstant(null==value?"":value+""))},transition_transition=function(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=get(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},id=0,selection_prototype=d3Selection.selection.prototype;Transition.prototype=transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease};var defaultTiming={time:null,delay:0,duration:250,ease:d3Ease.easeCubicInOut},selection_transition=function(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=d3Timer.now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};d3Selection.selection.prototype.interrupt=selection_interrupt,d3Selection.selection.prototype.transition=selection_transition;var root=[null],active=function(node,name){var schedule,i,schedules=node.__transition;if(schedules){name=null==name?null:name+"";for(i in schedules)if((schedule=schedules[i]).state>SCHEDULED&&schedule.name===name)return new Transition([[node]],root,name,+i)}return null};exports.transition=transition,exports.active=active,exports.interrupt=interrupt,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-color":19,"d3-dispatch":20,"d3-ease":23,"d3-interpolate":28,"d3-selection":36,"d3-timer":41}],43:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function x(d){return d[0]}function y(d){return d[1]}function RedBlackTree(){this._=null}function RedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}function RedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.R=q.L,p.R&&(p.R.U=p),q.L=p}function RedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.L=q.R,p.L&&(p.L.U=p),q.R=p}function RedBlackFirst(node){for(;node.L;)node=node.L;return node}function createEdge(left,right,v0,v1){var edge=[null,null],index=edges.push(edge)-1;return edge.left=left,edge.right=right,v0&&setEdgeEnd(edge,left,right,v0),v1&&setEdgeEnd(edge,right,left,v1),cells[left.index].halfedges.push(index),cells[right.index].halfedges.push(index),edge}function createBorderEdge(left,v0,v1){var edge=[v0,v1];return edge.left=left,edge}function setEdgeEnd(edge,left,right,vertex){edge[0]||edge[1]?edge.left===right?edge[1]=vertex:edge[0]=vertex:(edge[0]=vertex,edge.left=left,edge.right=right)}function clipEdge(edge,x0,y0,x1,y1){var r,a=edge[0],b=edge[1],ax=a[0],ay=a[1],bx=b[0],by=b[1],t0=0,t1=1,dx=bx-ax,dy=by-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return!(t0>0||t1<1)||(t0>0&&(edge[0]=[ax+t0*dx,ay+t0*dy]),t1<1&&(edge[1]=[ax+t1*dx,ay+t1*dy]),!0)}}}}}function connectEdge(edge,x0,y0,x1,y1){var v1=edge[1];if(v1)return!0;var fm,fb,v0=edge[0],left=edge.left,right=edge.right,lx=left[0],ly=left[1],rx=right[0],ry=right[1],fx=(lx+rx)/2,fy=(ly+ry)/2;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[fx,y0];v1=[fx,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[fx,y1];v1=[fx,y0]}}else if(fm=(lx-rx)/(ry-ly),fb=fy-fm*fx,fm<-1||fm>1)if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[(y0-fb)/fm,y0];v1=[(y1-fb)/fm,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[(y1-fb)/fm,y1];v1=[(y0-fb)/fm,y0]}else if(ly<ry){if(v0){if(v0[0]>=x1)return}else v0=[x0,fm*x0+fb];v1=[x1,fm*x1+fb]}else{if(v0){if(v0[0]<x0)return}else v0=[x1,fm*x1+fb];v1=[x0,fm*x0+fb]}return edge[0]=v0,edge[1]=v1,!0}function clipEdges(x0,y0,x1,y1){for(var edge,i=edges.length;i--;)connectEdge(edge=edges[i],x0,y0,x1,y1)&&clipEdge(edge,x0,y0,x1,y1)&&(Math.abs(edge[0][0]-edge[1][0])>epsilon||Math.abs(edge[0][1]-edge[1][1])>epsilon)||delete edges[i]}function createCell(site){return cells[site.index]={site:site,halfedges:[]}}function cellHalfedgeAngle(cell,edge){var site=cell.site,va=edge.left,vb=edge.right;return site===vb&&(vb=va,va=site),vb?Math.atan2(vb[1]-va[1],vb[0]-va[0]):(site===va?(va=edge[1],vb=edge[0]):(va=edge[0],vb=edge[1]),Math.atan2(va[0]-vb[0],vb[1]-va[1]))}function cellHalfedgeStart(cell,edge){return edge[+(edge.left!==cell.site)]}function cellHalfedgeEnd(cell,edge){return edge[+(edge.left===cell.site)]}function sortCellHalfedges(){for(var cell,halfedges,j,m,i=0,n=cells.length;i<n;++i)if((cell=cells[i])&&(m=(halfedges=cell.halfedges).length)){var index=new Array(m),array=new Array(m);for(j=0;j<m;++j)index[j]=j,array[j]=cellHalfedgeAngle(cell,edges[halfedges[j]]);for(index.sort(function(i,j){return array[j]-array[i]}),
j=0;j<m;++j)array[j]=halfedges[index[j]];for(j=0;j<m;++j)halfedges[j]=array[j]}}function clipCells(x0,y0,x1,y1){var iCell,cell,site,iHalfedge,halfedges,nHalfedges,start,startX,startY,end,endX,endY,nCells=cells.length,cover=!0;for(iCell=0;iCell<nCells;++iCell)if(cell=cells[iCell]){for(site=cell.site,halfedges=cell.halfedges,iHalfedge=halfedges.length;iHalfedge--;)edges[halfedges[iHalfedge]]||halfedges.splice(iHalfedge,1);for(iHalfedge=0,nHalfedges=halfedges.length;iHalfedge<nHalfedges;)end=cellHalfedgeEnd(cell,edges[halfedges[iHalfedge]]),endX=end[0],endY=end[1],start=cellHalfedgeStart(cell,edges[halfedges[++iHalfedge%nHalfedges]]),startX=start[0],startY=start[1],(Math.abs(endX-startX)>epsilon||Math.abs(endY-startY)>epsilon)&&(halfedges.splice(iHalfedge,0,edges.push(createBorderEdge(site,end,Math.abs(endX-x0)<epsilon&&y1-endY>epsilon?[x0,Math.abs(startX-x0)<epsilon?startY:y1]:Math.abs(endY-y1)<epsilon&&x1-endX>epsilon?[Math.abs(startY-y1)<epsilon?startX:x1,y1]:Math.abs(endX-x1)<epsilon&&endY-y0>epsilon?[x1,Math.abs(startX-x1)<epsilon?startY:y0]:Math.abs(endY-y0)<epsilon&&endX-x0>epsilon?[Math.abs(startY-y0)<epsilon?startX:x0,y0]:null))-1),++nHalfedges);nHalfedges&&(cover=!1)}if(cover){var dx,dy,d2,dc=1/0;for(iCell=0,cover=null;iCell<nCells;++iCell)(cell=cells[iCell])&&(site=cell.site,dx=site[0]-x0,dy=site[1]-y0,(d2=dx*dx+dy*dy)<dc&&(dc=d2,cover=cell));if(cover){var v00=[x0,y0],v01=[x0,y1],v11=[x1,y1],v10=[x1,y0];cover.halfedges.push(edges.push(createBorderEdge(site=cover.site,v00,v01))-1,edges.push(createBorderEdge(site,v01,v11))-1,edges.push(createBorderEdge(site,v11,v10))-1,edges.push(createBorderEdge(site,v10,v00))-1)}}for(iCell=0;iCell<nCells;++iCell)(cell=cells[iCell])&&(cell.halfedges.length||delete cells[iCell])}function Circle(){RedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function attachCircle(arc){var lArc=arc.P,rArc=arc.N;if(lArc&&rArc){var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite!==rSite){var bx=cSite[0],by=cSite[1],ax=lSite[0]-bx,ay=lSite[1]-by,cx=rSite[0]-bx,cy=rSite[1]-by,d=2*(ax*cy-ay*cx);if(!(d>=-epsilon2)){var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,circle=circlePool.pop()||new Circle;circle.arc=arc,circle.site=cSite,circle.x=x+bx,circle.y=(circle.cy=y+by)+Math.sqrt(x*x+y*y),arc.circle=circle;for(var before=null,node=circles._;node;)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(!node.L){before=node.P;break}node=node.L}else{if(!node.R){before=node;break}node=node.R}circles.insert(before,circle),before||(firstCircle=circle)}}}}function detachCircle(arc){var circle=arc.circle;circle&&(circle.P||(firstCircle=circle.N),circles.remove(circle),circlePool.push(circle),RedBlackNode(circle),arc.circle=null)}function Beach(){RedBlackNode(this),this.edge=this.site=this.circle=null}function createBeach(site){var beach=beachPool.pop()||new Beach;return beach.site=site,beach}function detachBeach(beach){detachCircle(beach),beaches.remove(beach),beachPool.push(beach),RedBlackNode(beach)}function removeBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex=[x,y],previous=beach.P,next=beach.N,disappearing=[beach];detachBeach(beach);for(var lArc=previous;lArc.circle&&Math.abs(x-lArc.circle.x)<epsilon&&Math.abs(y-lArc.circle.cy)<epsilon;)previous=lArc.P,disappearing.unshift(lArc),detachBeach(lArc),lArc=previous;disappearing.unshift(lArc),detachCircle(lArc);for(var rArc=next;rArc.circle&&Math.abs(x-rArc.circle.x)<epsilon&&Math.abs(y-rArc.circle.cy)<epsilon;)next=rArc.N,disappearing.push(rArc),detachBeach(rArc),rArc=next;disappearing.push(rArc),detachCircle(rArc);var iArc,nArcs=disappearing.length;for(iArc=1;iArc<nArcs;++iArc)rArc=disappearing[iArc],lArc=disappearing[iArc-1],setEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex);lArc=disappearing[0],rArc=disappearing[nArcs-1],rArc.edge=createEdge(lArc.site,rArc.site,null,vertex),attachCircle(lArc),attachCircle(rArc)}function addBeach(site){for(var lArc,rArc,dxl,dxr,x=site[0],directrix=site[1],node=beaches._;node;)if((dxl=leftBreakPoint(node,directrix)-x)>epsilon)node=node.L;else{if(!((dxr=x-rightBreakPoint(node,directrix))>epsilon)){dxl>-epsilon?(lArc=node.P,rArc=node):dxr>-epsilon?(lArc=node,rArc=node.N):lArc=rArc=node;break}if(!node.R){lArc=node;break}node=node.R}createCell(site);var newArc=createBeach(site);if(beaches.insert(lArc,newArc),lArc||rArc){if(lArc===rArc)return detachCircle(lArc),rArc=createBeach(lArc.site),beaches.insert(newArc,rArc),newArc.edge=rArc.edge=createEdge(lArc.site,newArc.site),attachCircle(lArc),void attachCircle(rArc);if(!rArc)return void(newArc.edge=createEdge(lArc.site,newArc.site));detachCircle(lArc),detachCircle(rArc);var lSite=lArc.site,ax=lSite[0],ay=lSite[1],bx=site[0]-ax,by=site[1]-ay,rSite=rArc.site,cx=rSite[0]-ax,cy=rSite[1]-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex=[(cy*hb-by*hc)/d+ax,(bx*hc-cx*hb)/d+ay];setEdgeEnd(rArc.edge,lSite,rSite,vertex),newArc.edge=createEdge(lSite,site,null,vertex),rArc.edge=createEdge(site,rSite,null,vertex),attachCircle(lArc),attachCircle(rArc)}}function leftBreakPoint(arc,directrix){var site=arc.site,rfocx=site[0],rfocy=site[1],pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-1/0;site=lArc.site;var lfocx=site[0],lfocy=site[1],plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;return aby2?(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx:(rfocx+lfocx)/2}function rightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return leftBreakPoint(rArc,directrix);var site=arc.site;return site[1]===directrix?site[0]:1/0}function triangleArea(a,b,c){return(a[0]-c[0])*(b[1]-a[1])-(a[0]-b[0])*(c[1]-a[1])}function lexicographic(a,b){return b[1]-a[1]||b[0]-a[0]}function Diagram(sites,extent){var x,y,circle,site=sites.sort(lexicographic).pop();for(edges=[],cells=new Array(sites.length),beaches=new RedBlackTree,circles=new RedBlackTree;;)if(circle=firstCircle,site&&(!circle||site[1]<circle.y||site[1]===circle.y&&site[0]<circle.x))site[0]===x&&site[1]===y||(addBeach(site),x=site[0],y=site[1]),site=sites.pop();else{if(!circle)break;removeBeach(circle.arc)}if(sortCellHalfedges(),extent){var x0=+extent[0][0],y0=+extent[0][1],x1=+extent[1][0],y1=+extent[1][1];clipEdges(x0,y0,x1,y1),clipCells(x0,y0,x1,y1)}this.edges=edges,this.cells=cells,beaches=circles=edges=cells=null}var constant=function(x){return function(){return x}};RedBlackTree.prototype={constructor:RedBlackTree,insert:function(after,node){var parent,grandpa,uncle;if(after){if(node.P=after,node.N=after.N,after.N&&(after.N.P=node),after.N=node,after.R){for(after=after.R;after.L;)after=after.L;after.L=node}else after.R=node;parent=after}else this._?(after=RedBlackFirst(this._),node.P=null,node.N=after,after.P=after.L=node,parent=after):(node.P=node.N=null,this._=node,parent=null);for(node.L=node.R=null,node.U=parent,node.C=!0,after=node;parent&&parent.C;)grandpa=parent.U,parent===grandpa.L?(uncle=grandpa.R,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.R&&(RedBlackRotateLeft(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,RedBlackRotateRight(this,grandpa))):(uncle=grandpa.L,uncle&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.L&&(RedBlackRotateRight(this,parent),after=parent,parent=after.U),parent.C=!1,grandpa.C=!0,RedBlackRotateLeft(this,grandpa))),parent=after.U;this._.C=!1},remove:function(node){node.N&&(node.N.P=node.P),node.P&&(node.P.N=node.N),node.N=node.P=null;var sibling,next,red,parent=node.U,left=node.L,right=node.R;if(next=left?right?RedBlackFirst(right):left:right,parent?parent.L===node?parent.L=next:parent.R=next:this._=next,left&&right?(red=next.C,next.C=node.C,next.L=left,left.U=next,next!==right?(parent=next.U,next.U=node.U,node=next.R,parent.L=node,next.R=right,right.U=next):(next.U=parent,parent=next,node=next.R)):(red=node.C,node=next),node&&(node.U=parent),!red){if(node&&node.C)return void(node.C=!1);do{if(node===this._)break;if(node===parent.L){if(sibling=parent.R,sibling.C&&(sibling.C=!1,parent.C=!0,RedBlackRotateLeft(this,parent),sibling=parent.R),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.R&&sibling.R.C||(sibling.L.C=!1,sibling.C=!0,RedBlackRotateRight(this,sibling),sibling=parent.R),sibling.C=parent.C,parent.C=sibling.R.C=!1,RedBlackRotateLeft(this,parent),node=this._;break}}else if(sibling=parent.L,sibling.C&&(sibling.C=!1,parent.C=!0,RedBlackRotateRight(this,parent),sibling=parent.L),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.L&&sibling.L.C||(sibling.R.C=!1,sibling.C=!0,RedBlackRotateLeft(this,sibling),sibling=parent.L),sibling.C=parent.C,parent.C=sibling.L.C=!1,RedBlackRotateRight(this,parent),node=this._;break}sibling.C=!0,node=parent,parent=parent.U}while(!node.C);node&&(node.C=!1)}}};var firstCircle,beaches,cells,circles,edges,circlePool=[],beachPool=[],epsilon=1e-6,epsilon2=1e-12;Diagram.prototype={constructor:Diagram,polygons:function(){var edges=this.edges;return this.cells.map(function(cell){var polygon=cell.halfedges.map(function(i){return cellHalfedgeStart(cell,edges[i])});return polygon.data=cell.site.data,polygon})},triangles:function(){var triangles=[],edges=this.edges;return this.cells.forEach(function(cell,i){if(m=(halfedges=cell.halfedges).length)for(var halfedges,m,s0,site=cell.site,j=-1,e1=edges[halfedges[m-1]],s1=e1.left===site?e1.right:e1.left;++j<m;)s0=s1,e1=edges[halfedges[j]],s1=e1.left===site?e1.right:e1.left,s0&&s1&&i<s0.index&&i<s1.index&&triangleArea(site,s0,s1)<0&&triangles.push([site.data,s0.data,s1.data])}),triangles},links:function(){return this.edges.filter(function(edge){return edge.right}).map(function(edge){return{source:edge.left.data,target:edge.right.data}})},find:function(x,y,radius){for(var i0,cell,that=this,i1=that._found||0,n=that.cells.length;!(cell=that.cells[i1]);)if(++i1>=n)return null;var dx=x-cell.site[0],dy=y-cell.site[1],d2=dx*dx+dy*dy;do{cell=that.cells[i0=i1],i1=null,cell.halfedges.forEach(function(e){var edge=that.edges[e],v=edge.left;if(v!==cell.site&&v||(v=edge.right)){var vx=x-v[0],vy=y-v[1],v2=vx*vx+vy*vy;v2<d2&&(d2=v2,i1=v.index)}})}while(null!==i1);return that._found=i0,null==radius||d2<=radius*radius?cell.site:null}};var voronoi=function(){function voronoi(data){return new Diagram(data.map(function(d,i){var s=[Math.round(x$$1(d,i,data)/epsilon)*epsilon,Math.round(y$$1(d,i,data)/epsilon)*epsilon];return s.index=i,s.data=d,s}),extent)}var x$$1=x,y$$1=y,extent=null;return voronoi.polygons=function(data){return voronoi(data).polygons()},voronoi.links=function(data){return voronoi(data).links()},voronoi.triangles=function(data){return voronoi(data).triangles()},voronoi.x=function(_){return arguments.length?(x$$1="function"==typeof _?_:constant(+_),voronoi):x$$1},voronoi.y=function(_){return arguments.length?(y$$1="function"==typeof _?_:constant(+_),voronoi):y$$1},voronoi.extent=function(_){return arguments.length?(extent=null==_?null:[[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]],voronoi):extent&&[[extent[0][0],extent[0][1]],[extent[1][0],extent[1][1]]]},voronoi.size=function(_){return arguments.length?(extent=null==_?null:[[0,0],[+_[0],+_[1]]],voronoi):extent&&[extent[1][0]-extent[0][0],extent[1][1]-extent[0][1]]},voronoi};exports.voronoi=voronoi,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],44:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports,require("d3-dispatch"),require("d3-drag"),require("d3-interpolate"),require("d3-selection"),require("d3-transition")):"function"==typeof define&&define.amd?define(["exports","d3-dispatch","d3-drag","d3-interpolate","d3-selection","d3-transition"],factory):factory(global.d3=global.d3||{},global.d3,global.d3,global.d3,global.d3,global.d3)}(this,function(exports,d3Dispatch,d3Drag,d3Interpolate,d3Selection,d3Transition){"use strict";function ZoomEvent(target,type,transform){this.target=target,this.type=type,this.transform=transform}function Transform(k,x,y){this.k=k,this.x=x,this.y=y}function transform(node){return node.__zoom||identity}function nopropagation(){d3Selection.event.stopImmediatePropagation()}function defaultFilter(){return!d3Selection.event.button}function defaultExtent(){var w,h,e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,w=e.width.baseVal.value,h=e.height.baseVal.value):(w=e.clientWidth,h=e.clientHeight),[[0,0],[w,h]]}function defaultTransform(){return this.__zoom||identity}function defaultWheelDelta(){return-d3Selection.event.deltaY*(d3Selection.event.deltaMode?120:1)/500}function defaultTouchable(){return"ontouchstart"in this}function defaultConstrain(transform$$1,extent,translateExtent){var dx0=transform$$1.invertX(extent[0][0])-translateExtent[0][0],dx1=transform$$1.invertX(extent[1][0])-translateExtent[1][0],dy0=transform$$1.invertY(extent[0][1])-translateExtent[0][1],dy1=transform$$1.invertY(extent[1][1])-translateExtent[1][1];return transform$$1.translate(dx1>dx0?(dx0+dx1)/2:Math.min(0,dx0)||Math.max(0,dx1),dy1>dy0?(dy0+dy1)/2:Math.min(0,dy0)||Math.max(0,dy1))}var constant=function(x){return function(){return x}};Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity=new Transform(1,0,0);transform.prototype=Transform.prototype;var noevent=function(){d3Selection.event.preventDefault(),d3Selection.event.stopImmediatePropagation()},zoom=function(){function zoom(selection){selection.property("__zoom",defaultTransform).on("wheel.zoom",wheeled).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).filter(touchable).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function scale(transform$$1,k){return k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],k)),k===transform$$1.k?transform$$1:new Transform(k,transform$$1.x,transform$$1.y)}function translate(transform$$1,p0,p1){var x=p0[0]-p1[0]*transform$$1.k,y=p0[1]-p1[1]*transform$$1.k;return x===transform$$1.x&&y===transform$$1.y?transform$$1:new Transform(transform$$1.k,x,y)}function centroid(extent){return[(+extent[0][0]+ +extent[1][0])/2,(+extent[0][1]+ +extent[1][1])/2]}function schedule(transition,transform$$1,center){transition.on("start.zoom",function(){gesture(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){gesture(this,arguments).end()}).tween("zoom",function(){var that=this,args=arguments,g=gesture(that,args),e=extent.apply(that,args),p=center||centroid(e),w=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),a=that.__zoom,b="function"==typeof transform$$1?transform$$1.apply(that,args):transform$$1,i=interpolate(a.invert(p).concat(w/a.k),b.invert(p).concat(w/b.k));return function(t){if(1===t)t=b;else{var l=i(t),k=w/l[2];t=new Transform(k,p[0]-l[0]*k,p[1]-l[1]*k)}g.zoom(null,t)}})}function gesture(that,args){for(var g,i=0,n=gestures.length;i<n;++i)if((g=gestures[i]).that===that)return g;return new Gesture(that,args)}function Gesture(that,args){this.that=that,this.args=args,this.index=-1,this.active=0,this.extent=extent.apply(that,args)}function wheeled(){function wheelidled(){g.wheel=null,g.end()}if(filter.apply(this,arguments)){var g=gesture(this,arguments),t=this.__zoom,k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],t.k*Math.pow(2,wheelDelta.apply(this,arguments)))),p=d3Selection.mouse(this);if(g.wheel)g.mouse[0][0]===p[0]&&g.mouse[0][1]===p[1]||(g.mouse[1]=t.invert(g.mouse[0]=p)),clearTimeout(g.wheel);else{if(t.k===k)return;g.mouse=[p,t.invert(p)],d3Transition.interrupt(this),g.start()}noevent(),g.wheel=setTimeout(wheelidled,wheelDelay),g.zoom("mouse",constrain(translate(scale(t,k),g.mouse[0],g.mouse[1]),g.extent,translateExtent))}}function mousedowned(){function mousemoved(){if(noevent(),!g.moved){var dx=d3Selection.event.clientX-x0,dy=d3Selection.event.clientY-y0;g.moved=dx*dx+dy*dy>clickDistance2}g.zoom("mouse",constrain(translate(g.that.__zoom,g.mouse[0]=d3Selection.mouse(g.that),g.mouse[1]),g.extent,translateExtent))}function mouseupped(){v.on("mousemove.zoom mouseup.zoom",null),d3Drag.dragEnable(d3Selection.event.view,g.moved),noevent(),g.end()}if(!touchending&&filter.apply(this,arguments)){var g=gesture(this,arguments),v=d3Selection.select(d3Selection.event.view).on("mousemove.zoom",mousemoved,!0).on("mouseup.zoom",mouseupped,!0),p=d3Selection.mouse(this),x0=d3Selection.event.clientX,y0=d3Selection.event.clientY;d3Drag.dragDisable(d3Selection.event.view),nopropagation(),g.mouse=[p,this.__zoom.invert(p)],d3Transition.interrupt(this),g.start()}}function dblclicked(){if(filter.apply(this,arguments)){var t0=this.__zoom,p0=d3Selection.mouse(this),p1=t0.invert(p0),k1=t0.k*(d3Selection.event.shiftKey?.5:2),t1=constrain(translate(scale(t0,k1),p0,p1),extent.apply(this,arguments),translateExtent);noevent(),duration>0?d3Selection.select(this).transition().duration(duration).call(schedule,t1,p0):d3Selection.select(this).call(zoom.transform,t1)}}function touchstarted(){if(filter.apply(this,arguments)){var started,i,t,p,g=gesture(this,arguments),touches=d3Selection.event.changedTouches,n=touches.length;for(nopropagation(),i=0;i<n;++i)t=touches[i],p=d3Selection.touch(this,touches,t.identifier),p=[p,this.__zoom.invert(p),t.identifier],g.touch0?g.touch1||(g.touch1=p):(g.touch0=p,started=!0);if(touchstarting&&(touchstarting=clearTimeout(touchstarting),!g.touch1))return g.end(),void((p=d3Selection.select(this).on("dblclick.zoom"))&&p.apply(this,arguments));started&&(touchstarting=setTimeout(function(){touchstarting=null},touchDelay),d3Transition.interrupt(this),g.start())}}function touchmoved(){var i,t,p,l,g=gesture(this,arguments),touches=d3Selection.event.changedTouches,n=touches.length;for(noevent(),touchstarting&&(touchstarting=clearTimeout(touchstarting)),i=0;i<n;++i)t=touches[i],p=d3Selection.touch(this,touches,t.identifier),g.touch0&&g.touch0[2]===t.identifier?g.touch0[0]=p:g.touch1&&g.touch1[2]===t.identifier&&(g.touch1[0]=p);if(t=g.that.__zoom,g.touch1){var p0=g.touch0[0],l0=g.touch0[1],p1=g.touch1[0],l1=g.touch1[1],dp=(dp=p1[0]-p0[0])*dp+(dp=p1[1]-p0[1])*dp,dl=(dl=l1[0]-l0[0])*dl+(dl=l1[1]-l0[1])*dl;t=scale(t,Math.sqrt(dp/dl)),p=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2]}else{if(!g.touch0)return;p=g.touch0[0],l=g.touch0[1]}g.zoom("touch",constrain(translate(t,p,l),g.extent,translateExtent))}function touchended(){var i,t,g=gesture(this,arguments),touches=d3Selection.event.changedTouches,n=touches.length;for(nopropagation(),touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},touchDelay),i=0;i<n;++i)t=touches[i],g.touch0&&g.touch0[2]===t.identifier?delete g.touch0:g.touch1&&g.touch1[2]===t.identifier&&delete g.touch1;g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0?g.touch0[1]=this.__zoom.invert(g.touch0[0]):g.end()}var touchstarting,touchending,filter=defaultFilter,extent=defaultExtent,constrain=defaultConstrain,wheelDelta=defaultWheelDelta,touchable=defaultTouchable,scaleExtent=[0,1/0],translateExtent=[[-1/0,-1/0],[1/0,1/0]],duration=250,interpolate=d3Interpolate.interpolateZoom,gestures=[],listeners=d3Dispatch.dispatch("start","zoom","end"),touchDelay=500,wheelDelay=150,clickDistance2=0;return zoom.transform=function(collection,transform$$1){var selection=collection.selection?collection.selection():collection;selection.property("__zoom",defaultTransform),collection!==selection?schedule(collection,transform$$1):selection.interrupt().each(function(){gesture(this,arguments).start().zoom(null,"function"==typeof transform$$1?transform$$1.apply(this,arguments):transform$$1).end()})},zoom.scaleBy=function(selection,k){zoom.scaleTo(selection,function(){return this.__zoom.k*("function"==typeof k?k.apply(this,arguments):k)})},zoom.scaleTo=function(selection,k){zoom.transform(selection,function(){var e=extent.apply(this,arguments),t0=this.__zoom,p0=centroid(e),p1=t0.invert(p0),k1="function"==typeof k?k.apply(this,arguments):k;return constrain(translate(scale(t0,k1),p0,p1),e,translateExtent)})},zoom.translateBy=function(selection,x,y){zoom.transform(selection,function(){return constrain(this.__zoom.translate("function"==typeof x?x.apply(this,arguments):x,"function"==typeof y?y.apply(this,arguments):y),extent.apply(this,arguments),translateExtent)})},zoom.translateTo=function(selection,x,y){zoom.transform(selection,function(){var e=extent.apply(this,arguments),t=this.__zoom,p=centroid(e);return constrain(identity.translate(p[0],p[1]).scale(t.k).translate("function"==typeof x?-x.apply(this,arguments):-x,"function"==typeof y?-y.apply(this,arguments):-y),e,translateExtent)})},Gesture.prototype={start:function(){return 1==++this.active&&(this.index=gestures.push(this)-1,this.emit("start")),this},zoom:function(key,transform$$1){return this.mouse&&"mouse"!==key&&(this.mouse[1]=transform$$1.invert(this.mouse[0])),this.touch0&&"touch"!==key&&(this.touch0[1]=transform$$1.invert(this.touch0[0])),this.touch1&&"touch"!==key&&(this.touch1[1]=transform$$1.invert(this.touch1[0])),this.that.__zoom=transform$$1,this.emit("zoom"),this},end:function(){return 0==--this.active&&(gestures.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(type){d3Selection.customEvent(new ZoomEvent(zoom,type,this.that.__zoom),listeners.apply,listeners,[type,this.that,this.args])}},zoom.wheelDelta=function(_){return arguments.length?(wheelDelta="function"==typeof _?_:constant(+_),zoom):wheelDelta},zoom.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant(!!_),zoom):filter},zoom.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:constant(!!_),zoom):touchable},zoom.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),zoom):extent},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent[0]=+_[0],scaleExtent[1]=+_[1],zoom):[scaleExtent[0],scaleExtent[1]]},zoom.translateExtent=function(_){return arguments.length?(translateExtent[0][0]=+_[0][0],translateExtent[1][0]=+_[1][0],translateExtent[0][1]=+_[0][1],translateExtent[1][1]=+_[1][1],zoom):[[translateExtent[0][0],translateExtent[0][1]],[translateExtent[1][0],translateExtent[1][1]]]},zoom.constrain=function(_){return arguments.length?(constrain=_,zoom):constrain},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.interpolate=function(_){return arguments.length?(interpolate=_,zoom):interpolate},zoom.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?zoom:value},zoom.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,zoom):Math.sqrt(clickDistance2)},zoom};exports.zoom=zoom,exports.zoomTransform=transform,exports.zoomIdentity=identity,Object.defineProperty(exports,"__esModule",{value:!0})})},{"d3-dispatch":20,"d3-drag":21,"d3-interpolate":28,"d3-selection":36,"d3-transition":42}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var d3Array=require("d3-array"),d3Axis=require("d3-axis"),d3Brush=require("d3-brush"),d3Chord=require("d3-chord"),d3Collection=require("d3-collection"),d3Color=require("d3-color"),d3Dispatch=require("d3-dispatch"),d3Drag=require("d3-drag"),d3Dsv=require("d3-dsv"),d3Ease=require("d3-ease"),d3Force=require("d3-force"),d3Format=require("d3-format"),d3Geo=require("d3-geo"),d3Hierarchy=require("d3-hierarchy"),d3Interpolate=require("d3-interpolate"),d3Path=require("d3-path"),d3Polygon=require("d3-polygon"),d3Quadtree=require("d3-quadtree"),d3Queue=require("d3-queue"),d3Random=require("d3-random"),d3Request=require("d3-request"),d3Scale=require("d3-scale"),d3Selection=require("d3-selection"),d3Shape=require("d3-shape"),d3Time=require("d3-time"),d3TimeFormat=require("d3-time-format"),d3Timer=require("d3-timer"),d3Transition=require("d3-transition"),d3Voronoi=require("d3-voronoi"),d3Zoom=require("d3-zoom");exports.version="4.13.0",Object.keys(d3Array).forEach(function(key){exports[key]=d3Array[key]}),Object.keys(d3Axis).forEach(function(key){exports[key]=d3Axis[key]}),Object.keys(d3Brush).forEach(function(key){exports[key]=d3Brush[key]}),Object.keys(d3Chord).forEach(function(key){exports[key]=d3Chord[key]}),Object.keys(d3Collection).forEach(function(key){exports[key]=d3Collection[key]}),Object.keys(d3Color).forEach(function(key){exports[key]=d3Color[key]}),Object.keys(d3Dispatch).forEach(function(key){exports[key]=d3Dispatch[key]}),Object.keys(d3Drag).forEach(function(key){exports[key]=d3Drag[key]}),Object.keys(d3Dsv).forEach(function(key){exports[key]=d3Dsv[key]}),Object.keys(d3Ease).forEach(function(key){exports[key]=d3Ease[key]}),Object.keys(d3Force).forEach(function(key){exports[key]=d3Force[key]}),Object.keys(d3Format).forEach(function(key){exports[key]=d3Format[key]}),Object.keys(d3Geo).forEach(function(key){exports[key]=d3Geo[key]}),Object.keys(d3Hierarchy).forEach(function(key){exports[key]=d3Hierarchy[key]}),Object.keys(d3Interpolate).forEach(function(key){exports[key]=d3Interpolate[key]}),Object.keys(d3Path).forEach(function(key){exports[key]=d3Path[key]}),Object.keys(d3Polygon).forEach(function(key){exports[key]=d3Polygon[key]}),Object.keys(d3Quadtree).forEach(function(key){exports[key]=d3Quadtree[key]}),Object.keys(d3Queue).forEach(function(key){exports[key]=d3Queue[key]}),Object.keys(d3Random).forEach(function(key){exports[key]=d3Random[key]}),Object.keys(d3Request).forEach(function(key){exports[key]=d3Request[key]}),Object.keys(d3Scale).forEach(function(key){exports[key]=d3Scale[key]}),Object.keys(d3Selection).forEach(function(key){exports[key]=d3Selection[key]}),Object.keys(d3Shape).forEach(function(key){exports[key]=d3Shape[key]}),Object.keys(d3Time).forEach(function(key){exports[key]=d3Time[key]}),Object.keys(d3TimeFormat).forEach(function(key){exports[key]=d3TimeFormat[key]}),Object.keys(d3Timer).forEach(function(key){exports[key]=d3Timer[key]}),Object.keys(d3Transition).forEach(function(key){exports[key]=d3Transition[key]}),Object.keys(d3Voronoi).forEach(function(key){exports[key]=d3Voronoi[key]}),Object.keys(d3Zoom).forEach(function(key){exports[key]=d3Zoom[key]}),Object.defineProperty(exports,"event",{get:function(){return d3Selection.event}})},{"d3-array":14,"d3-axis":15,"d3-brush":16,"d3-chord":17,"d3-collection":18,"d3-color":19,"d3-dispatch":20,"d3-drag":21,"d3-dsv":22,"d3-ease":46,"d3-force":24,"d3-format":25,"d3-geo":26,"d3-hierarchy":27,"d3-interpolate":28,"d3-path":29,"d3-polygon":30,"d3-quadtree":31,"d3-queue":32,"d3-random":33,"d3-request":34,"d3-scale":35,"d3-selection":36,"d3-shape":37,"d3-time":40,"d3-time-format":39,"d3-timer":41,"d3-transition":42,"d3-voronoi":43,"d3-zoom":44}],46:[function(require,module,exports){!function(global,factory){"object"==typeof exports&&void 0!==module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.d3=global.d3||{})}(this,function(exports){"use strict";function linear(t){return+t}function quadIn(t){return t*t}function quadOut(t){return t*(2-t)}function quadInOut(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function cubicIn(t){return t*t*t}function cubicOut(t){return--t*t*t+1}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}function sinIn(t){return 1-Math.cos(t*halfPi)}function sinOut(t){return Math.sin(t*halfPi)}function sinInOut(t){return(1-Math.cos(pi*t))/2}function expIn(t){return Math.pow(2,10*t-10)}function expOut(t){return 1-Math.pow(2,-10*t)}function expInOut(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function circleIn(t){return 1-Math.sqrt(1-t*t)}function circleOut(t){return Math.sqrt(1- --t*t)}function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function bounceIn(t){return 1-bounceOut(1-t)}function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}function bounceInOut(t){return((t*=2)<=1?1-bounceOut(1-t):bounceOut(t-1)+1)/2}var polyIn=function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn}(3),polyOut=function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),polyInOut=function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3),pi=Math.PI,halfPi=pi/2,b1=4/11,b2=6/11,b3=8/11,b4=.75,b5=9/11,b6=10/11,b7=.9375,b8=21/22,b9=63/64,b0=1/b1/b1,backIn=function custom(s){function backIn(t){return t*t*((s+1)*t-s)}return s=+s,backIn.overshoot=custom,backIn}(1.70158),backOut=function custom(s){function backOut(t){return--t*t*((s+1)*t+s)+1}return s=+s,backOut.overshoot=custom,backOut}(1.70158),backInOut=function custom(s){function backInOut(t){return((t*=2)<1?t*t*((s+1)*t-s):(t-=2)*t*((s+1)*t+s)+2)/2}return s=+s,backInOut.overshoot=custom,backInOut}(1.70158),tau=2*Math.PI,elasticIn=function custom(a,p){function elasticIn(t){return a*Math.pow(2,10*--t)*Math.sin((s-t)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticIn.amplitude=function(a){return custom(a,p*tau)},elasticIn.period=function(p){return custom(a,p)},elasticIn}(1,.3),elasticOut=function custom(a,p){function elasticOut(t){return 1-a*Math.pow(2,-10*(t=+t))*Math.sin((t+s)/p)}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticOut.amplitude=function(a){return custom(a,p*tau)},elasticOut.period=function(p){return custom(a,p)},elasticOut}(1,.3),elasticInOut=function custom(a,p){function elasticInOut(t){return((t=2*t-1)<0?a*Math.pow(2,10*t)*Math.sin((s-t)/p):2-a*Math.pow(2,-10*t)*Math.sin((s+t)/p))/2}var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);return elasticInOut.amplitude=function(a){return custom(a,p*tau)},elasticInOut.period=function(p){return custom(a,p)},elasticInOut}(1,.3);exports.easeLinear=linear,exports.easeQuad=quadInOut,exports.easeQuadIn=quadIn,exports.easeQuadOut=quadOut,exports.easeQuadInOut=quadInOut,exports.easeCubic=cubicInOut,exports.easeCubicIn=cubicIn,exports.easeCubicOut=cubicOut,exports.easeCubicInOut=cubicInOut,exports.easePoly=polyInOut,exports.easePolyIn=polyIn,exports.easePolyOut=polyOut,exports.easePolyInOut=polyInOut,exports.easeSin=sinInOut,exports.easeSinIn=sinIn,exports.easeSinOut=sinOut,exports.easeSinInOut=sinInOut,exports.easeExp=expInOut,exports.easeExpIn=expIn,exports.easeExpOut=expOut,exports.easeExpInOut=expInOut,exports.easeCircle=circleInOut,exports.easeCircleIn=circleIn,exports.easeCircleOut=circleOut,exports.easeCircleInOut=circleInOut,exports.easeBounce=bounceOut,exports.easeBounceIn=bounceIn,exports.easeBounceOut=bounceOut,exports.easeBounceInOut=bounceInOut,exports.easeBack=backInOut,exports.easeBackIn=backIn,exports.easeBackOut=backOut,exports.easeBackInOut=backInOut,exports.easeElastic=elasticOut,exports.easeElasticIn=elasticIn,exports.easeElasticOut=elasticOut,exports.easeElasticInOut=elasticInOut,Object.defineProperty(exports,"__esModule",{value:!0})})},{}],47:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}
function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((er=arguments[1])instanceof Error)throw er;var err=new Error('Uncaught, unspecified "error" event. ('+er+")");throw err.context=er,err}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:args=Array.prototype.slice.call(arguments,1),handler.apply(this,args)}else if(isObject(handler))for(args=Array.prototype.slice.call(arguments,1),listeners=handler.slice(),len=listeners.length,i=0;i<len;i++)listeners[i].apply(this,args);return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned&&(m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else if(listeners)for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){return this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.prototype.listenerCount=function(type){if(this._events){var evlistener=this._events[type];if(isFunction(evlistener))return 1;if(evlistener)return evlistener.length}return 0},EventEmitter.listenerCount=function(emitter,type){return emitter.listenerCount(type)}},{}],48:[function(require,module,exports){"use strict";require("@firebase/polyfill");var firebase=function(ex){return ex&&"object"==typeof ex&&"default"in ex?ex.default:ex}(require("@firebase/app"));module.exports=firebase},{"@firebase/app":1,"@firebase/polyfill":4}],49:[function(require,module,exports){"use strict";require("@firebase/database")},{"@firebase/database":2}],50:[function(require,module,exports){function validateParams(params){if("string"==typeof params&&(params=url.parse(params)),params.protocol||(params.protocol="https:"),"https:"!==params.protocol)throw new Error('Protocol "'+params.protocol+'" not supported. Expected "https:"');return params}var http=require("http"),url=require("url"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);https.request=function(params,cb){return params=validateParams(params),http.request.call(this,params,cb)},https.get=function(params,cb){return params=validateParams(params),http.get.call(this,params,cb)}},{http:72,url:10}],51:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:1/0*(s?-1:1);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],52:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],53:[function(require,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)}},{}],54:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],55:[function(require,module,exports){!function(global,factory){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=global.document?factory(global,!0):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)}:factory(global)}("undefined"!=typeof window?window:this,function(window,noGlobal){"use strict";function DOMEval(code,doc){doc=doc||document;var script=doc.createElement("script");script.text=code,doc.head.appendChild(script).parentNode.removeChild(script)}function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);return"function"!==type&&!jQuery.isWindow(obj)&&("array"===type||0===length||"number"==typeof length&&length>0&&length-1 in obj)}function nodeName(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()}function winnow(elements,qualifier,not){return jQuery.isFunction(qualifier)?jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not}):qualifier.nodeType?jQuery.grep(elements,function(elem){return elem===qualifier!==not}):"string"!=typeof qualifier?jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not}):risSimple.test(qualifier)?jQuery.filter(qualifier,elements,not):(qualifier=jQuery.filter(qualifier,elements),jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not&&1===elem.nodeType}))}function sibling(cur,dir){for(;(cur=cur[dir])&&1!==cur.nodeType;);return cur}function createOptions(options){var object={};return jQuery.each(options.match(rnothtmlwhite)||[],function(_,flag){object[flag]=!0}),object}function Identity(v){return v}function Thrower(ex){throw ex}function adoptValue(value,resolve,reject,noValue){var method;try{value&&jQuery.isFunction(method=value.promise)?method.call(value).done(resolve).fail(reject):value&&jQuery.isFunction(method=value.then)?method.call(value,resolve,reject):resolve.apply(void 0,[value].slice(noValue))}catch(value){reject.apply(void 0,[value])}}function completed(){document.removeEventListener("DOMContentLoaded",completed),window.removeEventListener("load",completed),jQuery.ready()}function Data(){this.expando=jQuery.expando+Data.uid++}function getData(data){return"true"===data||"false"!==data&&("null"===data?null:data===+data+""?+data:rbrace.test(data)?JSON.parse(data):data)}function dataAttr(elem,key,data){var name;if(void 0===data&&1===elem.nodeType)if(name="data-"+key.replace(rmultiDash,"-$&").toLowerCase(),"string"==typeof(data=elem.getAttribute(name))){try{data=getData(data)}catch(e){}dataUser.set(elem,key,data)}else data=void 0;return data}function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||"px"!==unit&&+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3],valueParts=valueParts||[],initialInUnit=+initial||1;do{scale=scale||".5",initialInUnit/=scale,jQuery.style(elem,prop,initialInUnit+unit)}while(scale!==(scale=currentValue()/initial)&&1!==scale&&--maxIterations)}return valueParts&&(initialInUnit=+initialInUnit||+initial||0,adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2],tween&&(tween.unit=unit,tween.start=initialInUnit,tween.end=adjusted)),adjusted}function getDefaultDisplay(elem){var temp,doc=elem.ownerDocument,nodeName=elem.nodeName,display=defaultDisplayMap[nodeName];return display||(temp=doc.body.appendChild(doc.createElement(nodeName)),display=jQuery.css(temp,"display"),temp.parentNode.removeChild(temp),"none"===display&&(display="block"),defaultDisplayMap[nodeName]=display,display)}function showHide(elements,show){for(var display,elem,values=[],index=0,length=elements.length;index<length;index++)elem=elements[index],elem.style&&(display=elem.style.display,show?("none"===display&&(values[index]=dataPriv.get(elem,"display")||null,values[index]||(elem.style.display="")),""===elem.style.display&&isHiddenWithinTree(elem)&&(values[index]=getDefaultDisplay(elem))):"none"!==display&&(values[index]="none",dataPriv.set(elem,"display",display)));for(index=0;index<length;index++)null!=values[index]&&(elements[index].style.display=values[index]);return elements}function getAll(context,tag){var ret;return ret=void 0!==context.getElementsByTagName?context.getElementsByTagName(tag||"*"):void 0!==context.querySelectorAll?context.querySelectorAll(tag||"*"):[],void 0===tag||tag&&nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){for(var i=0,l=elems.length;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],"globalEval"))}function buildFragment(elems,context,scripts,selection,ignored){for(var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;i<l;i++)if((elem=elems[i])||0===elem)if("object"===jQuery.type(elem))jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(rhtml.test(elem)){for(tmp=tmp||fragment.appendChild(context.createElement("div")),tag=(rtagName.exec(elem)||["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2],j=wrap[0];j--;)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes),tmp=fragment.firstChild,tmp.textContent=""}else nodes.push(context.createTextNode(elem));for(fragment.textContent="",i=0;elem=nodes[i++];)if(selection&&jQuery.inArray(elem,selection)>-1)ignored&&ignored.push(elem);else if(contains=jQuery.contains(elem.ownerDocument,elem),tmp=getAll(fragment.appendChild(elem),"script"),contains&&setGlobalEval(tmp),scripts)for(j=0;elem=tmp[j++];)rscriptType.test(elem.type||"")&&scripts.push(elem);return fragment}function returnTrue(){return!0}function returnFalse(){return!1}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if("object"==typeof types){"string"!=typeof selector&&(data=data||selector,selector=void 0);for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(null==data&&null==fn?(fn=selector,data=selector=void 0):null==fn&&("string"==typeof selector?(fn=data,data=void 0):(fn=data,data=selector,selector=void 0)),!1===fn)fn=returnFalse;else if(!fn)return elem;return 1===one&&(origFn=fn,fn=function(event){return jQuery().off(event),origFn.apply(this,arguments)},fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)),elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}function manipulationTarget(elem,content){return nodeName(elem,"table")&&nodeName(11!==content.nodeType?content:content.firstChild,"tr")?jQuery(">tbody",elem)[0]||elem:elem}function disableScript(elem){return elem.type=(null!==elem.getAttribute("type"))+"/"+elem.type,elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);return match?elem.type=match[1]:elem.removeAttribute("type"),elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(1===dest.nodeType){if(dataPriv.hasData(src)&&(pdataOld=dataPriv.access(src),pdataCur=dataPriv.set(dest,pdataOld),events=pdataOld.events)){delete pdataCur.handle,pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}dataUser.hasData(src)&&(udataOld=dataUser.access(src),udataCur=jQuery.extend({},udataOld),dataUser.set(dest,udataCur))}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();"input"===nodeName&&rcheckableType.test(src.type)?dest.checked=src.checked:"input"!==nodeName&&"textarea"!==nodeName||(dest.defaultValue=src.defaultValue)}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||l>1&&"string"==typeof value&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);isFunction&&(args[0]=value.call(this,index,self.html())),domManip(self,args,callback,ignored)});if(l&&(fragment=buildFragment(args,collection[0].ownerDocument,!1,collection,ignored),first=fragment.firstChild,1===fragment.childNodes.length&&(fragment=first),first||ignored)){for(scripts=jQuery.map(getAll(fragment,"script"),disableScript),hasScripts=scripts.length;i<l;i++)node=fragment,i!==iNoClone&&(node=jQuery.clone(node,!0,!0),hasScripts&&jQuery.merge(scripts,getAll(node,"script"))),callback.call(collection[i],node,i);if(hasScripts)for(doc=scripts[scripts.length-1].ownerDocument,jQuery.map(scripts,restoreScript),i=0;i<hasScripts;i++)node=scripts[i],rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node)&&(node.src?jQuery._evalUrl&&jQuery._evalUrl(node.src):DOMEval(node.textContent.replace(rcleanScript,""),doc))}return collection}function remove(elem,selector,keepData){for(var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;null!=(node=nodes[i]);i++)keepData||1!==node.nodeType||jQuery.cleanData(getAll(node)),node.parentNode&&(keepData&&jQuery.contains(node.ownerDocument,node)&&setGlobalEval(getAll(node,"script")),node.parentNode.removeChild(node));return elem}function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;return computed=computed||getStyles(elem),computed&&(ret=computed.getPropertyValue(name)||computed[name],""!==ret||jQuery.contains(elem.ownerDocument,elem)||(ret=jQuery.style(elem,name)),!support.pixelMarginRight()&&rnumnonpx.test(ret)&&rmargin.test(name)&&(width=style.width,minWidth=style.minWidth,maxWidth=style.maxWidth,style.minWidth=style.maxWidth=style.width=ret,ret=computed.width,style.width=width,style.minWidth=minWidth,style.maxWidth=maxWidth)),void 0!==ret?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){return conditionFn()?void delete this.get:(this.get=hookFn).apply(this,arguments)}}}function vendorPropName(name){if(name in emptyStyle)return name;for(var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;i--;)if((name=cssPrefixes[i]+capName)in emptyStyle)return name}function finalPropName(name){var ret=jQuery.cssProps[name];return ret||(ret=jQuery.cssProps[name]=vendorPropName(name)||name),ret}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i,val=0;for(i=extra===(isBorderBox?"border":"content")?4:"width"===name?1:0;i<4;i+=2)"margin"===extra&&(val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)),isBorderBox?("content"===extra&&(val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)),"margin"!==extra&&(val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles))):(val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles),"padding"!==extra&&(val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)));return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox,styles=getStyles(elem),val=curCSS(elem,name,styles),isBorderBox="border-box"===jQuery.css(elem,"boxSizing",!1,styles);return rnumnonpx.test(val)?val:(valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]),"auto"===val&&(val=elem["offset"+name[0].toUpperCase()+name.slice(1)]),(val=parseFloat(val)||0)+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px")}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}function schedule(){inProgress&&(!1===document.hidden&&window.requestAnimationFrame?window.requestAnimationFrame(schedule):window.setTimeout(schedule,jQuery.fx.interval),jQuery.fx.tick())}function createFxNow(){return window.setTimeout(function(){fxNow=void 0}),fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};for(includeWidth=includeWidth?1:0;i<4;i+=2-includeWidth)which=cssExpand[i],attrs["margin"+which]=attrs["padding"+which]=type;return includeWidth&&(attrs.opacity=attrs.width=type),attrs}function createTween(value,prop,animation){for(var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,hooks,oldfire,propTween,restoreDisplay,display,isBox="width"in props||"height"in props,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHiddenWithinTree(elem),dataShow=dataPriv.get(elem,"fxshow");opts.queue||(hooks=jQuery._queueHooks(elem,"fx"),null==hooks.unqueued&&(hooks.unqueued=0,oldfire=hooks.empty.fire,hooks.empty.fire=function(){hooks.unqueued||oldfire()}),hooks.unqueued++,anim.always(function(){anim.always(function(){hooks.unqueued--,jQuery.queue(elem,"fx").length||hooks.empty.fire()})}));for(prop in props)if(value=props[prop],rfxtypes.test(value)){if(delete props[prop],toggle=toggle||"toggle"===value,value===(hidden?"hide":"show")){if("show"!==value||!dataShow||void 0===dataShow[prop])continue;hidden=!0}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}if((propTween=!jQuery.isEmptyObject(props))||!jQuery.isEmptyObject(orig)){isBox&&1===elem.nodeType&&(opts.overflow=[style.overflow,style.overflowX,style.overflowY],restoreDisplay=dataShow&&dataShow.display,null==restoreDisplay&&(restoreDisplay=dataPriv.get(elem,"display")),display=jQuery.css(elem,"display"),"none"===display&&(restoreDisplay?display=restoreDisplay:(showHide([elem],!0),restoreDisplay=elem.style.display||restoreDisplay,display=jQuery.css(elem,"display"),showHide([elem]))),("inline"===display||"inline-block"===display&&null!=restoreDisplay)&&"none"===jQuery.css(elem,"float")&&(propTween||(anim.done(function(){style.display=restoreDisplay}),null==restoreDisplay&&(display=style.display,restoreDisplay="none"===display?"":display)),style.display="inline-block")),opts.overflow&&(style.overflow="hidden",anim.always(function(){style.overflow=opts.overflow[0],style.overflowX=opts.overflow[1],style.overflowY=opts.overflow[2]})),propTween=!1;for(prop in orig)propTween||(dataShow?"hidden"in dataShow&&(hidden=dataShow.hidden):dataShow=dataPriv.access(elem,"fxshow",{display:restoreDisplay}),toggle&&(dataShow.hidden=!hidden),hidden&&showHide([elem],!0),anim.done(function(){hidden||showHide([elem]),dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,prop,orig[prop])})),propTween=createTween(hidden?dataShow[prop]:0,prop,anim),prop in dataShow||(dataShow[prop]=propTween.start,hidden&&(propTween.end=propTween.start,propTween.start=0))}}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props)if(name=jQuery.camelCase(index),easing=specialEasing[name],value=props[index],Array.isArray(value)&&(easing=value[1],value=props[index]=value[0]),index!==name&&(props[name]=value,delete props[index]),(hooks=jQuery.cssHooks[name])&&"expand"in hooks){value=hooks.expand(value),delete props[name];for(index in value)index in props||(props[index]=value[index],specialEasing[index]=easing)}else specialEasing[name]=easing}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return!1;for(var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;index<length;index++)animation.tweens[index].run(percent);return deferred.notifyWith(elem,[animation,percent,remaining]),percent<1&&length?remaining:(length||deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation]),!1)},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);return animation.tweens.push(tween),tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;for(stopped=!0;index<length;index++)animation.tweens[index].run(1);return gotoEnd?(deferred.notifyWith(elem,[animation,1,0]),deferred.resolveWith(elem,[animation,gotoEnd])):deferred.rejectWith(elem,[animation,gotoEnd]),this}}),props=animation.props;for(propFilter(props,animation.opts.specialEasing);index<length;index++)if(result=Animation.prefilters[index].call(animation,elem,props,animation.opts))return jQuery.isFunction(result.stop)&&(jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result)),result;return jQuery.map(props,createTween,animation),jQuery.isFunction(animation.opts.start)&&animation.opts.start.call(elem,animation),animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always),jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue})),animation}function stripAndCollapse(value){return(value.match(rnothtmlwhite)||[]).join(" ")}function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}function buildParams(prefix,obj,traditional,add){var name;if(Array.isArray(obj))jQuery.each(obj,function(i,v){traditional||rbracket.test(prefix)?add(prefix,v):buildParams(prefix+"["+("object"==typeof v&&null!=v?i:"")+"]",v,traditional,add)});else if(traditional||"object"!==jQuery.type(obj))add(prefix,obj);else for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add)}function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){"string"!=typeof dataTypeExpression&&(func=dataTypeExpression,dataTypeExpression="*");var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnothtmlwhite)||[];if(jQuery.isFunction(func))for(;dataType=dataTypes[i++];)"+"===dataType[0]?(dataType=dataType.slice(1)||"*",(structure[dataType]=structure[dataType]||[]).unshift(func)):(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){function inspect(dataType){var selected;return inspected[dataType]=!0,jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);return"string"!=typeof dataTypeOrTransport||seekingTransport||inspected[dataTypeOrTransport]?seekingTransport?!(selected=dataTypeOrTransport):void 0:(options.dataTypes.unshift(dataTypeOrTransport),inspect(dataTypeOrTransport),!1)}),selected}var inspected={},seekingTransport=structure===transports;return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)void 0!==src[key]&&((flatOptions[key]?target:deep||(deep={}))[key]=src[key]);return deep&&jQuery.extend(!0,target,deep),target}function ajaxHandleResponses(s,jqXHR,responses){for(var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;"*"===dataTypes[0];)dataTypes.shift(),void 0===ct&&(ct=s.mimeType||jqXHR.getResponseHeader("Content-Type"));if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}firstDataType||(firstDataType=type)}finalDataType=finalDataType||firstDataType}if(finalDataType)return finalDataType!==dataTypes[0]&&dataTypes.unshift(finalDataType),responses[finalDataType]}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];for(current=dataTypes.shift();current;)if(s.responseFields[current]&&(jqXHR[s.responseFields[current]]=response),!prev&&isSuccess&&s.dataFilter&&(response=s.dataFilter(response,s.dataType)),prev=current,current=dataTypes.shift())if("*"===current)current=prev;else if("*"!==prev&&prev!==current){if(!(conv=converters[prev+" "+current]||converters["* "+current]))for(conv2 in converters)if(tmp=conv2.split(" "),tmp[1]===current&&(conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]])){!0===conv?conv=converters[conv2]:!0!==converters[conv2]&&(current=tmp[0],dataTypes.unshift(tmp[1]));break}if(!0!==conv)if(conv&&s.throws)response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}return{state:"success",data:response}}var arr=[],document=window.document,getProto=Object.getPrototypeOf,slice=arr.slice,concat=arr.concat,push=arr.push,indexOf=arr.indexOf,class2type={},toString=class2type.toString,hasOwn=class2type.hasOwnProperty,fnToString=hasOwn.toString,ObjectFunctionString=fnToString.call(Object),support={},jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([a-z])/g,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:"3.2.1",constructor:jQuery,length:0,toArray:function(){return slice.call(this)},get:function(num){return null==num?slice.call(this):num<0?this[num+this.length]:this[num]},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);return ret.prevObject=this,ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice},jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;for("boolean"==typeof target&&(deep=target,target=arguments[i]||{},i++),"object"==typeof target||jQuery.isFunction(target)||(target={}),i===length&&(target=this,i--);i<length;i++)if(null!=(options=arguments[i]))for(name in options)src=target[name],copy=options[name],target!==copy&&(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=Array.isArray(copy)))?(copyIsArray?(copyIsArray=!1,clone=src&&Array.isArray(src)?src:[]):clone=src&&jQuery.isPlainObject(src)?src:{},target[name]=jQuery.extend(deep,clone,copy)):void 0!==copy&&(target[name]=copy));return target},jQuery.extend({expando:"jQuery"+("3.2.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return"function"===jQuery.type(obj)},isWindow:function(obj){return null!=obj&&obj===obj.window},isNumeric:function(obj){var type=jQuery.type(obj);return("number"===type||"string"===type)&&!isNaN(obj-parseFloat(obj))},isPlainObject:function(obj){var proto,Ctor;return!(!obj||"[object Object]"!==toString.call(obj))&&(!(proto=getProto(obj))||"function"==typeof(Ctor=hasOwn.call(proto,"constructor")&&proto.constructor)&&fnToString.call(Ctor)===ObjectFunctionString)},isEmptyObject:function(obj){var name;for(name in obj)return!1;return!0},type:function(obj){return null==obj?obj+"":"object"==typeof obj||"function"==typeof obj?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){DOMEval(code)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},each:function(obj,callback){var length,i=0
;if(isArrayLike(obj))for(length=obj.length;i<length&&!1!==callback.call(obj[i],i,obj[i]);i++);else for(i in obj)if(!1===callback.call(obj[i],i,obj[i]))break;return obj},trim:function(text){return null==text?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];return null!=arr&&(isArrayLike(Object(arr))?jQuery.merge(ret,"string"==typeof arr?[arr]:arr):push.call(ret,arr)),ret},inArray:function(elem,arr,i){return null==arr?-1:indexOf.call(arr,elem,i)},merge:function(first,second){for(var len=+second.length,j=0,i=first.length;j<len;j++)first[i++]=second[j];return first.length=i,first},grep:function(elems,callback,invert){for(var matches=[],i=0,length=elems.length,callbackExpect=!invert;i<length;i++)!callback(elems[i],i)!==callbackExpect&&matches.push(elems[i]);return matches},map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems))for(length=elems.length;i<length;i++)null!=(value=callback(elems[i],i,arg))&&ret.push(value);else for(i in elems)null!=(value=callback(elems[i],i,arg))&&ret.push(value);return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if("string"==typeof context&&(tmp=fn[context],context=fn,fn=tmp),jQuery.isFunction(fn))return args=slice.call(arguments,2),proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))},proxy.guid=fn.guid=fn.guid||jQuery.guid++,proxy},now:Date.now,support:support}),"function"==typeof Symbol&&(jQuery.fn[Symbol.iterator]=arr[Symbol.iterator]),jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});var Sizzle=function(window){function Sizzle(selector,context,results,seed){var m,i,elem,nid,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;if(results=results||[],"string"!=typeof selector||!selector||1!==nodeType&&9!==nodeType&&11!==nodeType)return results;if(!seed&&((context?context.ownerDocument||context:preferredDoc)!==document&&setDocument(context),context=context||document,documentIsHTML)){if(11!==nodeType&&(match=rquickExpr.exec(selector)))if(m=match[1]){if(9===nodeType){if(!(elem=context.getElementById(m)))return results;if(elem.id===m)return results.push(elem),results}else if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m)return results.push(elem),results}else{if(match[2])return push.apply(results,context.getElementsByTagName(selector)),results;if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName)return push.apply(results,context.getElementsByClassName(m)),results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(1!==nodeType)newContext=context,newSelector=selector;else if("object"!==context.nodeName.toLowerCase()){for((nid=context.getAttribute("id"))?nid=nid.replace(rcssescape,fcssescape):context.setAttribute("id",nid=expando),groups=tokenize(selector),i=groups.length;i--;)groups[i]="#"+nid+" "+toSelector(groups[i]);newSelector=groups.join(","),newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{return push.apply(results,newContext.querySelectorAll(newSelector)),results}catch(qsaError){}finally{nid===expando&&context.removeAttribute("id")}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){function cache(key,value){return keys.push(key+" ")>Expr.cacheLength&&delete cache[keys.shift()],cache[key+" "]=value}var keys=[];return cache}function markFunction(fn){return fn[expando]=!0,fn}function assert(fn){var el=document.createElement("fieldset");try{return!!fn(el)}catch(e){return!1}finally{el.parentNode&&el.parentNode.removeChild(el),el=null}}function addHandle(attrs,handler){for(var arr=attrs.split("|"),i=arr.length;i--;)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&1===a.nodeType&&1===b.nodeType&&a.sourceIndex-b.sourceIndex;if(diff)return diff;if(cur)for(;cur=cur.nextSibling;)if(cur===b)return-1;return a?1:-1}function createDisabledPseudo(disabled){return function(elem){return"form"in elem?elem.parentNode&&!1===elem.disabled?"label"in elem?"label"in elem.parentNode?elem.parentNode.disabled===disabled:elem.disabled===disabled:elem.isDisabled===disabled||elem.isDisabled!==!disabled&&disabledAncestor(elem)===disabled:elem.disabled===disabled:"label"in elem&&elem.disabled===disabled}}function createPositionalPseudo(fn){return markFunction(function(argument){return argument=+argument,markFunction(function(seed,matches){for(var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;i--;)seed[j=matchIndexes[i]]&&(seed[j]=!(matches[j]=seed[j]))})})}function testContext(context){return context&&void 0!==context.getElementsByTagName&&context}function setFilters(){}function toSelector(tokens){for(var i=0,len=tokens.length,selector="";i<len;i++)selector+=tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,skip=combinator.next,key=skip||dir,checkNonElements=base&&"parentNode"===key,doneName=done++;return combinator.first?function(elem,context,xml){for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)return matcher(elem,context,xml);return!1}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml){for(;elem=elem[dir];)if((1===elem.nodeType||checkNonElements)&&matcher(elem,context,xml))return!0}else for(;elem=elem[dir];)if(1===elem.nodeType||checkNonElements)if(outerCache=elem[expando]||(elem[expando]={}),uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={}),skip&&skip===elem.nodeName.toLowerCase())elem=elem[dir]||elem;else{if((oldCache=uniqueCache[key])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];if(uniqueCache[key]=newCache,newCache[2]=matcher(elem,context,xml))return!0}return!1}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){for(var i=matchers.length;i--;)if(!matchers[i](elem,context,xml))return!1;return!0}:matchers[0]}function multipleContexts(selector,contexts,results){for(var i=0,len=contexts.length;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){for(var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=null!=map;i<len;i++)(elem=unmatched[i])&&(filter&&!filter(elem,context,xml)||(newUnmatched.push(elem),mapped&&map.push(i)));return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){return postFilter&&!postFilter[expando]&&(postFilter=setMatcher(postFilter)),postFinder&&!postFinder[expando]&&(postFinder=setMatcher(postFinder,postSelector)),markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=!preFilter||!seed&&selector?elems:condense(elems,preMap,preFilter,context,xml),matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher&&matcher(matcherIn,matcherOut,context,xml),postFilter)for(temp=condense(matcherOut,postMap),postFilter(temp,[],context,xml),i=temp.length;i--;)(elem=temp[i])&&(matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem));if(seed){if(postFinder||preFilter){if(postFinder){for(temp=[],i=matcherOut.length;i--;)(elem=matcherOut[i])&&temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}for(i=matcherOut.length;i--;)(elem=matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1&&(seed[temp]=!(results[temp]=elem))}}else matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut),postFinder?postFinder(null,results,matcherOut,xml):push.apply(results,matcherOut)})}function matcherFromTokens(tokens){for(var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));return checkContext=null,ret}];i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),matcher)];else{if(matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches),matcher[expando]){for(j=++i;j<len&&!Expr.relative[tokens[j].type];j++);return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:" "===tokens[i-2].type?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=dirruns+=null==contextBackup?1:Math.random()||.1,len=elems.length;for(outermost&&(outermostContext=context===document||context||outermost);i!==len&&null!=(elem=elems[i]);i++){if(byElement&&elem){for(j=0,context||elem.ownerDocument===document||(setDocument(elem),xml=!documentIsHTML);matcher=elementMatchers[j++];)if(matcher(elem,context||document,xml)){results.push(elem);break}outermost&&(dirruns=dirrunsUnique)}bySet&&((elem=!matcher&&elem)&&matchedCount--,seed&&unmatched.push(elem))}if(matchedCount+=i,bySet&&i!==matchedCount){for(j=0;matcher=setMatchers[j++];)matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)for(;i--;)unmatched[i]||setMatched[i]||(setMatched[i]=pop.call(results));setMatched=condense(setMatched)}push.apply(results,setMatched),outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1&&Sizzle.uniqueSort(results)}return outermost&&(dirruns=dirrunsUnique,outermostContext=contextBackup),unmatched};return bySet?markFunction(superMatcher):superMatcher}var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){return a===b&&(hasDuplicate=!0),0},hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){for(var i=0,len=list.length;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|.*)\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+identifier+")"),CLASS:new RegExp("^\\.("+identifier+")"),TAG:new RegExp("^("+identifier+"|[*])"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,1023&high|56320)},rcssescape=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,fcssescape=function(ch,asCodePoint){return asCodePoint?"\0"===ch?"":ch.slice(0,-1)+"\\"+ch.charCodeAt(ch.length-1).toString(16)+" ":"\\"+ch},unloadHandler=function(){setDocument()},disabledAncestor=addCombinator(function(elem){return!0===elem.disabled&&("form"in elem||"label"in elem)},{dir:"parentNode",next:"legend"});try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes),arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){for(var j=target.length,i=0;target[j++]=els[i++];);target.length=j-1}}}support=Sizzle.support={},isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return!!documentElement&&"HTML"!==documentElement.nodeName},setDocument=Sizzle.setDocument=function(node){var hasCompare,subWindow,doc=node?node.ownerDocument||node:preferredDoc;return doc!==document&&9===doc.nodeType&&doc.documentElement?(document=doc,docElem=document.documentElement,documentIsHTML=!isXML(document),preferredDoc!==document&&(subWindow=document.defaultView)&&subWindow.top!==subWindow&&(subWindow.addEventListener?subWindow.addEventListener("unload",unloadHandler,!1):subWindow.attachEvent&&subWindow.attachEvent("onunload",unloadHandler)),support.attributes=assert(function(el){return el.className="i",!el.getAttribute("className")}),support.getElementsByTagName=assert(function(el){return el.appendChild(document.createComment("")),!el.getElementsByTagName("*").length}),support.getElementsByClassName=rnative.test(document.getElementsByClassName),support.getById=assert(function(el){return docElem.appendChild(el).id=expando,!document.getElementsByName||!document.getElementsByName(expando).length}),support.getById?(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var elem=context.getElementById(id);return elem?[elem]:[]}}):(Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=void 0!==elem.getAttributeNode&&elem.getAttributeNode("id");return node&&node.value===attrId}},Expr.find.ID=function(id,context){if(void 0!==context.getElementById&&documentIsHTML){var node,i,elems,elem=context.getElementById(id);if(elem){if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem];for(elems=context.getElementsByName(id),i=0;elem=elems[i++];)if((node=elem.getAttributeNode("id"))&&node.value===id)return[elem]}return[]}}),Expr.find.TAG=support.getElementsByTagName?function(tag,context){return void 0!==context.getElementsByTagName?context.getElementsByTagName(tag):support.qsa?context.querySelectorAll(tag):void 0}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if("*"===tag){for(;elem=results[i++];)1===elem.nodeType&&tmp.push(elem);return tmp}return results},Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(void 0!==context.getElementsByClassName&&documentIsHTML)return context.getElementsByClassName(className)},rbuggyMatches=[],rbuggyQSA=[],(support.qsa=rnative.test(document.querySelectorAll))&&(assert(function(el){docElem.appendChild(el).innerHTML="<a id='"+expando+"'></a><select id='"+expando+"-\r\\' msallowcapture=''><option selected=''></option></select>",el.querySelectorAll("[msallowcapture^='']").length&&rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")"),el.querySelectorAll("[selected]").length||rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")"),el.querySelectorAll("[id~="+expando+"-]").length||rbuggyQSA.push("~="),el.querySelectorAll(":checked").length||rbuggyQSA.push(":checked"),el.querySelectorAll("a#"+expando+"+*").length||rbuggyQSA.push(".#.+[+~]")}),assert(function(el){el.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var input=document.createElement("input");input.setAttribute("type","hidden"),el.appendChild(input).setAttribute("name","D"),el.querySelectorAll("[name=d]").length&&rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?="),2!==el.querySelectorAll(":enabled").length&&rbuggyQSA.push(":enabled",":disabled"),docElem.appendChild(el).disabled=!0,2!==el.querySelectorAll(":disabled").length&&rbuggyQSA.push(":enabled",":disabled"),el.querySelectorAll("*,:x"),rbuggyQSA.push(",.*:")})),(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))&&assert(function(el){support.disconnectedMatch=matches.call(el,"*"),matches.call(el,"[s!='']:x"),rbuggyMatches.push("!=",pseudos)}),rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|")),rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|")),hasCompare=rnative.test(docElem.compareDocumentPosition),contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=9===a.nodeType?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!(!bup||1!==bup.nodeType||!(adown.contains?adown.contains(bup):a.compareDocumentPosition&&16&a.compareDocumentPosition(bup)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},sortOrder=hasCompare?function(a,b){if(a===b)return hasDuplicate=!0,0;var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;return compare||(compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&compare||!support.sortDetached&&b.compareDocumentPosition(a)===compare?a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)?-1:b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0:4&compare?-1:1)}:function(a,b){if(a===b)return hasDuplicate=!0,0;var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0;if(aup===bup)return siblingCheck(a,b);for(cur=a;cur=cur.parentNode;)ap.unshift(cur);for(cur=b;cur=cur.parentNode;)bp.unshift(cur);for(;ap[i]===bp[i];)i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0},document):document},Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)},Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document&&setDocument(elem),expr=expr.replace(rattributeQuotes,"='$1']"),support.matchesSelector&&documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&11!==elem.document.nodeType)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0},Sizzle.contains=function(context,elem){return(context.ownerDocument||context)!==document&&setDocument(context),contains(context,elem)},Sizzle.attr=function(elem,name){(elem.ownerDocument||elem)!==document&&setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):void 0;return void 0!==val?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null},Sizzle.escape=function(sel){return(sel+"").replace(rcssescape,fcssescape)},Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)},Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;if(hasDuplicate=!support.detectDuplicates,sortInput=!support.sortStable&&results.slice(0),results.sort(sortOrder),hasDuplicate){for(;elem=results[i++];)elem===results[i]&&(j=duplicates.push(i));for(;j--;)results.splice(duplicates[j],1)}return sortInput=null,results},getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(nodeType){if(1===nodeType||9===nodeType||11===nodeType){if("string"==typeof elem.textContent)return elem.textContent;for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem)}else if(3===nodeType||4===nodeType)return elem.nodeValue}else for(;node=elem[i++];)ret+=getText(node);return ret},Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){return match[1]=match[1].replace(runescape,funescape),match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape),"~="===match[2]&&(match[3]=" "+match[3]+" "),match.slice(0,4)},CHILD:function(match){return match[1]=match[1].toLowerCase(),"nth"===match[1].slice(0,3)?(match[3]||Sizzle.error(match[0]),match[4]=+(match[4]?match[5]+(match[6]||1):2*("even"===match[3]||"odd"===match[3])),match[5]=+(match[7]+match[8]||"odd"===match[3])):match[3]&&Sizzle.error(match[0]),match},PSEUDO:function(match){var excess,unquoted=!match[6]&&match[2];return matchExpr.CHILD.test(match[0])?null:(match[3]?match[2]=match[4]||match[5]||"":unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)&&(match[0]=match[0].slice(0,excess),match[2]=unquoted.slice(0,excess)),match.slice(0,3))}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return"*"===nodeNameSelector?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test("string"==typeof elem.className&&elem.className||void 0!==elem.getAttribute&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);return null==result?"!="===operator:!operator||(result+="","="===operator?result===check:"!="===operator?result!==check:"^="===operator?check&&0===result.indexOf(check):"*="===operator?check&&result.indexOf(check)>-1:"$="===operator?check&&result.slice(-check.length)===check:"~="===operator?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:"|="===operator&&(result===check||result.slice(0,check.length+1)===check+"-"))}},CHILD:function(type,what,argument,first,last){var simple="nth"!==type.slice(0,3),forward="last"!==type.slice(-4),ofType="of-type"===what;return 1===first&&0===last?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=!1;if(parent){if(simple){for(;dir;){for(node=elem;node=node[dir];)if(ofType?node.nodeName.toLowerCase()===name:1===node.nodeType)return!1;start=dir="only"===type&&!start&&"nextSibling"}return!0}if(start=[forward?parent.firstChild:parent.lastChild],forward&&useCache){for(node=parent,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex&&cache[2],node=nodeIndex&&parent.childNodes[nodeIndex];node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop();)if(1===node.nodeType&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else if(useCache&&(node=elem,outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),cache=uniqueCache[type]||[],nodeIndex=cache[0]===dirruns&&cache[1],diff=nodeIndex),!1===diff)for(;(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())&&((ofType?node.nodeName.toLowerCase()!==name:1!==node.nodeType)||!++diff||(useCache&&(outerCache=node[expando]||(node[expando]={}),uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={}),uniqueCache[type]=[dirruns,diff]),node!==elem)););return(diff-=last)===first||diff%first==0&&diff/first>=0}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);return fn[expando]?fn(argument):fn.length>1?(args=[pseudo,pseudo,"",argument],Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){for(var idx,matched=fn(seed,argument),i=matched.length;i--;)idx=indexOf(seed,matched[i]),seed[idx]=!(matches[idx]=matched[i])}):function(elem){return fn(elem,0,args)}):fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){for(var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;i--;)(elem=unmatched[i])&&(seed[i]=!(matches[i]=elem))}):function(elem,context,xml){return input[0]=elem,matcher(input,null,xml,results),input[0]=null,!results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return text=text.replace(runescape,funescape),function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){return ridentifier.test(lang||"")||Sizzle.error("unsupported lang: "+lang),lang=lang.replace(runescape,funescape).toLowerCase(),function(elem){var elemLang;do{if(elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))return(elemLang=elemLang.toLowerCase())===lang||0===elemLang.indexOf(lang+"-")}while((elem=elem.parentNode)&&1===elem.nodeType);return!1}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:createDisabledPseudo(!1),disabled:createDisabledPseudo(!0),checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return"input"===nodeName&&!!elem.checked||"option"===nodeName&&!!elem.selected},selected:function(elem){return elem.parentNode&&elem.parentNode.selectedIndex,!0===elem.selected},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return!1;return!0},parent:function(elem){return!Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return"input"===name&&"button"===elem.type||"button"===name},text:function(elem){var attr;return"input"===elem.nodeName.toLowerCase()&&"text"===elem.type&&(null==(attr=elem.getAttribute("type"))||"text"===attr.toLowerCase())},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){for(var i=0;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){for(var i=1;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;--i>=0;)matchIndexes.push(i);return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){for(var i=argument<0?argument+length:argument;++i<length;)matchIndexes.push(i);return matchIndexes})}},Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Expr.pseudos[i]=function(type){return function(elem){return"input"===elem.nodeName.toLowerCase()&&elem.type===type}}(i);for(i in{submit:!0,reset:!0})Expr.pseudos[i]=function(type){return function(elem){var name=elem.nodeName.toLowerCase();return("input"===name||"button"===name)&&elem.type===type}}(i);return setFilters.prototype=Expr.filters=Expr.pseudos,Expr.setFilters=new setFilters,tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);for(soFar=selector,groups=[],preFilters=Expr.preFilter;soFar;){matched&&!(match=rcomma.exec(soFar))||(match&&(soFar=soFar.slice(match[0].length)||soFar),groups.push(tokens=[])),matched=!1,(match=rcombinators.exec(soFar))&&(matched=match.shift(),tokens.push({value:matched,type:match[0].replace(rtrim," ")}),soFar=soFar.slice(matched.length));for(type in Expr.filter)!(match=matchExpr[type].exec(soFar))||preFilters[type]&&!(match=preFilters[type](match))||(matched=match.shift(),tokens.push({value:matched,type:type,matches:match}),soFar=soFar.slice(matched.length));if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)},compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){for(match||(match=tokenize(selector)),i=match.length;i--;)cached=matcherFromTokens(match[i]),cached[expando]?setMatchers.push(cached):elementMatchers.push(cached);cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers)),cached.selector=selector}return cached},select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled="function"==typeof selector&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);if(results=results||[],1===match.length){if(tokens=match[0]=match[0].slice(0),tokens.length>2&&"ID"===(token=tokens[0]).type&&9===context.nodeType&&documentIsHTML&&Expr.relative[tokens[1].type]){if(!(context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0]))return results;compiled&&(context=context.parentNode),selector=selector.slice(tokens.shift().value.length)}for(i=matchExpr.needsContext.test(selector)?0:tokens.length;i--&&(token=tokens[i],!Expr.relative[type=token.type]);)if((find=Expr.find[type])&&(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){if(tokens.splice(i,1),!(selector=seed.length&&toSelector(tokens)))return push.apply(results,seed),results;break}}return(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context),results},support.sortStable=expando.split("").sort(sortOrder).join("")===expando,support.detectDuplicates=!!hasDuplicate,setDocument(),
support.sortDetached=assert(function(el){return 1&el.compareDocumentPosition(document.createElement("fieldset"))}),assert(function(el){return el.innerHTML="<a href='#'></a>","#"===el.firstChild.getAttribute("href")})||addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,"type"===name.toLowerCase()?1:2)}),support.attributes&&assert(function(el){return el.innerHTML="<input/>",el.firstChild.setAttribute("value",""),""===el.firstChild.getAttribute("value")})||addHandle("value",function(elem,name,isXML){if(!isXML&&"input"===elem.nodeName.toLowerCase())return elem.defaultValue}),assert(function(el){return null==el.getAttribute("disabled")})||addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return!0===elem[name]?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}),Sizzle}(window);jQuery.find=Sizzle,jQuery.expr=Sizzle.selectors,jQuery.expr[":"]=jQuery.expr.pseudos,jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort,jQuery.text=Sizzle.getText,jQuery.isXMLDoc=Sizzle.isXML,jQuery.contains=Sizzle.contains,jQuery.escapeSelector=Sizzle.escape;var dir=function(elem,dir,until){for(var matched=[],truncate=void 0!==until;(elem=elem[dir])&&9!==elem.nodeType;)if(1===elem.nodeType){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched},siblings=function(n,elem){for(var matched=[];n;n=n.nextSibling)1===n.nodeType&&n!==elem&&matched.push(n);return matched},rneedsContext=jQuery.expr.match.needsContext,rsingleTag=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,risSimple=/^.[^:#\[\.,]*$/;jQuery.filter=function(expr,elems,not){var elem=elems[0];return not&&(expr=":not("+expr+")"),1===elems.length&&1===elem.nodeType?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return 1===elem.nodeType}))},jQuery.fn.extend({find:function(selector){var i,ret,len=this.length,self=this;if("string"!=typeof selector)return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++)if(jQuery.contains(self[i],this))return!0}));for(ret=this.pushStack([]),i=0;i<len;i++)jQuery.find(selector,self[i],ret);return len>1?jQuery.uniqueSort(ret):ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,"string"==typeof selector&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;if(root=root||rootjQuery,"string"==typeof selector){if(!(match="<"===selector[0]&&">"===selector[selector.length-1]&&selector.length>=3?[null,selector,null]:rquickExpr.exec(selector))||!match[1]&&context)return!context||context.jquery?(context||root).find(selector):this.constructor(context).find(selector);if(match[1]){if(context=context instanceof jQuery?context[0]:context,jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0)),rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)jQuery.isFunction(this[match])?this[match](context[match]):this.attr(match,context[match]);return this}return elem=document.getElementById(match[2]),elem&&(this[0]=elem,this.length=1),this}return selector.nodeType?(this[0]=selector,this.length=1,this):jQuery.isFunction(selector)?void 0!==root.ready?root.ready(selector):selector(jQuery):jQuery.makeArray(selector,this)}).prototype=jQuery.fn,rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.fn.extend({has:function(target){var targets=jQuery(target,this),l=targets.length;return this.filter(function(){for(var i=0;i<l;i++)if(jQuery.contains(this,targets[i]))return!0})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],targets="string"!=typeof selectors&&jQuery(selectors);if(!rneedsContext.test(selectors))for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(targets?targets.index(cur)>-1:1===cur.nodeType&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){return elem?"string"==typeof elem?indexOf.call(jQuery(elem),this[0]):indexOf.call(this,elem.jquery?elem[0]:elem):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(null==selector?this.prevObject:this.prevObject.filter(selector))}}),jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&11!==parent.nodeType?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return nodeName(elem,"iframe")?elem.contentDocument:(nodeName(elem,"template")&&(elem=elem.content||elem),jQuery.merge([],elem.childNodes))}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);return"Until"!==name.slice(-5)&&(selector=until),selector&&"string"==typeof selector&&(matched=jQuery.filter(selector,matched)),this.length>1&&(guaranteedUnique[name]||jQuery.uniqueSort(matched),rparentsprev.test(name)&&matched.reverse()),this.pushStack(matched)}});var rnothtmlwhite=/[^\x20\t\r\n\f]+/g;jQuery.Callbacks=function(options){options="string"==typeof options?createOptions(options):jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){for(locked=locked||options.once,fired=firing=!0;queue.length;firingIndex=-1)for(memory=queue.shift();++firingIndex<list.length;)!1===list[firingIndex].apply(memory[0],memory[1])&&options.stopOnFalse&&(firingIndex=list.length,memory=!1);options.memory||(memory=!1),firing=!1,locked&&(list=memory?[]:"")},self={add:function(){return list&&(memory&&!firing&&(firingIndex=list.length-1,queue.push(memory)),function add(args){jQuery.each(args,function(_,arg){jQuery.isFunction(arg)?options.unique&&self.has(arg)||list.push(arg):arg&&arg.length&&"string"!==jQuery.type(arg)&&add(arg)})}(arguments),memory&&!firing&&fire()),this},remove:function(){return jQuery.each(arguments,function(_,arg){for(var index;(index=jQuery.inArray(arg,list,index))>-1;)list.splice(index,1),index<=firingIndex&&firingIndex--}),this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:list.length>0},empty:function(){return list&&(list=[]),this},disable:function(){return locked=queue=[],list=memory="",this},disabled:function(){return!list},lock:function(){return locked=queue=[],memory||firing||(list=memory=""),this},locked:function(){return!!locked},fireWith:function(context,args){return locked||(args=args||[],args=[context,args.slice?args.slice():args],queue.push(args),firing||fire()),this},fire:function(){return self.fireWith(this,arguments),this},fired:function(){return!!fired}};return self},jQuery.extend({Deferred:function(func){var tuples=[["notify","progress",jQuery.Callbacks("memory"),jQuery.Callbacks("memory"),2],["resolve","done",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),0,"resolved"],["reject","fail",jQuery.Callbacks("once memory"),jQuery.Callbacks("once memory"),1,"rejected"]],state="pending",promise={state:function(){return state},always:function(){return deferred.done(arguments).fail(arguments),this},catch:function(fn){return promise.then(null,fn)},pipe:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[tuple[4]])&&fns[tuple[4]];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);returned&&jQuery.isFunction(returned.promise)?returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject):newDefer[tuple[0]+"With"](this,fn?[returned]:arguments)})}),fns=null}).promise()},then:function(onFulfilled,onRejected,onProgress){function resolve(depth,deferred,handler,special){return function(){var that=this,args=arguments,mightThrow=function(){var returned,then;if(!(depth<maxDepth)){if((returned=handler.apply(that,args))===deferred.promise())throw new TypeError("Thenable self-resolution");then=returned&&("object"==typeof returned||"function"==typeof returned)&&returned.then,jQuery.isFunction(then)?special?then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special)):(maxDepth++,then.call(returned,resolve(maxDepth,deferred,Identity,special),resolve(maxDepth,deferred,Thrower,special),resolve(maxDepth,deferred,Identity,deferred.notifyWith))):(handler!==Identity&&(that=void 0,args=[returned]),(special||deferred.resolveWith)(that,args))}},process=special?mightThrow:function(){try{mightThrow()}catch(e){jQuery.Deferred.exceptionHook&&jQuery.Deferred.exceptionHook(e,process.stackTrace),depth+1>=maxDepth&&(handler!==Thrower&&(that=void 0,args=[e]),deferred.rejectWith(that,args))}};depth?process():(jQuery.Deferred.getStackHook&&(process.stackTrace=jQuery.Deferred.getStackHook()),window.setTimeout(process))}}var maxDepth=0;return jQuery.Deferred(function(newDefer){tuples[0][3].add(resolve(0,newDefer,jQuery.isFunction(onProgress)?onProgress:Identity,newDefer.notifyWith)),tuples[1][3].add(resolve(0,newDefer,jQuery.isFunction(onFulfilled)?onFulfilled:Identity)),tuples[2][3].add(resolve(0,newDefer,jQuery.isFunction(onRejected)?onRejected:Thrower))}).promise()},promise:function(obj){return null!=obj?jQuery.extend(obj,promise):promise}},deferred={};return jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[5];promise[tuple[1]]=list.add,stateString&&list.add(function(){state=stateString},tuples[3-i][2].disable,tuples[0][2].lock),list.add(tuple[3].fire),deferred[tuple[0]]=function(){return deferred[tuple[0]+"With"](this===deferred?void 0:this,arguments),this},deferred[tuple[0]+"With"]=list.fireWith}),promise.promise(deferred),func&&func.call(deferred,deferred),deferred},when:function(singleValue){var remaining=arguments.length,i=remaining,resolveContexts=Array(i),resolveValues=slice.call(arguments),master=jQuery.Deferred(),updateFunc=function(i){return function(value){resolveContexts[i]=this,resolveValues[i]=arguments.length>1?slice.call(arguments):value,--remaining||master.resolveWith(resolveContexts,resolveValues)}};if(remaining<=1&&(adoptValue(singleValue,master.done(updateFunc(i)).resolve,master.reject,!remaining),"pending"===master.state()||jQuery.isFunction(resolveValues[i]&&resolveValues[i].then)))return master.then();for(;i--;)adoptValue(resolveValues[i],updateFunc(i),master.reject);return master.promise()}});var rerrorNames=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;jQuery.Deferred.exceptionHook=function(error,stack){window.console&&window.console.warn&&error&&rerrorNames.test(error.name)&&window.console.warn("jQuery.Deferred exception: "+error.message,error.stack,stack)},jQuery.readyException=function(error){window.setTimeout(function(){throw error})};var readyList=jQuery.Deferred();jQuery.fn.ready=function(fn){return readyList.then(fn).catch(function(error){jQuery.readyException(error)}),this},jQuery.extend({isReady:!1,readyWait:1,ready:function(wait){(!0===wait?--jQuery.readyWait:jQuery.isReady)||(jQuery.isReady=!0,!0!==wait&&--jQuery.readyWait>0||readyList.resolveWith(document,[jQuery]))}}),jQuery.ready.then=readyList.then,"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?window.setTimeout(jQuery.ready):(document.addEventListener("DOMContentLoaded",completed),window.addEventListener("load",completed));var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=null==key;if("object"===jQuery.type(key)){chainable=!0;for(i in key)access(elems,fn,i,key[i],!0,emptyGet,raw)}else if(void 0!==value&&(chainable=!0,jQuery.isFunction(value)||(raw=!0),bulk&&(raw?(fn.call(elems,value),fn=null):(bulk=fn,fn=function(elem,key,value){return bulk.call(jQuery(elem),value)})),fn))for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)));return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet},acceptData=function(owner){return 1===owner.nodeType||9===owner.nodeType||!+owner.nodeType};Data.uid=1,Data.prototype={cache:function(owner){var value=owner[this.expando];return value||(value={},acceptData(owner)&&(owner.nodeType?owner[this.expando]=value:Object.defineProperty(owner,this.expando,{value:value,configurable:!0}))),value},set:function(owner,data,value){var prop,cache=this.cache(owner);if("string"==typeof data)cache[jQuery.camelCase(data)]=value;else for(prop in data)cache[jQuery.camelCase(prop)]=data[prop];return cache},get:function(owner,key){return void 0===key?this.cache(owner):owner[this.expando]&&owner[this.expando][jQuery.camelCase(key)]},access:function(owner,key,value){return void 0===key||key&&"string"==typeof key&&void 0===value?this.get(owner,key):(this.set(owner,key,value),void 0!==value?value:key)},remove:function(owner,key){var i,cache=owner[this.expando];if(void 0!==cache){if(void 0!==key){Array.isArray(key)?key=key.map(jQuery.camelCase):(key=jQuery.camelCase(key),key=key in cache?[key]:key.match(rnothtmlwhite)||[]),i=key.length;for(;i--;)delete cache[key[i]]}(void 0===key||jQuery.isEmptyObject(cache))&&(owner.nodeType?owner[this.expando]=void 0:delete owner[this.expando])}},hasData:function(owner){var cache=owner[this.expando];return void 0!==cache&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data,dataUser=new Data,rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,name)}}),jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(void 0===key){if(this.length&&(data=dataUser.get(elem),1===elem.nodeType&&!dataPriv.get(elem,"hasDataAttrs"))){for(i=attrs.length;i--;)attrs[i]&&(name=attrs[i].name,0===name.indexOf("data-")&&(name=jQuery.camelCase(name.slice(5)),dataAttr(elem,name,data[name])));dataPriv.set(elem,"hasDataAttrs",!0)}return data}return"object"==typeof key?this.each(function(){dataUser.set(this,key)}):access(this,function(value){var data;if(elem&&void 0===value){if(void 0!==(data=dataUser.get(elem,key)))return data;if(void 0!==(data=dataAttr(elem,key)))return data}else this.each(function(){dataUser.set(this,key,value)})},null,value,arguments.length>1,null,!0)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}}),jQuery.extend({queue:function(elem,type,data){var queue;if(elem)return type=(type||"fx")+"queue",queue=dataPriv.get(elem,type),data&&(!queue||Array.isArray(data)?queue=dataPriv.access(elem,type,jQuery.makeArray(data)):queue.push(data)),queue||[]},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};"inprogress"===fn&&(fn=queue.shift(),startLength--),fn&&("fx"===type&&queue.unshift("inprogress"),delete hooks.stop,fn.call(elem,next,hooks)),!startLength&&hooks&&hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,[type+"queue",key])})})}}),jQuery.fn.extend({queue:function(type,data){var setter=2;return"string"!=typeof type&&(data=type,type="fx",setter--),arguments.length<setter?jQuery.queue(this[0],type):void 0===data?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type),"fx"===type&&"inprogress"!==queue[0]&&jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){--count||defer.resolveWith(elements,[elements])};for("string"!=typeof type&&(obj=type,type=void 0),type=type||"fx";i--;)(tmp=dataPriv.get(elements[i],type+"queueHooks"))&&tmp.empty&&(count++,tmp.empty.add(resolve));return resolve(),defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),cssExpand=["Top","Right","Bottom","Left"],isHiddenWithinTree=function(elem,el){return elem=el||elem,"none"===elem.style.display||""===elem.style.display&&jQuery.contains(elem.ownerDocument,elem)&&"none"===jQuery.css(elem,"display")},swap=function(elem,options,callback,args){var ret,name,old={};for(name in options)old[name]=elem.style[name],elem.style[name]=options[name];ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret},defaultDisplayMap={};jQuery.fn.extend({show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){return"boolean"==typeof state?state?this.show():this.hide():this.each(function(){isHiddenWithinTree(this)?jQuery(this).show():jQuery(this).hide()})}});var rcheckableType=/^(?:checkbox|radio)$/i,rtagName=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,rscriptType=/^$|\/(?:java|ecma)script/i,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option,wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead,wrapMap.th=wrapMap.td;var rhtml=/<|&#?\w+;/;!function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio"),input.setAttribute("checked","checked"),input.setAttribute("name","t"),div.appendChild(input),support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked,div.innerHTML="<textarea>x</textarea>",support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue}();var documentElement=document.documentElement,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;jQuery.event={global:{},add:function(elem,types,handler,data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(elemData)for(handler.handler&&(handleObjIn=handler,handler=handleObjIn.handler,selector=handleObjIn.selector),selector&&jQuery.find.matchesSelector(documentElement,selector),handler.guid||(handler.guid=jQuery.guid++),(events=elemData.events)||(events=elemData.events={}),(eventHandle=elemData.handle)||(eventHandle=elemData.handle=function(e){return void 0!==jQuery&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,arguments):void 0}),types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type&&(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,special=jQuery.event.special[type]||{},handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn),(handlers=events[type])||(handlers=events[type]=[],handlers.delegateCount=0,special.setup&&!1!==special.setup.call(elem,data,namespaces,eventHandle)||elem.addEventListener&&elem.addEventListener(type,eventHandle)),special.add&&(special.add.call(elem,handleObj),handleObj.handler.guid||(handleObj.handler.guid=handler.guid)),selector?handlers.splice(handlers.delegateCount++,0,handleObj):handlers.push(handleObj),jQuery.event.global[type]=!0)},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(elemData&&(events=elemData.events)){for(types=(types||"").match(rnothtmlwhite)||[""],t=types.length;t--;)if(tmp=rtypenamespace.exec(types[t])||[],type=origType=tmp[1],namespaces=(tmp[2]||"").split(".").sort(),type){for(special=jQuery.event.special[type]||{},type=(selector?special.delegateType:special.bindType)||type,handlers=events[type]||[],tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"),origCount=j=handlers.length;j--;)handleObj=handlers[j],!mappedTypes&&origType!==handleObj.origType||handler&&handler.guid!==handleObj.guid||tmp&&!tmp.test(handleObj.namespace)||selector&&selector!==handleObj.selector&&("**"!==selector||!handleObj.selector)||(handlers.splice(j,1),handleObj.selector&&handlers.delegateCount--,special.remove&&special.remove.call(elem,handleObj));origCount&&!handlers.length&&(special.teardown&&!1!==special.teardown.call(elem,namespaces,elemData.handle)||jQuery.removeEvent(elem,type,elemData.handle),delete events[type])}else for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,!0);jQuery.isEmptyObject(events)&&dataPriv.remove(elem,"handle events")}},dispatch:function(nativeEvent){var i,j,ret,matched,handleObj,handlerQueue,event=jQuery.event.fix(nativeEvent),args=new Array(arguments.length),handlers=(dataPriv.get(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};for(args[0]=event,i=1;i<arguments.length;i++)args[i]=arguments[i];if(event.delegateTarget=this,!special.preDispatch||!1!==special.preDispatch.call(this,event)){for(handlerQueue=jQuery.event.handlers.call(this,event,handlers),i=0;(matched=handlerQueue[i++])&&!event.isPropagationStopped();)for(event.currentTarget=matched.elem,j=0;(handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped();)event.rnamespace&&!event.rnamespace.test(handleObj.namespace)||(event.handleObj=handleObj,event.data=handleObj.data,void 0!==(ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args))&&!1===(event.result=ret)&&(event.preventDefault(),event.stopPropagation()));return special.postDispatch&&special.postDispatch.call(this,event),event.result}},handlers:function(event,handlers){var i,handleObj,sel,matchedHandlers,matchedSelectors,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&!("click"===event.type&&event.button>=1))for(;cur!==this;cur=cur.parentNode||this)if(1===cur.nodeType&&("click"!==event.type||!0!==cur.disabled)){for(matchedHandlers=[],matchedSelectors={},i=0;i<delegateCount;i++)handleObj=handlers[i],sel=handleObj.selector+" ",void 0===matchedSelectors[sel]&&(matchedSelectors[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length),matchedSelectors[sel]&&matchedHandlers.push(handleObj);matchedHandlers.length&&handlerQueue.push({elem:cur,handlers:matchedHandlers})}return cur=this,delegateCount<handlers.length&&handlerQueue.push({elem:cur,handlers:handlers.slice(delegateCount)}),handlerQueue},addProp:function(name,hook){Object.defineProperty(jQuery.Event.prototype,name,{enumerable:!0,configurable:!0,get:jQuery.isFunction(hook)?function(){if(this.originalEvent)return hook(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[name]},set:function(value){Object.defineProperty(this,name,{enumerable:!0,configurable:!0,writable:!0,value:value})}})},fix:function(originalEvent){return originalEvent[jQuery.expando]?originalEvent:new jQuery.Event(originalEvent)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&nodeName(this,"input"))return this.click(),!1},_default:function(event){return nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){void 0!==event.result&&event.originalEvent&&(event.originalEvent.returnValue=event.result)}}}},jQuery.removeEvent=function(elem,type,handle){elem.removeEventListener&&elem.removeEventListener(type,handle)},jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);src&&src.type?(this.originalEvent=src,this.type=src.type,this.isDefaultPrevented=src.defaultPrevented||void 0===src.defaultPrevented&&!1===src.returnValue?returnTrue:returnFalse,this.target=src.target&&3===src.target.nodeType?src.target.parentNode:src.target,this.currentTarget=src.currentTarget,this.relatedTarget=src.relatedTarget):this.type=src,props&&jQuery.extend(this,props),this.timeStamp=src&&src.timeStamp||jQuery.now(),this[jQuery.expando]=!0},jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},jQuery.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(event){var button=event.button;return null==event.which&&rkeyEvent.test(event.type)?null!=event.charCode?event.charCode:event.keyCode:!event.which&&void 0!==button&&rmouseEvent.test(event.type)?1&button?1:2&button?3:4&button?2:0:event.which}},jQuery.event.addProp),jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;return related&&(related===target||jQuery.contains(target,related))||(event.type=handleObj.origType,ret=handleObj.handler.apply(this,arguments),event.type=fix),ret}}}),jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj)return handleObj=types.handleObj,jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler),this;if("object"==typeof types){for(type in types)this.off(type,selector,types[type]);return this}return!1!==selector&&"function"!=typeof selector||(fn=selector,selector=void 0),!1===fn&&(fn=returnFalse),this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(!0),inPage=jQuery.contains(elem.ownerDocument,elem);if(!(support.noCloneChecked||1!==elem.nodeType&&11!==elem.nodeType||jQuery.isXMLDoc(elem)))for(destElements=getAll(clone),srcElements=getAll(elem),i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i]);if(dataAndEvents)if(deepDataAndEvents)for(srcElements=srcElements||getAll(elem),destElements=destElements||getAll(clone),i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],destElements[i]);else cloneCopyEvent(elem,clone);return destElements=getAll(clone,"script"),destElements.length>0&&setGlobalEval(destElements,!inPage&&getAll(elem,"script")),clone},cleanData:function(elems){for(var data,elem,type,special=jQuery.event.special,i=0;void 0!==(elem=elems[i]);i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)special[type]?jQuery.event.remove(elem,type):jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=void 0}elem[dataUser.expando]&&(elem[dataUser.expando]=void 0)}}}),jQuery.fn.extend({detach:function(selector){return remove(this,selector,!0)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return void 0===value?jQuery.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=value)})},null,value,arguments.length)},append:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){manipulationTarget(this,elem).appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,arguments,function(elem){this.parentNode&&this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){for(var elem,i=0;null!=(elem=this[i]);i++)1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.textContent="");return this},clone:function(dataAndEvents,deepDataAndEvents){return dataAndEvents=null!=dataAndEvents&&dataAndEvents,deepDataAndEvents=null==deepDataAndEvents?dataAndEvents:deepDataAndEvents,this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(void 0===value&&1===elem.nodeType)return elem.innerHTML;if("string"==typeof value&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++)elem=this[i]||{},1===elem.nodeType&&(jQuery.cleanData(getAll(elem,!1)),elem.innerHTML=value);elem=0}catch(e){}}elem&&this.empty().append(value)},null,value,arguments.length)},replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;jQuery.inArray(this,ignored)<0&&(jQuery.cleanData(getAll(this)),parent&&parent.replaceChild(elem,this))},ignored)}}),jQuery.each({appendTo:"append",
prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){for(var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;i<=last;i++)elems=i===last?this:this.clone(!0),jQuery(insert[i])[original](elems),push.apply(ret,elems.get());return this.pushStack(ret)}});var rmargin=/^margin/,rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i"),getStyles=function(elem){var view=elem.ownerDocument.defaultView;return view&&view.opener||(view=window),view.getComputedStyle(elem)};!function(){function computeStyleTests(){if(div){div.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",div.innerHTML="",documentElement.appendChild(container);var divStyle=window.getComputedStyle(div);pixelPositionVal="1%"!==divStyle.top,reliableMarginLeftVal="2px"===divStyle.marginLeft,boxSizingReliableVal="4px"===divStyle.width,div.style.marginRight="50%",pixelMarginRightVal="4px"===divStyle.marginRight,documentElement.removeChild(container),div=null}}var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");div.style&&(div.style.backgroundClip="content-box",div.cloneNode(!0).style.backgroundClip="",support.clearCloneStyle="content-box"===div.style.backgroundClip,container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",container.appendChild(div),jQuery.extend(support,{pixelPosition:function(){return computeStyleTests(),pixelPositionVal},boxSizingReliable:function(){return computeStyleTests(),boxSizingReliableVal},pixelMarginRight:function(){return computeStyleTests(),pixelMarginRightVal},reliableMarginLeft:function(){return computeStyleTests(),reliableMarginLeftVal}}))}();var rdisplayswap=/^(none|table(?!-c[ea]).+)/,rcustomProp=/^--/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","Moz","ms"],emptyStyle=document.createElement("div").style;jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return""===ret?"1":ret}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(elem,name,value,extra){if(elem&&3!==elem.nodeType&&8!==elem.nodeType&&elem.style){var ret,type,hooks,origName=jQuery.camelCase(name),isCustomProp=rcustomProp.test(name),style=elem.style;if(isCustomProp||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],void 0===value)return hooks&&"get"in hooks&&void 0!==(ret=hooks.get(elem,!1,extra))?ret:style[name];type=typeof value,"string"===type&&(ret=rcssNum.exec(value))&&ret[1]&&(value=adjustCSS(elem,name,ret),type="number"),null!=value&&value===value&&("number"===type&&(value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px")),support.clearCloneStyle||""!==value||0!==name.indexOf("background")||(style[name]="inherit"),hooks&&"set"in hooks&&void 0===(value=hooks.set(elem,value,extra))||(isCustomProp?style.setProperty(name,value):style[name]=value))}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);return rcustomProp.test(name)||(name=finalPropName(origName)),hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName],hooks&&"get"in hooks&&(val=hooks.get(elem,!0,extra)),void 0===val&&(val=curCSS(elem,name,styles)),"normal"===val&&name in cssNormalTransform&&(val=cssNormalTransform[name]),""===extra||extra?(num=parseFloat(val),!0===extra||isFinite(num)?num||0:val):val}}),jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return!rdisplayswap.test(jQuery.css(elem,"display"))||elem.getClientRects().length&&elem.getBoundingClientRect().width?getWidthOrHeight(elem,name,extra):swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)})},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,"border-box"===jQuery.css(elem,"boxSizing",!1,styles),styles);return subtract&&(matches=rcssNum.exec(value))&&"px"!==(matches[3]||"px")&&(elem.style[name]=value,value=jQuery.css(elem,name)),setPositiveNumber(elem,value,subtract)}}}),jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"}),jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){for(var i=0,expanded={},parts="string"==typeof value?value.split(" "):[value];i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}},rmargin.test(prefix)||(jQuery.cssHooks[prefix+suffix].set=setPositiveNumber)}),jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(Array.isArray(name)){for(styles=getStyles(elem),len=name.length;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],!1,styles);return map}return void 0!==value?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)}}),jQuery.Tween=Tween,Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem,this.prop=prop,this.easing=easing||jQuery.easing._default,this.options=options,this.start=this.now=this.cur(),this.end=end,this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];return this.options.duration?this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration):this.pos=eased=percent,this.now=(this.end-this.start)*eased+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),hooks&&hooks.set?hooks.set(this):Tween.propHooks._default.set(this),this}},Tween.prototype.init.prototype=Tween.prototype,Tween.propHooks={_default:{get:function(tween){var result;return 1!==tween.elem.nodeType||null!=tween.elem[tween.prop]&&null==tween.elem.style[tween.prop]?tween.elem[tween.prop]:(result=jQuery.css(tween.elem,tween.prop,""),result&&"auto"!==result?result:0)},set:function(tween){jQuery.fx.step[tween.prop]?jQuery.fx.step[tween.prop](tween):1!==tween.elem.nodeType||null==tween.elem.style[jQuery.cssProps[tween.prop]]&&!jQuery.cssHooks[tween.prop]?tween.elem[tween.prop]=tween.now:jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}}},Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){tween.elem.nodeType&&tween.elem.parentNode&&(tween.elem[tween.prop]=tween.now)}},jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"},jQuery.fx=Tween.prototype.init,jQuery.fx.step={};var fxNow,inProgress,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);return adjustCSS(tween.elem,prop,rcssNum.exec(value),tween),tween}]},tweener:function(props,callback){jQuery.isFunction(props)?(callback=props,props=["*"]):props=props.match(rnothtmlwhite);for(var prop,index=0,length=props.length;index<length;index++)prop=props[index],Animation.tweeners[prop]=Animation.tweeners[prop]||[],Animation.tweeners[prop].unshift(callback)},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){prepend?Animation.prefilters.unshift(callback):Animation.prefilters.push(callback)}}),jQuery.speed=function(speed,easing,fn){var opt=speed&&"object"==typeof speed?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};return jQuery.fx.off?opt.duration=0:"number"!=typeof opt.duration&&(opt.duration in jQuery.fx.speeds?opt.duration=jQuery.fx.speeds[opt.duration]:opt.duration=jQuery.fx.speeds._default),null!=opt.queue&&!0!==opt.queue||(opt.queue="fx"),opt.old=opt.complete,opt.complete=function(){jQuery.isFunction(opt.old)&&opt.old.call(this),opt.queue&&jQuery.dequeue(this,opt.queue)},opt},jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHiddenWithinTree).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);(empty||dataPriv.get(this,"finish"))&&anim.stop(!0)};return doAnimation.finish=doAnimation,empty||!1===optall.queue?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop,stop(gotoEnd)};return"string"!=typeof type&&(gotoEnd=clearQueue,clearQueue=type,type=void 0),clearQueue&&!1!==type&&this.queue(type||"fx",[]),this.each(function(){var dequeue=!0,index=null!=type&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index)data[index]&&data[index].stop&&stopQueue(data[index]);else for(index in data)data[index]&&data[index].stop&&rrun.test(index)&&stopQueue(data[index]);for(index=timers.length;index--;)timers[index].elem!==this||null!=type&&timers[index].queue!==type||(timers[index].anim.stop(gotoEnd),dequeue=!1,timers.splice(index,1));!dequeue&&gotoEnd||jQuery.dequeue(this,type)})},finish:function(type){return!1!==type&&(type=type||"fx"),this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;for(data.finish=!0,jQuery.queue(this,type,[]),hooks&&hooks.stop&&hooks.stop.call(this,!0),index=timers.length;index--;)timers[index].elem===this&&timers[index].queue===type&&(timers[index].anim.stop(!0),timers.splice(index,1));for(index=0;index<length;index++)queue[index]&&queue[index].finish&&queue[index].finish.call(this);delete data.finish})}}),jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return null==speed||"boolean"==typeof speed?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}}),jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}}),jQuery.timers=[],jQuery.fx.tick=function(){var timer,i=0,timers=jQuery.timers;for(fxNow=jQuery.now();i<timers.length;i++)(timer=timers[i])()||timers[i]!==timer||timers.splice(i--,1);timers.length||jQuery.fx.stop(),fxNow=void 0},jQuery.fx.timer=function(timer){jQuery.timers.push(timer),jQuery.fx.start()},jQuery.fx.interval=13,jQuery.fx.start=function(){inProgress||(inProgress=!0,schedule())},jQuery.fx.stop=function(){inProgress=null},jQuery.fx.speeds={slow:600,fast:200,_default:400},jQuery.fn.delay=function(time,type){return time=jQuery.fx?jQuery.fx.speeds[time]||time:time,type=type||"fx",this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})},function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox",support.checkOn=""!==input.value,support.optSelected=opt.selected,input=document.createElement("input"),input.value="t",input.type="radio",support.radioValue="t"===input.value}();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}}),jQuery.extend({attr:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return void 0===elem.getAttribute?jQuery.prop(elem,name,value):(1===nType&&jQuery.isXMLDoc(elem)||(hooks=jQuery.attrHooks[name.toLowerCase()]||(jQuery.expr.match.bool.test(name)?boolHook:void 0)),void 0!==value?null===value?void jQuery.removeAttr(elem,name):hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:(elem.setAttribute(name,value+""),value):hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:(ret=jQuery.find.attr(elem,name),null==ret?void 0:ret))},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&"radio"===value&&nodeName(elem,"input")){var val=elem.value;return elem.setAttribute("type",value),val&&(elem.value=val),value}}}},removeAttr:function(elem,value){var name,i=0,attrNames=value&&value.match(rnothtmlwhite);if(attrNames&&1===elem.nodeType)for(;name=attrNames[i++];)elem.removeAttribute(name)}}),boolHook={set:function(elem,value,name){return!1===value?jQuery.removeAttr(elem,name):elem.setAttribute(name,name),name}},jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle,lowercaseName=name.toLowerCase();return isXML||(handle=attrHandle[lowercaseName],attrHandle[lowercaseName]=ret,ret=null!=getter(elem,name,isXML)?lowercaseName:null,attrHandle[lowercaseName]=handle),ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}}),jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(3!==nType&&8!==nType&&2!==nType)return 1===nType&&jQuery.isXMLDoc(elem)||(name=jQuery.propFix[name]||name,hooks=jQuery.propHooks[name]),void 0!==value?hooks&&"set"in hooks&&void 0!==(ret=hooks.set(elem,value,name))?ret:elem[name]=value:hooks&&"get"in hooks&&null!==(ret=hooks.get(elem,name))?ret:elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),support.optSelected||(jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;return parent&&parent.parentNode&&parent.parentNode.selectedIndex,null},set:function(elem){var parent=elem.parentNode;parent&&(parent.selectedIndex,parent.parentNode&&parent.parentNode.selectedIndex)}}),jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this}),jQuery.fn.extend({addClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)cur.indexOf(" "+clazz+" ")<0&&(cur+=clazz+" ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if("string"==typeof value&&value)for(classes=value.match(rnothtmlwhite)||[];elem=this[i++];)if(curValue=getClass(elem),cur=1===elem.nodeType&&" "+stripAndCollapse(curValue)+" "){for(j=0;clazz=classes[j++];)for(;cur.indexOf(" "+clazz+" ")>-1;)cur=cur.replace(" "+clazz+" "," ");finalValue=stripAndCollapse(cur),curValue!==finalValue&&elem.setAttribute("class",finalValue)}return this},toggleClass:function(value,stateVal){var type=typeof value;return"boolean"==typeof stateVal&&"string"===type?stateVal?this.addClass(value):this.removeClass(value):jQuery.isFunction(value)?this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)}):this.each(function(){var className,i,self,classNames;if("string"===type)for(i=0,self=jQuery(this),classNames=value.match(rnothtmlwhite)||[];className=classNames[i++];)self.hasClass(className)?self.removeClass(className):self.addClass(className);else void 0!==value&&"boolean"!==type||(className=getClass(this),className&&dataPriv.set(this,"__className__",className),this.setAttribute&&this.setAttribute("class",className||!1===value?"":dataPriv.get(this,"__className__")||""))})},hasClass:function(selector){var className,elem,i=0;for(className=" "+selector+" ";elem=this[i++];)if(1===elem.nodeType&&(" "+stripAndCollapse(getClass(elem))+" ").indexOf(className)>-1)return!0;return!1}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];{if(arguments.length)return isFunction=jQuery.isFunction(value),this.each(function(i){var val;1===this.nodeType&&(val=isFunction?value.call(this,i,jQuery(this).val()):value,null==val?val="":"number"==typeof val?val+="":Array.isArray(val)&&(val=jQuery.map(val,function(value){return null==value?"":value+""})),(hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()])&&"set"in hooks&&void 0!==hooks.set(this,val,"value")||(this.value=val))});if(elem)return(hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()])&&"get"in hooks&&void 0!==(ret=hooks.get(elem,"value"))?ret:(ret=elem.value,"string"==typeof ret?ret.replace(rreturn,""):null==ret?"":ret)}}}),jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return null!=val?val:stripAndCollapse(jQuery.text(elem))}},select:{get:function(elem){var value,option,i,options=elem.options,index=elem.selectedIndex,one="select-one"===elem.type,values=one?null:[],max=one?index+1:options.length;for(i=index<0?max:one?index:0;i<max;i++)if(option=options[i],(option.selected||i===index)&&!option.disabled&&(!option.parentNode.disabled||!nodeName(option.parentNode,"optgroup"))){if(value=jQuery(option).val(),one)return value;values.push(value)}return values},set:function(elem,value){for(var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;i--;)option=options[i],(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)&&(optionSet=!0);return optionSet||(elem.selectedIndex=-1),values}}}}),jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(Array.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>-1}},support.checkOn||(jQuery.valHooks[this].get=function(elem){return null===elem.getAttribute("value")?"on":elem.value})});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];if(cur=tmp=elem=elem||document,3!==elem.nodeType&&8!==elem.nodeType&&!rfocusMorph.test(type+jQuery.event.triggered)&&(type.indexOf(".")>-1&&(namespaces=type.split("."),type=namespaces.shift(),namespaces.sort()),ontype=type.indexOf(":")<0&&"on"+type,event=event[jQuery.expando]?event:new jQuery.Event(type,"object"==typeof event&&event),event.isTrigger=onlyHandlers?2:3,event.namespace=namespaces.join("."),event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,event.result=void 0,event.target||(event.target=elem),data=null==data?[event]:jQuery.makeArray(data,[event]),special=jQuery.event.special[type]||{},onlyHandlers||!special.trigger||!1!==special.trigger.apply(elem,data))){if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){for(bubbleType=special.delegateType||type,rfocusMorph.test(bubbleType+type)||(cur=cur.parentNode);cur;cur=cur.parentNode)eventPath.push(cur),tmp=cur;tmp===(elem.ownerDocument||document)&&eventPath.push(tmp.defaultView||tmp.parentWindow||window)}for(i=0;(cur=eventPath[i++])&&!event.isPropagationStopped();)event.type=i>1?bubbleType:special.bindType||type,handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle"),handle&&handle.apply(cur,data),(handle=ontype&&cur[ontype])&&handle.apply&&acceptData(cur)&&(event.result=handle.apply(cur,data),!1===event.result&&event.preventDefault());return event.type=type,onlyHandlers||event.isDefaultPrevented()||special._default&&!1!==special._default.apply(eventPath.pop(),data)||!acceptData(elem)||ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)&&(tmp=elem[ontype],tmp&&(elem[ontype]=null),jQuery.event.triggered=type,elem[type](),jQuery.event.triggered=void 0,tmp&&(elem[ontype]=tmp)),event.result}},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:!0});jQuery.event.trigger(e,null,elem)}}),jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,!0)}}),jQuery.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}}),jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}}),support.focusin="onfocusin"in window,support.focusin||jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);attaches||doc.addEventListener(orig,handler,!0),dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;attaches?dataPriv.access(doc,fix,attaches):(doc.removeEventListener(orig,handler,!0),dataPriv.remove(doc,fix))}}});var location=window.location,nonce=jQuery.now(),rquery=/\?/;jQuery.parseXML=function(data){var xml;if(!data||"string"!=typeof data)return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=void 0}return xml&&!xml.getElementsByTagName("parsererror").length||jQuery.error("Invalid XML: "+data),xml};var rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,valueOrFunction){var value=jQuery.isFunction(valueOrFunction)?valueOrFunction():valueOrFunction;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(null==value?"":value)};if(Array.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&")},jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return null==val?null:Array.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});var r20=/%20/g,rhash=/#.*$/,rantiCache=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/gm,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href,jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;completed||(completed=!0,timeoutTimer&&window.clearTimeout(timeoutTimer),transport=void 0,responseHeadersString=headers||"",jqXHR.readyState=status>0?4:0,isSuccess=status>=200&&status<300||304===status,responses&&(response=ajaxHandleResponses(s,jqXHR,responses)),response=ajaxConvert(s,response,jqXHR,isSuccess),isSuccess?(s.ifModified&&(modified=jqXHR.getResponseHeader("Last-Modified"),modified&&(jQuery.lastModified[cacheURL]=modified),(modified=jqXHR.getResponseHeader("etag"))&&(jQuery.etag[cacheURL]=modified)),204===status||"HEAD"===s.type?statusText="nocontent":304===status?statusText="notmodified":(statusText=response.state,success=response.data,error=response.error,isSuccess=!error)):(error=statusText,!status&&statusText||(statusText="error",status<0&&(status=0))),jqXHR.status=status,jqXHR.statusText=(nativeStatusText||statusText)+"",isSuccess?deferred.resolveWith(callbackContext,[success,statusText,jqXHR]):deferred.rejectWith(callbackContext,[jqXHR,statusText,error]),jqXHR.statusCode(statusCode),statusCode=void 0,fireGlobals&&globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]),completeDeferred.fireWith(callbackContext,[jqXHR,statusText]),fireGlobals&&(globalEventContext.trigger("ajaxComplete",[jqXHR,s]),--jQuery.active||jQuery.event.trigger("ajaxStop")))}"object"==typeof url&&(options=url,url=void 0),options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,completed,fireGlobals,i,uncached,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(completed){if(!responseHeaders)for(responseHeaders={};match=rheaders.exec(responseHeadersString);)responseHeaders[match[1].toLowerCase()]=match[2];match=responseHeaders[key.toLowerCase()]}return null==match?null:match},getAllResponseHeaders:function(){return completed?responseHeadersString:null},setRequestHeader:function(name,value){return null==completed&&(name=requestHeadersNames[name.toLowerCase()]=requestHeadersNames[name.toLowerCase()]||name,requestHeaders[name]=value),this},overrideMimeType:function(type){return null==completed&&(s.mimeType=type),this},statusCode:function(map){var code;if(map)if(completed)jqXHR.always(map[jqXHR.status]);else for(code in map)statusCode[code]=[statusCode[code],map[code]];return this},abort:function(statusText){var finalText=statusText||strAbort;return transport&&transport.abort(finalText),done(0,finalText),this}};if(deferred.promise(jqXHR),s.url=((url||s.url||location.href)+"").replace(rprotocol,location.protocol+"//"),s.type=options.method||options.type||s.method||s.type,s.dataTypes=(s.dataType||"*").toLowerCase().match(rnothtmlwhite)||[""],null==s.crossDomain){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url,urlAnchor.href=urlAnchor.href,s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!=urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=!0}}if(s.data&&s.processData&&"string"!=typeof s.data&&(s.data=jQuery.param(s.data,s.traditional)),inspectPrefiltersOrTransports(prefilters,s,options,jqXHR),completed)return jqXHR;fireGlobals=jQuery.event&&s.global,fireGlobals&&0==jQuery.active++&&jQuery.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!rnoContent.test(s.type),cacheURL=s.url.replace(rhash,""),s.hasContent?s.data&&s.processData&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&(s.data=s.data.replace(r20,"+")):(uncached=s.url.slice(cacheURL.length),s.data&&(cacheURL+=(rquery.test(cacheURL)?"&":"?")+s.data,delete s.data),!1===s.cache&&(cacheURL=cacheURL.replace(rantiCache,"$1"),uncached=(rquery.test(cacheURL)?"&":"?")+"_="+nonce+++uncached),s.url=cacheURL+uncached),s.ifModified&&(jQuery.lastModified[cacheURL]&&jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]),jQuery.etag[cacheURL]&&jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])),(s.data&&s.hasContent&&!1!==s.contentType||options.contentType)&&jqXHR.setRequestHeader("Content-Type",s.contentType),jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+("*"!==s.dataTypes[0]?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(callbackContext,jqXHR,s)||completed))return jqXHR.abort();if(strAbort="abort",completeDeferred.add(s.complete),jqXHR.done(s.success),jqXHR.fail(s.error),transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR)){if(jqXHR.readyState=1,fireGlobals&&globalEventContext.trigger("ajaxSend",[jqXHR,s]),completed)return jqXHR;s.async&&s.timeout>0&&(timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout));try{completed=!1,transport.send(requestHeaders,done)}catch(e){if(completed)throw e;done(-1,e)}}else done(-1,"No Transport");return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,void 0,callback,"script")}}),jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){return jQuery.isFunction(data)&&(type=type||callback,callback=data,data=void 0),jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}}),jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},jQuery.fn.extend({wrapAll:function(html){var wrap;return this[0]&&(jQuery.isFunction(html)&&(html=html.call(this[0])),wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&wrap.insertBefore(this[0]),wrap.map(function(){for(var elem=this;elem.firstElementChild;)elem=elem.firstElementChild;return elem}).append(this)),this},wrapInner:function(html){
return jQuery.isFunction(html)?this.each(function(i){jQuery(this).wrapInner(html.call(this,i))}):this.each(function(){var self=jQuery(this),contents=self.contents();contents.length?contents.wrapAll(html):self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(selector){return this.parent(selector).not("body").each(function(){jQuery(this).replaceWith(this.childNodes)}),this}}),jQuery.expr.pseudos.hidden=function(elem){return!jQuery.expr.pseudos.visible(elem)},jQuery.expr.pseudos.visible=function(elem){return!!(elem.offsetWidth||elem.offsetHeight||elem.getClientRects().length)},jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported,support.ajax=xhrSupported=!!xhrSupported,jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();if(xhr.open(options.type,options.url,options.async,options.username,options.password),options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];options.mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(options.mimeType),options.crossDomain||headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest");for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){callback&&(callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null,"abort"===type?xhr.abort():"error"===type?"number"!=typeof xhr.status?complete(0,"error"):complete(xhr.status,xhr.statusText):complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,"text"!==(xhr.responseType||"text")||"string"!=typeof xhr.responseText?{binary:xhr.response}:{text:xhr.responseText},xhr.getAllResponseHeaders()))}},xhr.onload=callback(),errorCallback=xhr.onerror=callback("error"),void 0!==xhr.onabort?xhr.onabort=errorCallback:xhr.onreadystatechange=function(){4===xhr.readyState&&window.setTimeout(function(){callback&&errorCallback()})},callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e}},abort:function(){callback&&callback()}}}),jQuery.ajaxPrefilter(function(s){s.crossDomain&&(s.contents.script=!1)}),jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){return jQuery.globalEval(text),text}}}),jQuery.ajaxPrefilter("script",function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET")}),jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove(),callback=null,evt&&complete("error"===evt.type?404:200,evt.type)}),document.head.appendChild(script[0])},abort:function(){callback&&callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;return this[callback]=!0,callback}}),jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=!1!==s.jsonp&&(rjsonp.test(s.url)?"url":"string"==typeof s.data&&0===(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||"jsonp"===s.dataTypes[0])return callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,jsonProp?s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName):!1!==s.jsonp&&(s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName),s.converters["script json"]=function(){return responseContainer||jQuery.error(callbackName+" was not called"),responseContainer[0]},s.dataTypes[0]="json",overwritten=window[callbackName],window[callbackName]=function(){responseContainer=arguments},jqXHR.always(function(){void 0===overwritten?jQuery(window).removeProp(callbackName):window[callbackName]=overwritten,s[callbackName]&&(s.jsonpCallback=originalSettings.jsonpCallback,oldCallbacks.push(callbackName)),responseContainer&&jQuery.isFunction(overwritten)&&overwritten(responseContainer[0]),responseContainer=overwritten=void 0}),"script"}),support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;return body.innerHTML="<form></form><form></form>",2===body.childNodes.length}(),jQuery.parseHTML=function(data,context,keepScripts){if("string"!=typeof data)return[];"boolean"==typeof context&&(keepScripts=context,context=!1);var base,parsed,scripts;return context||(support.createHTMLDocument?(context=document.implementation.createHTMLDocument(""),base=context.createElement("base"),base.href=document.location.href,context.head.appendChild(base)):context=document),parsed=rsingleTag.exec(data),scripts=!keepScripts&&[],parsed?[context.createElement(parsed[1])]:(parsed=buildFragment([data],context,scripts),scripts&&scripts.length&&jQuery(scripts).remove(),jQuery.merge([],parsed.childNodes))},jQuery.fn.load=function(url,params,callback){var selector,type,response,self=this,off=url.indexOf(" ");return off>-1&&(selector=stripAndCollapse(url.slice(off)),url=url.slice(0,off)),jQuery.isFunction(params)?(callback=params,params=void 0):params&&"object"==typeof params&&(type="POST"),self.length>0&&jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments,self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(this,response||[jqXHR.responseText,status,jqXHR])})}),this},jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}}),jQuery.expr.pseudos.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length},jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};"static"===position&&(elem.style.position="relative"),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=("absolute"===position||"fixed"===position)&&(curCSSTop+curCSSLeft).indexOf("auto")>-1,calculatePosition?(curPosition=curElem.position(),curTop=curPosition.top,curLeft=curPosition.left):(curTop=parseFloat(curCSSTop)||0,curLeft=parseFloat(curCSSLeft)||0),jQuery.isFunction(options)&&(options=options.call(elem,i,jQuery.extend({},curOffset))),null!=options.top&&(props.top=options.top-curOffset.top+curTop),null!=options.left&&(props.left=options.left-curOffset.left+curLeft),"using"in options?options.using.call(elem,props):curElem.css(props)}},jQuery.fn.extend({offset:function(options){if(arguments.length)return void 0===options?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var doc,docElem,rect,win,elem=this[0];if(elem)return elem.getClientRects().length?(rect=elem.getBoundingClientRect(),doc=elem.ownerDocument,docElem=doc.documentElement,win=doc.defaultView,{top:rect.top+win.pageYOffset-docElem.clientTop,left:rect.left+win.pageXOffset-docElem.clientLeft}):{top:0,left:0}},position:function(){if(this[0]){var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};return"fixed"===jQuery.css(elem,"position")?offset=elem.getBoundingClientRect():(offsetParent=this.offsetParent(),offset=this.offset(),nodeName(offsetParent[0],"html")||(parentOffset=offsetParent.offset()),parentOffset={top:parentOffset.top+jQuery.css(offsetParent[0],"borderTopWidth",!0),left:parentOffset.left+jQuery.css(offsetParent[0],"borderLeftWidth",!0)}),{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var offsetParent=this.offsetParent;offsetParent&&"static"===jQuery.css(offsetParent,"position");)offsetParent=offsetParent.offsetParent;return offsetParent||documentElement})}}),jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win;if(jQuery.isWindow(elem)?win=elem:9===elem.nodeType&&(win=elem.defaultView),void 0===val)return win?win[prop]:elem[method];win?win.scrollTo(top?win.pageXOffset:val,top?val:win.pageYOffset):elem[method]=val},method,val,arguments.length)}}),jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed)return computed=curCSS(elem,prop),rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed})}),jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||"boolean"!=typeof margin),extra=defaultExtra||(!0===margin||!0===value?"margin":"border");return access(this,function(elem,type,value){var doc;return jQuery.isWindow(elem)?0===funcName.indexOf("outer")?elem["inner"+name]:elem.document.documentElement["client"+name]:9===elem.nodeType?(doc=elem.documentElement,Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])):void 0===value?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:void 0,chainable)}})}),jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return 1===arguments.length?this.off(selector,"**"):this.off(types,selector||"**",fn)}}),jQuery.holdReady=function(hold){hold?jQuery.readyWait++:jQuery.ready(!0)},jQuery.isArray=Array.isArray,jQuery.parseJSON=JSON.parse,jQuery.nodeName=nodeName,"function"==typeof define&&define.amd&&define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;return jQuery.noConflict=function(deep){return window.$===jQuery&&(window.$=_$),deep&&window.jQuery===jQuery&&(window.jQuery=_jQuery),jQuery},noGlobal||(window.jQuery=window.$=jQuery),jQuery})},{}],56:[function(require,module,exports){(function(process){"use strict";function nextTick(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick}).call(this,require("_process"))},{_process:57}],57:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],58:[function(require,module,exports){(function(global){!function(root){function error(type){throw RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";return parts.length>1&&(result=parts[0]+"@",string=parts[1]),string=string.replace(regexSeparators,"."),result+map(string.split("."),fn).join(".")}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for(basic=input.lastIndexOf(delimiter),basic<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),digit=basicToDigit(input.charCodeAt(index++)),(digit>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(digit<t);k+=base)baseMinusT=base-t,w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT;out=output.length+1,bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(input=ucs2decode(input),inputLength=input.length,n=initialN,delta=0,bias=initialBias,j=0;j<inputLength;++j)(currentValue=input[j])<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)(currentValue=input[j])>=n&&currentValue<m&&(m=currentValue);for(handledCPCountPlusOne=handledCPCount+1,m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if(currentValue=input[j],currentValue<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(q<t);k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;if(punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],59:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],60:[function(require,module,exports){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],61:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":59,"./encode":60}],62:[function(require,module,exports){"use strict";function Duplex(options){if(!(this instanceof Duplex))return new Duplex(options);Readable.call(this,options),Writable.call(this,options),options&&!1===options.readable&&(this.readable=!1),options&&!1===options.writable&&(this.writable=!1),this.allowHalfOpen=!0,options&&!1===options.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(self){self.end()}var processNextTick=require("process-nextick-args"),objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}Object.defineProperty(Duplex.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(value){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=value,this._writableState.destroyed=value)}}),Duplex.prototype._destroy=function(err,cb){this.push(null),this.end(),processNextTick(cb,err)}},{"./_stream_readable":64,"./_stream_writable":66,"core-util-is":13,inherits:52,"process-nextick-args":56}],63:[function(require,module,exports){"use strict";function PassThrough(options){if(!(this instanceof PassThrough))return new PassThrough(options);Transform.call(this,options)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":65,"core-util-is":13,inherits:52}],64:[function(require,module,exports){(function(process,global){"use strict";function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}function prependListener(emitter,event,fn){if("function"==typeof emitter.prependListener)return emitter.prependListener(event,fn);emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn)}function ReadableState(options,stream){Duplex=Duplex||require("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(this instanceof Readable))return new Readable(options);this._readableState=new ReadableState(options,this),this.readable=!0,options&&("function"==typeof options.read&&(this._read=options.read),"function"==typeof options.destroy&&(this._destroy=options.destroy)),Stream.call(this)}function readableAddChunk(stream,chunk,encoding,addToFront,skipChunkCheck){var state=stream._readableState;if(null===chunk)state.reading=!1,onEofChunk(stream,state);else{var er;skipChunkCheck||(er=chunkInvalid(state,chunk)),er?stream.emit("error",er):state.objectMode||chunk&&chunk.length>0?("string"==typeof chunk||state.objectMode||Object.getPrototypeOf(chunk)===Buffer.prototype||(chunk=_uint8ArrayToBuffer(chunk)),addToFront?state.endEmitted?stream.emit("error",new Error("stream.unshift() after end event")):addChunk(stream,state,chunk,!0):state.ended?stream.emit("error",new Error("stream.push() after EOF")):(state.reading=!1,state.decoder&&!encoding?(chunk=state.decoder.write(chunk),state.objectMode||0!==chunk.length?addChunk(stream,state,chunk,!1):maybeReadMore(stream,state)):addChunk(stream,state,chunk,!1))):addToFront||(state.reading=!1)}return needMoreData(state)}function addChunk(stream,state,chunk,addToFront){state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream)),maybeReadMore(stream,state)}function chunkInvalid(state,chunk){var er;return _isUint8Array(chunk)||"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function computeNewHighWaterMark(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!==n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=computeNewHighWaterMark(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){if(0===state.length)return null;var ret;return state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=fromListPartial(n,state.buffer,state.decoder),ret}function fromListPartial(n,list,hasStrings){var ret;return n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list),ret}function copyFromBufferString(n,list){var p=list.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(nb===str.length?ret+=str:ret+=str.slice(0,n),0===(n-=nb)){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=str.slice(nb));break}++c}return list.length-=c,ret}function copyFromBuffer(n,list){var ret=Buffer.allocUnsafe(n),p=list.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),0===(n-=nb)){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=buf.slice(nb));break}++c}return list.length-=c,ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}var processNextTick=require("process-nextick-args");module.exports=Readable;var Duplex,isArray=require("isarray");Readable.ReadableState=ReadableState;var EElistenerCount=(require("events").EventEmitter,function(emitter,type){return emitter.listeners(type).length}),Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList"),destroyImpl=require("./internal/streams/destroy");util.inherits(Readable,Stream);var kProxyEvents=["error","close","destroy","pause","resume"];Object.defineProperty(Readable.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(value){this._readableState&&(this._readableState.destroyed=value)}}),
Readable.prototype.destroy=destroyImpl.destroy,Readable.prototype._undestroy=destroyImpl.undestroy,Readable.prototype._destroy=function(err,cb){this.push(null),cb(err)},Readable.prototype.push=function(chunk,encoding){var skipChunkCheck,state=this._readableState;return state.objectMode?skipChunkCheck=!0:"string"==typeof chunk&&(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=Buffer.from(chunk,encoding),encoding=""),skipChunkCheck=!0),readableAddChunk(this,chunk,encoding,!1,skipChunkCheck)},Readable.prototype.unshift=function(chunk){return readableAddChunk(this,chunk,null,!0,!1)},Readable.prototype.isPaused=function(){return!1===this._readableState.flowing},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(0===(n=howMuchToRead(n,state))&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),state.ended||state.reading?(doRead=!1,debug("reading or ended",doRead)):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state)));var ret;return ret=n>0?fromList(n,state):null,null===ret?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable,unpipeInfo){debug("onunpipe"),readable===src&&unpipeInfo&&!1===unpipeInfo.hasUnpiped&&(unpipeInfo.hasUnpiped=!0,cleanup())}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",unpipe),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata"),increasedAwaitDrain=!1,!1!==dest.write(chunk)||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||state.pipesCount>1&&-1!==indexOf(state.pipes,dest))&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||!1!==pipeOpts.end)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:unpipe;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=!1,increasedAwaitDrain=!1;return src.on("data",ondata),prependListener(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState,unpipeInfo={hasUnpiped:!1};if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this,unpipeInfo),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this,unpipeInfo);return this}var index=indexOf(state.pipes,dest);return-1===index?this:(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this,unpipeInfo),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)!1!==this._readableState.flowing&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){self.push(chunk)||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));for(var n=0;n<kProxyEvents.length;n++)stream.on(kProxyEvents[n],self.emit.bind(self,kProxyEvents[n]));return self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":62,"./internal/streams/BufferList":67,"./internal/streams/destroy":68,"./internal/streams/stream":69,_process:57,"core-util-is":13,events:47,inherits:52,isarray:54,"process-nextick-args":56,"safe-buffer":71,"string_decoder/":76,util:7}],65:[function(require,module,exports){"use strict";function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("write callback called multiple times"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(er,data){done(stream,er,data)}):done(stream)})}function done(stream,er,data){if(er)return stream.emit("error",er);null!==data&&void 0!==data&&stream.push(data);var ws=stream._writableState,ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0},Transform.prototype._destroy=function(err,cb){var _this=this;Duplex.prototype._destroy.call(this,err,function(err2){cb(err2),_this.emit("close")})}},{"./_stream_duplex":62,"core-util-is":13,inherits:52}],66:[function(require,module,exports){(function(process,global){"use strict";function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(){onCorkedFinish(_this,state)}}function _uint8ArrayToBuffer(chunk){return Buffer.from(chunk)}function _isUint8Array(obj){return Buffer.isBuffer(obj)||obj instanceof OurUint8Array}function nop(){}function WritableState(options,stream){Duplex=Duplex||require("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var noDecode=!1===options.decodeStrings;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){if(Duplex=Duplex||require("./_stream_duplex"),!(realHasInstance.call(Writable,this)||this instanceof Duplex))return new Writable(options);this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev),"function"==typeof options.destroy&&(this._destroy=options.destroy),"function"==typeof options.final&&(this._final=options.final)),Stream.call(this)}function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er),processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),processNextTick(cb,er),valid=!1),valid}function decodeChunk(state,chunk,encoding){return state.objectMode||!1===state.decodeStrings||"string"!=typeof chunk||(chunk=Buffer.from(chunk,encoding)),chunk}function writeOrBuffer(stream,state,isBuf,chunk,encoding,cb){if(!isBuf){var newChunk=decodeChunk(state,chunk,encoding);chunk!==newChunk&&(isBuf=!0,encoding="buffer",chunk=newChunk)}var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(ret||(state.needDrain=!0),state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest={chunk:chunk,encoding:encoding,isBuf:isBuf,callback:cb,next:null},last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){--state.pendingcb,sync?(processNextTick(cb,er),processNextTick(finishMaybe,stream,state),stream._writableState.errorEmitted=!0,stream.emit("error",er)):(cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er),finishMaybe(stream,state))}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0,allBuffers=!0;entry;)buffer[count]=entry,entry.isBuf||(allBuffers=!1),entry=entry.next,count+=1;buffer.allBuffers=allBuffers,doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state)}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback;if(doWrite(stream,state,!1,state.objectMode?1:chunk.length,chunk,encoding,cb),entry=entry.next,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequestCount=0,state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function callFinal(stream,state){stream._final(function(err){state.pendingcb--,err&&stream.emit("error",err),state.prefinished=!0,stream.emit("prefinish"),finishMaybe(stream,state)})}function prefinish(stream,state){state.prefinished||state.finalCalled||("function"==typeof stream._final?(state.pendingcb++,state.finalCalled=!0,processNextTick(callFinal,stream,state)):(state.prefinished=!0,stream.emit("prefinish")))}function finishMaybe(stream,state){var need=needFinish(state);return need&&(prefinish(stream,state),0===state.pendingcb&&(state.finished=!0,stream.emit("finish"))),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?processNextTick(cb):stream.once("finish",cb)),state.ended=!0,stream.writable=!1}function onCorkedFinish(corkReq,state,err){var entry=corkReq.entry;for(corkReq.entry=null;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=corkReq:state.corkedRequestsFree=corkReq}var processNextTick=require("process-nextick-args");module.exports=Writable;var Duplex,asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var internalUtil={deprecate:require("util-deprecate")},Stream=require("./internal/streams/stream"),Buffer=require("safe-buffer").Buffer,OurUint8Array=global.Uint8Array||function(){},destroyImpl=require("./internal/streams/destroy");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(_){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||object&&object._writableState instanceof WritableState}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1,isBuf=_isUint8Array(chunk)&&!state.objectMode;return isBuf&&!Buffer.isBuffer(chunk)&&(chunk=_uint8ArrayToBuffer(chunk)),"function"==typeof encoding&&(cb=encoding,encoding=null),isBuf?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?writeAfterEnd(this,cb):(isBuf||validChunk(this,state,chunk,cb))&&(state.pendingcb++,ret=writeOrBuffer(this,state,isBuf,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){this._writableState.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||endWritable(this,state,cb)},Object.defineProperty(Writable.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(value){this._writableState&&(this._writableState.destroyed=value)}}),Writable.prototype.destroy=destroyImpl.destroy,Writable.prototype._undestroy=destroyImpl.undestroy,Writable.prototype._destroy=function(err,cb){this.end(),cb(err)}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_stream_duplex":62,"./internal/streams/destroy":68,"./internal/streams/stream":69,_process:57,"core-util-is":13,inherits:52,"process-nextick-args":56,"safe-buffer":71,"util-deprecate":79}],67:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function copyBuffer(src,target,offset){src.copy(target,offset)}var Buffer=require("safe-buffer").Buffer;module.exports=function(){function BufferList(){_classCallCheck(this,BufferList),this.head=null,this.tail=null,this.length=0}return BufferList.prototype.push=function(v){var entry={data:v,next:null};this.length>0?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return Buffer.alloc(0);if(1===this.length)return this.head.data;for(var ret=Buffer.allocUnsafe(n>>>0),p=this.head,i=0;p;)copyBuffer(p.data,ret,i),i+=p.data.length,p=p.next;return ret},BufferList}()},{"safe-buffer":71}],68:[function(require,module,exports){"use strict";function destroy(err,cb){var _this=this,readableDestroyed=this._readableState&&this._readableState.destroyed,writableDestroyed=this._writableState&&this._writableState.destroyed;if(readableDestroyed||writableDestroyed)return void(cb?cb(err):!err||this._writableState&&this._writableState.errorEmitted||processNextTick(emitErrorNT,this,err));this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(err||null,function(err){!cb&&err?(processNextTick(emitErrorNT,_this,err),_this._writableState&&(_this._writableState.errorEmitted=!0)):cb&&cb(err)})}function undestroy(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function emitErrorNT(self,err){self.emit("error",err)}var processNextTick=require("process-nextick-args");module.exports={destroy:destroy,undestroy:undestroy}},{"process-nextick-args":56}],69:[function(require,module,exports){module.exports=require("events").EventEmitter},{events:47}],70:[function(require,module,exports){exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":62,"./lib/_stream_passthrough.js":63,"./lib/_stream_readable.js":64,"./lib/_stream_transform.js":65,"./lib/_stream_writable.js":66}],71:[function(require,module,exports){function copyProps(src,dst){for(var key in src)dst[key]=src[key]}function SafeBuffer(arg,encodingOrOffset,length){return Buffer(arg,encodingOrOffset,length)}var buffer=require("buffer"),Buffer=buffer.Buffer;Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?module.exports=buffer:(copyProps(buffer,exports),exports.Buffer=SafeBuffer),copyProps(Buffer,SafeBuffer),SafeBuffer.from=function(arg,encodingOrOffset,length){if("number"==typeof arg)throw new TypeError("Argument must not be a number");return Buffer(arg,encodingOrOffset,length)},SafeBuffer.alloc=function(size,fill,encoding){if("number"!=typeof size)throw new TypeError("Argument must be a number");var buf=Buffer(size);return void 0!==fill?"string"==typeof encoding?buf.fill(fill,encoding):buf.fill(fill):buf.fill(0),buf},SafeBuffer.allocUnsafe=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return Buffer(size)},SafeBuffer.allocUnsafeSlow=function(size){if("number"!=typeof size)throw new TypeError("Argument must be a number");return buffer.SlowBuffer(size)}},{buffer:9}],72:[function(require,module,exports){(function(global){var ClientRequest=require("./lib/request"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(opts,cb){opts="string"==typeof opts?url.parse(opts):extend(opts);var defaultProtocol=-1===global.location.protocol.search(/^https?:$/)?"http:":"",protocol=opts.protocol||defaultProtocol,host=opts.hostname||opts.host,port=opts.port,path=opts.path||"/";host&&-1!==host.indexOf(":")&&(host="["+host+"]"),opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path,opts.method=(opts.method||"GET").toUpperCase(),opts.headers=opts.headers||{};var req=new ClientRequest(opts);return cb&&req.on("response",cb),req},http.get=function(opts,cb){var req=http.request(opts,cb);return req.end(),req},http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./lib/request":74,"builtin-status-codes":12,url:10,xtend:82}],73:[function(require,module,exports){(function(global){function getXHR(){if(void 0!==xhr)return xhr;if(global.XMLHttpRequest){xhr=new global.XMLHttpRequest;try{xhr.open("GET",global.XDomainRequest?"/":"https://example.com")}catch(e){xhr=null}}else xhr=null;return xhr}function checkTypeSupport(type){var xhr=getXHR();if(!xhr)return!1;try{return xhr.responseType=type,xhr.responseType===type}catch(e){}return!1}function isFunction(value){return"function"==typeof value}exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableStream),exports.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),exports.blobConstructor=!0}catch(e){}var xhr,haveArrayBuffer=void 0!==global.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);exports.arraybuffer=exports.fetch||haveArrayBuffer&&checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=exports.fetch||!!getXHR()&&isFunction(getXHR().overrideMimeType),exports.vbArray=isFunction(global.VBArray),xhr=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],74:[function(require,module,exports){(function(process,global,Buffer){function decideMode(preferBinary,useFetch){return capability.fetch&&useFetch?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&preferBinary?"arraybuffer":capability.vbArray&&preferBinary?"text:vbarray":"text"}function statusValid(xhr){try{var status=xhr.status;return null!==status&&0!==status}catch(e){return!1}}var capability=require("./capability"),inherits=require("inherits"),response=require("./response"),stream=require("readable-stream"),toArrayBuffer=require("to-arraybuffer"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates,ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self),self._opts=opts,self._body=[],self._headers={},opts.auth&&self.setHeader("Authorization","Basic "+new Buffer(opts.auth).toString("base64")),Object.keys(opts.headers).forEach(function(name){self.setHeader(name,opts.headers[name])});var preferBinary,useFetch=!0;if("disable-fetch"===opts.mode||"timeout"in opts)useFetch=!1,preferBinary=!0;else if("prefer-streaming"===opts.mode)preferBinary=!1;else if("allow-wrong-content-type"===opts.mode)preferBinary=!capability.overrideMimeType;else{if(opts.mode&&"default"!==opts.mode&&"prefer-fast"!==opts.mode)throw new Error("Invalid value for opts.mode");preferBinary=!0}self._mode=decideMode(preferBinary,useFetch),self.on("finish",function(){self._onFinish()})};inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(name,value){var self=this,lowerName=name.toLowerCase();-1===unsafeHeaders.indexOf(lowerName)&&(self._headers[lowerName]={name:name,value:value})},ClientRequest.prototype.getHeader=function(name){var header=this._headers[name.toLowerCase()];return header?header.value:null},ClientRequest.prototype.removeHeader=function(name){delete this._headers[name.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var self=this;if(!self._destroyed){var opts=self._opts,headersObj=self._headers,body=null;"GET"!==opts.method&&"HEAD"!==opts.method&&(body=capability.blobConstructor?new global.Blob(self._body.map(function(buffer){return toArrayBuffer(buffer)}),{type:(headersObj["content-type"]||{}).value||""}):Buffer.concat(self._body).toString());var headersList=[];if(Object.keys(headersObj).forEach(function(keyName){var name=headersObj[keyName].name,value=headersObj[keyName].value;Array.isArray(value)?value.forEach(function(v){headersList.push([name,v])}):headersList.push([name,value])}),"fetch"===self._mode)global.fetch(self._opts.url,{method:self._opts.method,headers:headersList,body:body||void 0,mode:"cors",credentials:opts.withCredentials?"include":"same-origin"}).then(function(response){self._fetchResponse=response,self._connect()},function(reason){self.emit("error",reason)});else{var xhr=self._xhr=new global.XMLHttpRequest;try{xhr.open(self._opts.method,self._opts.url,!0)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}"responseType"in xhr&&(xhr.responseType=self._mode.split(":")[0]),"withCredentials"in xhr&&(xhr.withCredentials=!!opts.withCredentials),"text"===self._mode&&"overrideMimeType"in xhr&&xhr.overrideMimeType("text/plain; charset=x-user-defined"),"timeout"in opts&&(xhr.timeout=opts.timeout,xhr.ontimeout=function(){self.emit("timeout")}),headersList.forEach(function(header){xhr.setRequestHeader(header[0],header[1])}),self._response=null,xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress()}},"moz-chunked-arraybuffer"===self._mode&&(xhr.onprogress=function(){self._onXHRProgress()}),xhr.onerror=function(){self._destroyed||self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}}}},ClientRequest.prototype._onXHRProgress=function(){var self=this;statusValid(self._xhr)&&!self._destroyed&&(self._response||self._connect(),self._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var self=this;self._destroyed||(self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode),self._response.on("error",function(err){self.emit("error",err)}),self.emit("response",self._response))},ClientRequest.prototype._write=function(chunk,encoding,cb){this._body.push(chunk),cb()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var self=this;self._destroyed=!0,self._response&&(self._response._destroyed=!0),self._xhr&&self._xhr.abort()},ClientRequest.prototype.end=function(data,encoding,cb){var self=this;"function"==typeof data&&(cb=data,data=void 0),stream.Writable.prototype.end.call(self,data,encoding,cb)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){}
;var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":73,"./response":75,_process:57,buffer:9,inherits:52,"readable-stream":70,"to-arraybuffer":77}],75:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability"),inherits=require("inherits"),stream=require("readable-stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(xhr,response,mode){function read(){reader.read().then(function(result){if(!self._destroyed){if(result.done)return void self.push(null);self.push(new Buffer(result.value)),read()}}).catch(function(err){self.emit("error",err)})}var self=this;if(stream.Readable.call(self),self._mode=mode,self.headers={},self.rawHeaders=[],self.trailers={},self.rawTrailers=[],self.on("end",function(){process.nextTick(function(){self.emit("close")})}),"fetch"===mode){self._fetchResponse=response,self.url=response.url,self.statusCode=response.status,self.statusMessage=response.statusText,response.headers.forEach(function(header,key){self.headers[key.toLowerCase()]=header,self.rawHeaders.push(key,header)});var reader=response.body.getReader();read()}else{self._xhr=xhr,self._pos=0,self.url=xhr.responseURL,self.statusCode=xhr.status,self.statusMessage=xhr.statusText;if(xhr.getAllResponseHeaders().split(/\r?\n/).forEach(function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();"set-cookie"===key?(void 0===self.headers[key]&&(self.headers[key]=[]),self.headers[key].push(matches[2])):void 0!==self.headers[key]?self.headers[key]+=", "+matches[2]:self.headers[key]=matches[2],self.rawHeaders.push(matches[1],matches[2])}}),self._charset="x-user-defined",!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);charsetMatch&&(self._charset=charsetMatch[1].toLowerCase())}self._charset||(self._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){},IncomingMessage.prototype._onXHRProgress=function(){var self=this,xhr=self._xhr,response=null;switch(self._mode){case"text:vbarray":if(xhr.readyState!==rStates.DONE)break;try{response=new global.VBArray(xhr.responseBody).toArray()}catch(e){}if(null!==response){self.push(new Buffer(response));break}case"text":try{response=xhr.responseText}catch(e){self._mode="text:vbarray";break}if(response.length>self._pos){var newData=response.substr(self._pos);if("x-user-defined"===self._charset){for(var buffer=new Buffer(newData.length),i=0;i<newData.length;i++)buffer[i]=255&newData.charCodeAt(i);self.push(buffer)}else self.push(newData,self._charset);self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE||!xhr.response)break;response=xhr.response,self.push(new Buffer(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":if(response=xhr.response,xhr.readyState!==rStates.LOADING||!response)break;self.push(new Buffer(new Uint8Array(response)));break;case"ms-stream":if(response=xhr.response,xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader;reader.onprogress=function(){reader.result.byteLength>self._pos&&(self.push(new Buffer(new Uint8Array(reader.result.slice(self._pos)))),self._pos=reader.result.byteLength)},reader.onload=function(){self.push(null)},reader.readAsArrayBuffer(response)}self._xhr.readyState===rStates.DONE&&"ms-stream"!==self._mode&&self.push(null)}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":73,_process:57,buffer:9,inherits:52,"readable-stream":70}],76:[function(require,module,exports){"use strict";function _normalizeEncoding(enc){if(!enc)return"utf8";for(var retried;;)switch(enc){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return enc;default:if(retried)return;enc=(""+enc).toLowerCase(),retried=!0}}function normalizeEncoding(enc){var nenc=_normalizeEncoding(enc);if("string"!=typeof nenc&&(Buffer.isEncoding===isEncoding||!isEncoding(enc)))throw new Error("Unknown encoding: "+enc);return nenc||enc}function StringDecoder(encoding){this.encoding=normalizeEncoding(encoding);var nb;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,nb=4;break;case"utf8":this.fillLast=utf8FillLast,nb=4;break;case"base64":this.text=base64Text,this.end=base64End,nb=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(nb)}function utf8CheckByte(byte){return byte<=127?0:byte>>5==6?2:byte>>4==14?3:byte>>3==30?4:-1}function utf8CheckIncomplete(self,buf,i){var j=buf.length-1;if(j<i)return 0;var nb=utf8CheckByte(buf[j]);return nb>=0?(nb>0&&(self.lastNeed=nb-1),nb):--j<i?0:(nb=utf8CheckByte(buf[j]))>=0?(nb>0&&(self.lastNeed=nb-2),nb):--j<i?0:(nb=utf8CheckByte(buf[j]),nb>=0?(nb>0&&(2===nb?nb=0:self.lastNeed=nb-3),nb):0)}function utf8CheckExtraBytes(self,buf,p){if(128!=(192&buf[0]))return self.lastNeed=0,"".repeat(p);if(self.lastNeed>1&&buf.length>1){if(128!=(192&buf[1]))return self.lastNeed=1,"".repeat(p+1);if(self.lastNeed>2&&buf.length>2&&128!=(192&buf[2]))return self.lastNeed=2,"".repeat(p+2)}}function utf8FillLast(buf){var p=this.lastTotal-this.lastNeed,r=utf8CheckExtraBytes(this,buf,p);return void 0!==r?r:this.lastNeed<=buf.length?(buf.copy(this.lastChar,p,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(buf.copy(this.lastChar,p,0,buf.length),void(this.lastNeed-=buf.length))}function utf8Text(buf,i){var total=utf8CheckIncomplete(this,buf,i);if(!this.lastNeed)return buf.toString("utf8",i);this.lastTotal=total;var end=buf.length-(total-this.lastNeed);return buf.copy(this.lastChar,0,end),buf.toString("utf8",i,end)}function utf8End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+"".repeat(this.lastTotal-this.lastNeed):r}function utf16Text(buf,i){if((buf.length-i)%2==0){var r=buf.toString("utf16le",i);if(r){var c=r.charCodeAt(r.length-1);if(c>=55296&&c<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=buf[buf.length-1],buf.toString("utf16le",i,buf.length-1)}function utf16End(buf){var r=buf&&buf.length?this.write(buf):"";if(this.lastNeed){var end=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,end)}return r}function base64Text(buf,i){var n=(buf.length-i)%3;return 0===n?buf.toString("base64",i):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=buf[buf.length-1]:(this.lastChar[0]=buf[buf.length-2],this.lastChar[1]=buf[buf.length-1]),buf.toString("base64",i,buf.length-n))}function base64End(buf){var r=buf&&buf.length?this.write(buf):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(buf){return buf.toString(this.encoding)}function simpleEnd(buf){return buf&&buf.length?this.write(buf):""}var Buffer=require("safe-buffer").Buffer,isEncoding=Buffer.isEncoding||function(encoding){switch((encoding=""+encoding)&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};exports.StringDecoder=StringDecoder,StringDecoder.prototype.write=function(buf){if(0===buf.length)return"";var r,i;if(this.lastNeed){if(void 0===(r=this.fillLast(buf)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<buf.length?r?r+this.text(buf,i):this.text(buf,i):r||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(buf){if(this.lastNeed<=buf.length)return buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);buf.copy(this.lastChar,this.lastTotal-this.lastNeed,0,buf.length),this.lastNeed-=buf.length}},{"safe-buffer":71}],77:[function(require,module,exports){var Buffer=require("buffer").Buffer;module.exports=function(buf){if(buf instanceof Uint8Array){if(0===buf.byteOffset&&buf.byteLength===buf.buffer.byteLength)return buf.buffer;if("function"==typeof buf.buffer.slice)return buf.buffer.slice(buf.byteOffset,buf.byteOffset+buf.byteLength)}if(Buffer.isBuffer(buf)){for(var arrayCopy=new Uint8Array(buf.length),len=buf.length,i=0;i<len;i++)arrayCopy[i]=buf[i];return arrayCopy.buffer}throw new Error("Argument must be a Buffer")}},{buffer:9}],78:[function(require,module,exports){(function(global){var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault;!function(factory){function createExporter(exports,previous){return exports!==root&&("function"==typeof Object.create?Object.defineProperty(exports,"__esModule",{value:!0}):exports.__esModule=!0),function(id,v){return exports[id]=previous?previous(id,v):v}}var root="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};"function"==typeof define&&define.amd?define("tslib",["exports"],function(exports){factory(createExporter(root,createExporter(exports)))}):factory("object"==typeof module&&"object"==typeof module.exports?createExporter(root,createExporter(module.exports)):createExporter(root))}(function(exporter){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};__extends=function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)},__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p])}return t},__rest=function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&(t[p[i]]=s[p[i]]);return t},__decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__param=function(paramIndex,decorator){return function(target,key){decorator(target,key,paramIndex)}},__metadata=function(metadataKey,metadataValue){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(metadataKey,metadataValue)},__awaiter=function(thisArg,_arguments,P,generator){return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):new P(function(resolve){resolve(result.value)}).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})},__generator=function(thisArg,body){function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=y[2&op[0]?"return":op[0]?"throw":"next"])&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[0,t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(t=_.trys,!(t=t.length>0&&t[t.length-1])&&(6===op[0]||2===op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g},__exportStar=function(m,exports){for(var p in m)exports.hasOwnProperty(p)||(exports[p]=m[p])},__values=function(o){var m="function"==typeof Symbol&&o[Symbol.iterator],i=0;return m?m.call(o):{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}}},__read=function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__spread=function(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar},__await=function(v){return this instanceof __await?(this.v=v,this):new __await(v)},__asyncGenerator=function(thisArg,_arguments,generator){function verb(n){g[n]&&(i[n]=function(v){return new Promise(function(a,b){q.push([n,v,a,b])>1||resume(n,v)})})}function resume(n,v){try{step(g[n](v))}catch(e){settle(q[0][3],e)}}function step(r){r.value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(q[0][2],r)}function fulfill(value){resume("next",value)}function reject(value){resume("throw",value)}function settle(f,v){f(v),q.shift(),q.length&&resume(q[0][0],q[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,g=generator.apply(thisArg,_arguments||[]),q=[];return i={},verb("next"),verb("throw"),verb("return"),i[Symbol.asyncIterator]=function(){return this},i},__asyncDelegator=function(o){function verb(n,f){o[n]&&(i[n]=function(v){return(p=!p)?{value:__await(o[n](v)),done:"return"===n}:f?f(v):v})}var i,p;return i={},verb("next"),verb("throw",function(e){throw e}),verb("return"),i[Symbol.iterator]=function(){return this},i},__asyncValues=function(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m=o[Symbol.asyncIterator];return m?m.call(o):"function"==typeof __values?__values(o):o[Symbol.iterator]()},__makeTemplateObject=function(cooked,raw){return Object.defineProperty?Object.defineProperty(cooked,"raw",{value:raw}):cooked.raw=raw,cooked},__importStar=function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)Object.hasOwnProperty.call(mod,k)&&(result[k]=mod[k]);return result.default=mod,result},__importDefault=function(mod){return mod&&mod.__esModule?mod:{default:mod}},exporter("__extends",__extends),exporter("__assign",__assign),exporter("__rest",__rest),exporter("__decorate",__decorate),exporter("__param",__param),exporter("__metadata",__metadata),exporter("__awaiter",__awaiter),exporter("__generator",__generator),exporter("__exportStar",__exportStar),exporter("__values",__values),exporter("__read",__read),exporter("__spread",__spread),exporter("__await",__await),exporter("__asyncGenerator",__asyncGenerator),exporter("__asyncDelegator",__asyncDelegator),exporter("__asyncValues",__asyncValues),exporter("__makeTemplateObject",__makeTemplateObject),exporter("__importStar",__importStar),exporter("__importDefault",__importDefault)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],79:[function(require,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],80:[function(require,module,exports){!function(self){"use strict";function normalizeName(name){if("string"!=typeof name&&(name=String(name)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name))throw new TypeError("Invalid character in header field name");return name.toLowerCase()}function normalizeValue(value){return"string"!=typeof value&&(value=String(value)),value}function iteratorFor(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return support.iterable&&(iterator[Symbol.iterator]=function(){return iterator}),iterator}function Headers(headers){this.map={},headers instanceof Headers?headers.forEach(function(value,name){this.append(name,value)},this):Array.isArray(headers)?headers.forEach(function(header){this.append(header[0],header[1])},this):headers&&Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name])},this)}function consumed(body){if(body.bodyUsed)return Promise.reject(new TypeError("Already read"));body.bodyUsed=!0}function fileReaderReady(reader){return new Promise(function(resolve,reject){reader.onload=function(){resolve(reader.result)},reader.onerror=function(){reject(reader.error)}})}function readBlobAsArrayBuffer(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsArrayBuffer(blob),promise}function readBlobAsText(blob){var reader=new FileReader,promise=fileReaderReady(reader);return reader.readAsText(blob),promise}function readArrayBufferAsText(buf){for(var view=new Uint8Array(buf),chars=new Array(view.length),i=0;i<view.length;i++)chars[i]=String.fromCharCode(view[i]);return chars.join("")}function bufferClone(buf){if(buf.slice)return buf.slice(0);var view=new Uint8Array(buf.byteLength);return view.set(new Uint8Array(buf)),view.buffer}function Body(){return this.bodyUsed=!1,this._initBody=function(body){if(this._bodyInit=body,body)if("string"==typeof body)this._bodyText=body;else if(support.blob&&Blob.prototype.isPrototypeOf(body))this._bodyBlob=body;else if(support.formData&&FormData.prototype.isPrototypeOf(body))this._bodyFormData=body;else if(support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body))this._bodyText=body.toString();else if(support.arrayBuffer&&support.blob&&isDataView(body))this._bodyArrayBuffer=bufferClone(body.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!support.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(body)&&!isArrayBufferView(body))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=bufferClone(body)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof body?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):support.searchParams&&URLSearchParams.prototype.isPrototypeOf(body)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},support.blob&&(this.blob=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?consumed(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(readBlobAsArrayBuffer)}),this.text=function(){var rejected=consumed(this);if(rejected)return rejected;if(this._bodyBlob)return readBlobAsText(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},support.formData&&(this.formData=function(){return this.text().then(decode)}),this.json=function(){return this.text().then(JSON.parse)},this}function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method}function Request(input,options){options=options||{};var body=options.body;if(input instanceof Request){if(input.bodyUsed)throw new TypeError("Already read");this.url=input.url,this.credentials=input.credentials,options.headers||(this.headers=new Headers(input.headers)),this.method=input.method,this.mode=input.mode,body||null==input._bodyInit||(body=input._bodyInit,input.bodyUsed=!0)}else this.url=String(input);if(this.credentials=options.credentials||this.credentials||"omit",!options.headers&&this.headers||(this.headers=new Headers(options.headers)),this.method=normalizeMethod(options.method||this.method||"GET"),this.mode=options.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(body)}function decode(body){var form=new FormData;return body.trim().split("&").forEach(function(bytes){if(bytes){var split=bytes.split("="),name=split.shift().replace(/\+/g," "),value=split.join("=").replace(/\+/g," ");form.append(decodeURIComponent(name),decodeURIComponent(value))}}),form}function parseHeaders(rawHeaders){var headers=new Headers;return rawHeaders.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(line){var parts=line.split(":"),key=parts.shift().trim();if(key){var value=parts.join(":").trim();headers.append(key,value)}}),headers}function Response(bodyInit,options){options||(options={}),this.type="default",this.status=void 0===options.status?200:options.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in options?options.statusText:"OK",this.headers=new Headers(options.headers),this.url=options.url||"",this._initBody(bodyInit)}if(!self.fetch){var support={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(support.arrayBuffer)var viewClasses=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],isDataView=function(obj){return obj&&DataView.prototype.isPrototypeOf(obj)},isArrayBufferView=ArrayBuffer.isView||function(obj){return obj&&viewClasses.indexOf(Object.prototype.toString.call(obj))>-1};Headers.prototype.append=function(name,value){name=normalizeName(name),value=normalizeValue(value);var oldValue=this.map[name];this.map[name]=oldValue?oldValue+","+value:value},Headers.prototype.delete=function(name){delete this.map[normalizeName(name)]},Headers.prototype.get=function(name){return name=normalizeName(name),this.has(name)?this.map[name]:null},Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name))},Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=normalizeValue(value)},Headers.prototype.forEach=function(callback,thisArg){for(var name in this.map)this.map.hasOwnProperty(name)&&callback.call(thisArg,this.map[name],name,this)},Headers.prototype.keys=function(){var items=[];return this.forEach(function(value,name){items.push(name)}),iteratorFor(items)},Headers.prototype.values=function(){var items=[];return this.forEach(function(value){items.push(value)}),iteratorFor(items)},Headers.prototype.entries=function(){var items=[];return this.forEach(function(value,name){items.push([name,value])}),iteratorFor(items)},support.iterable&&(Headers.prototype[Symbol.iterator]=Headers.prototype.entries);var methods=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];Request.prototype.clone=function(){return new Request(this,{body:this._bodyInit})},Body.call(Request.prototype),Body.call(Response.prototype),Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url})},Response.error=function(){var response=new Response(null,{status:0,statusText:""});return response.type="error",response};var redirectStatuses=[301,302,303,307,308];Response.redirect=function(url,status){if(-1===redirectStatuses.indexOf(status))throw new RangeError("Invalid status code");return new Response(null,{status:status,headers:{location:url}})},self.Headers=Headers,self.Request=Request,self.Response=Response,self.fetch=function(input,init){return new Promise(function(resolve,reject){var request=new Request(input,init),xhr=new XMLHttpRequest;xhr.onload=function(){var options={status:xhr.status,statusText:xhr.statusText,headers:parseHeaders(xhr.getAllResponseHeaders()||"")};options.url="responseURL"in xhr?xhr.responseURL:options.headers.get("X-Request-URL");var body="response"in xhr?xhr.response:xhr.responseText;resolve(new Response(body,options))},xhr.onerror=function(){reject(new TypeError("Network request failed"))},xhr.ontimeout=function(){reject(new TypeError("Network request failed"))},xhr.open(request.method,request.url,!0),"include"===request.credentials?xhr.withCredentials=!0:"omit"===request.credentials&&(xhr.withCredentials=!1),"responseType"in xhr&&support.blob&&(xhr.responseType="blob"),request.headers.forEach(function(value,name){xhr.setRequestHeader(name,value)}),xhr.send(void 0===request._bodyInit?null:request._bodyInit)})},self.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}],81:[function(require,module,exports){(function(process,Buffer){var Url=require("url"),spawn=require("child_process").spawn,fs=require("fs");exports.XMLHttpRequest=function(){"use strict";var request,response,self=this,http=require("http"),https=require("https"),settings={},disableHeaderCheck=!1,defaultHeaders={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},headers={},headersCase={},forbiddenRequestHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],forbiddenRequestMethods=["TRACE","TRACK","CONNECT"],sendFlag=!1,errorFlag=!1,listeners={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;var isAllowedHttpHeader=function(header){return disableHeaderCheck||header&&-1===forbiddenRequestHeaders.indexOf(header.toLowerCase())},isAllowedHttpMethod=function(method){return method&&-1===forbiddenRequestMethods.indexOf(method)};this.open=function(method,url,async,user,password){if(this.abort(),errorFlag=!1,!isAllowedHttpMethod(method))throw new Error("SecurityError: Request method not allowed");settings={method:method,url:url.toString(),async:"boolean"!=typeof async||async,user:user||null,password:password||null},setState(this.OPENED)},this.setDisableHeaderCheck=function(state){disableHeaderCheck=state},this.setRequestHeader=function(header,value){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(!isAllowedHttpHeader(header))return void console.warn('Refused to set unsafe header "'+header+'"');if(sendFlag)throw new Error("INVALID_STATE_ERR: send flag is true");header=headersCase[header.toLowerCase()]||header,headersCase[header.toLowerCase()]=header,headers[header]=headers[header]?headers[header]+", "+value:value},this.getResponseHeader=function(header){return"string"==typeof header&&this.readyState>this.OPENED&&response&&response.headers&&response.headers[header.toLowerCase()]&&!errorFlag?response.headers[header.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||errorFlag)return"";var result="";for(var i in response.headers)"set-cookie"!==i&&"set-cookie2"!==i&&(result+=i+": "+response.headers[i]+"\r\n");return result.substr(0,result.length-2)},this.getRequestHeader=function(name){return"string"==typeof name&&headersCase[name.toLowerCase()]?headers[headersCase[name.toLowerCase()]]:""},this.send=function(data){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(sendFlag)throw new Error("INVALID_STATE_ERR: send has already been called");var host,ssl=!1,local=!1,url=Url.parse(settings.url);switch(url.protocol){case"https:":ssl=!0;case"http:":host=url.hostname;break;case"file:":local=!0;break;case void 0:case null:case"":host="localhost";break;default:throw new Error("Protocol not supported.")}if(local){if("GET"!==settings.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(settings.async)fs.readFile(url.pathname,"utf8",function(error,data){error?self.handleError(error):(self.status=200,self.responseText=data,setState(self.DONE))});else try{this.responseText=fs.readFileSync(url.pathname,"utf8"),this.status=200,setState(self.DONE)}catch(e){this.handleError(e)}}else{var port=url.port||(ssl?443:80),uri=url.pathname+(url.search?url.search:"");for(var name in defaultHeaders)headersCase[name.toLowerCase()]||(headers[name]=defaultHeaders[name]);if(headers.Host=host,ssl&&443===port||80===port||(headers.Host+=":"+url.port),settings.user){void 0===settings.password&&(settings.password="");var authBuf=new Buffer(settings.user+":"+settings.password);headers.Authorization="Basic "+authBuf.toString("base64")}"GET"===settings.method||"HEAD"===settings.method?data=null:data?(headers["Content-Length"]=Buffer.isBuffer(data)?data.length:Buffer.byteLength(data),headers["Content-Type"]||(headers["Content-Type"]="text/plain;charset=UTF-8")):"POST"===settings.method&&(headers["Content-Length"]=0);var options={host:host,port:port,path:uri,method:settings.method,headers:headers,agent:!1,withCredentials:self.withCredentials};if(errorFlag=!1,settings.async){var doRequest=ssl?https.request:http.request;sendFlag=!0,self.dispatchEvent("readystatechange");var responseHandler=function responseHandler(resp){if(response=resp,301===response.statusCode||302===response.statusCode||303===response.statusCode||307===response.statusCode){settings.url=response.headers.location;var url=Url.parse(settings.url);host=url.hostname;var newOptions={hostname:url.hostname,port:url.port,path:url.path,method:303===response.statusCode?"GET":settings.method,headers:headers,withCredentials:self.withCredentials};return request=doRequest(newOptions,responseHandler).on("error",errorHandler),void request.end()}response.setEncoding("utf8"),setState(self.HEADERS_RECEIVED),self.status=response.statusCode,response.on("data",function(chunk){chunk&&(self.responseText+=chunk),sendFlag&&setState(self.LOADING)}),response.on("end",function(){sendFlag&&(setState(self.DONE),sendFlag=!1)}),response.on("error",function(error){self.handleError(error)})},errorHandler=function(error){self.handleError(error)}
;request=doRequest(options,responseHandler).on("error",errorHandler),data&&request.write(data),request.end(),self.dispatchEvent("loadstart")}else{var contentFile=".node-xmlhttprequest-content-"+process.pid,syncFile=".node-xmlhttprequest-sync-"+process.pid;fs.writeFileSync(syncFile,"","utf8");for(var execString="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(ssl?"s":"")+".request;var options = "+JSON.stringify(options)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+contentFile+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+syncFile+"');});response.on('error', function(error) {fs.writeFileSync('"+contentFile+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+syncFile+"');});}).on('error', function(error) {fs.writeFileSync('"+contentFile+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+syncFile+"');});"+(data?"req.write('"+JSON.stringify(data).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",syncProc=spawn(process.argv[0],["-e",execString]);fs.existsSync(syncFile););var resp=JSON.parse(fs.readFileSync(contentFile,"utf8"));syncProc.stdin.end(),fs.unlinkSync(contentFile),resp.err?self.handleError(resp.err):(response=resp.data,self.status=resp.data.statusCode,self.responseText=resp.data.text,setState(self.DONE))}}},this.handleError=function(error){this.status=0,this.statusText=error,this.responseText=error.stack,errorFlag=!0,setState(this.DONE),this.dispatchEvent("error")},this.abort=function(){request&&(request.abort(),request=null),headers=defaultHeaders,this.status=0,this.responseText="",this.responseXML="",errorFlag=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!sendFlag||this.readyState===this.DONE||(sendFlag=!1,setState(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(event,callback){event in listeners||(listeners[event]=[]),listeners[event].push(callback)},this.removeEventListener=function(event,callback){event in listeners&&(listeners[event]=listeners[event].filter(function(ev){return ev!==callback}))},this.dispatchEvent=function(event){if("function"==typeof self["on"+event]&&self["on"+event](),event in listeners)for(var i=0,len=listeners[event].length;i<len;i++)listeners[event][i].call(self)};var setState=function(state){state!=self.LOADING&&self.readyState===state||(self.readyState=state,(settings.async||self.readyState<self.OPENED||self.readyState===self.DONE)&&self.dispatchEvent("readystatechange"),self.readyState!==self.DONE||errorFlag||(self.dispatchEvent("load"),self.dispatchEvent("loadend")))}}}).call(this,require("_process"),require("buffer").Buffer)},{_process:57,buffer:9,child_process:8,fs:8,http:72,https:50,url:10}],82:[function(require,module,exports){function extend(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty},{}],83:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function findData(aid,radioValue){var chartableAid=aid.yearly_data.slice(2,9).reverse();return"aid_amt"===radioValue?chartableAid.map(function(year){return(0,_jquery2.default)("#aid-placeholder").hide(),{timescale:year.year,otherGrants:year.avg_amount_other_grant_aid_first_time_full_time_undergrad,pellGrants:year.avg_amount_pell_grants_first_time_full_time_undergrad,fedLoans:year.avg_amount_federal_loans_first_time_full_time_undergrad}}):chartableAid.map(function(year){return(0,_jquery2.default)("#aid-placeholder").hide(),{timescale:year.year,otherGrants:year.perc_first_time_full_time_undergrad_other_grant_aid,pellGrants:year.perc_pell_grants_first_time_full_time_undergrad,fedLoans:year.perc_federal_loans_first_time_full_time_undergrad}})}function isitChartable(data){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var d=_step.value;if(d.fedLoans||d.otherGrants||d.pellGrants)return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function runData(datafile,radioValue){function mouseover(){focus.style("display",null),d3.selectAll("#aid-chart .points text").style("display",null)}function mouseout(){focus.style("display","none"),d3.selectAll("#aid-chart .points text").style("display","none")}function mousemove(){(0,_tooltip2.default)("#aid-chart",this,timeScales,datafile,x,y,z,focus,"aid_amt"!==radioValue)}isitChartable(datafile)||((0,_jquery2.default)("#aid-container").hide(),(0,_jquery2.default)("#aid-placeholder").show());var window_width=(0,_jquery2.default)(window).width(),fullWidth=void 0;window_width>=650?fullWidth=600:window_width<=350?fullWidth=300:fullWidth=window_width-50;var commas=d3.format(","),margin={top:20,right:20,bottom:30,left:50},svg=d3.select("#aid-chart"),width=fullWidth-margin.left-margin.right,height=(0,_jquery2.default)("#retention-chart").height()-margin.top-margin.bottom,g=svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),x=d3.scaleBand().rangeRound([0,width]).padding(1),y=d3.scaleLinear().rangeRound([height,0]),z=d3.scaleOrdinal(["#036888","#D2392A","#DAA520"]),line=d3.line().x(function(d){return x(d.timescale)}).y(function(d){return y(d.total)});z.domain(d3.keys(datafile[0]).filter(function(key){return"timescale"!==key}));var trends=z.domain().map(function(name){return{name:name,values:datafile.map(function(d){return{timescale:d.timescale,total:+d[name]}})}});x.domain(datafile.map(function(d){return d.timescale})),y.domain([0,d3.max(trends,function(c){return d3.max(c.values,function(v){return v.total})})]).nice();var newTrends=trends.map(function(rate){return rate.values=rate.values.filter(function(item){return!isNaN(item.total)}),rate});x.domain(newTrends[0].values.map(function(d){return d.timescale})),y.domain([0,d3.max(newTrends,function(c){return d3.max(c.values,function(v){return v.total})})]);var trend=g.selectAll(".trend").data(newTrends).enter().append("g").attr("class","trend");trend.append("path").attr("class","line").attr("d",function(d){for(var keepValues=[],i=0;i<d.values.length;i++)d.values[i].total&&keepValues.push(d.values[i]);return line(keepValues)});g.selectAll(".points").data(trends).enter().append("g").attr("class","points").append("text");trend.style("fill","#FFF").style("stroke",function(d){return z(d.name)}).selectAll("circle.line").data(function(d){for(var keepValues=[],i=0;i<d.values.length;i++)!1===isNaN(d.values[i].total)&&0===d.values[i].total||keepValues.push(d.values[i]);return keepValues}).enter().append("circle").attr("r",3).style("stroke-width",3).attr("cx",function(d){return x(d.timescale)}).attr("cy",function(d){return y(d.total)}),g.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+height+")").call(d3.axisBottom(x)),g.append("g").attr("class","axis axis-y").call(d3.axisLeft(y).ticks(5).tickFormat(function(d){return"aid_amt"===radioValue?"$"+commas(d):d+"%"}));var focus=g.append("g").attr("class","focus").style("display","none");focus.append("line").attr("class","x-hover-line hover-line").attr("y1",0).attr("y2",height),svg.append("rect").attr("transform","translate("+margin.left+","+margin.top+")").attr("class","overlay").attr("width",width).attr("height",height).on("mouseover",mouseover).on("mouseout",mouseout).on("mousemove",mousemove);var timeScales=datafile.map(function(name){return x(name.timescale)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findData=findData,exports.runData=runData;var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),_tooltip=require("./tooltip"),_tooltip2=_interopRequireDefault(_tooltip);exports.default={findData:findData,runData:runData}},{"./tooltip":96,d3:45,jquery:55}],84:[function(require,module,exports){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function runData(datafile){var margin=(d3.format(","),{top:0,right:25,bottom:130,left:0}),height=500-margin.top-margin.bottom,windowWidth=void 0;windowWidth=(0,_jquery2.default)(window).width()<=650?(0,_jquery2.default)("#demographics").width():(0,_jquery2.default)(window).width();var width=Math.min(625,(0,_jquery2.default)(window).width()-margin.left-margin.right),chartWidth=Math.min(600,windowWidth),x=d3.scaleLinear().domain([0,100]).range([0,chartWidth]),globalRacePool=["white","black","hisp","asian","twomore","amerindalasknat","nathawpacisl","unknown","nonresident"],globalReadableRaces=["WHITE","BLACK / AFRICAN-AMERICAN","HISPANIC / LATINO","ASIAN","TWO OR MORE RACES","NATIVE HAWAIIAN / PACIFIC ISLANDER","AMERICAN INDIAN / ALASKA NATIVE","NO RACE REPORTED","NOT U.S. RESIDENT"],raceColors=["#00aeef","#8531BA","#E4C16F","#E46F88","#6FE4CF","#e9651b","#52b033","grey"],rectangles=globalRacePool.map(function(race){return{label:race,value:datafile["enrollment_"+race]/datafile.total_enrollment*100}}),svg=d3.select("#demographics-chart").attr("width",width).attr("height",height+margin.top+margin.bottom),group=svg.selectAll("g").data(rectangles).enter().append("g").attr("transform",function(d,i){return"translate("+margin.left+","+(45*i+margin.top)+")"}).attr("class",function(d,i){return d.label});group.append("rect").attr("class","dummy-bar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",45).attr("fill","white"),group.append("rect").attr("class","backBar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",25).attr("fill","#ebebeb"),group.append("rect").attr("class","bar-fill").attr("width",0).attr("x",0).attr("y",0).attr("height",25).attr("fill",function(d,i){return d3.rgb(raceColors[i]).darker(.5)}).transition().delay(function(d,i){return 40*i}).attr("width",function(d,i){return x(d.value)}),group.append("text").attr("class","bar-label").attr("x",0).attr("y",17).text(function(d,i){return isNaN(d.value)?"N/A":Math.round(d.value)+"%"}).attr("fill",function(d,i){return d.value<90?"black":isNaN(d.value)?"#c4c4c4":"white"}).attr("opacity",0).transition().delay(function(d,i){return 40*i+80}).attr("opacity",1).attr("x",function(d,i){return d.value<90?x(d.value)+5:isNaN(d.value)?x(50):x(d.value)-40}),group.append("text").classed("label",!0).attr("height",70).attr("x",0).attr("y",38).attr("dy",0).text(function(d,i){return globalReadableRaces[i]}).attr("opacity",0).transition().delay(function(d,i){return 40*i+500}).attr("opacity",1)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.runData=runData;var _jquery=require("jquery"),_jquery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_jquery),_d=require("d3"),d3=_interopRequireWildcard(_d),_d3SymbolExtra=require("d3-symbol-extra");_interopRequireWildcard(_d3SymbolExtra),require("./utils");exports.default={runData:runData}},{"./utils":97,d3:45,"d3-symbol-extra":38,jquery:55}],85:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function setCookie(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"}function getCookie(cname){for(var name=cname+"=",decodedCookie=decodeURIComponent(document.cookie),ca=decodedCookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""}var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d);require("./furniture");var _grad=require("./grad"),_grad2=_interopRequireDefault(_grad),_retention=require("./retention"),_retention2=_interopRequireDefault(_retention),_demographics=require("./demographics"),_demographics2=_interopRequireDefault(_demographics),_aid=require("./aid"),_aid2=_interopRequireDefault(_aid),_stickerPrice=require("./sticker-price"),_stickerPrice2=_interopRequireDefault(_stickerPrice),_stickerPriceEmbed=require("./sticker-price-embed"),_stickerPriceEmbed2=_interopRequireDefault(_stickerPriceEmbed),selectedNetPrice=void 0,selectedIncomeYear=void 0,totalNumFamilies=void 0,numFamilies030K=void 0,numFamilies3048K=void 0,numFamilies4875K=void 0,numFamilies75110K=void 0,numFamilies110K=void 0,avgTuition030K=void 0,avgTuition3048K=void 0,avgTuition4875K=void 0,avgTuition75110K=void 0,avgTuition110K=void 0,addCommas=d3.format(","),pageUrl=window.location,pageUnitid=pageUrl.href.split("=")[1];getCookie("income")||setCookie("income","1",1),pageUnitid&&_jquery2.default.getJSON("./data/school-data-09042019/"+pageUnitid+".json",function(data){var site="http://"+data.website;selectedIncomeYear=0;var incomeObj=data.yearly_data[selectedIncomeYear];avgTuition030K=0===incomeObj.avg_net_price_0_30000_titleiv_privateforprofit||"NAN"===incomeObj.avg_net_price_0_30000_titleiv_privateforprofit||null===incomeObj.avg_net_price_0_30000_titleiv_privateforprofit?"N/A":"$"+addCommas(Math.round(incomeObj.avg_net_price_0_30000_titleiv_privateforprofit,0)),avgTuition3048K=0===incomeObj.avg_net_price_30001_48000_titleiv_privateforprofit||"NAN"===incomeObj.avg_net_price_30001_48000_titleiv_privateforprofit||null===incomeObj.avg_net_price_30001_48000_titleiv_privateforprofit?"N/A":"$"+addCommas(Math.round(incomeObj.avg_net_price_30001_48000_titleiv_privateforprofit,0)),avgTuition4875K=0===incomeObj.avg_net_price_48001_75000_titleiv_privateforprofit||"NAN"===incomeObj.avg_net_price_48001_75000_titleiv_privateforprofit||null===incomeObj.avg_net_price_48001_75000_titleiv_privateforprofit?"N/A":"$"+addCommas(Math.round(incomeObj.avg_net_price_48001_75000_titleiv_privateforprofit,0)),avgTuition75110K=0===incomeObj.avg_net_price_75001_110000_titleiv_privateforprofit||"NAN"===incomeObj.avg_net_price_75001_110000_titleiv_privateforprofit||null===incomeObj.avg_net_price_75001_110000_titleiv_privateforprofit?"N/A":"$"+addCommas(Math.round(incomeObj.avg_net_price_75001_110000_titleiv_privateforprofit,2)),avgTuition110K=0===incomeObj.avg_net_price_110001_titleiv_privateforprofit||"NAN"===incomeObj.avg_net_price_110001_titleiv_privateforprofit||null===incomeObj.avg_net_price_110001_titleiv_privateforprofit?"N/A":"$"+addCommas(Math.round(incomeObj.avg_net_price_110001_titleiv_privateforprofit,2)),numFamilies030K=incomeObj.number_income_privateforprofit_0_30000,numFamilies3048K=incomeObj.number_income_privateforprofit_30001_48000,numFamilies4875K=incomeObj.number_income_privateforprofit_48001_75000,numFamilies75110K=incomeObj.number_income_privateforprofit_75001_100000,numFamilies110K=incomeObj.number_income_privateforprofit_110001,totalNumFamilies=numFamilies030K+numFamilies3048K+numFamilies4875K+numFamilies75110K+numFamilies110K,numFamilies030K=+incomeObj.number_income_privateforprofit_0_30000||"0",numFamilies3048K=+incomeObj.number_income_privateforprofit_30001_48000||"0",numFamilies4875K=+incomeObj.number_income_privateforprofit_48001_75000||"0",numFamilies75110K=+incomeObj.number_income_privateforprofit_75001_100000||"0",numFamilies110K=+incomeObj.number_income_privateforprofit_110001||"0";totalNumFamilies&&totalNumFamilies>0?(Math.round(numFamilies030K/totalNumFamilies*100)+"%",Math.round(numFamilies3048K/totalNumFamilies*100)+"%",Math.round(numFamilies4875K/totalNumFamilies*100)+"%",Math.round(numFamilies75110K/totalNumFamilies*100)+"%",Math.round(numFamilies110K/totalNumFamilies*100)):("N/A","N/A","N/A","N/A"),"1"===getCookie("income")?((0,_jquery2.default)("#calculated-net-price").text(avgTuition030K),(0,_jquery2.default)("#net-number").html(numFamilies030K),(0,_jquery2.default)("#bracket").html("$0&ndash;$30,000")):"2"===getCookie("income")?((0,_jquery2.default)("#calculated-net-price").text(avgTuition3048K),(0,_jquery2.default)("#net-number").html(numFamilies3048K),(0,_jquery2.default)("#bracket").html("$30,000&ndash;$48,000")):"3"===getCookie("income")?((0,_jquery2.default)("#calculated-net-price").text(avgTuition4875K),(0,_jquery2.default)("#net-number").html(numFamilies4875K),(0,_jquery2.default)("#bracket").html("$48,000&ndash;$75,000")):"4"===getCookie("income")?((0,_jquery2.default)("#calculated-net-price").text(avgTuition75110K),(0,_jquery2.default)("#net-number").html(numFamilies75110K),(0,_jquery2.default)("#bracket").html("$75,000&ndash;$110,000")):"5"===getCookie("income")&&((0,_jquery2.default)("#calculated-net-price").text(avgTuition110K),(0,_jquery2.default)("#net-number").html(numFamilies110K),(0,_jquery2.default)("#bracket").html("$110,000 and above")),(0,_jquery2.default)("#net-school").html(data.institution);var returnedNetPrice=(0,_jquery2.default)("#calculated-net-price").text();"N/A"!==returnedNetPrice&&"NaN"!==returnedNetPrice||(0,_jquery2.default)("#calculated-net-price").text("No data"),(0,_jquery2.default)("#stats-url a, #mobile-stats-url a").attr("href",site),1===data.control?(0,_jquery2.default)("#stats-type, #mobile-stats-type span").html("public"):2===data.control?(0,_jquery2.default)("#stats-type, #mobile-stats-type span").html("private"):(0,_jquery2.default)("#stats-type, #mobile-stats-type span").html("for-profit"),data.level<4?(0,_jquery2.default)("#stats-degree span strong, #mobile-stats-degree span strong").html("4"):(0,_jquery2.default)("#stats-degree span strong, #mobile-stats-degree span strong").html("2"),1===data.hbcu?(0,_jquery2.default)("#stats-hbcu, #mobile-stats-hbcu").show():(0,_jquery2.default)("#stats-hbcu, #mobile-stats-hbcu").hide(),1===data.tribal_college?(0,_jquery2.default)("#stats-tribal, #mobile-stats-tribal").show():(0,_jquery2.default)("#stats-tribal, #mobile-stats-tribal").hide(),null===data.enrollment.perc_admitted||1==data.enrollment.perc_admitted?(0,_jquery2.default)("#stats-acc-rate span, #mobile-stats-acc-rate span").html("N/A"):(0,_jquery2.default)("#stats-acc-rate span, #mobile-stats-acc-rate span").html(data.enrollment.perc_admitted+"%"),null===data.enrollment.perc_sticker||1==data.enrollment.perc_sticker?(0,_jquery2.default)("#stats-sticker span, #mobile-stats-sticker span").html("N/A"):(0,_jquery2.default)("#stats-acc-sticker span, #mobile-stats-sticker span").html(data.enrollment.perc_sticker+"%"),(0,_jquery2.default)(".city-state-label").html(data.city+", "+(data.abbreviation||"")),(0,_jquery2.default)(".school-name").html(data.institution),(0,_jquery2.default)(window).on("scroll",function(){window.pageYOffset>88?((0,_jquery2.default)("#school-name-nav-bar").addClass("fixed"),(0,_jquery2.default)(".locator-map").addClass("fixed")):((0,_jquery2.default)("#school-name-nav-bar").removeClass("fixed"),(0,_jquery2.default)(".locator-map").removeClass("fixed"))});var twitterLink="https://twitter.com/intent/tweet?text=How much will "+data.institution+" actually cost in 2020? Find out with Tuition Tracker&url=http://tuitiontracker.org/school.html?unitid="+pageUnitid;(0,_jquery2.default)("#twitter-link").attr("href",twitterLink);var facebookLink="https://www.facebook.com/sharer/sharer.php?u=http://tuitiontracker.org/school.html?unitid="+pageUnitid;(0,_jquery2.default)("#facebook-link").attr("href",facebookLink);var priceStickerHeadline=_stickerPrice2.default.findData(data,1),stickerPrice=void 0;null===priceStickerHeadline[10].stickerPrice||0===priceStickerHeadline[10].stickerPrice?(stickerPrice="$"+addCommas(Math.round(data.yearly_data[0].price_instate_offcampus_nofamily)),(0,_jquery2.default)("#sticker-living").text("off campus without family")):"price_instate_offcampus_nofamily"===priceStickerHeadline[10].stickerPriceType?(stickerPrice="$"+addCommas(Math.round(priceStickerHeadline[10].stickerPrice)),(0,_jquery2.default)("#sticker-living").text("off campus without family")):(stickerPrice="$"+addCommas(Math.round(priceStickerHeadline[10].stickerPrice)),(0,_jquery2.default)("#sticker-living").text("on campus"),(0,_jquery2.default)("#sticker-living-fine").text(", on-campus room and board")),(0,_jquery2.default)("#sticker-price").html(stickerPrice),(0,_jquery2.default)("#sticker-school").html(data.institution),(0,_jquery2.default)("#who-pays").html(""+(100-data.yearly_data[2].perc_first_time_full_time_undergrad_other_grant_aid));var returnedStickerValue=(0,_jquery2.default)("#sticker-price").text();"$0"!==returnedStickerValue&&"$NaN"!==returnedStickerValue||(0,_jquery2.default)("#sticker-price").text("No data");var malePct=Math.round(data.enrollment.total_men/data.enrollment.total_enrollment*100),femalePct=Math.round(data.enrollment.total_women/data.enrollment.total_enrollment*100);(0,_jquery2.default)("#gender-pct-female").attr("data-pct",femalePct),(0,_jquery2.default)("#gender-pct-male").attr("data-pct",malePct),(0,_jquery2.default)("#gender-pct-female").css("width",femalePct+"%"),(0,_jquery2.default)("#gender-pct-male").css("width",malePct+"%");var genderBarMale=parseInt((0,_jquery2.default)("#gender-pct-male").attr("data-pct")),genderBarFemale=parseInt((0,_jquery2.default)("#gender-pct-female").attr("data-pct"));genderBarMale<5?(0,_jquery2.default)("#gender-pct-male").addClass("small-num"):genderBarFemale<5&&(0,_jquery2.default)("#gender-pct-female").addClass("small-num"),genderBarMale>96&&((0,_jquery2.default)("#gender-pct-male").addClass("high-pct"),(0,_jquery2.default)("#gender-pct-female").removeClass("small-num"),(0,_jquery2.default)("#gender-pct-female").addClass("no-num")),(0,_jquery2.default)(".enrollment-stat span").html(addCommas(data.enrollment.total_enrollment)),(0,_jquery2.default)("#choose-year-family-income").change(function(){(0,_jquery2.default)("tbody").html("<tr><td data-label='income' class='income'>$0-$30,000</td><td data-label='net-price' class='net-price'>"+avgTuition030K+"</td><td data-label='num-students' class='num-students'>"+numFamilies030K+"</td></tr>\n\n    <tr><td data-label='income' class='income'>$30,0001-$48,000</td><td data-label='net-price' class='net-price'>"+avgTuition3048K+"</td><td data-label='num-students' class='num-students'>"+numFamilies3048K+"</td></tr>\n\n    <tr><td data-label='income' class='income'>$48,0001-$75,000</td><td data-label='net-price' class='net-price'>"+avgTuition4875K+"</td><td data-label='num-students' class='num-students'>"+numFamilies4875K+"</td></tr>\n\n    <tr><td data-label='income' class='income'>$75,0001-$110,000</td><td data-label='net-price' class='net-price'>"+avgTuition75110K+"</td><td data-label='num-students' class='num-students'>"+numFamilies75110K+"</td></tr>\n\n    <tr><td data-label='income' class='income'>$110,000+</td><td data-label='net-price' class='net-price'>"+avgTuition110K+"</td><td data-label='num-families' class='num-students'>"+numFamilies110K+"</td></tr>")}),(0,_jquery2.default)("#choose-year-family-income option:selected").val("0").trigger("change"),(0,_jquery2.default)("#choose-family-income-bracket").change(function(){selectedNetPrice=parseInt((0,_jquery2.default)("#choose-family-income-bracket option:selected").val());Math.round(numFamilies030K/totalNumFamilies*100),Math.round(numFamilies3048K/totalNumFamilies*100),Math.round(numFamilies4875K/totalNumFamilies*100),Math.round(numFamilies75110K/totalNumFamilies*100),Math.round(numFamilies110K/totalNumFamilies*100);1===selectedNetPrice?((0,_jquery2.default)("#calculated-net-price").text(avgTuition030K),(0,_jquery2.default)("#net-number").html(numFamilies030K),(0,_jquery2.default)("#bracket").html("$0&ndash;$30,000")):2===selectedNetPrice?((0,_jquery2.default)("#calculated-net-price").text(avgTuition3048K),(0,_jquery2.default)("#net-number").html(numFamilies3048K),(0,_jquery2.default)("#bracket").html("$30,000&ndash;$48,000")):3===selectedNetPrice?((0,_jquery2.default)("#calculated-net-price").text(avgTuition4875K),(0,_jquery2.default)("#net-number").html(numFamilies4875K),(0,_jquery2.default)("#bracket").html("$48,000&ndash;$75,000")):4===selectedNetPrice?((0,_jquery2.default)("#calculated-net-price").text(avgTuition75110K),(0,_jquery2.default)("#net-number").html(numFamilies75110K),(0,_jquery2.default)("#bracket").html("$75,000&ndash;$110,000")):5===selectedNetPrice&&((0,_jquery2.default)("#calculated-net-price").text(avgTuition110K),(0,_jquery2.default)("#net-number").html(numFamilies110K),(0,_jquery2.default)("#bracket").html("$110,000 and above")),(0,_jquery2.default)("#net-school").html(data.institution);var returnedNetPrice=(0,_jquery2.default)("#calculated-net-price").text();"N/A"!==returnedNetPrice&&"NaN"!==returnedNetPrice||(0,_jquery2.default)("#calculated-net-price").text("No data")}),(0,_jquery2.default)("#price-bracket").change(function(){selectedNetPrice=parseInt((0,_jquery2.default)("#price-bracket option:selected").val());Math.round(numFamilies030K/totalNumFamilies*100),Math.round(numFamilies3048K/totalNumFamilies*100),Math.round(numFamilies4875K/totalNumFamilies*100),Math.round(numFamilies75110K/totalNumFamilies*100),Math.round(numFamilies110K/totalNumFamilies*100);(0,_jquery2.default)("#net-school").html(data.institution);var returnedNetPrice=(0,_jquery2.default)(".calculated-net-price span").text();"$0"!==returnedNetPrice&&"$NaN"!==returnedNetPrice||(0,_jquery2.default)(".calculated-net-price span").text("No data")}),(0,_jquery2.default)("#family-income-table").hide(),(0,_jquery2.default)(".show-table").click(function(){(0,_jquery2.default)(this);(0,_jquery2.default)("#family-income-table").slideToggle("slow",function(){(0,_jquery2.default)(this).is(":visible")?(0,_jquery2.default)("#show-hide").text("hide"):(0,_jquery2.default)("#show-hide").text("show")})});var submitIcon=(0,_jquery2.default)(".searchbox-icon"),closeIcon=(0,_jquery2.default)("#results-close"),inputBox=(0,_jquery2.default)(".searchbox-input"),searchBox=(0,_jquery2.default)(".searchbox"),isOpen=!1;(0,_jquery2.default)("#tracker-pullout").on("click",function(){(0,_jquery2.default)("#tracker-pullout-container").removeClass("disappear"),(0,_jquery2.default)(".searchbox").hasClass("searchbox-open"),searchBox.removeClass("searchbox-open"),inputBox.focusout(),isOpen=!1,(0,_jquery2.default)(".searchbox-icon").css("display","inline-block"),(0,_jquery2.default)(".new-searchbox-icon").hide(),(0,_jquery2.default)("#tracker-pullout-container").toggleClass("slide-in"),(0,_jquery2.default)(this).toggleClass("tracker-open")}),closeIcon.click(function(){1==isOpen?((0,_jquery2.default)("#tracker-pullout-container").toggleClass("disappear"),searchBox.removeClass("searchbox-open"),inputBox.focusout(),isOpen=!1,(0,_jquery2.default)(".searchbox-icon").css("display","inline-block"),(0,_jquery2.default)(".new-searchbox-icon").hide()):(searchBox.addClass("searchbox-open"),inputBox.focus(),isOpen=!0,(0,_jquery2.default)(".new-searchbox-icon").show())}),submitIcon.click(function(){0==isOpen?((0,_jquery2.default)("#tracker-pullout-container").toggleClass("disappear"),(0,_jquery2.default)("#tracker-pullout-container").hasClass("slide-in")&&((0,_jquery2.default)("#tracker-pullout-container").toggleClass("slide-in"),(0,_jquery2.default)(this).toggleClass("tracker-open")),searchBox.addClass("searchbox-open"),inputBox.focus(),isOpen=!0,(0,_jquery2.default)(this).css("display","none"),(0,_jquery2.default)(".new-searchbox-icon").show()):(searchBox.removeClass("searchbox-open"),inputBox.focusout(),isOpen=!1,(0,_jquery2.default)(".new-searchbox-icon").hide())});var aidRadio="aid_amt",aidDatafile=_aid2.default.findData(data,aidRadio);_aid2.default.runData(aidDatafile,aidRadio),(0,_jquery2.default)(".switch-field input[name='switch-btn-aid']").click(function(){aidRadio=this.value,aidDatafile=_aid2.default.findData(data,aidRadio),(0,_jquery2.default)("#aid-chart").empty(),_aid2.default.runData(aidDatafile,aidRadio)});var priceDatafile=_stickerPrice2.default.findData(data,1);_stickerPrice2.default.runData(priceDatafile),_stickerPriceEmbed2.default.runData(priceDatafile),(0,_jquery2.default)("#choose-family-income-bracket").change(function(){var selectedVal=parseInt(this.value,10),priceDatafile=((0,_jquery2.default)("#choose-family-income-bracket option:selected").text(),_stickerPrice2.default.findData(data,selectedVal));(0,_jquery2.default)("#sticker-price-chart").empty(),(0,_jquery2.default)("#sticker-price-chart-embed").empty(),_stickerPrice2.default.runData(priceDatafile),_stickerPriceEmbed2.default.runData(priceDatafile),(0,_jquery2.default)("#price-bracket").val(this.value)}),(0,_jquery2.default)("#price-bracket").change(function(){var selectedVal=parseInt(this.value,10),priceDatafile=((0,_jquery2.default)("#price-bracket option:selected").text(),_stickerPrice2.default.findData(data,selectedVal));(0,_jquery2.default)("#sticker-price-chart").empty(),(0,_jquery2.default)("#sticker-price-chart-embed").empty(),_stickerPrice2.default.runData(priceDatafile),_stickerPriceEmbed2.default.runData(priceDatafile),(0,_jquery2.default)("#choose-family-income-bracket").val(this.value)}),(0,_jquery2.default)(window).on("scroll",function(){if(window.pageYOffset>document.getElementById("grad-rates-container").offsetTop-400){var gradDatafile=_grad2.default.findData(data);_grad2.default.runData(gradDatafile)}if(window.pageYOffset>document.getElementById("retention-rates-container").offsetTop-500){var retentionDatafile=_retention2.default.findData(data);_retention2.default.runData(retentionDatafile)}if(window.pageYOffset>document.getElementById("demographics-container").offsetTop-600){var demographicsDatafile=data.enrollment;_demographics2.default.runData(demographicsDatafile)}});var latitude=data.lat,longitude=data.lon,schoolMarker={lat:latitude,lng:longitude};new google.maps.Map(document.getElementById("locator-map"),{zoom:10,center:schoolMarker,mapTypeId:google.maps.MapTypeId.ROAD,disableDefaultUI:!0,scrollwheel:!1,styles:[{featureType:"water",elementType:"geometry",stylers:[{color:"#c9d9de"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#e6e6e6"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#d4d4d4"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#d4e2d4"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]}]})}),(0,
_jquery2.default)("#add-school").click(function(){var schoolCookies=getCookie("schools"),thisSchool=window.location.href.split("=")[1],cookies=void 0;cookies=schoolCookies.length>1?schoolCookies.split(","):[],-1===cookies.indexOf(thisSchool)&&cookies.push(thisSchool),cookies.join(","),setCookie("schools",cookies,1)}),(0,_jquery2.default)("#choose-family-income-bracket-topnav").change(function(){setCookie("income",(0,_jquery2.default)(this).val(),1),window.location.reload()}),(0,_jquery2.default)(".expander-trigger").click(function(){(0,_jquery2.default)(this).toggleClass("expander-hidden")}),(0,_jquery2.default)(".how-we-know-close").click(function(){(0,_jquery2.default)(".how-we-know-text").removeClass("how-we-know-visible")}),(0,_jquery2.default)(".how-we-know").click(function(){(0,_jquery2.default)(".how-we-know-text").addClass("how-we-know-visible")})},{"./aid":83,"./demographics":84,"./furniture":87,"./grad":88,"./retention":91,"./sticker-price":95,"./sticker-price-embed":94,d3:45,jquery:55}],86:[function(require,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function($){$.tagator=function(source_element,options){var defaults={prefix:"tagator_",height:"auto",useDimmer:!1,showAllOptionsOnFocus:!1,allowAutocompleteOnly:!1,autocomplete:[]},self=this,selected_index=-1,$source_element=$(source_element),$tagator_element=null,$tags_element=null,$placeholder_element=null,$input_element=null,$textlength_element=null,$options_element=null,key={backspace:8,enter:13,escape:27,left:37,up:38,right:39,down:40,comma:188};self.settings={},self.init=function(){if(self.settings=$.extend({},defaults,options),self.settings.useDimmer&&0===$("#"+self.settings.prefix+"dimmer").length){var $dimmer_element=$(document.createElement("div"));$dimmer_element.attr("id",self.settings.prefix+"dimmer"),$dimmer_element.hide(),$(document.body).prepend($dimmer_element)}$tagator_element=$(document.createElement("div")),void 0!==$source_element[0].id&&$tagator_element.attr("id",self.settings.prefix+$source_element[0].id),$tagator_element.addClass(self.settings.prefix+"element options-hidden"),$tagator_element.css({padding:$source_element.css("padding"),"flex-grow":$source_element.css("flex-grow"),position:"relative"}),0!=parseInt($source_element.css("width"))&&$tagator_element.css({width:$source_element.css("width")}),"element"===self.settings.height&&$tagator_element.css({height:$source_element.outerHeight+"px"}),$source_element.after($tagator_element),$source_element.hide(),$textlength_element=$(document.createElement("span")),$textlength_element.addClass(self.settings.prefix+"textlength"),$textlength_element.css({position:"absolute",visibility:"hidden"}),$tagator_element.append($textlength_element),$tags_element=$(document.createElement("div")),$tags_element.addClass(self.settings.prefix+"tags"),$tagator_element.append($tags_element),$placeholder_element=$(document.createElement("div")),$placeholder_element.addClass(self.settings.prefix+"placeholder"),$tagator_element.append($placeholder_element),$input_element=$(document.createElement("input")),$input_element.addClass(self.settings.prefix+"input"),$input_element.width(20),$input_element.attr("autocomplete","false"),$tagator_element.append($input_element),$options_element=$(document.createElement("ul")),$options_element.addClass(self.settings.prefix+"options"),$tagator_element.append($options_element),$source_element.change(function(){refreshTags()}),$tagator_element.bind("focus",function(e){e.preventDefault(),e.stopPropagation(),showOptions(),$input_element.focus()}),$tagator_element.bind("mousedown",function(e){if(e.preventDefault(),e.stopPropagation(),$input_element.focus(),$input_element[0].setSelectionRange)$input_element.focus(),$input_element[0].setSelectionRange($input_element.val().length,$input_element.val().length);else if($input_element[0].createTextRange){var range=$input_element[0].createTextRange();range.collapse(!0),range.moveEnd("character",$input_element.val().length),range.moveStart("character",$input_element.val().length),range.select()}}),$tagator_element.bind("mouseup",function(e){e.preventDefault(),e.stopPropagation()}),$tagator_element.bind("click",function(e){e.preventDefault(),e.stopPropagation(),self.settings.showAllOptionsOnFocus&&searchOptions(),$input_element.focus()}),$tagator_element.bind("dblclick",function(e){e.preventDefault(),e.stopPropagation(),$input_element.focus(),$input_element.select()}),$input_element.bind("click",function(e){e.preventDefault(),e.stopPropagation()}),$input_element.bind("dblclick",function(e){e.preventDefault(),e.stopPropagation()}),$input_element.bind("keydown",function(e){switch(e.stopPropagation(),e.keyCode||e.which){case key.up:e.preventDefault(),selected_index>-1?selected_index-=1:selected_index=$options_element.find("."+self.settings.prefix+"option").length-1,refreshActiveOption(),scrollToActiveOption();break;case key.down:e.preventDefault(),selected_index<$options_element.find("."+self.settings.prefix+"option").length-1?selected_index+=1:selected_index=-1,refreshActiveOption(),scrollToActiveOption();break;case key.escape:e.preventDefault();break;case key.comma:e.preventDefault(),-1===selected_index&&""!==$input_element.val()&&addTag($input_element.val()),resizeInput();break;case key.enter:e.preventDefault(),-1!==selected_index?selectOption():""!==$input_element.val()&&addTag($input_element.val()),resizeInput();break;case key.backspace:""===$input_element.val()&&($source_element.val($source_element.val().substring(0,$source_element.val().lastIndexOf(","))),$source_element.trigger("change"),searchOptions()),resizeInput();break;default:resizeInput()}refreshPlaceholder()}),$input_element.bind("keyup",function(e){e.preventDefault(),e.stopPropagation();var keyCode=e.keyCode||e.which;keyCode===key.escape||keyCode===key.enter?hideOptions():(keyCode<37||keyCode>40)&&searchOptions(),!$tagator_element.hasClass("options-hidden")||keyCode!==key.left&&keyCode!==key.right&&keyCode!==key.up&&keyCode!==key.down||searchOptions(),resizeInput(),refreshPlaceholder()}),$input_element.bind("focus",function(e){e.preventDefault(),e.stopPropagation(),$options_element.is(":empty")&&!self.settings.showAllOptionsOnFocus||(searchOptions(),showOptions())}),$input_element.bind("blur",function(e){e.preventDefault(),e.stopPropagation(),hideOptions()}),refreshTags()};var resizeInput=function(){$textlength_element.html($input_element.val()),$input_element.css({width:$textlength_element.width()+20+"px"})};self.autocomplete=function(autocomplete){self.settings.autocomplete=void 0!==autocomplete?autocomplete:[]},self.refresh=function(){refreshTags()};var refreshTags=function(){$tags_element.empty();var tags=$source_element.val().split(",");$.each(tags,function(key,value){if(""!==value&&checkAllowedTag(value)){var $tag_element=$(document.createElement("div"));$tag_element.addClass(self.settings.prefix+"tag"),$tag_element.html(value);var $button_remove_element=$(document.createElement("div"));$button_remove_element.data("text",value),$button_remove_element.addClass(self.settings.prefix+"tag_remove"),$button_remove_element.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),$button_remove_element.bind("mouseup",function(e){e.preventDefault(),e.stopPropagation(),removeTag($(this).data("text")),$source_element.trigger("change")}),$button_remove_element.html("X"),$tag_element.append($button_remove_element);var $clear_element=$(document.createElement("div"));$clear_element.css("clear","both"),$tag_element.append($clear_element),$tags_element.append($tag_element)}}),refreshPlaceholder(),searchOptions()},refreshPlaceholder=function(){$tags_element.is(":empty")&&!$input_element.val()&&$source_element.attr("placeholder")?($placeholder_element.html($source_element.attr("placeholder")),$placeholder_element.show()):$placeholder_element.hide()},removeTag=function(text){var tagsBefore=$source_element.val().split(","),tagsAfter=[];$.each(tagsBefore,function(key,value){value!==text&&""!==value&&tagsAfter.push(value)}),$source_element.val(tagsAfter.join(","))},hasTag=function(text){var tags=$source_element.val().split(","),hasTag=!1;return $.each(tags,function(key,value){$.trim(value)===$.trim(text)&&(hasTag=!0)}),hasTag},checkAllowedTag=function(text){if(!self.settings.allowAutocompleteOnly)return!0;var checkAllowedTag=!1;return $.each(self.settings.autocomplete,function(key,value){$.trim(value)===$.trim(text)&&(checkAllowedTag=!0)}),checkAllowedTag},addTag=function(text){!hasTag(text)&&checkAllowedTag(text)&&($source_element.val($source_element.val()+(""!==$source_element.val()?",":"")+text),$source_element.trigger("change")),$input_element.val(""),$tagator_element.focus(),hideOptions()},searchOptions=function(){if($options_element.empty(),""!==$input_element.val().replace(/\s/g,"")||self.settings.showAllOptionsOnFocus){var optionsArray=[];$.each(self.settings.autocomplete,function(key,value){-1!==value.toLowerCase().indexOf($input_element.val().toLowerCase())&&(hasTag(value)||optionsArray.push(value))}),generateOptions(optionsArray)}$input_element.is(":focus")?$options_element.is(":empty")?hideOptions():showOptions():hideOptions(),selected_index=-1},generateOptions=function(optionsArray){var index=-1;$(optionsArray).each(function(key,value){index++;var option=createOption(value,index);$options_element.append(option)}),refreshActiveOption()},createOption=function(text,index){var option=document.createElement("li");return $(option).data("index",index),$(option).data("text",text),$(option).html(text),$(option).addClass(self.settings.prefix+"option"),self.selected&&$(option).addClass("active"),$(option).bind("mouseover",function(e){e.stopPropagation(),e.preventDefault(),selected_index=index,refreshActiveOption()}),$(option).bind("mousedown",function(e){e.stopPropagation(),e.preventDefault()}),$(option).bind("click",function(e){e.preventDefault(),e.stopPropagation(),selectOption()}),option},showOptions=function(){$tagator_element.removeClass("options-hidden").addClass("options-visible"),self.settings.useDimmer&&$("#"+self.settings.prefix+"dimmer").show(),$options_element.css("top",$tagator_element.outerHeight-2+"px"),$tagator_element.hasClass("single")&&(selected_index=$options_element.find("."+self.settings.prefix+"option").index($options_element.find("."+self.settings.prefix+"option.active"))),scrollToActiveOption()},hideOptions=function(){$tagator_element.removeClass("options-visible").addClass("options-hidden"),self.settings.useDimmer&&$("#"+self.settings.prefix+"dimmer").hide()},refreshActiveOption=function(){$options_element.find(".active").removeClass("active"),-1!==selected_index&&$options_element.find("."+self.settings.prefix+"option").eq(selected_index).addClass("active")},scrollToActiveOption=function(){var $active_element=$options_element.find("."+self.settings.prefix+"option.active");$active_element.length>0&&$options_element.scrollTop($options_element.scrollTop()+$active_element.position().top-$options_element.height()/2+$active_element.height()/2)},selectOption=function(){addTag($options_element.find("."+self.settings.prefix+"option").eq(selected_index).data("text"))};self.destroy=function(){$tagator_element.remove(),$.removeData($source_element,"tagator"),$source_element.show(),0===$(".tagator").length&&$("#"+self.settings.prefix+"dimmer").remove()},self.init()},$.fn.tagator=function(){var parameters=void 0!==arguments[0]?arguments:[{}];return this.each(function(){if("object"===_typeof(parameters[0])){if(void 0===$(this).data("tagator")){var plugin=new $.tagator(this,parameters[0]);$(this).data("tagator",plugin)}}else $(this).data("tagator")[parameters[0]]?$(this).data("tagator")[parameters[0]].apply(this,Array.prototype.slice.call(parameters,1)):$.error("Method "+parameters[0]+" does not exist in $.tagator")})}}(jQuery),$(function(){$(".tagator").each(function(){var $this=$(this),options={};$.each($this.data(),function(key,value){if("tagator"==key.substring(0,7)){var value_temp=value.toString().replace(/'/g,'"');value_temp=$.parseJSON(value_temp),"object"==(void 0===value_temp?"undefined":_typeof(value_temp))&&(value=value_temp),options[key.substring(7,8).toLowerCase()+key.substring(8)]=value}}),$this.tagator(options)})})},{}],87:[function(require,module,exports){"use strict";$(document).ready(function(){function closeList(){$(".open-list").removeClass("open-list"),$(".open-button").removeClass("open-button")}var d=new Date,year=d.getFullYear();$(".copyright").text(year);var $hedButton=$(".header-group button");$hedButton.click(function(e){!0===$hedButton.hasClass("open-button")&&!0===$(this).hasClass("open-button")?closeList():(closeList(),$(this).addClass("open-button"),$(this).siblings("ul").addClass("open-list")),e.stopPropagation()}),$("body").click(function(){closeList()}),document.cookie.indexOf("DMN-P")>=0?$("body").addClass("subscribed"):$("body").removeClass("subscribed")})},{}],88:[function(require,module,exports){"use strict";function _interopRequireWildcard(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}function findData(grad,degreetype){var chartableGrad=grad.yearly_data.slice(1,7).reverse(),globalRacePool=["white","black","hisp","asian","twomore","amerindalasknat","nathawpacisl","unknown"],globalReadableRaces=["WHITE","BLACK / AFRICAN-AMERICAN","HISPANIC / LATINO","ASIAN","TWO OR MORE RACES","AMERICAN INDIAN / ALASKA NATIVE","NATIVE HAWAIIAN / PACIFIC ISLANDER","NO RACE REPORTED"],passedRacePool=[];return globalRacePool.forEach(function(race,index){passedRacePool.push(race),readableRacePool.push(globalReadableRaces[index])}),document.onload=function(){console.log("Document onload")},4===grad.level||5===grad.level||6===grad.level?chartableGrad.map(function(year){(0,_jquery2.default)("#grad-rates-container").show(),(0,_jquery2.default)("#grad-placeholder").hide();var thisYear={sector:1,timescale:"20"+year.year.slice(0,2),allGradPct:{rate:year.grad_rate_associate_3years_total,cohort:year.grad_cohort_associate_3years_total}};return passedRacePool.forEach(function(race){thisYear[race+"GradPct"]={},thisYear[race+"GradPct"].rate=year["grad_rate_associate_3years_"+race],thisYear[race+"GradPct"].cohort=year["grad_cohort_associate_3years_"+race]}),thisYear}):chartableGrad.map(function(year){(0,_jquery2.default)("#grad-rates-container").show(),(0,_jquery2.default)("#grad-placeholder").hide();var thisYear={sector:0,timescale:"20"+year.year.slice(0,2),allGradPct:{rate:year.grad_rate_bachelors_6years_total,cohort:year.grad_cohort_bachelors_6years_total}};return passedRacePool.forEach(function(race){thisYear[race+"GradPct"]={},thisYear[race+"GradPct"].rate=year["grad_rate_bachelors_6years_"+race],thisYear[race+"GradPct"].cohort=year["grad_cohort_bachelors_6years_"+race]}),thisYear})}function isitChartable(data){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if(_step.value.allGradPct.rate)return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function runData(datafile){isitChartable(datafile)||((0,_jquery2.default)("#grad-rates-container").hide(),(0,_jquery2.default)("#grad-placeholder").show());var margin=(d3.format(","),{top:0,right:25,bottom:130,left:0}),height=500-margin.top-margin.bottom,windowWidth=void 0;windowWidth=(0,_jquery2.default)(window).width()<=650?(0,_jquery2.default)("#demographics").width():(0,_jquery2.default)(window).width();var width=Math.min(625,(0,_jquery2.default)(window).width()-margin.left-margin.right),chartWidth=Math.min(600,windowWidth),x=d3.scaleLinear().domain([0,100]).range([0,chartWidth]),globalRacePool=["all","white","black","hisp","asian","twomore","amerindalasknat","nathawpacisl","unknown"],globalReadableRaces=["TOTAL","WHITE","BLACK / AFRICAN-AMERICAN","HISPANIC / LATINO","ASIAN","TWO OR MORE RACES","AMERICAN INDIAN / ALASKA NATIVE","NATIVE HAWAIIAN / PACIFIC ISLANDER","NO RACE REPORTED"],raceColors=["#000000","#00aeef","#8531BA","#E4C16F","#E46F88","#6FE4CF","#e9651b","#52b033","grey"],rectangles=globalRacePool.map(function(race){return{label:race,value:datafile[3][race+"GradPct"].rate}}),svg=d3.select("#grad-rates-chart").attr("width",width).attr("height",height+margin.top+margin.bottom),group=svg.selectAll("g").data(rectangles).enter().append("g").attr("transform",function(d,i){return"translate("+margin.left+","+(45*i+margin.top)+")"}).attr("class",function(d,i){return d.label});group.append("rect").attr("class","dummy-bar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",45).attr("fill","white"),group.append("rect").attr("class","backBar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",25).attr("fill","#ebebeb"),group.append("rect").attr("class","bar-fill").attr("width",0).attr("x",0).attr("y",0).attr("height",25).attr("fill",function(d,i){return d3.rgb(raceColors[i]).darker(.5)}).transition().delay(function(d,i){return 40*i}).attr("width",function(d,i){return x(d.value)}),group.append("text").attr("class","bar-label").attr("x",0).attr("y",17).text(function(d,i){return null==d.value||isNaN(d.value)?"N/A":Math.round(d.value)+"%"}).attr("fill",function(d,i){return null==d.value||isNaN(d.value)?"#c4c4c4":d.value<90?"black":"white"}).attr("opacity",0).transition().delay(function(d,i){return 40*i+80}).attr("opacity",1).attr("x",function(d,i){return null==d.value||isNaN(d.value)?x(50):d.value<90?x(d.value)+5:x(d.value)-40}),group.append("text").classed("label",!0).attr("height",70).attr("x",0).attr("y",38).attr("dy",0).text(function(d,i){return globalReadableRaces[i]}).attr("opacity",0).transition().delay(function(d,i){return 40*i+500}).attr("opacity",1),group.append("path").attr("class","triangle").attr("transform",function(d,i){return"translate(0,-10)"}).attr("d",d3.symbol().size(30).type(d3.symbolTriangle)).attr("pointer-events","none").attr("opacity",0).transition().duration(1050).ease(d3.easeElastic).delay(function(d,i){return 40*i+1e3}).attr("opacity",function(d,i){return i<1?1:0}).attr("transform",function(d,i){return"translate("+x(nationalAverage[datafile[0].sector][i])+","+-10+") rotate(-60)"}),group.append("text").attr("class","triangle-label").attr("height",70).attr("x",0).attr("y",0).attr("width",chartWidth).attr("pointer-events","none").attr("transform",function(d,i){return"translate(10,-7)"}).attr("dy",0).text(function(d,i){return"NAT'L AVERAGE"}).attr("font-size",12).attr("opacity",0).transition().duration(1050).ease(d3.easeElastic).delay(function(d,i){return 40*i+1e3}).attr("opacity",function(d,i){return i<1?1:0}).attr("text-anchor","beginning").attr("transform",function(d,i){return nationalAverage[datafile[0].sector][i]>50?"translate("+(x(nationalAverage[datafile[0].sector][i])-105)+","+-4+")":"translate("+(x(nationalAverage[datafile[0].sector][i])+10)+","+-4+")"}),setTimeout(function(){group.on("mouseover",function(d,i){d3.select(".all").selectAll(".triangle-label,.triangle").transition().duration(250).attr("opacity",0),d3.select(this).selectAll(".triangle-label,.triangle").transition().delay(60).duration(250).attr("opacity",1)}).on("mouseout",function(d,i){d3.select(".all").selectAll(".triangle-label,.triangle").transition().duration(250).delay(60).attr("opacity",1),d3.select(this).selectAll(".triangle-label,.triangle").transition().duration(250).attr("opacity",0)})},1500)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findData=findData,exports.runData=runData;var _jquery=require("jquery"),_jquery2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_jquery),_d=require("d3"),d3=_interopRequireWildcard(_d),_d3SymbolExtra=require("d3-symbol-extra"),readableRacePool=(_interopRequireWildcard(_d3SymbolExtra),require("./utils"),["TOTAL"]),nationalAverage=[[59.7,63.48,40.04,53.78,72.46,61.74,49.48,39.78,-100,67.88],[29.64,30.92,22.86,30.9,35.68,25.22,34.64,25.14,-100,35.42]];exports.default={findData:findData,runData:runData}},{"./utils":97,d3:45,"d3-symbol-extra":38,jquery:55}],89:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}function carriesPrograms(array_a,array_b){return array_a.every(function(val){return array_b.includes(val)})}function showSearchResult(school){if(school){var baseHref=window.location.href;!0===baseHref.includes("school")?baseHref=baseHref.substring(0,baseHref.lastIndexOf("/"))+"/":!0===baseHref.includes(".html")&&(baseHref=baseHref.substring(0,baseHref.lastIndexOf("/"))),window.open(""+baseHref+schoolUrl+school.unitid,"_self")}}function determineSchool(school){if(school)showSearchResult(school);else if($(".search-group").find("input").val().length>=0){var enteredSchool=$(".search-group").find("input").val(),returnedSchool=rawData.find(function(school){return school.schoolname===enteredSchool});returnedSchool?showSearchResult(returnedSchool):""==$("#tags")[0].value?($(".alert-search").removeClass("alert-search-hidden"),$(".alert-search").text("Please begin typing to search schools"),setTimeout(function(){$(".alert-search").addClass("alert-search-hidden")},800)):0==listLength?($(".alert-search").removeClass("alert-search-hidden"),$(".alert-search").text("No schools found, please revise your search"),setTimeout(function(){$(".alert-search").addClass("alert-search-hidden")},800)):($(".alert-search").removeClass("alert-search-hidden"),$(".alert-search").text("Select a school from the list below and then click search"),setTimeout(function(){$(".alert-search").addClass("alert-search-hidden")},800))}else $(".alert-search").removeClass("alert-search-hidden"),$(".alert-search").text("Begin typing to search schools"),setTimeout(function(){$(".alert-search").addClass("alert-search-hidden")},800)}function handleTagChange(ev){var cb=$(this),spread=$(cb).val().split(",");filters.programs=spread.map(function(cb){return programArray.indexOf(cb)+1}),runFilters(),printSchoolList()}function handleCheckBoxChange(ev){var cb=$(this),parent=cb.parent(),cbGroup=parent.find(".chk");switch(parent.attr("id").substr(7)){case"type":filters.schoolcontrol=cbGroup.filter(":checked").toArray().map(function(cb){return $(cb).val()});break;case"degree":filters.degreetype=cbGroup.filter(":checked").toArray().map(function(cb){return $(cb).val()});break;case"size":filters.size=cbGroup.filter(":checked").toArray().map(function(cb){return $(cb).val()});break;case"urbanization":filters.urbanization=cbGroup.filter(":checked").toArray().map(function(cb){return $(cb).val()})}runFilters(),printSchoolList()}function printSchoolList(){var html=filteredItems.map(function(school){return'<li><a href="#" data-unitid="'+school.unitid+'">'+school.schoolname+"</a></li>"}).join("");document.getElementById("schools-list").innerHTML=html}function runFilters(){if(filteredItems=[].concat(_toConsumableArray(rawData)),!filters.stateabbr)return printInfoBox(filters),errorMessage.removeClass("hide");errorMessage.addClass("hide"),Object.keys(filters).forEach(function(key){var filterValue=filters[key];if(filterValue&&0!==filterValue.length)switch(key){case"stateabbr":filteredItems="string"==typeof filterValue?filteredItems.filter(function(school){return school.stateabbr===filterValue}):filteredItems.filter(function(school){return filterValue.includes(school.stateabbr)});break;case"programs":filteredItems=filteredItems.filter(function(school){return 0===filterValue[0]?school:carriesPrograms(filterValue,school[key])});break;case"schoolcontrol":case"urbanization":filteredItems=filteredItems.filter(function(school){return filterValue.includes(school[key])});break;case"enrollment1617":case"size":var spl,spl2,spl3;filters[key].length>3?filteredItems=filteredItems:3===filters[key].length?(spl=filters[key][0].split(","),spl2=filters[key][1].split(","),spl3=filters[key][2].split(","),filteredItems=filteredItems.filter(function(school){return school.enrollment1617>parseInt(spl[0])&&school.enrollment1617<parseInt(spl[1])||school.enrollment1617>parseInt(spl2[0])&&school.enrollment1617<parseInt(spl2[1])||school.enrollment1617>parseInt(spl3[0])&&school.enrollment1617<parseInt(spl3[1])})):2===filters[key].length?(spl=filters[key][0].split(","),spl2=filters[key][1].split(","),filteredItems=filteredItems.filter(function(school){return school.enrollment1617>parseInt(spl[0])&&school.enrollment1617<parseInt(spl[1])||school.enrollment1617>parseInt(spl2[0])&&school.enrollment1617<parseInt(spl2[1])})):(spl=filters[key][0].split(","),filteredItems=filteredItems.filter(function(school){return school.enrollment1617>parseInt(spl[0])&&school.enrollment1617<parseInt(spl[1])}))}}),printInfoBox(filters)}function setEventForSchoolType(){$("#input_tagator1").on("change",handleTagChange),$(".chk").on("change",handleCheckBoxChange),$("#states").on("change",onSelectChange),$("rect").click(mapClick)}function getSchoolNames(data){$.each(data,function(k,v){-1!==schoolNames.indexOf(v.schoolname)&&-1!==schoolNames.indexOf(v.aliasname)||schoolNames.push(v.schoolname)})}function mapClick(){var stateId=$(this).attr("id");states.includes(stateId)?states=states.filter(function(state){return state!=stateId}):states.push(stateId),$("#states").val(stateId);$("#states option:selected").text();setState(stateId),filters.stateabbr=states,runFilters(),printSchoolList()}function onSelectChange(ev){var selectedState=$("#states").val();filters.stateabbr=selectedState,states.push(selectedState),setState(selectedState),runFilters(),printSchoolList()}function printInfoBox(filters){var stateName=($("#states").find(":selected").index(),states.join(", ")),priceSpan=$(".price:checked").attr("data-label"),sizeSpan=$("#choose-size input:checkbox:checked").map(function(){return this.value}).get().join(", "),selectedType=$("#choose-type input:checkbox:checked").map(function(){return this.value}).get().join(", "),selectedDegree=$("#choose-degree input:checkbox:checked").map(function(){return this.value}).get().join(", ");$(".chosen-state span").html(stateName||"NO SELECTION(S) MADE"),$(".chosen-price span").html(priceSpan||"NO SELECTION(S) MADE"),$(".chosen-degree span").html(selectedDegree||"NO SELECTION(S) MADE"),$(".chosen-type span").html(selectedType||"NO SELECTION(S) MADE"),$(".chosen-size span").html(sizeSpan||"NO SELECTION(S) MADE"),$(".your-schools span").html(filteredItems.length)}function setState(stateId){$("#"+stateId).hasClass("state-selected")?$("#"+stateId).removeClass("state-selected"):$("#"+stateId).addClass("state-selected")}require("./jquery-ui.min"),require("./fm.tagator.jquery");var _social=require("../js/social.js"),_app=(_interopRequireDefault(_social),require("firebase/app")),_app2=_interopRequireDefault(_app);require("firebase/database");var config={apiKey:"AIzaSyAy-ss_MvS5uioLUdxTYkuuhed-HjW0RkE",authDomain:"newagent-50447.firebaseapp.com",databaseURL:"https://newagent-50447.firebaseio.com",projectId:"newagent-50447",storageBucket:"newagent-50447.appspot.com",messagingSenderId:"920466406897"};_app2.default.initializeApp(config);var rawData=[],schoolNames=[],filteredItems=[],listLength=void 0,states=[],schoolUrl="school.html?unitid=",errorMessage=$("#progress-box .error, #progress-box-mobile .error"),schoolListUl=$("#schools-list"),programArray=["Agriculture Agriculture Operations and Related Sciences","Natural Resources and Conservation","Architecture and Related Services","Area Ethnic Cultural Gender and Group Studies","Communication Journalism and Related Programs","Communications Technologies/Technicians and Support Services","Computer and Information Sciences and Support Services","Personal and Culinary Services","Education","Engineering","Engineering Technologies and Engineering-Related Fields","Foreign Languages Literatures and Linguistics","Family and Consumer Sciences/Human Sciences","Legal Professions and Studies","English Language and Literature/Letters","Liberal Arts and Sciences General Studies and Humanities","Library Science","Biological and Biomedical Sciences","Mathematics and Statistics","Military Technologies and Applied Sciences","Multi/Interdisciplinary Studies","Parks Recreation Leisure and Fitness Studies","Philosophy and Religious Studies","Theology and Religious Vocations","Physical Sciences","Science Technologies/Technicians","Psychology","Homeland Security Law Enforcement Firefighting and Related Protective Services","Public Administration and Social Service Professions","Social Sciences","Construction Trades","Mechanic and Repair Technologies/Technicians","Precision Production","Transportation and Materials Moving","Visual and Performing Arts","Health Professions and Related Programs","Business Management Marketing and Related Support Services","History"],filters={stateabbr:null,schoolcontrol:null,programs:null,urbanization:null,enrollment1617:null,degreetype:null};$(function(){fetchInitialData(),registerAllEvents(),$("#search-results").hide()});var fetchInitialData=function(){$.getJSON("./data/form-data.json",function(data){rawData=data,getSchoolNames(data),filteredItems=[].concat(_toConsumableArray(rawData)),printInfoBox(filters)})},ref=(_app2.default.database(),_app2.default.database().ref("searches")),registerAllEvents=function(){setEventForSchoolType(),setSearchBehavior(),schoolListUl.click(function(ev){ev.preventDefault();var target=ev.target;if(target.href){showSearchResult({unitid:$(target).data("unitid")})}}),$(".btn").click(function(){var tabId=$(this).attr("data-tab");$(".btn").removeClass("selected-btn"),$(".tab-content").css("display","none"),$(this).addClass("selected-btn"),$("#"+tabId).addClass("selected-btn").css("display","block")}),$("#filter-search").click(function(e){if("find"===$(this).attr("data-function"))if(e.preventDefault(),null!==filters.stateabbr){var allChoices=[];errorMessage.addClass("hide"),$("#search-results").show(),allChoices.push(filters.schoolcontrol,filters.enrollment1617,filters.degreetype,$("#states").val()),ref.push(allChoices),$(this).attr("data-function","again"),$(this).text("SEARCH AGAIN"),setTimeout(function(){$("html, body").animate({scrollTop:$("#filter-search").offset().top-65},400)},50)}else $("#search-results").hide(),errorMessage.removeClass("hide"),$(this).attr("data-function","find"),$(this).text("FIND SCHOOLS");else location.reload()})},setSearchBehavior=function(){var resultingSchool=void 0;$("#search, #results-search").click(function(evt){evt.preventDefault(),determineSchool(resultingSchool)}),$("#tags, #schools-searchbar").keyup(function(e){$(this).is(":focus")&&13===e.keyCode&&determineSchool(resultingSchool)}),$("#tags, #schools-searchbar").autocomplete({source:function(request,response){var term=request.term.toLowerCase(),matchingSchools=rawData.filter(function(school){return(school.schoolname.toLowerCase()+school.aliasname.toLowerCase()).includes(term)}).map(function(school){return school.schoolname});listLength=matchingSchools.length,response(matchingSchools)},delay:600,minLength:3,select:function(event,ui){var schoolSelected=ui.item.value;resultingSchool=rawData.find(function(school){return school.schoolname===schoolSelected})}})};$(function(){var $input_tagator1=$("#input_tagator1"),$activate_tagator1=$("#activate_tagator1");$activate_tagator1.click(function(){void 0===$input_tagator1.data("tagator")?($input_tagator1.tagator({autocomplete:[""],useDimmer:!1}),
$activate_tagator1.val("destroy tagator")):($input_tagator1.tagator("destroy"),$activate_tagator1.val("activate tagator"))}),$activate_tagator1.trigger("click")}),$("#input_tagator1").tagator({autocomplete:["Agriculture Agriculture Operations and Related Sciences","Architecture and Related Services","Area Ethnic Cultural Gender and Group Studies","Biological and Biomedical Sciences","Business Management Marketing and Related Support Services","Communication Journalism and Related Programs","Communications Technologies/Technicians and Support Services","Computer and Information Sciences and Support Services","Construction Trades","Education","Engineering","Engineering Technologies and Engineering-Related Fields","English Language and Literature/Letters","Family and Consumer Sciences/Human Sciences","Foreign Languages Literatures and Linguistics","Health Professions and Related Programs","History","Homeland Security Law Enforcement Firefighting and Related Protective Services","Legal Professions and Studies","Liberal Arts and Sciences General Studies and Humanities","Library Science","Mathematics and Statistics","Mechanic and Repair Technologies/Technicians","Military Technologies and Applied Sciences","Multi/Interdisciplinary Studies","Natural Resources and Conservation","Parks Recreation Leisure and Fitness Studies","Personal and Culinary Services","Philosophy and Religious Studies","Physical Sciences","Precision Production","Psychology","Public Administration and Social Service Professions","Science Technologies/Technicians","Social Sciences","Theology and Religious Vocations","Transportation and Materials Moving","Visual and Performing Arts"],useDimmer:!1})},{"../js/social.js":93,"./fm.tagator.jquery":86,"./jquery-ui.min":90,"firebase/app":48,"firebase/database":49}],90:[function(require,module,exports){"use strict";!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(t){for(var e=t.css("visibility");"inherit"===e;)t=t.parent(),e=t.css("visibility");return"hidden"!==e}t.ui=t.ui||{},t.ui.version="1.12.1";var i=0,s=Array.prototype.slice;t.cleanData=function(e){return function(i){var s,n,o;for(o=0;null!=(n=i[o]);o++)try{(s=t._data(n,"events"))&&s.remove&&t(n).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,s){var n,o,a,r={},l=e.split(".")[0];e=e.split(".")[1];var h=l+"-"+e;return s||(s=i,i=t.Widget),t.isArray(s)&&(s=t.extend.apply(null,[{}].concat(s))),t.expr[":"][h.toLowerCase()]=function(e){return!!t.data(e,h)},t[l]=t[l]||{},n=t[l][e],o=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new o(t,e)},t.extend(o,n,{version:s.version,_proto:t.extend({},s),_childConstructors:[]}),a=new i,a.options=t.widget.extend({},a.options),t.each(s,function(e,s){return t.isFunction(s)?void(r[e]=function(){function t(){return i.prototype[e].apply(this,arguments)}function n(t){return i.prototype[e].apply(this,t)}return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=n,e=s.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(r[e]=s)}),o.prototype=t.widget.extend(a,{widgetEventPrefix:n?a.widgetEventPrefix||e:e},r,{constructor:o,namespace:l,widgetName:e,widgetFullName:h}),n?(t.each(n._childConstructors,function(e,i){var s=i.prototype;t.widget(s.namespace+"."+s.widgetName,o,i._proto)}),delete n._childConstructors):i._childConstructors.push(o),t.widget.bridge(e,o),o},t.widget.extend=function(e){for(var i,n,o=s.call(arguments,1),a=0,r=o.length;r>a;a++)for(i in o[a])n=o[a][i],o[a].hasOwnProperty(i)&&void 0!==n&&(e[i]=t.isPlainObject(n)?t.isPlainObject(e[i])?t.widget.extend({},e[i],n):t.widget.extend({},n):n);return e},t.widget.bridge=function(e,i){var n=i.prototype.widgetFullName||e;t.fn[e]=function(o){var a="string"==typeof o,r=s.call(arguments,1),l=this;return a?this.length||"instance"!==o?this.each(function(){var i,s=t.data(this,n);return"instance"===o?(l=s,!1):s?t.isFunction(s[o])&&"_"!==o.charAt(0)?(i=s[o].apply(s,r),i!==s&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+o+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+o+"'")}):l=void 0:(r.length&&(o=t.widget.extend.apply(null,[o].concat(r))),this.each(function(){var e=t.data(this,n);e?(e.option(o||{}),e._init&&e._init()):t.data(this,n,new i(o,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(e,s){s=t(s||this.defaultElement||this)[0],this.element=t(s),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},s!==this&&(t.data(s,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===s&&this.destroy()}}),this.document=t(s.style?s.ownerDocument:s.document||s),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,function(t,i){e._removeClass(i,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var s,n,o,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},s=e.split("."),e=s.shift(),s.length){for(n=a[e]=t.widget.extend({},this.options[e]),o=0;s.length-1>o;o++)n[s[o]]=n[s[o]]||{},n=n[s[o]];if(e=s.pop(),1===arguments.length)return void 0===n[e]?null:n[e];n[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,s,n;for(i in e)n=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&n&&n.length&&(s=t(n.get()),this._removeClass(n,i),s.addClass(this._classes({element:s,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){function i(i,o){var a,r;for(r=0;i.length>r;r++)a=n.classesElementLookup[i[r]]||t(),a=t(e.add?t.unique(a.get().concat(e.element.get())):a.not(e.element).get()),n.classesElementLookup[i[r]]=a,s.push(i[r]),o&&e.classes[i[r]]&&s.push(e.classes[i[r]])}var s=[],n=this;return e=t.extend({element:this.element,classes:this.options.classes||{}},e),this._on(e.element,{remove:"_untrackClassesElement"}),e.keys&&i(e.keys.match(/\S+/g)||[],!0),e.extra&&i(e.extra.match(/\S+/g)||[]),s.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,function(s,n){-1!==t.inArray(e.target,n)&&(i.classesElementLookup[s]=t(n.not(e.target).get()))})},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){s="boolean"==typeof s?s:i;var n="string"==typeof t||null===t,o={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s};return o.element.toggleClass(this._classes(o),s),this},_on:function(e,i,s){var n,o=this;"boolean"!=typeof e&&(s=i,i=e,e=!1),s?(i=n=t(i),this.bindings=this.bindings.add(i)):(s=i,i=this.element,n=this.widget()),t.each(s,function(s,a){function r(){return e||!0!==o.options.disabled&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?o[a]:a).apply(o,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=s.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+o.eventNamespace,c=l[2];c?n.on(h,c,r):i.on(h,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i).off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?s[t]:t).apply(s,arguments)}var s=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,s){var n,o,a=this.options[e];if(s=s||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(n in o)n in i||(i[n]=o[n]);return this.element.trigger(i,s),!(t.isFunction(a)&&!1===a.apply(this.element[0],[i].concat(s))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(s,n,o){"string"==typeof n&&(n={effect:n});var a,r=n?!0===n||"number"==typeof n?i:n.effect||i:e;n=n||{},"number"==typeof n&&(n={duration:n}),a=!t.isEmptyObject(n),n.complete=o,n.delay&&s.delay(n.delay),a&&t.effects&&t.effects.effect[r]?s[e](n):r!==e&&s[r]?s[r](n.duration,n.easing,o):s.queue(function(i){t(this)[e](),o&&o.call(s[0]),i()})}}),t.widget,function(){function e(t,e,i){return[parseFloat(t[0])*(u.test(t[0])?e/100:1),parseFloat(t[1])*(u.test(t[1])?i/100:1)]}function i(e,i){return parseInt(t.css(e,i),10)||0}function s(e){var i=e[0];return 9===i.nodeType?{width:e.width(),height:e.height(),offset:{top:0,left:0}}:t.isWindow(i)?{width:e.width(),height:e.height(),offset:{top:e.scrollTop(),left:e.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:e.outerWidth(),height:e.outerHeight(),offset:e.offset()}}var n,o=Math.max,a=Math.abs,r=/left|center|right/,l=/top|center|bottom/,h=/[\+\-]\d+(\.[\d]+)?%?/,c=/^\w+/,u=/%$/,d=t.fn.position;t.position={scrollbarWidth:function(){if(void 0!==n)return n;var e,i,s=t("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=s.children()[0];return t("body").append(s),e=o.offsetWidth,s.css("overflow","scroll"),i=o.offsetWidth,e===i&&(i=s[0].clientWidth),s.remove(),n=e-i},getScrollInfo:function(e){var i=e.isWindow||e.isDocument?"":e.element.css("overflow-x"),s=e.isWindow||e.isDocument?"":e.element.css("overflow-y"),n="scroll"===i||"auto"===i&&e.width<e.element[0].scrollWidth;return{width:"scroll"===s||"auto"===s&&e.height<e.element[0].scrollHeight?t.position.scrollbarWidth():0,height:n?t.position.scrollbarWidth():0}},getWithinInfo:function(e){var i=t(e||window),s=t.isWindow(i[0]),n=!!i[0]&&9===i[0].nodeType;return{element:i,isWindow:s,isDocument:n,offset:s||n?{left:0,top:0}:t(e).offset(),scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:i.outerWidth(),height:i.outerHeight()}}},t.fn.position=function(n){if(!n||!n.of)return d.apply(this,arguments);n=t.extend({},n);var u,p,f,g,m,_,v=t(n.of),b=t.position.getWithinInfo(n.within),y=t.position.getScrollInfo(b),w=(n.collision||"flip").split(" "),k={};return _=s(v),v[0].preventDefault&&(n.at="left top"),p=_.width,f=_.height,g=_.offset,m=t.extend({},g),t.each(["my","at"],function(){var t,e,i=(n[this]||"").split(" ");1===i.length&&(i=r.test(i[0])?i.concat(["center"]):l.test(i[0])?["center"].concat(i):["center","center"]),i[0]=r.test(i[0])?i[0]:"center",i[1]=l.test(i[1])?i[1]:"center",t=h.exec(i[0]),e=h.exec(i[1]),k[this]=[t?t[0]:0,e?e[0]:0],n[this]=[c.exec(i[0])[0],c.exec(i[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===n.at[0]?m.left+=p:"center"===n.at[0]&&(m.left+=p/2),"bottom"===n.at[1]?m.top+=f:"center"===n.at[1]&&(m.top+=f/2),u=e(k.at,p,f),m.left+=u[0],m.top+=u[1],this.each(function(){var s,r,l=t(this),h=l.outerWidth(),c=l.outerHeight(),d=i(this,"marginLeft"),_=i(this,"marginTop"),x=h+d+i(this,"marginRight")+y.width,C=c+_+i(this,"marginBottom")+y.height,D=t.extend({},m),T=e(k.my,l.outerWidth(),l.outerHeight());"right"===n.my[0]?D.left-=h:"center"===n.my[0]&&(D.left-=h/2),"bottom"===n.my[1]?D.top-=c:"center"===n.my[1]&&(D.top-=c/2),D.left+=T[0],D.top+=T[1],s={marginLeft:d,marginTop:_},t.each(["left","top"],function(e,i){t.ui.position[w[e]]&&t.ui.position[w[e]][i](D,{targetWidth:p,targetHeight:f,elemWidth:h,elemHeight:c,collisionPosition:s,collisionWidth:x,collisionHeight:C,offset:[u[0]+T[0],u[1]+T[1]],my:n.my,at:n.at,within:b,elem:l})}),n.using&&(r=function(t){var e=g.left-D.left,i=e+p-h,s=g.top-D.top,r=s+f-c,u={target:{element:v,left:g.left,top:g.top,width:p,height:f},element:{element:l,left:D.left,top:D.top,width:h,height:c},horizontal:0>i?"left":e>0?"right":"center",vertical:0>r?"top":s>0?"bottom":"middle"};h>p&&p>a(e+i)&&(u.horizontal="center"),c>f&&f>a(s+r)&&(u.vertical="middle"),u.important=o(a(e),a(i))>o(a(s),a(r))?"horizontal":"vertical",n.using.call(this,t,u)}),l.offset(t.extend(D,{using:r}))})},t.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,a=s.width,r=t.left-e.collisionPosition.marginLeft,l=n-r,h=r+e.collisionWidth-a-n;e.collisionWidth>a?l>0&&0>=h?(i=t.left+l+e.collisionWidth-a-n,t.left+=l-i):t.left=h>0&&0>=l?n:l>h?n+a-e.collisionWidth:n:l>0?t.left+=l:h>0?t.left-=h:t.left=o(t.left-r,t.left)},top:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollTop:s.offset.top,a=e.within.height,r=t.top-e.collisionPosition.marginTop,l=n-r,h=r+e.collisionHeight-a-n;e.collisionHeight>a?l>0&&0>=h?(i=t.top+l+e.collisionHeight-a-n,t.top+=l-i):t.top=h>0&&0>=l?n:l>h?n+a-e.collisionHeight:n:l>0?t.top+=l:h>0?t.top-=h:t.top=o(t.top-r,t.top)}},flip:{left:function(t,e){var i,s,n=e.within,o=n.offset.left+n.scrollLeft,r=n.width,l=n.isWindow?n.scrollLeft:n.offset.left,h=t.left-e.collisionPosition.marginLeft,c=h-l,u=h+e.collisionWidth-r-l,d="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,p="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,f=-2*e.offset[0];0>c?(0>(i=t.left+d+p+f+e.collisionWidth-r-o)||a(c)>i)&&(t.left+=d+p+f):u>0&&((s=t.left-e.collisionPosition.marginLeft+d+p+f-l)>0||u>a(s))&&(t.left+=d+p+f)},top:function(t,e){var i,s,n=e.within,o=n.offset.top+n.scrollTop,r=n.height,l=n.isWindow?n.scrollTop:n.offset.top,h=t.top-e.collisionPosition.marginTop,c=h-l,u=h+e.collisionHeight-r-l,d="top"===e.my[1],p=d?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,f="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,g=-2*e.offset[1];0>c?(0>(s=t.top+p+f+g+e.collisionHeight-r-o)||a(c)>s)&&(t.top+=p+f+g):u>0&&((i=t.top-e.collisionPosition.marginTop+p+f+g-l)>0||u>a(i))&&(t.top+=p+f+g)}},flipfit:{left:function(){t.ui.position.flip.left.apply(this,arguments),t.ui.position.fit.left.apply(this,arguments)},top:function(){t.ui.position.flip.top.apply(this,arguments),t.ui.position.fit.top.apply(this,arguments)}}}}(),t.ui.position,t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,s){return!!t.data(e,s[3])}}),t.fn.extend({disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.on(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.off(".ui-disableSelection")}}),t.ui.focusable=function(i,s){var n,o,a,r,l,h=i.nodeName.toLowerCase();return"area"===h?(n=i.parentNode,o=n.name,!(!i.href||!o||"map"!==n.nodeName.toLowerCase())&&(a=t("img[usemap='#"+o+"']"),a.length>0&&a.is(":visible"))):(/^(input|select|textarea|button|object)$/.test(h)?(r=!i.disabled)&&(l=t(i).closest("fieldset")[0])&&(r=!l.disabled):r="a"===h?i.href||s:s,r&&t(i).is(":visible")&&e(t(i)))},t.extend(t.expr[":"],{focusable:function(e){return t.ui.focusable(e,null!=t.attr(e,"tabindex"))}}),t.ui.focusable,t.fn.form=function(){return"string"==typeof this[0].form?this.closest("form"):t(this[0].form)},t.ui.formResetMixin={_formResetHandler:function(){var e=t(this);setTimeout(function(){var i=e.data("ui-form-reset-instances");t.each(i,function(){this.refresh()})})},_bindFormResetHandler:function(){if(this.form=this.element.form(),this.form.length){var t=this.form.data("ui-form-reset-instances")||[];t.length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t)}},_unbindFormResetHandler:function(){if(this.form.length){var e=this.form.data("ui-form-reset-instances");e.splice(t.inArray(this,e),1),e.length?this.form.data("ui-form-reset-instances",e):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset")}}},"1.7"===t.fn.jquery.substring(0,3)&&(t.each(["Width","Height"],function(e,i){function s(e,i,s,o){return t.each(n,function(){i-=parseFloat(t.css(e,"padding"+this))||0,s&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),o&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var n="Width"===i?["Left","Right"]:["Top","Bottom"],o=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(o,s(this,e)+"px")})},t.fn["outer"+i]=function(e,n){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,n)+"px")})}}),t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t.ui.keyCode={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},t.ui.escapeSelector=function(){var t=/([!"#$%&'()*+,.\/:;<=>?@[\]^`{|}~])/g;return function(e){return e.replace(t,"\\$1")}}(),t.fn.labels=function(){var e,i,s,n,o;return this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(n=this.eq(0).parents("label"),s=this.attr("id"),s&&(e=this.eq(0).parents().last(),o=e.add(e.length?e.siblings():this.siblings()),i="label[for='"+t.ui.escapeSelector(s)+"']",n=n.add(o.find(i).addBack(i))),this.pushStack(n))},t.fn.scrollParent=function(e){var i=this.css("position"),s="absolute"===i,n=e?/(auto|scroll|hidden)/:/(auto|scroll)/,o=this.parents().filter(function(){var e=t(this);return(!s||"static"!==e.css("position"))&&n.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&o.length?o:t(this[0].ownerDocument||document)},t.extend(t.expr[":"],{tabbable:function(e){var i=t.attr(e,"tabindex"),s=null!=i;return(!s||i>=0)&&t.ui.focusable(e,s)}}),t.fn.extend({uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.ui.safeActiveElement=function(t){var e;try{e=t.activeElement}catch(i){e=t.body}return e||(e=t.body),e.nodeName||(e=t.body),e},t.widget("ui.menu",{version:"1.12.1",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu","ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault()},"click .ui-menu-item":function(e){var i=t(e.target),s=t(t.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&i.not(".ui-state-disabled").length&&(this.select(e),e.isPropagationStopped()||(this.mouseHandled=!0),i.has(".ui-menu").length?this.expand(e):!this.element.is(":focus")&&s.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){if(!this.previousFilter){var i=t(e.target).closest(".ui-menu-item"),s=t(e.currentTarget);i[0]===s[0]&&(this._removeClass(s.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(e,s))}},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this.element.find(this.options.items).eq(0);e||this.focus(t,i)},blur:function(e){this._delay(function(){!t.contains(this.element[0],t.ui.safeActiveElement(this.document[0]))&&this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t),this.mouseHandled=!1}})},_destroy:function(){var e=this.element.find(".ui-menu-item").removeAttr("role aria-disabled"),i=e.children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),i.children().each(function(){var e=t(this);e.data("ui-menu-submenu-caret")&&e.remove()})},_keydown:function(e){var i,s,n,o,a=!0;switch(e.keyCode){case t.ui.keyCode.PAGE_UP:this.previousPage(e);break;case t.ui.keyCode.PAGE_DOWN:this.nextPage(e);break;case t.ui.keyCode.HOME:this._move("first","first",e);break;case t.ui.keyCode.END:this._move("last","last",e);break;case t.ui.keyCode.UP:this.previous(e);break;case t.ui.keyCode.DOWN:this.next(e);break;case t.ui.keyCode.LEFT:this.collapse(e);break;case t.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(e);break;case t.ui.keyCode.ENTER:case t.ui.keyCode.SPACE:this._activate(e);break;case t.ui.keyCode.ESCAPE:this.collapse(e);break;default:a=!1,s=this.previousFilter||"",o=!1,n=e.keyCode>=96&&105>=e.keyCode?""+(e.keyCode-96):String.fromCharCode(e.keyCode),clearTimeout(this.filterTimer),n===s?o=!0:n=s+n,i=this._filterMenuItems(n),i=o&&-1!==i.index(this.active.next())?this.active.nextAll(".ui-menu-item"):i,i.length||(n=String.fromCharCode(e.keyCode),i=this._filterMenuItems(n)),i.length?(this.focus(e,i),this.previousFilter=n,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter}a&&e.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):this.select(t))},refresh:function(){var e,i,s,n,o,a=this,r=this.options.icons.submenu,l=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),s=l.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var e=t(this),i=e.prev(),s=t("<span>").data("ui-menu-submenu-caret",!0);a._addClass(s,"ui-menu-icon","ui-icon "+r),i.attr("aria-haspopup","true").prepend(s),e.attr("aria-labelledby",i.attr("id"))}),this._addClass(s,"ui-menu","ui-widget ui-widget-content ui-front"),e=l.add(this.element),i=e.find(this.options.items),i.not(".ui-menu-item").each(function(){var e=t(this);a._isDivider(e)&&a._addClass(e,"ui-menu-divider","ui-widget-content")}),n=i.not(".ui-menu-item, .ui-menu-divider"),o=n.children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(n,"ui-menu-item")._addClass(o,"ui-menu-item-wrapper"),i.filter(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!t.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){if("icons"===t){var i=this.element.find(".ui-menu-icon");this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)}this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t+""),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i,s,n;this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),s=this.active.children(".ui-menu-item-wrapper"),this._addClass(s,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",s.attr("id")),n=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(n,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),i=e.children(".ui-menu"),i.length&&t&&/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(e){var i,s,n,o,a,r;this._hasScroll()&&(i=parseFloat(t.css(this.activeMenu[0],"borderTopWidth"))||0,s=parseFloat(t.css(this.activeMenu[0],"paddingTop"))||0,n=e.offset().top-this.activeMenu.offset().top-i-s,o=this.activeMenu.scrollTop(),a=this.activeMenu.height(),r=e.outerHeight(),0>n?this.activeMenu.scrollTop(o+n):n+r>a&&this.activeMenu.scrollTop(o+n-a+r))},blur:function(t,e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(e){var i=t.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(i)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var s=i?this.element:t(e&&e.target).closest(this.element.find(".ui-menu"));s.length||(s=this.element),this._close(s),this.blur(e),this._removeClass(s.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=s},this.delay)},_close:function(t){t||(t=this.active?this.active.parent():this.element),t.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false")},_closeOnDocumentClick:function(e){return!t(e.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this.active.children(".ui-menu ").find(this.options.items).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(t,e,i){var s;this.active&&(s="first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[t+"All"](".ui-menu-item").eq(0)),s&&s.length&&this.active||(s=this.activeMenu.find(this.options.items)[e]()),this.focus(i,s)},nextPage:function(e){var i,s,n;return this.active?void(this.isLastItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return i=t(this),0>i.offset().top-s-n}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items)[this.active?"last":"first"]()))):void this.next(e)},previousPage:function(e){var i,s,n;return this.active?void(this.isFirstItem()||(this._hasScroll()?(s=this.active.offset().top,n=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return i=t(this),i.offset().top-s+n>0}),this.focus(e,i)):this.focus(e,this.activeMenu.find(this.options.items).first()))):void this.next(e)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||t(e.target).closest(".ui-menu-item");var i={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,i)},_filterMenuItems:function(e){var i=e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),s=RegExp("^"+i,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return s.test(t.trim(t(this).children(".ui-menu-item-wrapper").text()))})}}),t.widget("ui.autocomplete",{version:"1.12.1",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var e,i,s,n=this.element[0].nodeName.toLowerCase(),o="textarea"===n,a="input"===n;this.isMultiLine=o||!a&&this._isContentEditable(this.element),this.valueMethod=this.element[o||a?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(n){if(this.element.prop("readOnly"))return e=!0,s=!0,void(i=!0);e=!1,s=!1,i=!1;var o=t.ui.keyCode;switch(n.keyCode){case o.PAGE_UP:e=!0,this._move("previousPage",n);break;case o.PAGE_DOWN:e=!0,this._move("nextPage",n);break;case o.UP:e=!0,this._keyEvent("previous",n);break;case o.DOWN:e=!0,this._keyEvent("next",n);break;case o.ENTER:this.menu.active&&(e=!0,n.preventDefault(),this.menu.select(n));break;case o.TAB:this.menu.active&&this.menu.select(n);break;case o.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(n),n.preventDefault());break;default:i=!0,this._searchTimeout(n)}},keypress:function(s){if(e)return e=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&s.preventDefault());if(!i){var n=t.ui.keyCode;switch(s.keyCode){case n.PAGE_UP:this._move("previousPage",s);break;case n.PAGE_DOWN:this._move("nextPage",s);break;case n.UP:this._keyEvent("previous",s);break;case n.DOWN:this._keyEvent("next",s)}}},input:function(t){return s?(s=!1,void t.preventDefault()):void this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(t),void this._change(t))}}),this._initSource(),this.menu=t("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),this._on(this.menu.element,{mousedown:function(e){e.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,this.element[0]!==t.ui.safeActiveElement(this.document[0])&&this.element.trigger("focus")})},menufocus:function(e,i){var s,n;return this.isNewMenu&&(this.isNewMenu=!1,e.originalEvent&&/^mouse/.test(e.originalEvent.type))?(this.menu.blur(),void this.document.one("mousemove",function(){t(e.target).trigger(e.originalEvent)})):(n=i.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",e,{item:n})&&e.originalEvent&&/^key/.test(e.originalEvent.type)&&this._value(n.value),void((s=i.item.attr("aria-label")||n.value)&&t.trim(s).length&&(this.liveRegion.children().hide(),t("<div>").text(s).appendTo(this.liveRegion))))},menuselect:function(e,i){var s=i.item.data("ui-autocomplete-item"),n=this.previous
;this.element[0]!==t.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=n,this._delay(function(){this.previous=n,this.selectedItem=s})),!1!==this._trigger("select",e,{item:s})&&this._value(s.value),this.term=this._value(),this.close(e),this.selectedItem=s}}),this.liveRegion=t("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(e){var i=this.menu.element[0];return e.target===this.element[0]||e.target===i||t.contains(i,e.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var e=this.options.appendTo;return e&&(e=e.jquery||e.nodeType?t(e):this.document.find(e).eq(0)),e&&e[0]||(e=this.element.closest(".ui-front, dialog")),e.length||(e=this.document[0].body),e},_initSource:function(){var e,i,s=this;t.isArray(this.options.source)?(e=this.options.source,this.source=function(i,s){s(t.ui.autocomplete.filter(e,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(e,n){s.xhr&&s.xhr.abort(),s.xhr=t.ajax({url:i,data:e,dataType:"json",success:function(t){n(t)},error:function(){n([])}})}):this.source=this.options.source},_searchTimeout:function(t){clearTimeout(this.searching),this.searching=this._delay(function(){var e=this.term===this._value(),i=this.menu.element.is(":visible"),s=t.altKey||t.ctrlKey||t.metaKey||t.shiftKey;(!e||e&&!i&&!s)&&(this.selectedItem=null,this.search(null,t))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},_response:function(){var e=++this.requestIndex;return t.proxy(function(t){e===this.requestIndex&&this.__response(t),--this.pending||this._removeClass("ui-autocomplete-loading")},this)},__response:function(t){t&&(t=this._normalize(t)),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:t.map(e,function(e){return"string"==typeof e?{label:e,value:e}:t.extend({},e,{label:e.label||e.value,value:e.value||e.label})})},_suggest:function(e){var i=this.menu.element.empty();this._renderMenu(i,e),this.isNewMenu=!0,this.menu.refresh(),i.show(),this._resizeMenu(),i.position(t.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,i){var s=this;t.each(i,function(t,i){s._renderItemData(e,i)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",e)},_renderItem:function(e,i){return t("<li>").append(t("<div>").text(i.label)).appendTo(e)},_move:function(t,e){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),void this.menu.blur()):void this.menu[t](e):void this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){if(!t.length)return!1;var e=t.prop("contentEditable");return"inherit"===e?this._isContentEditable(t.parent()):"true"===e}}),t.extend(t.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,i){var s=RegExp(t.ui.autocomplete.escapeRegex(i),"i");return t.grep(e,function(t){return s.test(t.label||t.value||t)})}}),t.widget("ui.autocomplete",t.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(t){return t+(t>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(e){var i;this._superApply(arguments),this.options.disabled||this.cancelSearch||(i=e&&e.length?this.options.messages.results(e.length):this.options.messages.noResults,this.liveRegion.children().hide(),t("<div>").text(i).appendTo(this.liveRegion))}}),t.ui.autocomplete})},{}],91:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function findData(retention,radioValue){var chartableRetention=retention.yearly_data.slice(1,10).reverse();return 4===retention.level||5===retention.level||6===retention.level?chartableRetention.map(function(year){return(0,_jquery2.default)("#retention-placeholder").hide(),{sector:1,timescale:"20"+year.year.slice(0,2),ftRetentionPct:year.full_time_retention_rate,ptRetentionPct:year.part_time_retention_rate}}):chartableRetention.map(function(year){return(0,_jquery2.default)("#retention-placeholder").hide(),{sector:0,timescale:"20"+year.year.slice(0,2),ftRetentionPct:year.full_time_retention_rate,ptRetentionPct:year.part_time_retention_rate}})}function isitChartable(data){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if(_step.value.ftRetentionPct)return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function runData(datafile){isitChartable(datafile)||((0,_jquery2.default)("#retention-container").hide(),(0,_jquery2.default)("#retention-placeholder").show());var margin=(d3.format(","),{top:15,right:25,bottom:130,left:0}),height=100-margin.top-margin.bottom,windowWidth=void 0;windowWidth=(0,_jquery2.default)(window).width()<=650?(0,_jquery2.default)("#demographics").width():(0,_jquery2.default)(window).width();var width=Math.min(625,(0,_jquery2.default)(window).width()-margin.left-margin.right),chartWidth=Math.min(600,windowWidth),x=d3.scaleLinear().domain([0,100]).range([0,chartWidth]),globalRetPool=["ft","pt"],globalReadableRet=["FULL-TIME","PART-TIME"],retColors=["#000000","#00aeef"],rectangles=globalRetPool.map(function(type){return{label:type,value:datafile[6][type+"RetentionPct"]}}),svg=d3.select("#retention-rates-chart").attr("width",width).attr("height",height+margin.top+margin.bottom),group=svg.selectAll("g").data(rectangles).enter().append("g").attr("transform",function(d,i){return"translate("+margin.left+","+(45*i+margin.top)+")"}).attr("class",function(d,i){return d.label});group.append("rect").attr("class","dummy-bar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",45).attr("fill","white"),group.append("rect").attr("class","backBar").attr("width",chartWidth).attr("y",0).attr("x",0).attr("height",25).attr("fill","#ebebeb"),group.append("rect").attr("class","bar-fill").attr("width",0).attr("x",0).attr("y",0).attr("height",25).attr("fill",function(d,i){return d3.rgb(retColors[i]).darker(.5)}).transition().delay(function(d,i){return 40*i}).attr("width",function(d,i){return x(d.value)}),group.append("text").attr("class","bar-label").attr("x",0).attr("y",17).text(function(d,i){return null==d.value||isNaN(d.value)?"N/A":Math.round(d.value)+"%"}).attr("fill",function(d,i){return null==d.value||isNaN(d.value)?"#c4c4c4":d.value<90?"black":"white"}).attr("opacity",0).transition().delay(function(d,i){return 40*i+80}).attr("opacity",1).attr("x",function(d,i){return null==d.value||isNaN(d.value)?x(50):d.value<90?x(d.value)+5:x(d.value)-40}),group.append("text").classed("label",!0).attr("height",70).attr("x",0).attr("y",38).attr("dy",0).text(function(d,i){return globalReadableRet[i]}).attr("opacity",0).transition().delay(function(d,i){return 40*i+500}).attr("opacity",1),group.append("path").attr("class","triangle").attr("transform",function(d,i){return"translate(0,-10)"}).attr("d",d3.symbol().size(30).type(d3.symbolTriangle)).attr("pointer-events","none").attr("opacity",0).transition().duration(1050).ease(d3.easeElastic).delay(function(d,i){return 40*i+1e3}).attr("opacity",function(d,i){return i<1?1:0}).attr("transform",function(d,i){return"translate("+x(nationalAverage[datafile[0].sector][i])+","+-10+") rotate(-60)"}),group.append("text").attr("class","triangle-label").attr("height",70).attr("x",0).attr("y",0).attr("width",chartWidth).attr("pointer-events","none").attr("transform",function(d,i){return"translate(10,-7)"}).attr("dy",0).text(function(d,i){return"NAT'L AVERAGE"}).attr("font-size",12).attr("opacity",0).transition().duration(1050).ease(d3.easeElastic).delay(function(d,i){return 40*i+1e3}).attr("opacity",function(d,i){return i<1?1:0}).attr("text-anchor","beginning").attr("transform",function(d,i){return"translate("+(x(nationalAverage[datafile[0].sector][i])-105)+","+-4+")"}),setTimeout(function(){group.on("mouseover",function(d,i){d3.select(".ft").selectAll(".triangle-label,.triangle").transition().duration(250).attr("opacity",0),d3.select(this).selectAll(".triangle-label,.triangle").transition().delay(60).duration(250).attr("opacity",1)}).on("mouseout",function(d,i){d3.select(".ft").selectAll(".triangle-label,.triangle").transition().duration(250).delay(60).attr("opacity",1),d3.select(this).selectAll(".triangle-label,.triangle").transition().duration(250).attr("opacity",0)})},1500)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findData=findData,exports.runData=runData;var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),_tooltip=require("./tooltip"),nationalAverage=(_interopRequireDefault(_tooltip),[[80.52,46.76],[61.38,43.76]]);(0,_jquery2.default)(window).width();exports.default={findData:findData,runData:runData}},{"./tooltip":96,d3:45,jquery:55}],92:[function(require,module,exports){"use strict";require("./home"),require("./details")},{"./details":85,"./home":89}],93:[function(require,module,exports){"use strict";$("document").ready(function(){$("#twitter-share").append('<a href="https://twitter.com/intent/tweet?text='+function(text){var via="undefined"!=typeof twitterTag?" @"+twitterTag:" @hechingerreport",returnText=text+via,arrayText=[];if(returnText.length+21<=280)return returnText;for(arrayText=text.split(" ");returnText.length+21>280;)arrayText.pop(),returnText=arrayText.join(" ")+via;return returnText}(leadText)+"&url="+encodeURI(storyURL)+'" class="popup"><i class="fab fa-twitter"></i></a>'),$("#facebook-share").append('<a  href="https://www.facebook.com/sharer/sharer.php?u='+encodeURI(storyURL)+'" class="popup"><i class="fab fa-facebook"></i></a>')})},{}],94:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function findData(price,selectedNetPrice){var chartablePrice=price.yearly_data.slice(0,9).reverse(),schoolString=void 0,schoolPrice=void 0;return schoolString=1===price.control?"public":"privateforprofit",schoolPrice=1===selectedNetPrice?"0_30000":2===selectedNetPrice?"30001_48000":3===selectedNetPrice?"48001_75000":4===selectedNetPrice?"75001_110000":"110001",chartablePrice.map(function(year){var stickerPriceType=void 0,onCampusCount=0,offCampusCount=0;for(var entry in price.yearly_data)null!==price.yearly_data[entry].price_instate_oncampus&&0!==price.yearly_data[entry].price_instate_oncampus||(offCampusCount+=1),null!==price.yearly_data[entry].price_instate_offcampus_nofamily&&0!==price.yearly_data[entry].price_instate_offcampus_nofamily||(onCampusCount+=1);return stickerPriceType=offCampusCount>=onCampusCount?"price_instate_offcampus_nofamily":"price_instate_oncampus",{timescale:year.year,stickerPrice:year[""+stickerPriceType],stickerPriceType:stickerPriceType,nyetPriceA:year["avg_net_price_0_30000_titleiv_"+schoolString],nyetPriceB:year["avg_net_price_30001_48000_titleiv_"+schoolString],nyetPriceC:year["avg_net_price_48001_75000_titleiv_"+schoolString],nyetPriceD:year["avg_net_price_75001_110000_titleiv_"+schoolString],nyetPriceE:year["avg_net_price_110001_titleiv_"+schoolString],netPrice:year["avg_net_price_"+schoolPrice+"_titleiv_"+schoolString]}})}function isitChartable(data){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var d=_step.value;if((d.stickerPriceOnCampus||d.stickerPriceOffCampus)&&d.netPrice)return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function runData(datafile){function mouseover(){focus.style("display",null),d3.selectAll("#sticker-price-chart-embed .points text").style("display",null)}function mouseout(){focus.style("display","none"),d3.selectAll("#sticker-price-chart-embed .points text").style("display","none")}function mousemove(){(0,_tooltip2.default)("#sticker-price-chart-embed",this,timeScales,datafile,x,y,z,focus)}isitChartable(datafile)||(0,_jquery2.default)("#sticker-price-container").hide();var window_width=(0,_jquery2.default)(window).width(),fullWidth=void 0;window_width>=650?fullWidth=600:window_width<=350?fullWidth=300:fullWidth=window_width-50;var commas=d3.format(","),margin={top:10,right:10,bottom:20,left:50},svg=d3.select("#sticker-price-chart-embed"),width=(0,_jquery2.default)("#sticker-price-chart-embed").width()-margin.left-margin.right,height=(0,_jquery2.default)("#sticker-price-chart-embed").height()-margin.top-margin.bottom,g=svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),x=d3.scaleBand().rangeRound([0,width]).padding(1),y=d3.scaleLinear().rangeRound([height,0]),z=d3.scaleOrdinal(["#036888","#D2392A","#D2392A","#D2392A"]),line=d3.line().x(function(d){return x(d.timescale)}).y(function(d){return y(d.total)});z.domain(d3.keys(datafile[0]).filter(function(key){return"timescale"!==key}));var trends=z.domain().map(function(name){return{name:name,values:datafile.map(function(d){return{timescale:d.timescale,total:+d[name]}})}});x.domain(datafile.map(function(d){return d.timescale})),y.domain([0,d3.max(trends,function(c){return d3.max(c.values,function(v){return v.total})})]).nice();var newTrends=trends.map(function(rate){return rate.values=rate.values.filter(function(item){return!isNaN(item.total)}),rate});x.domain(newTrends[0].values.map(function(d){return d.timescale})),y.domain([0,d3.max(newTrends,function(c){return d3.max(c.values,function(v){return v.total})})]);var trend=g.selectAll(".trend").data(newTrends).enter().append("g").attr("class","trend");trend.append("path").attr("class","line").attr("d",function(d){for(var keepValues=[],i=0;i<d.values.length;i++)d.values[i].total&&keepValues.push(d.values[i]);return line(keepValues)}).style("stroke-dasharray",function(d){if(d.name.includes("nyet"))return 3});g.selectAll(".points").data(trends).enter().append("g").attr("class",function(d){if("netPrice"==d.name||"stickerPrice"==d.name)return"points"}).append("text");trend.style("fill","#FFF").style("stroke",function(d){return"stickerPrice"==d.name?"#036888":"#D2392A"}).attr("opacity",function(d){if(d.name.includes("nyet"))return.3}).selectAll("circle.line").data(function(d){for(var keepValues=[],i=0;i<d.values.length;i++)!1===isNaN(d.values[i].total)&&0===d.values[i].total||keepValues.push(d.values[i]);return keepValues}).enter().append("circle").attr("r",3).style("stroke-width",3).attr("cx",function(d){return x(d.timescale)}).attr("cy",function(d){return y(d.total)}),g.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+height+")").call(d3.axisBottom(x)),g.append("g").attr("class","axis axis-y").call(d3.axisLeft(y).ticks(5).tickFormat(function(d){return"$"+commas(d)}));var focus=g.append("g").attr("class","focus").style("display","none");focus.append("line").attr("class","x-hover-line hover-line").attr("y1",0).attr("y2",height),svg.append("rect").attr("transform","translate("+margin.left+","+margin.top+")").attr("class","overlay").attr("width",width).attr("height",height).on("mouseover",mouseover).on("mouseout",mouseout).on("mousemove",mousemove);var timeScales=datafile.map(function(name){return x(name.timescale)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findData=findData,exports.runData=runData;var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),_tooltip=require("./tooltip"),_tooltip2=_interopRequireDefault(_tooltip);exports.default={findData:findData,runData:runData}},{"./tooltip":96,d3:45,jquery:55}],95:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function findData(price,selectedNetPrice){var chartablePrice=price.yearly_data.slice(0,11).reverse(),schoolPrice=void 0;return"public",schoolPrice=1===selectedNetPrice?"0_30000":2===selectedNetPrice?"30001_48000":3===selectedNetPrice?"48001_75000":4===selectedNetPrice?"75001_110000":"110001",chartablePrice.map(function(year){var stickerPriceType="price_instate_oncampus",onCampusCount=0,offCampusCount=0;for(var priceYear in chartablePrice)chartablePrice[priceYear].price_instate_oncampus>1&&(onCampusCount+=1),chartablePrice[priceYear].price_instate_offcampus_nofamily>1&&(offCampusCount+=1);return offCampusCount>onCampusCount&&(stickerPriceType="price_instate_offcampus_nofamily"),{timescale:year.year,stickerPrice:year[""+stickerPriceType],stickerPriceType:stickerPriceType,nyetPriceA:year.avg_net_price_0_30000_titleiv_privateforprofit,nyetPriceB:year.avg_net_price_30001_48000_titleiv_privateforprofit,nyetPriceC:year.avg_net_price_48001_75000_titleiv_privateforprofit,nyetPriceD:year.avg_net_price_75001_110000_titleiv_privateforprofit,nyetPriceE:year.avg_net_price_110001_titleiv_privateforprofit,netPrice:year["avg_net_price_"+schoolPrice+"_titleiv_privateforprofit"]}})}function isitChartable(data){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var d=_step.value;if((d.stickerPriceOnCampus||d.stickerPriceOffCampus)&&d.netPrice)return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}function runData(datafile){function mouseover(){focus.style("display",null),d3.selectAll("#sticker-price-chart .points text").style("display",null)}function mouseout(){focus.style("display","none"),d3.selectAll("#sticker-price-chart .points text").style("display","none")}function mousemove(){(0,_tooltip2.default)("#sticker-price-chart",this,timeScales,datafile,x,y,z,focus)}isitChartable(datafile)||(0,_jquery2.default)("#sticker-price-container").hide();var window_width=(0,_jquery2.default)(window).width(),fullWidth=void 0;window_width>=650?fullWidth=600:window_width<=350?fullWidth=200:fullWidth=window_width-180;var commas=d3.format(","),margin={top:20,right:20,bottom:30,left:50},svg=d3.select("#sticker-price-chart"),width=fullWidth-margin.left-margin.right,height=(0,_jquery2.default)("#sticker-price-chart").height()-margin.top-margin.bottom,x=d3.scaleBand().rangeRound([0,width]).padding(1),y=d3.scaleLinear().rangeRound([height,0]),z=d3.scaleOrdinal(["#036888","#D2392A","#D2392A","#D2392A"]),nx=d3.scaleBand().rangeRound([0,width]).padding(1),ny=d3.scaleLinear().rangeRound([height,0]),svgDefs=svg.append("defs"),mainGradient=svgDefs.append("linearGradient").attr("id","mainGradient");mainGradient.append("stop").attr("class","stop-left").attr("offset","0"),mainGradient.append("stop").attr("class","stop-right").attr("offset",".1");var filled=svg.append("rect").classed("filled",!0),g=svg.append("g").attr("transform","translate("+margin.left+","+margin.top+")"),line=d3.line().x(function(d){return x(d.timescale)}).y(function(d){return y(d.total)});z.domain(d3.keys(datafile[0]).filter(function(key){return"timescale"!==key}));var trends=z.domain().map(function(name){return{name:name,values:datafile.map(function(d){return{timescale:d.timescale,total:+d[name]}})}});nx.domain(datafile.map(function(d){return d.timescale})),ny.domain([0,d3.max(trends,function(c){return d3.max(c.values,function(v){return v.total})})+500]).nice();var newTrends=trends.map(function(rate){return rate.values=rate.values.filter(function(item){return!isNaN(item.total)}),rate});x.domain(newTrends[0].values.map(function(d){return d.timescale})),y.domain([0,d3.max(newTrends,function(c){return d3.max(c.values,function(v){return 1.1*v.total})})]);var trend=g.selectAll(".trend").data(newTrends).enter().append("g").attr("class","trend");trend.append("path").attr("class","line").attr("d",function(d){for(var keepValues=[],i=0;i<d.values.length;i++)d.values[i].total&&keepValues.push(d.values[i]);return line(keepValues)}).style("stroke-dasharray",function(d){if(d.name.includes("nyet"))return 3});g.selectAll(".points").data(trends).enter().append("g").attr("class",function(d){if("netPrice"==d.name||"stickerPrice"==d.name)return"points"}).append("text");trend.style("fill","#FFF").style("stroke",function(d){return"stickerPrice"==d.name?"#036888":"#D2392A"}).attr("opacity",function(d){if(d.name.includes("nyet"))return.3}).selectAll("circle.line").data(function(d){for(var keepValues=[],i=0;i<d.values.length;i++)!1===isNaN(d.values[i].total)&&0===d.values[i].total||keepValues.push(d.values[i]);return keepValues}).enter().append("circle").attr("r",3).attr("opacity",function(){return(0,_jquery2.default)(window).width()<=360?0:1}).style("stroke-width",3).attr("cx",function(d){return x(d.timescale)}).attr("cy",function(d){return y(d.total)}),g.append("g").attr("class","axis axis-x").attr("transform","translate(0, "+height+")").call(d3.axisBottom(x)),g.append("g").attr("class","axis axis-y").call(d3.axisLeft(y).ticks(5).tickFormat(function(d){return"$"+commas(d)})),g.append("text").classed("label-projected",!0).attr("y",height-10).attr("x",width-10).attr("text-anchor","end").text("Projected");var focus=g.append("g").attr("class","focus").style("display","none");focus.append("line").attr("class","x-hover-line hover-line").attr("y1",0).attr("y2",height),svg.append("rect").attr("transform","translate("+margin.left+","+margin.top+")").attr("class","overlay").attr("width",width).attr("height",height).on("mouseover",mouseover).on("mouseout",mouseout).on("mousemove",mousemove),filled.attr("transform","translate("+margin.left+",0)").attr("x",x("16-17")).attr("y",margin.top).attr("width",width-x("16-17")).attr("opacity",.3).attr("height",height);var timeScales=datafile.map(function(name){return x(name.timescale)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.findData=findData,exports.runData=runData;var _jquery=require("jquery"),_jquery2=_interopRequireDefault(_jquery),_d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),_tooltip=require("./tooltip"),_tooltip2=_interopRequireDefault(_tooltip);exports.default={findData:findData,runData:runData}},{"./tooltip":96,d3:45,jquery:55}],96:[function(require,module,exports){"use strict";function tooltip(selector,chart,timeScales,chartData,x,y,z,focus,usePct){var i=d3.bisect(timeScales,d3.mouse(chart)[0],1)-1,di=chartData[i];focus.attr("transform","translate("+x(di.timescale)+",0)"),d3.selectAll(selector+" .points text").each(function(d,index){d3.select(this).attr("transform","translate(0,0)").attr("x",x(di.timescale)+5).attr("y",function(d){var iClamped=(0,_utils.clampIndex)(i,d.values),nextDatumIndexClamped=(0,_utils.clampIndex)(i+1,d.values),yOffset=17;return d.values[nextDatumIndexClamped].total-d.values[iClamped].total<0&&(yOffset=-7),100==d.values[iClamped].total&&(yOffset=24),yOffset+=2*index,y(d.values[iClamped].total)<25&&(yOffset+=10),y(d.values[iClamped].total)+yOffset}).attr("text-anchor",function(d){return"17-18"==di.timescale?"middle":"start"}).text(function(d){var value=void 0;return value=void 0===d.values[i]||0==d.values[i].total?"":(0,_utils.commas)(Math.round(d.values[i].total)),usePct&&value.length>0?value+"%":value.length>0?"$"+value:value}).style("fill",function(d){return d3.rgb(z(d.name)).darker(.5)}).style("font-weight","bold")}),arrangeLabels(selector)}function arrangeLabels(selektor){for(var move=1;move>0;)move=0,d3.selectAll(selektor+" .points text").each(function(){var that=this,a=this.getBoundingClientRect();d3.selectAll(selektor+" .points text").each(function(){if(this!=that){var b=this.getBoundingClientRect();if(2*Math.abs(a.left-b.left)<a.width+b.width&&2*Math.abs(a.top-b.top)<a.height+b.height){var dx=.01*(Math.max(0,a.right-b.left)+Math.min(0,a.left-b.right)),dy=.02*(Math.max(0,a.bottom-b.top)+Math.min(0,a.top-b.bottom)),tt=getTranslation(d3.select(this).attr("transform")),to=getTranslation(d3.select(that).attr("transform"));move+=Math.abs(dx)+Math.abs(dy),to.translate=[to[0]+dx,to[1]+dy],tt.translate=[tt[0]-dx,tt[1]-dy],d3.select(this).attr("transform","translate("+tt.translate+")"),d3.select(that).attr("transform","translate("+to.translate+")"),a=this.getBoundingClientRect()}}})})}function getTranslation(transform){var g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"transform",transform);var matrix=g.transform.baseVal.consolidate().matrix;return[matrix.e,matrix.f]}var _d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),_utils=require("./utils");module.exports=tooltip},{"./utils":97,d3:45}],97:[function(require,module,exports){"use strict";function clampIndex(index,array){return Math.min(Math.max(index,0),array.length-1)}var _d=require("d3"),d3=function(obj){if(obj&&obj.__esModule)return obj;var newObj={};if(null!=obj)for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(newObj[key]=obj[key]);return newObj.default=obj,newObj}(_d),commas=d3.format(",");module.exports={clampIndex:clampIndex,commas:commas}},{d3:45}]},{},[92]);
//# sourceMappingURL=scripts-bundle.js.map
